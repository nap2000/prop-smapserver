(()=>{var B="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function U(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function F(t,e){return t(e={exports:{}},e.exports),e.exports}var m=F(function(t){var e,n;e="undefined"!=typeof window?window:B,n=function(b,M){function v(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item}function B(t){return null!=t&&t===t.window}var e=[],U=Object.getPrototypeOf,s=e.slice,F=e.flat?function(t){return e.flat.call(t)}:function(t){return e.concat.apply([],t)},V=e.push,_=e.indexOf,H={},z=H.toString,j=H.hasOwnProperty,q=j.toString,W=q.call(Object),g={},C=b.document,G={type:!0,src:!0,nonce:!0,noModule:!0};function $(t,e,n){var r,i,o=(n=n||C).createElement("script");if(o.text=t,e)for(r in G)(i=e[r]||e.getAttribute&&e.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function K(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?H[z.call(t)]||"object":typeof t}var X=/HTML$/i,E=function(t,e){return new E.fn.init(t,e)};function Z(t){var e=!!t&&"length"in t&&t.length,n=K(t);return!v(t)&&!B(t)&&("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t)}function w(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}E.fn=E.prototype={jquery:"3.7.1",constructor:E,length:0,toArray:function(){return s.call(this)},get:function(t){return null==t?s.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){t=E.merge(this.constructor(),t);return t.prevObject=this,t},each:function(t){return E.each(this,t)},map:function(n){return this.pushStack(E.map(this,function(t,e){return n.call(t,e,t)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(E.grep(this,function(t,e){return(e+1)%2}))},odd:function(){return this.pushStack(E.grep(this,function(t,e){return e%2}))},eq:function(t){var e=this.length,t=+t+(t<0?e:0);return this.pushStack(0<=t&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:V,sort:e.sort,splice:e.splice},E.extend=E.fn.extend=function(){var t,e,n,r,i,o=arguments[0]||{},a=1,s=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||v(o)||(o={}),a===s&&(o=this,a--);a<s;a++)if(null!=(t=arguments[a]))for(e in t)n=t[e],"__proto__"!==e&&o!==n&&(l&&n&&(E.isPlainObject(n)||(r=Array.isArray(n)))?(i=o[e],i=r&&!Array.isArray(i)?[]:r||E.isPlainObject(i)?i:{},r=!1,o[e]=E.extend(l,i,n)):void 0!==n&&(o[e]=n));return o},E.extend({expando:"jQuery"+("3.7.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){return!(!t||"[object Object]"!==z.call(t)||(t=U(t))&&("function"!=typeof(t=j.call(t,"constructor")&&t.constructor)||q.call(t)!==W))},isEmptyObject:function(t){for(var e in t)return!1;return!0},globalEval:function(t,e,n){$(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,r=0;if(Z(t))for(n=t.length;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},text:function(t){var e,n="",r=0,i=t.nodeType;if(!i)for(;e=t[r++];)n+=E.text(e);return 1===i||11===i?t.textContent:9===i?t.documentElement.textContent:3===i||4===i?t.nodeValue:n},makeArray:function(t,e){e=e||[];return null!=t&&(Z(Object(t))?E.merge(e,"string"==typeof t?[t]:t):V.call(e,t)),e},inArray:function(t,e,n){return null==e?-1:_.call(e,t,n)},isXMLDoc:function(t){var e=t&&t.namespaceURI,t=t&&(t.ownerDocument||t).documentElement;return!X.test(e||t&&t.nodeName||"HTML")},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,o=t.length,a=!n;i<o;i++)!e(t[i],i)!=a&&r.push(t[i]);return r},map:function(t,e,n){var r,i,o=0,a=[];if(Z(t))for(r=t.length;o<r;o++)null!=(i=e(t[o],o,n))&&a.push(i);else for(o in t)null!=(i=e(t[o],o,n))&&a.push(i);return F(a)},guid:1,support:g}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=e[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){H["[object "+e+"]"]=e.toLowerCase()});var Y=e.pop,Q=e.sort,J=e.splice,n="[\\x20\\t\\r\\n\\f]",tt=new RegExp("^"+n+"+|((?:^|[^\\\\])(?:\\\\.)*)"+n+"+$","g"),et=(E.contains=function(t,e){e=e&&e.parentNode;return t===e||!(!e||1!==e.nodeType||!(t.contains?t.contains(e):t.compareDocumentPosition&&16&t.compareDocumentPosition(e)))},/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g);function nt(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t}E.escapeSelector=function(t){return(t+"").replace(et,nt)};var rt,S,it,ot,at,T,r,A,d,st,i=C,lt=V,I=lt,L=E.expando,k=0,ut=0,ct=kt(),ht=kt(),dt=kt(),pt=kt(),ft=function(t,e){return t===e&&(at=!0),0},gt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",t="(?:\\\\[\\da-fA-F]{1,6}"+n+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",o="\\["+n+"*("+t+")(?:"+n+"*([*^$|!~]?=)"+n+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+t+"))|)"+n+"*\\]",a=":("+t+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+o+")*)|.*)\\)|)",mt=new RegExp(n+"+","g"),yt=new RegExp("^"+n+"*,"+n+"*"),vt=new RegExp("^"+n+"*([>+~]|"+n+")"+n+"*"),_t=new RegExp(n+"|>"),wt=new RegExp(a),bt=new RegExp("^"+t+"$"),Ct={ID:new RegExp("^#("+t+")"),CLASS:new RegExp("^\\.("+t+")"),TAG:new RegExp("^("+t+"|[*])"),ATTR:new RegExp("^"+o),PSEUDO:new RegExp("^"+a),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+n+"*(even|odd|(([+-]|)(\\d*)n|)"+n+"*(?:([+-]|)"+n+"*(\\d+)|))"+n+"*\\)|)","i"),bool:new RegExp("^(?:"+gt+")$","i"),needsContext:new RegExp("^"+n+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+n+"*((?:-\\d)?\\d*)"+n+"*\\)|)(?=[^-]|$)","i")},Et=/^(?:input|select|textarea|button)$/i,St=/^h\d$/i,Tt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,At=/[+~]/,h=new RegExp("\\\\[\\da-fA-F]{1,6}"+n+"?|\\\\([^\\r\\n\\f])","g"),p=function(t,e){t="0x"+t.slice(1)-65536;return e||(t<0?String.fromCharCode(65536+t):String.fromCharCode(t>>10|55296,1023&t|56320))},It=function(){Pt()},Lt=Ut(function(t){return!0===t.disabled&&w(t,"fieldset")},{dir:"parentNode",next:"legend"});try{I.apply(e=s.call(i.childNodes),i.childNodes),e[i.childNodes.length].nodeType}catch(t){I={apply:function(t,e){lt.apply(t,s.call(e))},call:function(t){lt.apply(t,s.call(arguments,1))}}}function x(e,t,n,r){var i,o,a,s,l,u,c=t&&t.ownerDocument,h=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return n;if(!r&&(Pt(t),t=t||T,A)){if(11!==h&&(s=Tt.exec(e)))if(i=s[1]){if(9===h){if(!(u=t.getElementById(i)))return n;if(u.id===i)return I.call(n,u),n}else if(c&&(u=c.getElementById(i))&&x.contains(t,u)&&u.id===i)return I.call(n,u),n}else{if(s[2])return I.apply(n,t.getElementsByTagName(e)),n;if((i=s[3])&&t.getElementsByClassName)return I.apply(n,t.getElementsByClassName(i)),n}if(!(pt[e+" "]||d&&d.test(e))){if(u=e,c=t,1===h&&(_t.test(e)||vt.test(e))){for((c=At.test(e)&&Rt(t.parentNode)||t)==t&&g.scope||((a=t.getAttribute("id"))?a=E.escapeSelector(a):t.setAttribute("id",a=L)),o=(l=Mt(e)).length;o--;)l[o]=(a?"#"+a:":scope")+" "+Bt(l[o]);u=l.join(",")}try{return I.apply(n,c.querySelectorAll(u)),n}catch(t){pt(e,!0)}finally{a===L&&t.removeAttribute("id")}}}return qt(e.replace(tt,"$1"),t,n,r)}function kt(){var n=[];function r(t,e){return n.push(t+" ")>S.cacheLength&&delete r[n.shift()],r[t+" "]=e}return r}function l(t){return t[L]=!0,t}function xt(t){var e=T.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e)}}function Dt(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Lt(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function Nt(a){return l(function(o){return o=+o,l(function(t,e){for(var n,r=a([],t.length,o),i=r.length;i--;)t[n=r[i]]&&(t[n]=!(e[n]=t[n]))})})}function Rt(t){return t&&void 0!==t.getElementsByTagName&&t}function Pt(t){var t=t?t.ownerDocument||t:i;return t!=T&&9===t.nodeType&&t.documentElement&&(r=(T=t).documentElement,A=!E.isXMLDoc(T),st=r.matches||r.webkitMatchesSelector||r.msMatchesSelector,r.msMatchesSelector&&i!=T&&(t=T.defaultView)&&t.top!==t&&t.addEventListener("unload",It),g.getById=xt(function(t){return r.appendChild(t).id=E.expando,!T.getElementsByName||!T.getElementsByName(E.expando).length}),g.disconnectedMatch=xt(function(t){return st.call(t,"*")}),g.scope=xt(function(){return T.querySelectorAll(":scope")}),g.cssHas=xt(function(){try{T.querySelector(":has(*,:jqfake)")}catch(t){return 1}}),g.getById?(S.filter.ID=function(t){var e=t.replace(h,p);return function(t){return t.getAttribute("id")===e}},S.find.ID=function(t,e){if(void 0!==e.getElementById&&A)return(e=e.getElementById(t))?[e]:[]}):(S.filter.ID=function(t){var e=t.replace(h,p);return function(t){t=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return t&&t.value===e}},S.find.ID=function(t,e){if(void 0!==e.getElementById&&A){var n,r,i,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(i=e.getElementsByName(t),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),S.find.TAG=function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):e.querySelectorAll(t)},S.find.CLASS=function(t,e){if(void 0!==e.getElementsByClassName&&A)return e.getElementsByClassName(t)},d=[],xt(function(t){var e;r.appendChild(t).innerHTML="<a id='"+L+"' href='' disabled='disabled'></a><select id='"+L+"-\r\\' disabled='disabled'><option selected=''></option></select>",t.querySelectorAll("[selected]").length||d.push("\\["+n+"*(?:value|"+gt+")"),t.querySelectorAll("[id~="+L+"-]").length||d.push("~="),t.querySelectorAll("a#"+L+"+*").length||d.push(".#.+[+~]"),t.querySelectorAll(":checked").length||d.push(":checked"),(e=T.createElement("input")).setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),r.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(e=T.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||d.push("\\["+n+"*name"+n+"*="+n+"*(?:''|\"\")")}),g.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),ft=function(t,e){var n;return t===e?(at=!0,0):(n=!t.compareDocumentPosition-!e.compareDocumentPosition)||(1&(n=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!g.sortDetached&&e.compareDocumentPosition(t)===n?t===T||t.ownerDocument==i&&x.contains(i,t)?-1:e===T||e.ownerDocument==i&&x.contains(i,e)?1:ot?_.call(ot,t)-_.call(ot,e):0:4&n?-1:1)}),T}for(rt in x.matches=function(t,e){return x(t,null,null,e)},x.matchesSelector=function(t,e){if(Pt(t),A&&!pt[e+" "]&&(!d||!d.test(e)))try{var n=st.call(t,e);if(n||g.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){pt(e,!0)}return 0<x(e,T,null,[t]).length},x.contains=function(t,e){return(t.ownerDocument||t)!=T&&Pt(t),E.contains(t,e)},x.attr=function(t,e){(t.ownerDocument||t)!=T&&Pt(t);var n=S.attrHandle[e.toLowerCase()],n=n&&j.call(S.attrHandle,e.toLowerCase())?n(t,e,!A):void 0;return void 0!==n?n:t.getAttribute(e)},x.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},E.uniqueSort=function(t){var e,n=[],r=0,i=0;if(at=!g.sortStable,ot=!g.sortStable&&s.call(t,0),Q.call(t,ft),at){for(;e=t[i++];)e===t[i]&&(r=n.push(i));for(;r--;)J.call(t,n[r],1)}return ot=null,t},E.fn.uniqueSort=function(){return this.pushStack(E.uniqueSort(s.apply(this)))},(S=E.expr={cacheLength:50,createPseudo:l,match:Ct,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(h,p),t[3]=(t[3]||t[4]||t[5]||"").replace(h,p),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||x.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&x.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Ct.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&wt.test(n)&&(e=(e=Mt(n,!0))&&n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(h,p).toLowerCase();return"*"===t?function(){return!0}:function(t){return w(t,e)}},CLASS:function(t){var e=ct[t+" "];return e||(e=new RegExp("(^|"+n+")"+t+"("+n+"|$)"))&&ct(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(t){t=x.attr(t,e);return null==t?"!="===n:!n||(t+="","="===n?t===r:"!="===n?t!==r:"^="===n?r&&0===t.indexOf(r):"*="===n?r&&-1<t.indexOf(r):"$="===n?r&&t.slice(-r.length)===r:"~="===n?-1<(" "+t.replace(mt," ")+" ").indexOf(r):"|="===n&&(t===r||t.slice(0,r.length+1)===r+"-"))}},CHILD:function(p,t,e,f,g){var m="nth"!==p.slice(0,3),y="last"!==p.slice(-4),v="of-type"===t;return 1===f&&0===g?function(t){return!!t.parentNode}:function(t,e,n){var r,i,o,a,s,l=m!=y?"nextSibling":"previousSibling",u=t.parentNode,c=v&&t.nodeName.toLowerCase(),h=!n&&!v,d=!1;if(u){if(m){for(;l;){for(o=t;o=o[l];)if(v?w(o,c):1===o.nodeType)return!1;s=l="only"===p&&!s&&"nextSibling"}return!0}if(s=[y?u.firstChild:u.lastChild],y&&h){for(d=(a=(r=(i=u[L]||(u[L]={}))[p]||[])[0]===k&&r[1])&&r[2],o=a&&u.childNodes[a];o=++a&&o&&o[l]||(d=a=0,s.pop());)if(1===o.nodeType&&++d&&o===t){i[p]=[k,a,d];break}}else if(!1===(d=h?a=(r=(i=t[L]||(t[L]={}))[p]||[])[0]===k&&r[1]:d))for(;(o=++a&&o&&o[l]||(d=a=0,s.pop()))&&((v?!w(o,c):1!==o.nodeType)||!++d||(h&&((i=o[L]||(o[L]={}))[p]=[k,d]),o!==t)););return(d-=g)===f||d%f==0&&0<=d/f}}},PSEUDO:function(t,o){var e,a=S.pseudos[t]||S.setFilters[t.toLowerCase()]||x.error("unsupported pseudo: "+t);return a[L]?a(o):1<a.length?(e=[t,t,"",o],S.setFilters.hasOwnProperty(t.toLowerCase())?l(function(t,e){for(var n,r=a(t,o),i=r.length;i--;)t[n=_.call(t,r[i])]=!(e[n]=r[i])}):function(t){return a(t,0,e)}):a}},pseudos:{not:l(function(t){var r=[],i=[],s=jt(t.replace(tt,"$1"));return s[L]?l(function(t,e,n,r){for(var i,o=s(t,null,r,[]),a=t.length;a--;)(i=o[a])&&(t[a]=!(e[a]=i))}):function(t,e,n){return r[0]=t,s(r,null,n,i),r[0]=null,!i.pop()}}),has:l(function(e){return function(t){return 0<x(e,t).length}}),contains:l(function(e){return e=e.replace(h,p),function(t){return-1<(t.textContent||E.text(t)).indexOf(e)}}),lang:l(function(n){return bt.test(n||"")||x.error("unsupported lang: "+n),n=n.replace(h,p).toLowerCase(),function(t){var e;do{if(e=A?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===n||0===e.indexOf(n+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=b.location&&b.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===r},focus:function(t){return t===(()=>{try{return T.activeElement}catch(t){}})()&&T.hasFocus()&&!!(t.type||t.href||~t.tabIndex)},enabled:Dt(!1),disabled:Dt(!0),checked:function(t){return w(t,"input")&&!!t.checked||w(t,"option")&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!S.pseudos.empty(t)},header:function(t){return St.test(t.nodeName)},input:function(t){return Et.test(t.nodeName)},button:function(t){return w(t,"input")&&"button"===t.type||w(t,"button")},text:function(t){return w(t,"input")&&"text"===t.type&&(null==(t=t.getAttribute("type"))||"text"===t.toLowerCase())},first:Nt(function(){return[0]}),last:Nt(function(t,e){return[e-1]}),eq:Nt(function(t,e,n){return[n<0?n+e:n]}),even:Nt(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:Nt(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:Nt(function(t,e,n){for(var r=n<0?n+e:e<n?e:n;0<=--r;)t.push(r);return t}),gt:Nt(function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t})}}).pseudos.nth=S.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[rt]=(e=>function(t){return w(t,"input")&&t.type===e})(rt);for(rt in{submit:!0,reset:!0})S.pseudos[rt]=(e=>function(t){return(w(t,"input")||w(t,"button"))&&t.type===e})(rt);function Ot(){}function Mt(t,e){var n,r,i,o,a,s,l,u=ht[t+" "];if(u)return e?0:u.slice(0);for(a=t,s=[],l=S.preFilter;a;){for(o in n&&!(r=yt.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=vt.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(tt," ")}),a=a.slice(n.length)),S.filter)!(r=Ct[o].exec(a))||l[o]&&!(r=l[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?x.error(t):ht(t,s).slice(0)}function Bt(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function Ut(a,t,e){var s=t.dir,l=t.next,u=l||s,c=e&&"parentNode"===u,h=ut++;return t.first?function(t,e,n){for(;t=t[s];)if(1===t.nodeType||c)return a(t,e,n);return!1}:function(t,e,n){var r,i,o=[k,h];if(n){for(;t=t[s];)if((1===t.nodeType||c)&&a(t,e,n))return!0}else for(;t=t[s];)if(1===t.nodeType||c)if(i=t[L]||(t[L]={}),l&&w(t,l))t=t[s]||t;else{if((r=i[u])&&r[0]===k&&r[1]===h)return o[2]=r[2];if((i[u]=o)[2]=a(t,e,n))return!0}return!1}}function Ft(i){return 1<i.length?function(t,e,n){for(var r=i.length;r--;)if(!i[r](t,e,n))return!1;return!0}:i[0]}function Vt(t,e,n,r,i){for(var o,a=[],s=0,l=t.length,u=null!=e;s<l;s++)!(o=t[s])||n&&!n(o,r,i)||(a.push(o),u&&e.push(s));return a}function Ht(p,f,g,m,y,t){return m&&!m[L]&&(m=Ht(m)),y&&!y[L]&&(y=Ht(y,t)),l(function(t,e,n,r){var i,o,a,s,l=[],u=[],c=e.length,h=t||((t,e,n)=>{for(var r=0,i=e.length;r<i;r++)x(t,e[r],n);return n})(f||"*",n.nodeType?[n]:n,[]),d=!p||!t&&f?h:Vt(h,l,p,n,r);if(g?g(d,s=y||(t?p:c||m)?[]:e,n,r):s=d,m)for(i=Vt(s,u),m(i,[],n,r),o=i.length;o--;)(a=i[o])&&(s[u[o]]=!(d[u[o]]=a));if(t){if(y||p){if(y){for(i=[],o=s.length;o--;)(a=s[o])&&i.push(d[o]=a);y(null,s=[],i,r)}for(o=s.length;o--;)(a=s[o])&&-1<(i=y?_.call(t,a):l[o])&&(t[i]=!(e[i]=a))}}else s=Vt(s===e?s.splice(c,s.length):s),y?y(null,e,s,r):I.apply(e,s)})}function zt(m,y){function t(t,e,n,r,i){var o,a,s,l=0,u="0",c=t&&[],h=[],d=it,p=t||_&&S.find.TAG("*",i),f=k+=null==d?1:Math.random()||.1,g=p.length;for(i&&(it=e==T||e||i);u!==g&&null!=(o=p[u]);u++){if(_&&o){for(a=0,e||o.ownerDocument==T||(Pt(o),n=!A);s=m[a++];)if(s(o,e||T,n)){I.call(r,o);break}i&&(k=f)}v&&((o=!s&&o)&&l--,t)&&c.push(o)}if(l+=u,v&&u!==l){for(a=0;s=y[a++];)s(c,h,e,n);if(t){if(0<l)for(;u--;)c[u]||h[u]||(h[u]=Y.call(r));h=Vt(h)}I.apply(r,h),i&&!t&&0<h.length&&1<l+y.length&&E.uniqueSort(r)}return i&&(k=f,it=d),c}var v=0<y.length,_=0<m.length;return v?l(t):t}function jt(t,e){var n,r=[],i=[],o=dt[t+" "];if(!o){for(n=(e=e||Mt(t)).length;n--;)((o=function t(e){for(var r,n,i,o=e.length,a=S.relative[e[0].type],s=a||S.relative[" "],l=a?1:0,u=Ut(function(t){return t===r},s,!0),c=Ut(function(t){return-1<_.call(r,t)},s,!0),h=[function(t,e,n){return t=!a&&(n||e!=it)||((r=e).nodeType?u:c)(t,e,n),r=null,t}];l<o;l++)if(n=S.relative[e[l].type])h=[Ut(Ft(h),n)];else{if((n=S.filter[e[l].type].apply(null,e[l].matches))[L]){for(i=++l;i<o&&!S.relative[e[i].type];i++);return Ht(1<l&&Ft(h),1<l&&Bt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(tt,"$1"),n,l<i&&t(e.slice(l,i)),i<o&&t(e=e.slice(i)),i<o&&Bt(e))}h.push(n)}return Ft(h)}(e[n]))[L]?r:i).push(o);(o=dt(t,zt(i,r))).selector=t}return o}function qt(t,e,n,r){var i,o,a,s,l,u="function"==typeof t&&t,c=!r&&Mt(t=u.selector||t);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===e.nodeType&&A&&S.relative[o[1].type]){if(!(e=(S.find.ID(a.matches[0].replace(h,p),e)||[])[0]))return n;u&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(i=Ct.needsContext.test(t)?0:o.length;i--&&(a=o[i],!S.relative[s=a.type]);)if((l=S.find[s])&&(r=l(a.matches[0].replace(h,p),At.test(o[0].type)&&Rt(e.parentNode)||e))){if(o.splice(i,1),t=r.length&&Bt(o))break;return I.apply(n,r),n}}return(u||jt(t,c))(r,e,!A,n,!e||At.test(t)&&Rt(e.parentNode)||e),n}Ot.prototype=S.filters=S.pseudos,S.setFilters=new Ot,g.sortStable=L.split("").sort(ft).join("")===L,Pt(),g.sortDetached=xt(function(t){return 1&t.compareDocumentPosition(T.createElement("fieldset"))}),E.find=x,E.expr[":"]=E.expr.pseudos,E.unique=E.uniqueSort,x.compile=jt,x.select=qt,x.setDocument=Pt,x.tokenize=Mt,x.escape=E.escapeSelector,x.getText=E.text,x.isXML=E.isXMLDoc,x.selectors=E.expr,x.support=E.support,x.uniqueSort=E.uniqueSort;function Wt(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&E(t).is(n))break;r.push(t)}return r}function Gt(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}var $t=E.expr.match.needsContext,Kt=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Xt(t,n,r){return v(n)?E.grep(t,function(t,e){return!!n.call(t,e,t)!==r}):n.nodeType?E.grep(t,function(t){return t===n!==r}):"string"!=typeof n?E.grep(t,function(t){return-1<_.call(n,t)!==r}):E.filter(n,t,r)}E.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?E.find.matchesSelector(r,t)?[r]:[]:E.find.matches(t,E.grep(e,function(t){return 1===t.nodeType}))},E.fn.extend({find:function(t){var e,n,r=this.length,i=this;if("string"!=typeof t)return this.pushStack(E(t).filter(function(){for(e=0;e<r;e++)if(E.contains(i[e],this))return!0}));for(n=this.pushStack([]),e=0;e<r;e++)E.find(t,i[e],n);return 1<r?E.uniqueSort(n):n},filter:function(t){return this.pushStack(Xt(this,t||[],!1))},not:function(t){return this.pushStack(Xt(this,t||[],!0))},is:function(t){return!!Xt(this,"string"==typeof t&&$t.test(t)?E(t):t||[],!1).length}});var Zt,Yt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Qt=((E.fn.init=function(t,e,n){if(t){if(n=n||Zt,"string"!=typeof t)return t.nodeType?(this[0]=t,this.length=1,this):v(t)?void 0!==n.ready?n.ready(t):t(E):E.makeArray(t,this);if(!(r="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:Yt.exec(t))||!r[1]&&e)return(!e||e.jquery?e||n:this.constructor(e)).find(t);if(r[1]){if(e=e instanceof E?e[0]:e,E.merge(this,E.parseHTML(r[1],e&&e.nodeType?e.ownerDocument||e:C,!0)),Kt.test(r[1])&&E.isPlainObject(e))for(var r in e)v(this[r])?this[r](e[r]):this.attr(r,e[r])}else(n=C.getElementById(r[2]))&&(this[0]=n,this.length=1)}return this}).prototype=E.fn,Zt=E(C),/^(?:parents|prev(?:Until|All))/),Jt={children:!0,contents:!0,next:!0,prev:!0};function te(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}E.fn.extend({has:function(t){var e=E(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(E.contains(this,e[t]))return!0})},closest:function(t,e){var n,r=0,i=this.length,o=[],a="string"!=typeof t&&E(t);if(!$t.test(t))for(;r<i;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&E.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(1<o.length?E.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?_.call(E(t),this[0]):_.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),E.each({parent:function(t){t=t.parentNode;return t&&11!==t.nodeType?t:null},parents:function(t){return Wt(t,"parentNode")},parentsUntil:function(t,e,n){return Wt(t,"parentNode",n)},next:function(t){return te(t,"nextSibling")},prev:function(t){return te(t,"previousSibling")},nextAll:function(t){return Wt(t,"nextSibling")},prevAll:function(t){return Wt(t,"previousSibling")},nextUntil:function(t,e,n){return Wt(t,"nextSibling",n)},prevUntil:function(t,e,n){return Wt(t,"previousSibling",n)},siblings:function(t){return Gt((t.parentNode||{}).firstChild,t)},children:function(t){return Gt(t.firstChild)},contents:function(t){return null!=t.contentDocument&&U(t.contentDocument)?t.contentDocument:(w(t,"template")&&(t=t.content||t),E.merge([],t.childNodes))}},function(r,i){E.fn[r]=function(t,e){var n=E.map(this,i,t);return(e="Until"!==r.slice(-5)?t:e)&&"string"==typeof e&&(n=E.filter(e,n)),1<this.length&&(Jt[r]||E.uniqueSort(n),Qt.test(r))&&n.reverse(),this.pushStack(n)}});var D=/[^\x20\t\r\n\f]+/g;function ee(t){return t}function ne(t){throw t}function re(t,e,n,r){var i;try{t&&v(i=t.promise)?i.call(t).done(e).fail(n):t&&v(i=t.then)?i.call(t,e,n):e.apply(void 0,[t].slice(r))}catch(t){n.apply(void 0,[t])}}E.Callbacks=function(r){var t,n;r="string"==typeof r?(t=r,n={},E.each(t.match(D)||[],function(t,e){n[e]=!0}),n):E.extend({},r);function i(){for(s=s||r.once,a=o=!0;u.length;c=-1)for(e=u.shift();++c<l.length;)!1===l[c].apply(e[0],e[1])&&r.stopOnFalse&&(c=l.length,e=!1);r.memory||(e=!1),o=!1,s&&(l=e?[]:"")}var o,e,a,s,l=[],u=[],c=-1,h={add:function(){return l&&(e&&!o&&(c=l.length-1,u.push(e)),function n(t){E.each(t,function(t,e){v(e)?r.unique&&h.has(e)||l.push(e):e&&e.length&&"string"!==K(e)&&n(e)})}(arguments),e)&&!o&&i(),this},remove:function(){return E.each(arguments,function(t,e){for(var n;-1<(n=E.inArray(e,l,n));)l.splice(n,1),n<=c&&c--}),this},has:function(t){return t?-1<E.inArray(t,l):0<l.length},empty:function(){return l=l&&[],this},disable:function(){return s=u=[],l=e="",this},disabled:function(){return!l},lock:function(){return s=u=[],e||o||(l=e=""),this},locked:function(){return!!s},fireWith:function(t,e){return s||(e=[t,(e=e||[]).slice?e.slice():e],u.push(e),o)||i(),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!a}};return h},E.extend({Deferred:function(t){var o=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return a.then(null,t)},pipe:function(){var i=arguments;return E.Deferred(function(r){E.each(o,function(t,e){var n=v(i[e[4]])&&i[e[4]];s[e[1]](function(){var t=n&&n.apply(this,arguments);t&&v(t.promise)?t.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[e[0]+"With"](this,n?[t]:arguments)})}),i=null}).promise()},then:function(e,n,r){var l=0;function u(i,o,a,s){return function(){function t(){var t,e;if(!(i<l)){if((t=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");e=t&&("object"==typeof t||"function"==typeof t)&&t.then,v(e)?s?e.call(t,u(l,o,ee,s),u(l,o,ne,s)):(l++,e.call(t,u(l,o,ee,s),u(l,o,ne,s),u(l,o,ee,o.notifyWith))):(a!==ee&&(n=void 0,r=[t]),(s||o.resolveWith)(n,r))}}var n=this,r=arguments,e=s?t:function(){try{t()}catch(t){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(t,e.error),l<=i+1&&(a!==ne&&(n=void 0,r=[t]),o.rejectWith(n,r))}};i?e():(E.Deferred.getErrorHook?e.error=E.Deferred.getErrorHook():E.Deferred.getStackHook&&(e.error=E.Deferred.getStackHook()),b.setTimeout(e))}}return E.Deferred(function(t){o[0][3].add(u(0,t,v(r)?r:ee,t.notifyWith)),o[1][3].add(u(0,t,v(e)?e:ee)),o[2][3].add(u(0,t,v(n)?n:ne))}).promise()},promise:function(t){return null!=t?E.extend(t,a):a}},s={};return E.each(o,function(t,e){var n=e[2],r=e[5];a[e[1]]=n.add,r&&n.add(function(){i=r},o[3-t][2].disable,o[3-t][3].disable,o[0][2].lock,o[0][3].lock),n.add(e[3].fire),s[e[0]]=function(){return s[e[0]+"With"](this===s?void 0:this,arguments),this},s[e[0]+"With"]=n.fireWith}),a.promise(s),t&&t.call(s,s),s},when:function(t){function e(e){return function(t){i[e]=this,o[e]=1<arguments.length?s.call(arguments):t,--n||a.resolveWith(i,o)}}var n=arguments.length,r=n,i=Array(r),o=s.call(arguments),a=E.Deferred();if(n<=1&&(re(t,a.done(e(r)).resolve,a.reject,!n),"pending"===a.state()||v(o[r]&&o[r].then)))return a.then();for(;r--;)re(o[r],e(r),a.reject);return a.promise()}});var ie=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/,oe=(E.Deferred.exceptionHook=function(t,e){b.console&&b.console.warn&&t&&ie.test(t.name)&&b.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},E.readyException=function(t){b.setTimeout(function(){throw t})},E.Deferred());function ae(){C.removeEventListener("DOMContentLoaded",ae),b.removeEventListener("load",ae),E.ready()}E.fn.ready=function(t){return oe.then(t).catch(function(t){E.readyException(t)}),this},E.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--E.readyWait:E.isReady)||(E.isReady=!0)!==t&&0<--E.readyWait||oe.resolveWith(C,[E])}}),E.ready.then=oe.then,"complete"===C.readyState||"loading"!==C.readyState&&!C.documentElement.doScroll?b.setTimeout(E.ready):(C.addEventListener("DOMContentLoaded",ae),b.addEventListener("load",ae));function c(t,e,n,r,i,o,a){var s=0,l=t.length,u=null==n;if("object"===K(n))for(s in i=!0,n)c(t,e,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,v(r)||(a=!0),e=u?a?(e.call(t,r),null):(u=e,function(t,e,n){return u.call(E(t),n)}):e))for(;s<l;s++)e(t[s],n,a?r:r.call(t[s],s,e(t[s],n)));return i?t:u?e.call(t):l?e(t[0],n):o}var se=/^-ms-/,le=/-([a-z])/g;function ue(t,e){return e.toUpperCase()}function N(t){return t.replace(se,"ms-").replace(le,ue)}function ce(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}function he(){this.expando=E.expando+he.uid++}he.uid=1,he.prototype={cache:function(t){var e=t[this.expando];return e||(e={},ce(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var r,i=this.cache(t);if("string"==typeof e)i[N(e)]=n;else for(r in e)i[N(r)]=e[r];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][N(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r=t[this.expando];if(void 0!==r){if(void 0!==e){n=(e=Array.isArray(e)?e.map(N):(e=N(e))in r?[e]:e.match(D)||[]).length;for(;n--;)delete r[e[n]]}void 0!==e&&!E.isEmptyObject(r)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){t=t[this.expando];return void 0!==t&&!E.isEmptyObject(t)}};var y=new he,u=new he,de=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,pe=/[A-Z]/g;function fe(t,e,n){var r,i;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(pe,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:de.test(i)?JSON.parse(i):i)}catch(t){}u.set(t,e,n)}else n=void 0;return n}E.extend({hasData:function(t){return u.hasData(t)||y.hasData(t)},data:function(t,e,n){return u.access(t,e,n)},removeData:function(t,e){u.remove(t,e)},_data:function(t,e,n){return y.access(t,e,n)},_removeData:function(t,e){y.remove(t,e)}}),E.fn.extend({data:function(n,t){var e,r,i,o=this[0],a=o&&o.attributes;if(void 0!==n)return"object"==typeof n?this.each(function(){u.set(this,n)}):c(this,function(t){var e;if(o&&void 0===t)return void 0!==(e=u.get(o,n))||void 0!==(e=fe(o,n))?e:void 0;this.each(function(){u.set(this,n,t)})},null,t,1<arguments.length,null,!0);if(this.length&&(i=u.get(o),1===o.nodeType)&&!y.get(o,"hasDataAttrs")){for(e=a.length;e--;)a[e]&&0===(r=a[e].name).indexOf("data-")&&(r=N(r.slice(5)),fe(o,r,i[r]));y.set(o,"hasDataAttrs",!0)}return i},removeData:function(t){return this.each(function(){u.remove(this,t)})}}),E.extend({queue:function(t,e,n){var r;if(t)return r=y.get(t,e=(e||"fx")+"queue"),n&&(!r||Array.isArray(n)?r=y.access(t,e,E.makeArray(n)):r.push(n)),r||[]},dequeue:function(t,e){e=e||"fx";var n=E.queue(t,e),r=n.length,i=n.shift(),o=E._queueHooks(t,e);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,function(){E.dequeue(t,e)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return y.get(t,n)||y.access(t,n,{empty:E.Callbacks("once memory").add(function(){y.remove(t,[e+"queue",n])})})}}),E.fn.extend({queue:function(e,n){var t=2;return"string"!=typeof e&&(n=e,e="fx",t--),arguments.length<t?E.queue(this[0],e):void 0===n?this:this.each(function(){var t=E.queue(this,e,n);E._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&E.dequeue(this,e)})},dequeue:function(t){return this.each(function(){E.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function n(){--i||o.resolveWith(a,[a])}var r,i=1,o=E.Deferred(),a=this,s=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(r=y.get(a[s],t+"queueHooks"))&&r.empty&&(i++,r.empty.add(n));return n(),o.promise(e)}});function ge(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&_e(t)&&"none"===E.css(t,"display")}var t=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,me=new RegExp("^(?:([+-])=|)("+t+")([a-z%]*)$","i"),ye=["Top","Right","Bottom","Left"],ve=C.documentElement,_e=function(t){return E.contains(t.ownerDocument,t)},we={composed:!0};ve.getRootNode&&(_e=function(t){return E.contains(t.ownerDocument,t)||t.getRootNode(we)===t.ownerDocument});function be(t,e,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return E.css(t,e,"")},l=s(),u=n&&n[3]||(E.cssNumber[e]?"":"px"),c=t.nodeType&&(E.cssNumber[e]||"px"!==u&&+l)&&me.exec(E.css(t,e));if(c&&c[3]!==u){for(u=u||c[3],c=+(l/=2)||1;a--;)E.style(t,e,c+u),(1-o)*(1-(o=s()/l||.5))<=0&&(a=0),c/=o;E.style(t,e,(c*=2)+u),n=n||[]}return n&&(c=+c||+l||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r)&&(r.unit=u,r.start=c,r.end=i),i}var Ce={};function Ee(t,e){for(var n,r,i,o,a,s=[],l=0,u=t.length;l<u;l++)(r=t[l]).style&&(n=r.style.display,e?("none"===n&&(s[l]=y.get(r,"display")||null,s[l]||(r.style.display="")),""===r.style.display&&ge(r)&&(s[l]=(a=o=void 0,o=(i=r).ownerDocument,(a=Ce[i=i.nodeName])||(o=o.body.appendChild(o.createElement(i)),a=E.css(o,"display"),o.parentNode.removeChild(o),Ce[i]=a="none"===a?"block":a),a))):"none"!==n&&(s[l]="none",y.set(r,"display",n)));for(l=0;l<u;l++)null!=s[l]&&(t[l].style.display=s[l]);return t}E.fn.extend({show:function(){return Ee(this,!0)},hide:function(){return Ee(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){ge(this)?E(this).show():E(this).hide()})}});var Se=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ae=/^$|^module$|\/(?:java|ecma)script/i,f=(o=C.createDocumentFragment().appendChild(C.createElement("div")),(a=C.createElement("input")).setAttribute("type","radio"),a.setAttribute("checked","checked"),a.setAttribute("name","t"),o.appendChild(a),g.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,o.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!o.cloneNode(!0).lastChild.defaultValue,o.innerHTML="<option></option>",g.option=!!o.lastChild,{thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]});function m(t,e){var n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&w(t,e)?E.merge([t],n):n}function Ie(t,e){for(var n=0,r=t.length;n<r;n++)y.set(t[n],"globalEval",!e||y.get(e[n],"globalEval"))}f.tbody=f.tfoot=f.colgroup=f.caption=f.thead,f.th=f.td,g.option||(f.optgroup=f.option=[1,"<select multiple='multiple'>","</select>"]);var Le=/<|&#?\w+;/;function ke(t,e,n,r,i){for(var o,a,s,l,u,c=e.createDocumentFragment(),h=[],d=0,p=t.length;d<p;d++)if((o=t[d])||0===o)if("object"===K(o))E.merge(h,o.nodeType?[o]:o);else if(Le.test(o)){for(a=a||c.appendChild(e.createElement("div")),s=(Te.exec(o)||["",""])[1].toLowerCase(),s=f[s]||f._default,a.innerHTML=s[1]+E.htmlPrefilter(o)+s[2],u=s[0];u--;)a=a.lastChild;E.merge(h,a.childNodes),(a=c.firstChild).textContent=""}else h.push(e.createTextNode(o));for(c.textContent="",d=0;o=h[d++];)if(r&&-1<E.inArray(o,r))i&&i.push(o);else if(l=_e(o),a=m(c.appendChild(o),"script"),l&&Ie(a),n)for(u=0;o=a[u++];)Ae.test(o.type||"")&&n.push(o);return c}var xe=/^([^.]*)(?:\.(.+)|)/;function De(){return!0}function Ne(){return!1}function Re(t,e,n,r,i,o){var a,s;if("object"==typeof e){for(s in"string"!=typeof n&&(r=r||n,n=void 0),e)Re(t,s,n,r,e[s],o);return t}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Ne;else if(!i)return t;return 1===o&&(a=i,(i=function(t){return E().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=E.guid++)),t.each(function(){E.event.add(this,e,i,r,n)})}function Pe(t,r,e){e?(y.set(t,r,!1),E.event.add(t,r,{namespace:!1,handler:function(t){var e,n=y.get(this,r);if(1&t.isTrigger&&this[r]){if(n)(E.event.special[r]||{}).delegateType&&t.stopPropagation();else if(n=s.call(arguments),y.set(this,r,n),this[r](),e=y.get(this,r),y.set(this,r,!1),n!==e)return t.stopImmediatePropagation(),t.preventDefault(),e}else n&&(y.set(this,r,E.event.trigger(n[0],n.slice(1),this)),t.stopPropagation(),t.isImmediatePropagationStopped=De)}})):void 0===y.get(t,r)&&E.event.add(t,r,De)}E.event={global:{},add:function(e,t,n,r,i){var o,a,s,l,u,c,h,d,p,f=y.get(e);if(ce(e))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&E.find.matchesSelector(ve,i),n.guid||(n.guid=E.guid++),s=(s=f.events)||(f.events=Object.create(null)),a=(a=f.handle)||(f.handle=function(t){return void 0!==E&&E.event.triggered!==t.type?E.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(D)||[""]).length;l--;)h=p=(d=xe.exec(t[l])||[])[1],d=(d[2]||"").split(".").sort(),h&&(u=E.event.special[h]||{},h=(i?u.delegateType:u.bindType)||h,u=E.event.special[h]||{},p=E.extend({type:h,origType:p,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&E.expr.match.needsContext.test(i),namespace:d.join(".")},o),(c=s[h])||((c=s[h]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,r,d,a))||e.addEventListener&&e.addEventListener(h,a),u.add&&(u.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),i?c.splice(c.delegateCount++,0,p):c.push(p),E.event.global[h]=!0)},remove:function(t,e,n,r,i){var o,a,s,l,u,c,h,d,p,f,g,m=y.hasData(t)&&y.get(t);if(m&&(l=m.events)){for(u=(e=(e||"").match(D)||[""]).length;u--;)if(p=g=(s=xe.exec(e[u])||[])[1],f=(s[2]||"").split(".").sort(),p){for(h=E.event.special[p]||{},d=l[p=(r?h.delegateType:h.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)c=d[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(t,c));a&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,f,m.handle)||E.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)E.event.remove(t,p+e[u],n,r,!0);E.isEmptyObject(l)&&y.remove(t,"handle events")}},dispatch:function(t){var e,n,r,i,o,a=new Array(arguments.length),s=E.event.fix(t),t=(y.get(this,"events")||Object.create(null))[s.type]||[],l=E.event.special[s.type]||{};for(a[0]=s,e=1;e<arguments.length;e++)a[e]=arguments[e];if(s.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,s)){for(o=E.event.handlers.call(this,s,t),e=0;(r=o[e++])&&!s.isPropagationStopped();)for(s.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!1!==i.namespace&&!s.rnamespace.test(i.namespace)||(s.handleObj=i,s.data=i.data,void 0!==(i=((E.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,a))&&!1===(s.result=i)&&(s.preventDefault(),s.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,s),s.result}},handlers:function(t,e){var n,r,i,o,a,s=[],l=e.delegateCount,u=t.target;if(l&&u.nodeType&&!("click"===t.type&&1<=t.button))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==t.type||!0!==u.disabled)){for(o=[],a={},n=0;n<l;n++)void 0===a[i=(r=e[n]).selector+" "]&&(a[i]=r.needsContext?-1<E(i,this).index(u):E.find(i,this,null,[u]).length),a[i]&&o.push(r);o.length&&s.push({elem:u,handlers:o})}return u=this,l<e.length&&s.push({elem:u,handlers:e.slice(l)}),s},addProp:function(e,t){Object.defineProperty(E.Event.prototype,e,{enumerable:!0,configurable:!0,get:v(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(t){return t[E.expando]?t:new E.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){t=this||t;return Se.test(t.type)&&t.click&&w(t,"input")&&Pe(t,"click",!0),!1},trigger:function(t){t=this||t;return Se.test(t.type)&&t.click&&w(t,"input")&&Pe(t,"click"),!0},_default:function(t){t=t.target;return Se.test(t.type)&&t.click&&w(t,"input")&&y.get(t,"click")||w(t,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},E.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},E.Event=function(t,e){if(!(this instanceof E.Event))return new E.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?De:Ne,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&E.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:Ne,isPropagationStopped:Ne,isImmediatePropagationStopped:Ne,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=De,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=De,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=De,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},function(r,i){function o(t){var e,n;C.documentMode?(e=y.get(this,"handle"),(n=E.event.fix(t)).type="focusin"===t.type?"focus":"blur",n.isSimulated=!0,e(t),n.target===n.currentTarget&&e(n)):E.event.simulate(i,t.target,E.event.fix(t))}E.event.special[r]={setup:function(){var t;if(Pe(this,r,!0),!C.documentMode)return!1;(t=y.get(this,i))||this.addEventListener(i,o),y.set(this,i,(t||0)+1)},trigger:function(){return Pe(this,r),!0},teardown:function(){var t;if(!C.documentMode)return!1;(t=y.get(this,i)-1)?y.set(this,i,t):(this.removeEventListener(i,o),y.remove(this,i))},_default:function(t){return y.get(t.target,r)},delegateType:i},E.event.special[i]={setup:function(){var t=this.ownerDocument||this.document||this,e=C.documentMode?this:t,n=y.get(e,i);n||(C.documentMode?this.addEventListener(i,o):t.addEventListener(r,o,!0)),y.set(e,i,(n||0)+1)},teardown:function(){var t=this.ownerDocument||this.document||this,e=C.documentMode?this:t,n=y.get(e,i)-1;n?y.set(e,i,n):(C.documentMode?this.removeEventListener(i,o):t.removeEventListener(r,o,!0),y.remove(e,i))}}}),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,i){E.event.special[t]={delegateType:i,bindType:i,handle:function(t){var e,n=t.relatedTarget,r=t.handleObj;return n&&(n===this||E.contains(this,n))||(t.type=r.origType,e=r.handler.apply(this,arguments),t.type=i),e}}}),E.fn.extend({on:function(t,e,n,r){return Re(this,t,e,n,r)},one:function(t,e,n,r){return Re(this,t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)r=t.handleObj,E(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler);else{if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=Ne),this.each(function(){E.event.remove(this,t,n,e)});for(i in t)this.off(i,e,t[i])}return this}});var Oe=/<script|<style|<link/i,Me=/checked\s*(?:[^=]|=\s*.checked.)/i,Be=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Ue(t,e){return w(t,"table")&&w(11!==e.nodeType?e:e.firstChild,"tr")&&E(t).children("tbody")[0]||t}function Fe(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Ve(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function He(t,e){var n,r,i,o;if(1===e.nodeType){if(y.hasData(t)&&(o=y.get(t).events))for(i in y.remove(e,"handle events"),o)for(n=0,r=o[i].length;n<r;n++)E.event.add(e,i,o[i][n]);u.hasData(t)&&(t=u.access(t),t=E.extend({},t),u.set(e,t))}}function ze(n,r,i,o){r=F(r);var t,e,a,s,l,u,c=0,h=n.length,d=h-1,p=r[0],f=v(p);if(f||1<h&&"string"==typeof p&&!g.checkClone&&Me.test(p))return n.each(function(t){var e=n.eq(t);f&&(r[0]=p.call(this,t,e.html())),ze(e,r,i,o)});if(h&&(e=(t=ke(r,n[0].ownerDocument,!1,n,o)).firstChild,1===t.childNodes.length&&(t=e),e||o)){for(s=(a=E.map(m(t,"script"),Fe)).length;c<h;c++)l=t,c!==d&&(l=E.clone(l,!0,!0),s)&&E.merge(a,m(l,"script")),i.call(n[c],l,c);if(s)for(u=a[a.length-1].ownerDocument,E.map(a,Ve),c=0;c<s;c++)l=a[c],Ae.test(l.type||"")&&!y.access(l,"globalEval")&&E.contains(u,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?E._evalUrl&&!l.noModule&&E._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},u):$(l.textContent.replace(Be,""),l,u))}return n}function je(t,e,n){for(var r,i=e?E.filter(e,t):t,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||E.cleanData(m(r)),r.parentNode&&(n&&_e(r)&&Ie(m(r,"script")),r.parentNode.removeChild(r));return t}E.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var r,i,o,a,s,l,u,c=t.cloneNode(!0),h=_e(t);if(!(g.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||E.isXMLDoc(t)))for(a=m(c),r=0,i=(o=m(t)).length;r<i;r++)s=o[r],l=a[r],u=void 0,"input"===(u=l.nodeName.toLowerCase())&&Se.test(s.type)?l.checked=s.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=s.defaultValue);if(e)if(n)for(o=o||m(t),a=a||m(c),r=0,i=o.length;r<i;r++)He(o[r],a[r]);else He(t,c);return 0<(a=m(c,"script")).length&&Ie(a,!h&&m(t,"script")),c},cleanData:function(t){for(var e,n,r,i=E.event.special,o=0;void 0!==(n=t[o]);o++)if(ce(n)){if(e=n[y.expando]){if(e.events)for(r in e.events)i[r]?E.event.remove(n,r):E.removeEvent(n,r,e.handle);n[y.expando]=void 0}n[u.expando]&&(n[u.expando]=void 0)}}}),E.fn.extend({detach:function(t){return je(this,t,!0)},remove:function(t){return je(this,t)},text:function(t){return c(this,function(t){return void 0===t?E.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return ze(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ue(this,t).appendChild(t)})},prepend:function(){return ze(this,arguments,function(t){var e;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(e=Ue(this,t)).insertBefore(t,e.firstChild)})},before:function(){return ze(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return ze(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(E.cleanData(m(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return E.clone(this,t,e)})},html:function(t){return c(this,function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Oe.test(t)&&!f[(Te.exec(t)||["",""])[1].toLowerCase()]){t=E.htmlPrefilter(t);try{for(;n<r;n++)1===(e=this[n]||{}).nodeType&&(E.cleanData(m(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var n=[];return ze(this,arguments,function(t){var e=this.parentNode;E.inArray(this,n)<0&&(E.cleanData(m(this)),e)&&e.replaceChild(t,this)},n)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,a){E.fn[t]=function(t){for(var e,n=[],r=E(t),i=r.length-1,o=0;o<=i;o++)e=o===i?this:this.clone(!0),E(r[o])[a](e),V.apply(n,e.get());return this.pushStack(n)}});function qe(t){var e=t.ownerDocument.defaultView;return(e=e&&e.opener?e:b).getComputedStyle(t)}function We(t,e,n){var r,i={};for(r in e)i[r]=t.style[r],t.style[r]=e[r];for(r in n=n.call(t),e)t.style[r]=i[r];return n}var Ge,$e,Ke,Xe,Ze,Ye,Qe,R,Je=new RegExp("^("+t+")(?!px)[a-z%]+$","i"),tn=/^--/,en=new RegExp(ye.join("|"),"i");function nn(){var t;R&&(Qe.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",R.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ve.appendChild(Qe).appendChild(R),t=b.getComputedStyle(R),Ge="1%"!==t.top,Ye=12===rn(t.marginLeft),R.style.right="60%",Xe=36===rn(t.right),$e=36===rn(t.width),R.style.position="absolute",Ke=12===rn(R.offsetWidth/3),ve.removeChild(Qe),R=null)}function rn(t){return Math.round(parseFloat(t))}function on(t,e,n){var r,i=tn.test(e),o=t.style;return(n=n||qe(t))&&(r=n.getPropertyValue(e)||n[e],""!==(r=i?r&&(r.replace(tt,"$1")||void 0):r)||_e(t)||(r=E.style(t,e)),!g.pixelBoxStyles())&&Je.test(r)&&en.test(e)&&(i=o.width,t=o.minWidth,e=o.maxWidth,o.minWidth=o.maxWidth=o.width=r,r=n.width,o.width=i,o.minWidth=t,o.maxWidth=e),void 0!==r?r+"":r}function an(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}Qe=C.createElement("div"),(R=C.createElement("div")).style&&(R.style.backgroundClip="content-box",R.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===R.style.backgroundClip,E.extend(g,{boxSizingReliable:function(){return nn(),$e},pixelBoxStyles:function(){return nn(),Xe},pixelPosition:function(){return nn(),Ge},reliableMarginLeft:function(){return nn(),Ye},scrollboxSize:function(){return nn(),Ke},reliableTrDimensions:function(){var t,e,n;return null==Ze&&(t=C.createElement("table"),e=C.createElement("tr"),n=C.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",e.style.cssText="box-sizing:content-box;border:1px solid",e.style.height="1px",n.style.height="9px",n.style.display="block",ve.appendChild(t).appendChild(e).appendChild(n),n=b.getComputedStyle(e),Ze=parseInt(n.height,10)+parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)===e.offsetHeight,ve.removeChild(t)),Ze}}));var sn=["Webkit","Moz","ms"],ln=C.createElement("div").style,un={};function cn(t){var e=E.cssProps[t]||un[t];return e||(t in ln?t:un[t]=(t=>{for(var e=t[0].toUpperCase()+t.slice(1),n=sn.length;n--;)if((t=sn[n]+e)in ln)return t})(t)||t)}var hn=/^(none|table(?!-c[ea]).+)/,dn={position:"absolute",visibility:"hidden",display:"block"},pn={letterSpacing:"0",fontWeight:"400"};function fn(t,e,n){var r=me.exec(e);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):e}function gn(t,e,n,r,i,o){var a="width"===e?1:0,s=0,l=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=E.css(t,n+ye[a],!0,i)),r?("content"===n&&(l-=E.css(t,"padding"+ye[a],!0,i)),"margin"!==n&&(l-=E.css(t,"border"+ye[a]+"Width",!0,i))):(l+=E.css(t,"padding"+ye[a],!0,i),"padding"!==n?l+=E.css(t,"border"+ye[a]+"Width",!0,i):s+=E.css(t,"border"+ye[a]+"Width",!0,i));return!r&&0<=o&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-s-.5))||0),l+u}function mn(t,e,n){var r=qe(t),i=(!g.boxSizingReliable()||n)&&"border-box"===E.css(t,"boxSizing",!1,r),o=i,a=on(t,e,r),s="offset"+e[0].toUpperCase()+e.slice(1);if(Je.test(a)){if(!n)return a;a="auto"}return(!g.boxSizingReliable()&&i||!g.reliableTrDimensions()&&w(t,"tr")||"auto"===a||!parseFloat(a)&&"inline"===E.css(t,"display",!1,r))&&t.getClientRects().length&&(i="border-box"===E.css(t,"boxSizing",!1,r),o=s in t)&&(a=t[s]),(a=parseFloat(a)||0)+gn(t,e,n||(i?"border":"content"),o,r,a)+"px"}function P(t,e,n,r,i){return new P.prototype.init(t,e,n,r,i)}E.extend({cssHooks:{opacity:{get:function(t,e){if(e)return""===(e=on(t,"opacity"))?"1":e}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,o,a,s=N(e),l=tn.test(e),u=t.style;if(l||(e=cn(s)),a=E.cssHooks[e]||E.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(t,!1,r))?i:u[e];"string"===(o=typeof n)&&(i=me.exec(n))&&i[1]&&(n=be(t,e,i),o="number"),null==n||n!=n||("number"!==o||l||(n+=i&&i[3]||(E.cssNumber[s]?"":"px")),g.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,r)))||(l?u.setProperty(e,n):u[e]=n)}},css:function(t,e,n,r){var i,o=N(e);return tn.test(e)||(e=cn(o)),"normal"===(i=void 0===(i=(o=E.cssHooks[e]||E.cssHooks[o])&&"get"in o?o.get(t,!0,n):i)?on(t,e,r):i)&&e in pn&&(i=pn[e]),(""===n||n)&&(o=parseFloat(i),!0===n||isFinite(o))?o||0:i}}),E.each(["height","width"],function(t,a){E.cssHooks[a]={get:function(t,e,n){if(e)return!hn.test(E.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?mn(t,a,n):We(t,dn,function(){return mn(t,a,n)})},set:function(t,e,n){var r=qe(t),i=!g.scrollboxSize()&&"absolute"===r.position,o=(i||n)&&"border-box"===E.css(t,"boxSizing",!1,r),n=n?gn(t,a,n,o,r):0;return o&&i&&(n-=Math.ceil(t["offset"+a[0].toUpperCase()+a.slice(1)]-parseFloat(r[a])-gn(t,a,"border",!1,r)-.5)),n&&(o=me.exec(e))&&"px"!==(o[3]||"px")&&(t.style[a]=e,e=E.css(t,a)),fn(0,e,n)}}}),E.cssHooks.marginLeft=an(g.reliableMarginLeft,function(t,e){if(e)return(parseFloat(on(t,"marginLeft"))||t.getBoundingClientRect().left-We(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),E.each({margin:"",padding:"",border:"Width"},function(i,o){E.cssHooks[i+o]={expand:function(t){for(var e=0,n={},r="string"==typeof t?t.split(" "):[t];e<4;e++)n[i+ye[e]+o]=r[e]||r[e-2]||r[0];return n}},"margin"!==i&&(E.cssHooks[i+o].set=fn)}),E.fn.extend({css:function(t,e){return c(this,function(t,e,n){var r,i,o={},a=0;if(Array.isArray(e)){for(r=qe(t),i=e.length;a<i;a++)o[e[a]]=E.css(t,e[a],!1,r);return o}return void 0!==n?E.style(t,e,n):E.css(t,e)},t,e,1<arguments.length)}}),((E.Tween=P).prototype={constructor:P,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||E.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(E.cssNumber[n]?"":"px")},cur:function(){var t=P.propHooks[this.prop];return(t&&t.get?t:P.propHooks._default).get(this)},run:function(t){var e,n=P.propHooks[this.prop];return this.options.duration?this.pos=e=E.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(n&&n.set?n:P.propHooks._default).set(this),this}}).init.prototype=P.prototype,(P.propHooks={_default:{get:function(t){return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(t=E.css(t.elem,t.prop,""))&&"auto"!==t?t:0},set:function(t){E.fx.step[t.prop]?E.fx.step[t.prop](t):1!==t.elem.nodeType||!E.cssHooks[t.prop]&&null==t.elem.style[cn(t.prop)]?t.elem[t.prop]=t.now:E.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=P.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},E.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},E.fx=P.prototype.init,E.fx.step={};var yn,vn,_n=/^(?:toggle|show|hide)$/,wn=/queueHooks$/;function bn(){vn&&(!1===C.hidden&&b.requestAnimationFrame?b.requestAnimationFrame(bn):b.setTimeout(bn,E.fx.interval),E.fx.tick())}function Cn(){return b.setTimeout(function(){yn=void 0}),yn=Date.now()}function En(t,e){var n,r=0,i={height:t};for(e=e?1:0;r<4;r+=2-e)i["margin"+(n=ye[r])]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function Sn(t,e,n){for(var r,i=(O.tweeners[e]||[]).concat(O.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,e,t))return r}function O(i,t,e){var n,o,r,a,s,l,u,c=0,h=O.prefilters.length,d=E.Deferred().always(function(){delete p.elem}),p=function(){if(!o){for(var t=yn||Cn(),t=Math.max(0,f.startTime+f.duration-t),e=1-(t/f.duration||0),n=0,r=f.tweens.length;n<r;n++)f.tweens[n].run(e);if(d.notifyWith(i,[f,e,t]),e<1&&r)return t;r||d.notifyWith(i,[f,1,0]),d.resolveWith(i,[f])}return!1},f=d.promise({elem:i,props:E.extend({},t),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},e),originalProperties:t,originalOptions:e,startTime:yn||Cn(),duration:e.duration,tweens:[],createTween:function(t,e){e=E.Tween(i,f.opts,t,e,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(e),e},stop:function(t){var e=0,n=t?f.tweens.length:0;if(!o){for(o=!0;e<n;e++)f.tweens[e].run(1);t?(d.notifyWith(i,[f,1,0]),d.resolveWith(i,[f,t])):d.rejectWith(i,[f,t])}return this}}),g=f.props,m=g,y=f.opts.specialEasing;for(r in m)if(s=y[a=N(r)],l=m[r],Array.isArray(l)&&(s=l[1],l=m[r]=l[0]),r!==a&&(m[a]=l,delete m[r]),(u=E.cssHooks[a])&&"expand"in u)for(r in l=u.expand(l),delete m[a],l)r in m||(m[r]=l[r],y[r]=s);else y[a]=s;for(;c<h;c++)if(n=O.prefilters[c].call(f,i,g,f.opts))return v(n.stop)&&(E._queueHooks(f.elem,f.opts.queue).stop=n.stop.bind(n)),n;return E.map(g,Sn,f),v(f.opts.start)&&f.opts.start.call(i,f),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always),E.fx.timer(E.extend(p,{elem:i,anim:f,queue:f.opts.queue})),f}E.Animation=E.extend(O,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return be(n.elem,t,me.exec(e),n),n}]},tweener:function(t,e){for(var n,r=0,i=(t=v(t)?(e=t,["*"]):t.match(D)).length;r<i;r++)n=t[r],O.tweeners[n]=O.tweeners[n]||[],O.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var r,i,o,a,s,l,u,c="width"in e||"height"in e,h=this,d={},p=t.style,f=t.nodeType&&ge(t),g=y.get(t,"fxshow");for(r in n.queue||(null==(a=E._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,E.queue(t,"fx").length||a.empty.fire()})})),e)if(i=e[r],_n.test(i)){if(delete e[r],o=o||"toggle"===i,i===(f?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;f=!0}d[r]=g&&g[r]||E.style(t,r)}if((l=!E.isEmptyObject(e))||!E.isEmptyObject(d))for(r in c&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(u=g&&g.display)&&(u=y.get(t,"display")),"none"===(c=E.css(t,"display"))&&(u?c=u:(Ee([t],!0),u=t.style.display||u,c=E.css(t,"display"),Ee([t]))),"inline"===c||"inline-block"===c&&null!=u)&&"none"===E.css(t,"float")&&(l||(h.done(function(){p.display=u}),null==u&&(c=p.display,u="none"===c?"":c)),p.display="inline-block"),n.overflow&&(p.overflow="hidden",h.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),l=!1,d)l||(g?"hidden"in g&&(f=g.hidden):g=y.access(t,"fxshow",{display:u}),o&&(g.hidden=!f),f&&Ee([t],!0),h.done(function(){for(r in f||Ee([t]),y.remove(t,"fxshow"),d)E.style(t,r,d[r])})),l=Sn(f?g[r]:0,r,h),r in g||(g[r]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?O.prefilters.unshift(t):O.prefilters.push(t)}}),E.speed=function(t,e,n){var r=t&&"object"==typeof t?E.extend({},t):{complete:n||!n&&e||v(t)&&t,duration:t,easing:n&&e||e&&!v(e)&&e};return E.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in E.fx.speeds?r.duration=E.fx.speeds[r.duration]:r.duration=E.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&E.dequeue(this,r.queue)},r},E.fn.extend({fadeTo:function(t,e,n,r){return this.filter(ge).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(e,t,n,r){function i(){var t=O(this,E.extend({},e),a);(o||y.get(this,"finish"))&&t.stop(!0)}var o=E.isEmptyObject(e),a=E.speed(t,n,r);return i.finish=i,o||!1===a.queue?this.each(i):this.queue(a.queue,i)},stop:function(i,t,o){function a(t){var e=t.stop;delete t.stop,e(o)}return"string"!=typeof i&&(o=t,t=i,i=void 0),t&&this.queue(i||"fx",[]),this.each(function(){var t=!0,e=null!=i&&i+"queueHooks",n=E.timers,r=y.get(this);if(e)r[e]&&r[e].stop&&a(r[e]);else for(e in r)r[e]&&r[e].stop&&wn.test(e)&&a(r[e]);for(e=n.length;e--;)n[e].elem!==this||null!=i&&n[e].queue!==i||(n[e].anim.stop(o),t=!1,n.splice(e,1));!t&&o||E.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var t,e=y.get(this),n=e[a+"queue"],r=e[a+"queueHooks"],i=E.timers,o=n?n.length:0;for(e.finish=!0,E.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===a&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<o;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete e.finish})}}),E.each(["toggle","show","hide"],function(t,r){var i=E.fn[r];E.fn[r]=function(t,e,n){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(En(r,!0),t,e,n)}}),E.each({slideDown:En("show"),slideUp:En("hide"),slideToggle:En("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,r){E.fn[t]=function(t,e,n){return this.animate(r,t,e,n)}}),E.timers=[],E.fx.tick=function(){var t,e=0,n=E.timers;for(yn=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||E.fx.stop(),yn=void 0},E.fx.timer=function(t){E.timers.push(t),E.fx.start()},E.fx.interval=13,E.fx.start=function(){vn||(vn=!0,bn())},E.fx.stop=function(){vn=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(r,t){return r=E.fx&&E.fx.speeds[r]||r,this.queue(t=t||"fx",function(t,e){var n=b.setTimeout(t,r);e.stop=function(){b.clearTimeout(n)}})},a=C.createElement("input"),o=C.createElement("select").appendChild(C.createElement("option")),a.type="checkbox",g.checkOn=""!==a.value,g.optSelected=o.selected,(a=C.createElement("input")).value="t",a.type="radio",g.radioValue="t"===a.value;var Tn,An=E.expr.attrHandle,In=(E.fn.extend({attr:function(t,e){return c(this,E.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){E.removeAttr(this,t)})}}),E.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?E.prop(t,e,n):(1===o&&E.isXMLDoc(t)||(i=E.attrHooks[e.toLowerCase()]||(E.expr.match.bool.test(e)?Tn:void 0)),void 0!==n?null===n?void E.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):!(i&&"get"in i&&null!==(r=i.get(t,e)))&&null==(r=E.find.attr(t,e))?void 0:r)},attrHooks:{type:{set:function(t,e){var n;if(!g.radioValue&&"radio"===e&&w(t,"input"))return n=t.value,t.setAttribute("type",e),n&&(t.value=n),e}}},removeAttr:function(t,e){var n,r=0,i=e&&e.match(D);if(i&&1===t.nodeType)for(;n=i[r++];)t.removeAttribute(n)}}),Tn={set:function(t,e,n){return!1===e?E.removeAttr(t,n):t.setAttribute(n,n),n}},E.each(E.expr.match.bool.source.match(/\w+/g),function(t,e){var a=An[e]||E.find.attr;An[e]=function(t,e,n){var r,i,o=e.toLowerCase();return n||(i=An[o],An[o]=r,r=null!=a(t,e,n)?o:null,An[o]=i),r}}),/^(?:input|select|textarea|button)$/i),Ln=/^(?:a|area)$/i;function kn(t){return(t.match(D)||[]).join(" ")}function xn(t){return t.getAttribute&&t.getAttribute("class")||""}function Dn(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(D)||[]}E.fn.extend({prop:function(t,e){return c(this,E.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[E.propFix[t]||t]})}}),E.extend({prop:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&E.isXMLDoc(t)||(e=E.propFix[e]||e,i=E.propHooks[e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=E.find.attr(t,"tabindex");return e?parseInt(e,10):In.test(t.nodeName)||Ln.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(E.propHooks.selected={get:function(t){t=t.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(t){t=t.parentNode;t&&(t.selectedIndex,t.parentNode)&&t.parentNode.selectedIndex}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){E.propFix[this.toLowerCase()]=this}),E.fn.extend({addClass:function(e){var t,n,r,i,o,a;return v(e)?this.each(function(t){E(this).addClass(e.call(this,t,xn(this)))}):(t=Dn(e)).length?this.each(function(){if(r=xn(this),n=1===this.nodeType&&" "+kn(r)+" "){for(o=0;o<t.length;o++)i=t[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=kn(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(e){var t,n,r,i,o,a;return v(e)?this.each(function(t){E(this).removeClass(e.call(this,t,xn(this)))}):arguments.length?(t=Dn(e)).length?this.each(function(){if(r=xn(this),n=1===this.nodeType&&" "+kn(r)+" "){for(o=0;o<t.length;o++)for(i=t[o];-1<n.indexOf(" "+i+" ");)n=n.replace(" "+i+" "," ");a=kn(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(e,n){var t,r,i,o,a=typeof e,s="string"==a||Array.isArray(e);return v(e)?this.each(function(t){E(this).toggleClass(e.call(this,t,xn(this),n),n)}):"boolean"==typeof n&&s?n?this.addClass(e):this.removeClass(e):(t=Dn(e),this.each(function(){if(s)for(o=E(this),i=0;i<t.length;i++)r=t[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==e&&"boolean"!=a||((r=xn(this))&&y.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",!r&&!1!==e&&y.get(this,"__className__")||""))}))},hasClass:function(t){for(var e,n=0,r=" "+t+" ";e=this[n++];)if(1===e.nodeType&&-1<(" "+kn(xn(e))+" ").indexOf(r))return!0;return!1}});function Nn(t){t.stopPropagation()}var Rn=/\r/g,Pn=(E.fn.extend({val:function(e){var n,t,r,i=this[0];return arguments.length?(r=v(e),this.each(function(t){1!==this.nodeType||(null==(t=r?e.call(this,t,E(this).val()):e)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=E.map(t,function(t){return null==t?"":t+""})),(n=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,t,"value"))||(this.value=t)})):i?(n=E.valHooks[i.type]||E.valHooks[i.nodeName.toLowerCase()])&&"get"in n&&void 0!==(t=n.get(i,"value"))?t:"string"==typeof(t=i.value)?t.replace(Rn,""):null==t?"":t:void 0}}),E.extend({valHooks:{option:{get:function(t){var e=E.find.attr(t,"value");return null!=e?e:kn(E.text(t))}},select:{get:function(t){for(var e,n=t.options,r=t.selectedIndex,i="select-one"===t.type,o=i?null:[],a=i?r+1:n.length,s=r<0?a:i?r:0;s<a;s++)if(((e=n[s]).selected||s===r)&&!e.disabled&&(!e.parentNode.disabled||!w(e.parentNode,"optgroup"))){if(e=E(e).val(),i)return e;o.push(e)}return o},set:function(t,e){for(var n,r,i=t.options,o=E.makeArray(e),a=i.length;a--;)((r=i[a]).selected=-1<E.inArray(E.valHooks.option.get(r),o))&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),E.each(["radio","checkbox"],function(){E.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<E.inArray(E(t).val(),e)}},g.checkOn||(E.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),b.location),On={guid:Date.now()},Mn=/\?/,Bn=(E.parseXML=function(t){var e,n;if(!t||"string"!=typeof t)return null;try{e=(new b.DOMParser).parseFromString(t,"text/xml")}catch(t){}return n=e&&e.getElementsByTagName("parsererror")[0],e&&!n||E.error("Invalid XML: "+(n?E.map(n.childNodes,function(t){return t.textContent}).join("\n"):t)),e},/^(?:focusinfocus|focusoutblur)$/),Un=(E.extend(E.event,{trigger:function(t,e,n,r){var i,o,a,s,l,u,c,h=[n||C],d=j.call(t,"type")?t.type:t,p=j.call(t,"namespace")?t.namespace.split("."):[],f=c=o=n=n||C;if(3!==n.nodeType&&8!==n.nodeType&&!Bn.test(d+E.event.triggered)&&(-1<d.indexOf(".")&&(d=(p=d.split(".")).shift(),p.sort()),s=d.indexOf(":")<0&&"on"+d,(t=t[E.expando]?t:new E.Event(d,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=p.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:E.makeArray(e,[t]),u=E.event.special[d]||{},r||!u.trigger||!1!==u.trigger.apply(n,e))){if(!r&&!u.noBubble&&!B(n)){for(a=u.delegateType||d,Bn.test(a+d)||(f=f.parentNode);f;f=f.parentNode)h.push(f),o=f;o===(n.ownerDocument||C)&&h.push(o.defaultView||o.parentWindow||b)}for(i=0;(f=h[i++])&&!t.isPropagationStopped();)c=f,t.type=1<i?a:u.bindType||d,(l=(y.get(f,"events")||Object.create(null))[t.type]&&y.get(f,"handle"))&&l.apply(f,e),(l=s&&f[s])&&l.apply&&ce(f)&&(t.result=l.apply(f,e),!1===t.result)&&t.preventDefault();return t.type=d,r||t.isDefaultPrevented()||u._default&&!1!==u._default.apply(h.pop(),e)||!ce(n)||s&&v(n[d])&&!B(n)&&((o=n[s])&&(n[s]=null),E.event.triggered=d,t.isPropagationStopped()&&c.addEventListener(d,Nn),n[d](),t.isPropagationStopped()&&c.removeEventListener(d,Nn),E.event.triggered=void 0,o)&&(n[s]=o),t.result}},simulate:function(t,e,n){n=E.extend(new E.Event,n,{type:t,isSimulated:!0});E.event.trigger(n,null,e)}}),E.fn.extend({trigger:function(t,e){return this.each(function(){E.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return E.event.trigger(t,e,n,!0)}}),/\[\]$/),Fn=/\r?\n/g,Vn=/^(?:submit|button|image|reset|file)$/i,Hn=/^(?:input|select|textarea|keygen)/i;E.param=function(t,e){function n(t,e){e=v(e)?e():e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==e?"":e)}var r,i=[];if(null==t)return"";if(Array.isArray(t)||t.jquery&&!E.isPlainObject(t))E.each(t,function(){n(this.name,this.value)});else for(r in t)!function n(r,t,i,o){if(Array.isArray(t))E.each(t,function(t,e){i||Un.test(r)?o(r,e):n(r+"["+("object"==typeof e&&null!=e?t:"")+"]",e,i,o)});else if(i||"object"!==K(t))o(r,t);else for(var e in t)n(r+"["+e+"]",t[e],i,o)}(r,t[r],e,n);return i.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=E.prop(this,"elements");return t?E.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!E(this).is(":disabled")&&Hn.test(this.nodeName)&&!Vn.test(t)&&(this.checked||!Se.test(t))}).map(function(t,e){var n=E(this).val();return null==n?null:Array.isArray(n)?E.map(n,function(t){return{name:e.name,value:t.replace(Fn,"\r\n")}}):{name:e.name,value:n.replace(Fn,"\r\n")}}).get()}});var zn=/%20/g,jn=/#.*$/,qn=/([?&])_=[^&]*/,Wn=/^(.*?):[ \t]*([^\r\n]*)$/gm,Gn=/^(?:GET|HEAD)$/,$n=/^\/\//,Kn={},Xn={},Zn="*/".concat("*"),Yn=C.createElement("a");function Qn(o){return function(t,e){"string"!=typeof t&&(e=t,t="*");var n,r=0,i=t.toLowerCase().match(D)||[];if(v(e))for(;n=i[r++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(e)):(o[n]=o[n]||[]).push(e)}}function Jn(e,r,i,o){var a={},s=e===Xn;function l(t){var n;return a[t]=!0,E.each(e[t]||[],function(t,e){e=e(r,i,o);return"string"!=typeof e||s||a[e]?s?!(n=e):void 0:(r.dataTypes.unshift(e),l(e),!1)}),n}return l(r.dataTypes[0])||!a["*"]&&l("*")}function tr(t,e){var n,r,i=E.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r=r||{})[n]=e[n]);return r&&E.extend(!0,t,r),t}Yn.href=Pn.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Pn.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Pn.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Zn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?tr(tr(t,E.ajaxSettings),e):tr(E.ajaxSettings,t)},ajaxPrefilter:Qn(Kn),ajaxTransport:Qn(Xn),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0);var l,u,c,n,h,d,p,r,f=E.ajaxSetup({},e=e||{}),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?E(g):E.event,y=E.Deferred(),v=E.Callbacks("once memory"),_=f.statusCode||{},i={},o={},a="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(d){if(!n)for(n={};e=Wn.exec(c);)n[e[1].toLowerCase()+" "]=(n[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=n[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return d?c:null},setRequestHeader:function(t,e){return null==d&&(t=o[t.toLowerCase()]=o[t.toLowerCase()]||t,i[t]=e),this},overrideMimeType:function(t){return null==d&&(f.mimeType=t),this},statusCode:function(t){if(t)if(d)w.always(t[w.status]);else for(var e in t)_[e]=[_[e],t[e]];return this},abort:function(t){t=t||a;return l&&l.abort(t),s(0,t),this}};if(y.promise(w),f.url=((t||f.url||Pn.href)+"").replace($n,Pn.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(D)||[""],null==f.crossDomain){t=C.createElement("a");try{t.href=f.url,t.href=t.href,f.crossDomain=Yn.protocol+"//"+Yn.host!=t.protocol+"//"+t.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=E.param(f.data,f.traditional)),Jn(Kn,f,e,w),!d){for(r in(p=E.event&&f.global)&&0==E.active++&&E.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Gn.test(f.type),u=f.url.replace(jn,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(zn,"+")):(t=f.url.slice(u.length),f.data&&(f.processData||"string"==typeof f.data)&&(u+=(Mn.test(u)?"&":"?")+f.data,delete f.data),!1===f.cache&&(u=u.replace(qn,"$1"),t=(Mn.test(u)?"&":"?")+"_="+On.guid+++t),f.url=u+t),f.ifModified&&(E.lastModified[u]&&w.setRequestHeader("If-Modified-Since",E.lastModified[u]),E.etag[u])&&w.setRequestHeader("If-None-Match",E.etag[u]),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&w.setRequestHeader("Content-Type",f.contentType),w.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Zn+"; q=0.01":""):f.accepts["*"]),f.headers)w.setRequestHeader(r,f.headers[r]);if(f.beforeSend&&(!1===f.beforeSend.call(g,w,f)||d))return w.abort();if(a="abort",v.add(f.complete),w.done(f.success),w.fail(f.error),l=Jn(Xn,f,e,w)){if(w.readyState=1,p&&m.trigger("ajaxSend",[w,f]),d)return w;f.async&&0<f.timeout&&(h=b.setTimeout(function(){w.abort("timeout")},f.timeout));try{d=!1,l.send(i,s)}catch(t){if(d)throw t;s(-1,t)}}else s(-1,"No Transport")}return w;function s(t,e,n,r){var i,o,a,s=e;d||(d=!0,h&&b.clearTimeout(h),l=void 0,c=r||"",w.readyState=0<t?4:0,r=200<=t&&t<300||304===t,n&&(a=((t,e,n)=>{for(var r,i,o,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){l.unshift(i);break}if(l[0]in n)o=l[0];else{for(i in n){if(!l[0]||t.converters[i+" "+l[0]]){o=i;break}a=a||i}o=o||a}if(o)return o!==l[0]&&l.unshift(o),n[o]})(f,w,n)),!r&&-1<E.inArray("script",f.dataTypes)&&E.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),a=((t,e,n,r)=>{var i,o,a,s,l,u={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)u[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=u[l+" "+o]||u["* "+o]))for(i in u)if((s=i.split(" "))[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[i]:!0!==u[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}})(f,a,w,r),r?(f.ifModified&&((n=w.getResponseHeader("Last-Modified"))&&(E.lastModified[u]=n),n=w.getResponseHeader("etag"))&&(E.etag[u]=n),204===t||"HEAD"===f.type?s="nocontent":304===t?s="notmodified":(s=a.state,i=a.data,r=!(o=a.error))):(o=s,!t&&s||(s="error",t<0&&(t=0))),w.status=t,w.statusText=(e||s)+"",r?y.resolveWith(g,[i,s,w]):y.rejectWith(g,[w,s,o]),w.statusCode(_),_=void 0,p&&m.trigger(r?"ajaxSuccess":"ajaxError",[w,f,r?i:o]),v.fireWith(g,[w,s]),p&&(m.trigger("ajaxComplete",[w,f]),--E.active||E.event.trigger("ajaxStop")))}},getJSON:function(t,e,n){return E.get(t,e,n,"json")},getScript:function(t,e){return E.get(t,void 0,e,"script")}}),E.each(["get","post"],function(t,i){E[i]=function(t,e,n,r){return v(e)&&(r=r||n,n=e,e=void 0),E.ajax(E.extend({url:t,type:i,dataType:r,data:e,success:n},E.isPlainObject(t)&&t))}}),E.ajaxPrefilter(function(t){for(var e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")}),E._evalUrl=function(t,e,n){return E.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){E.globalEval(t,e,n)}})},E.fn.extend({wrapAll:function(t){return this[0]&&(v(t)&&(t=t.call(this[0])),t=E(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(n){return v(n)?this.each(function(t){E(this).wrapInner(n.call(this,t))}):this.each(function(){var t=E(this),e=t.contents();e.length?e.wrapAll(n):t.append(n)})},wrap:function(e){var n=v(e);return this.each(function(t){E(this).wrapAll(n?e.call(this,t):e)})},unwrap:function(t){return this.parent(t).not("body").each(function(){E(this).replaceWith(this.childNodes)}),this}}),E.expr.pseudos.hidden=function(t){return!E.expr.pseudos.visible(t)},E.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new b.XMLHttpRequest}catch(t){}};var er={0:200,1223:204},nr=E.ajaxSettings.xhr(),rr=(g.cors=!!nr&&"withCredentials"in nr,g.ajax=nr=!!nr,E.ajaxTransport(function(i){var o,a;if(g.cors||nr&&!i.crossDomain)return{send:function(t,e){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)r.setRequestHeader(n,t[n]);o=function(t){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===t?r.abort():"error"===t?"number"!=typeof r.status?e(0,"error"):e(r.status,r.statusText):e(er[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&b.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(t){if(o)throw t}},abort:function(){o&&o()}}}),E.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return E.globalEval(t),t}}}),E.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),E.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(t,e){r=E("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(t){r.remove(),i=null,t&&e("error"===t.type?404:200,t.type)}),C.head.appendChild(r[0])},abort:function(){i&&i()}}}),[]),ir=/(=)\?(?=&|$)|\?\?/,or=(E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=rr.pop()||E.expando+"_"+On.guid++;return this[t]=!0,t}}),E.ajaxPrefilter("json jsonp",function(t,e,n){var r,i,o,a=!1!==t.jsonp&&(ir.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ir.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=v(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(ir,"$1"+r):!1!==t.jsonp&&(t.url+=(Mn.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return o||E.error(r+" was not called"),o[0]},t.dataTypes[0]="json",i=b[r],b[r]=function(){o=arguments},n.always(function(){void 0===i?E(b).removeProp(r):b[r]=i,t[r]&&(t.jsonpCallback=e.jsonpCallback,rr.push(r)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),g.createHTMLDocument=((t=C.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===t.childNodes.length),E.parseHTML=function(t,e,n){var r;return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(g.createHTMLDocument?((r=(e=C.implementation.createHTMLDocument("")).createElement("base")).href=C.location.href,e.head.appendChild(r)):e=C),r=!n&&[],(n=Kt.exec(t))?[e.createElement(n[1])]:(n=ke([t],e,r),r&&r.length&&E(r).remove(),E.merge([],n.childNodes)))},E.fn.load=function(t,e,n){var r,i,o,a=this,s=t.indexOf(" ");return-1<s&&(r=kn(t.slice(s)),t=t.slice(0,s)),v(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),0<a.length&&E.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(r?E("<div>").append(E.parseHTML(t)).find(r):t)}).always(n&&function(t,e){a.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},E.expr.pseudos.animated=function(e){return E.grep(E.timers,function(t){return e===t.elem}).length},E.offset={setOffset:function(t,e,n){var r,i,o,a,s=E.css(t,"position"),l=E(t),u={};"static"===s&&(t.style.position="relative"),o=l.offset(),r=E.css(t,"top"),a=E.css(t,"left"),s=("absolute"===s||"fixed"===s)&&-1<(r+a).indexOf("auto")?(i=(s=l.position()).top,s.left):(i=parseFloat(r)||0,parseFloat(a)||0),null!=(e=v(e)?e.call(t,n,E.extend({},o)):e).top&&(u.top=e.top-o.top+i),null!=e.left&&(u.left=e.left-o.left+s),"using"in e?e.using.call(t,u):l.css(u)}},E.fn.extend({offset:function(e){var t,n;return arguments.length?void 0===e?this:this.each(function(t){E.offset.setOffset(this,e,t)}):(n=this[0])?n.getClientRects().length?(t=n.getBoundingClientRect(),n=n.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,r=this[0],i={top:0,left:0};if("fixed"===E.css(r,"position"))e=r.getBoundingClientRect();else{for(e=this.offset(),n=r.ownerDocument,t=r.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===E.css(t,"position");)t=t.parentNode;t&&t!==r&&1===t.nodeType&&((i=E(t).offset()).top+=E.css(t,"borderTopWidth",!0),i.left+=E.css(t,"borderLeftWidth",!0))}return{top:e.top-i.top-E.css(r,"marginTop",!0),left:e.left-i.left-E.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===E.css(t,"position");)t=t.offsetParent;return t||ve})}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var o="pageYOffset"===i;E.fn[e]=function(t){return c(this,function(t,e,n){var r;if(B(t)?r=t:9===t.nodeType&&(r=t.defaultView),void 0===n)return r?r[i]:t[e];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):t[e]=n},e,t,arguments.length)}}),E.each(["top","left"],function(t,n){E.cssHooks[n]=an(g.pixelPosition,function(t,e){if(e)return e=on(t,n),Je.test(e)?E(t).position()[n]+"px":e})}),E.each({Height:"height",Width:"width"},function(a,s){E.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){E.fn[o]=function(t,e){var n=arguments.length&&(r||"boolean"!=typeof t),i=r||(!0===t||!0===e?"margin":"border");return c(this,function(t,e,n){var r;return B(t)?0===o.indexOf("outer")?t["inner"+a]:t.document.documentElement["client"+a]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+a],r["scroll"+a],t.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?E.css(t,e,i):E.style(t,e,n,i)},s,n?t:void 0,n)}})}),E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){E.fn[e]=function(t){return this.on(e,t)}}),E.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.on("mouseenter",t).on("mouseleave",e||t)}}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,n){E.fn[n]=function(t,e){return 0<arguments.length?this.on(n,null,t,e):this.trigger(n)}}),/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g),ar=(E.proxy=function(t,e){var n,r;if("string"==typeof e&&(r=t[e],e=t,t=r),v(t))return n=s.call(arguments,2),(r=function(){return t.apply(e||this,n.concat(s.call(arguments)))}).guid=t.guid=t.guid||E.guid++,r},E.holdReady=function(t){t?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=w,E.isFunction=v,E.isWindow=B,E.camelCase=N,E.type=K,E.now=Date.now,E.isNumeric=function(t){var e=E.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},E.trim=function(t){return null==t?"":(t+"").replace(or,"$1")},b.jQuery),sr=b.$;return E.noConflict=function(t){return b.$===E&&(b.$=sr),t&&b.jQuery===E&&(b.jQuery=ar),E},void 0===M&&(b.jQuery=b.$=E),E},t.exports=e.document?n(e,!0):function(t){if(t.document)return n(t);throw new Error("jQuery requires a window with a document")}});let V={get available(){return H},logCounter:0},H=void 0!==window.indexedDB,z,j=(z=window.idbConfig?window.idbConfig.version:30,"webform"),q="media",W="logs",G="lastSavedRecords",$="records";var K="fs::";V.isSupported=function(){return new Promise(e=>{H?X().then(()=>{e(!0)}).catch(t=>{console.log(t),e(!1)}):e(!1)})};let X=function(){return new Promise((e,n)=>{var t;void 0!==V[j]?e(V[j]):void 0!==window.indexedDB?((t=window.indexedDB.open(j,z)).onerror=function(t){console.log("Error",t.target.error.message),n(t)},t.onblocked=function(t){console.log("Error",t.target.error.message),alert("Error",t.target.error.message),n(t)},t.onsuccess=function(t){t=t.target.result;t.onerror=function(t){console.error("Database error: "+t.target.error.message)},V[j]=t,e(t)},t.onupgradeneeded=function(t){t=t.target.result;t.objectStoreNames.contains(q)||t.createObjectStore(q),t.objectStoreNames.contains($)||t.createObjectStore($,{keyPath:"id",autoIncrement:!0}).createIndex("assignment","assignment.assignment_id",{unique:!1}),t.objectStoreNames.contains(W)||t.createObjectStore(W),t.objectStoreNames.contains(G)||t.createObjectStore(G,{keyPath:"_surveyId",autoIncrement:!1}),e(t)}):n("indexeddb not supported")})};V.delete=function(t,r){if(void 0!==t||r){t?console.log("delete directory: "+t):console.log("delete all attachments");var e,n,i=K+"/"+t;for(e in X().then(function(t){var n=t.transaction([q],"readwrite").objectStore(q);n.openCursor().onsuccess=function(t){var e=t.target.result;e&&(r||e.key.startsWith(i))&&(e.value&&window.URL.revokeObjectURL(e.value),n.delete(e.key).onsuccess=function(t){console.log("Delete: "+e.key)},e.continue())}}),localStorage)(r&&e.startsWith(K)||e.startsWith())&&((n=localStorage.getItem(e))&&window.URL.revokeObjectURL(n),console.log("Delete item: "+e),localStorage.removeItem(e))}},V.saveFile=function(e,n){X().then(function(t){console.log("save file: "+e.name+" : "+n);t=t.transaction([q],"readwrite");t.onerror=function(t){alert("Error: failed to open transaction to save file "+e.name)},t.objectStore(q).put(e.dataUrl,K+"/"+n+"/"+e.name)})},V.setLastSavedRecord=function(r){return new Promise((e,n)=>{X().then(function(t){console.log("Set last saved record");t=t.transaction([G],"readwrite").objectStore(G).put(r);t.onerror=function(t){n(t)},t.onsuccess=function(t){e()}})})},V.getLastSavedRecord=function(i){return new Promise((n,r)=>{X().then(function(t){console.log("Get last saved record: "+i);t=t.transaction([G],"readonly");t.onerror=function(t){alert("Error: failed to open transaction to write get last saved record "+name),r(t)};let e=t.objectStore(G).get(i);e.onerror=function(t){r("Error getting last record")},e.onsuccess=function(t){n(e.result)}})})},V.removeLastSavedRecord=function(r){return new Promise((e,n)=>{X().then(function(t){console.log("Delete last saved record: "+r);t=t.transaction([G],"readwrite");t.onerror=function(t){alert("Error: failed to open transaction to delete saved record "+name),n(t)},t.objectStore(G).delete(r),e()})})},V.writeLog=function(r,i,o,a){X().then(function(t){console.log("write log entry: "+i+" : "+o);var t=t.transaction([W],"readwrite"),e=(t.onerror=function(t){alert("Error: failed to open transaction to write log entry "+i)},new Date),n=(e.setMilliseconds(e.getMilliseconds()+V.logCounter),100<V.logCounter?V.logCounter=0:V.logCounter++,{date:e,action:r,name:i,status:o,instanceid:a}),t=t.objectStore(W),n=(t.add(n,e),new Date),e=new Date(n.getTime()-864e7);t.delete(IDBKeyRange.upperBound(e))})},V.getFile=function(t,o){return new Promise((e,n)=>{var i,r=K+"/"+o+"/"+t;console.log("get file: "+r),i=r,new Promise((n,r)=>{X().then(t=>{var e=t.transaction([q],"readonly").objectStore(q).get(i);e.onerror=function(t){r("Error getting file")},e.onsuccess=function(t){n(e.result)}})}).then(function(t){if(t)e(t);else try{e(localStorage.getItem(r))}catch(t){n("Error: "+t.message)}}).catch(function(t){n(t)})})},V.retrieveFile=function(r,i){return new Promise((e,t)=>{var n={fileName:i.fileName};V.getFile(i.fileName,r).then(function(t){n.blob=V.dataURLtoBlob(t),n.size=n.blob.size,e(n)})})},V.dataURLtoBlob=function(t){if(t){var e,n,r,i,t=t.split(",");if(1<t.length){for(e=t[0].match(/:(.*?);/)[1],r=(n=atob(t[1])).length,i=new Uint8Array(r);r--;)i[r]=n.charCodeAt(r);return new Blob([i],{type:e})}}return new Blob},V.setRecord=function(r,i){return new Promise((e,n)=>{console.log("set record: "),X().then(t=>{t=t.transaction([$],"readwrite");t.onerror=function(t){alert("Error: failed to add record ")};t=t.objectStore($).put(r,i);t.onsuccess=function(t){e()},t.onerror=function(t){console.log("Error",t.target.error.name),n()}})})};var Z=["user_locale","__settings","null","__history","Firebug","undefined","__bookmark","__counter","__current_server","__loadLog","__writetest","__maxSize"],Y=window.localStorage;let Q={isSupported:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},isWritable:function(){return"success"===Q.setRecord("__writetest","x",null,!0)&&(Q.removeRecord("__writetest"),!0)},getForbiddenKeys:function(){return Z},setRecord:function(t,e,n,r,i){if(!t||"string"!=typeof t||t.length<1)return"require";if(t=t.trim(),i="string"==typeof i?i.trim():null,r=void 0!==r&&!0===r,"string"==typeof e.data&&Q.isReservedKey(t))return"forbidden";if("string"==typeof e.data&&i!==t&&Q.isExistingKey(t)&&!0!==r||i===t&&!0!==r)return"existing";try{return"string"==typeof e.data&&(e.lastSaved=(new Date).getTime(),Y.setItem("__counter",JSON.stringify({counter:Q.getCounterValue()}))),Y.setItem(t,JSON.stringify(e)),null!==i&&""!==i&&i!==t&&n&&(console.log("going to remove old record with key:"+i),Q.removeRecord(i)),"success"}catch(t){return t&&22===t.code?"full (or browser is set to not allow storage)":(console.log("error in store.setRecord:",t),"error: "+(t?JSON.stringify(t):"unknown"))}},setKey:function(t,e){Y.setItem(t,e)},getKey:function(t){t=Y.getItem(t);return t=t&&'"'===t.charAt(0)?t.replace(/"/g,""):t},getRecord:function(t){var e;try{var n=Y.getItem(t);return e=n&&n.trim().startsWith("{")?JSON.parse(Y.getItem(t)):e}catch(t){return console.error("error with loading data from store: "+t.message),null}},removeRecord:function(t){try{return Y.removeItem(t),Q.isReservedKey(t)||m("form.or").trigger("delete",JSON.stringify(Q.getRecordList())),!0}catch(t){return console.log("error with removing data from store: "+t.message),!1}},removeAllRecords:function(){getSurveyRecords(!1).forEach(function(t){Q.removeRecord(t.key)})},getFormList:function(t){return void 0===t?null:Q.getRecord("__server_"+t)},getRecordList:function(){var e=[];return Q.getSurveyRecords(!1).forEach(function(t){e.push({key:t.key,draft:t.draft,lastSaved:t.lastSaved})}),e.sort(function(t,e){return t.lastSaved-e.lastSaved}),e},getSurveyRecords:function(t,e){var n,r,i=[],o={};for(t=void 0!==t&&t,e=e||null,n=0;n<Y.length;n++)if(r=Y.key(n),!Q.isReservedKey(r)&&!r.startsWith("fs::")&&(o=Q.getRecord(r)))try{(o.key=r)===e||t&&o.draft||o.form&&i.push(o)}catch(t){console.log("record found that was probably not in the expected JSON format (e.g. Firebug settings or corrupt record) (error: "+t.message+"), record was ignored")}return i},getSurveyDataArr:function(t,e){return t=void 0===t||t,e=e||null,Q.getSurveyRecords(t,e)},getExportStr:function(){var e="";return Q.getSurveyDataArr(!1).forEach(function(t){e+='<record name="'+t.key+'" lastSaved="'+t.lastSaved+'"'+(t.draft?' draft="true()"':"")+">"+t.data+"</record>"}),e},isReservedKey:function(t){for(var e=0;e<Z.length;e++)if(t===Z[e])return!0;return!1},isExistingKey:function(t){return!!Y.getItem(t)}};var J,tt,et,nt,rt={maps:[{tiles:["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"],name:"streets",attribution:"Â© <a href='http://openstreetmap.org'>OpenStreetMap</a> | <a href='www.openstreetmap.org/copyright'>Terms</a>"},{tiles:"GOOGLE_SATELLITE",name:"satellite"}],googleApiKey:"",repeatOrdinals:!(Q.getCounterValue=function(){var t,e=Q.getRecord("__counter");return((e&&e.counter&&(t=e.counter,!isNaN(parseFloat(t)))&&isFinite(t)?Number(e.counter):0)+1).toString()}),validateContinuously:!1,validatePage:!0,swipePage:!0,textMaxChars:65535},it=(()=>{for(var t,e=window.location.search.substring(1).split("&"),n={},r=0;r<e.length;r++){var i=e[r].split("=");0<i[0].length&&(t=decodeURIComponent(i[1]),t="true"===t||"false"!==t&&t,n[i[0]]=t)}return n})(),ot={};for(J in[{q:"return",s:"returnUrl"},{q:"returnURL",s:"returnUrl"},{q:"returnUrl",s:"returnUrl"},{q:"touch",s:"touch"},{q:"server",s:"serverUrl"},{q:"serverURL",s:"serverUrl"},{q:"serverUrl",s:"serverUrl"},{q:"form",s:"xformUrl"},{q:"id",s:"xformId"},{q:"instanceId",s:"instanceId"},{q:"instance_id",s:"instanceId"},{q:"parentWindowOrigin",s:"parentWindowOrigin"}].forEach(function(t){void 0!==it[t.q]&&void 0===ot[t.s]&&(ot[t.s]=it[t.q])}),ot.loginUrl=rt.basePath+"/login",ot.defaultReturnUrl=rt.basePath+"/thanks",ot.defaults={},it)it.hasOwnProperty(J)&&-1!==J.search(/d\[(.*)\]/)&&(tt=decodeURIComponent(J.match(/d\[(.*)\]/)[1]),et=decodeURIComponent(it[J]),ot.defaults[tt]=et);for(nt in rt)rt.hasOwnProperty(nt)&&(ot[nt]=rt[nt]);function at(t,e){return new RegExp(t).test(e)?e.substring(e.lastIndexOf(t)+t.length):null}function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),r.forEach(function(t){lt(e,t,n[t])})}return e}function ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dt(t,e,n){e&&ht(t.prototype,e),n&&ht(t,n)}ot.submissionParameter&&ot.submissionParameter.name&&(ot.submissionParameter.value=it[ot.submissionParameter.name]),ot.languageOverrideParameter=it.lang?{name:"lang",value:it.lang}:void 0,ot.maxSize=5242880,0===window.location.pathname.indexOf("/preview")?ot.type="preview":0===window.location.pathname.indexOf("/single")?ot.type="single":0===window.location.pathname.indexOf("/edit")?ot.type="edit":0===window.location.pathname.indexOf("/view")?ot.type="view":ot.type="other",ot.basePath="webForm",ot.enketoIdPrefix="::",ot.offline=!!document.querySelector("html").getAttribute("manifest"),ot.enketoId=ot.offline?at("#",window.location.hash):at("/"+ot.enketoIdPrefix,window.location.pathname),"single"===ot.type&&32!==ot.enketoId.length&&64!==ot.enketoId.length&&(ot.multipleAllowed=!0),ot.goTo="edit"===ot.type||"preview"===ot.type||"view"===ot.type,ot.printRelevantOnly=!!ot.instanceId;var pt=(u=u=F(function(e){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(t){return typeof t}:e.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e.exports.default=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0}))&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u;function ft(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gt(t,e){if(e&&("object"===pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ft(t)}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}var _t={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,e){console&&console[t]&&console[t].apply(console,e)}};function wt(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};ct(this,wt),this.init(t,e)}dt(wt,[{key:"init",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||_t,this.options=e,this.debug=e.debug}},{key:"setDebug",value:function(t){this.debug=t}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}},{key:"deprecate",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(t,e,n,r){return r&&!this.debug?null:("string"==typeof t[0]&&(t[0]="".concat(n).concat(this.prefix," ").concat(t[0])),this.logger[e](t))}},{key:"create",value:function(t){return new wt(this.logger,ut({},{prefix:"".concat(this.prefix,":").concat(t,":")},this.options))}}]);var bt=new wt,Ct=(dt(Et,[{key:"on",value:function(t,e){var n=this;return t.split(" ").forEach(function(t){n.observers[t]=n.observers[t]||[],n.observers[t].push(e)}),this}},{key:"off",value:function(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter(function(t){return t!==e}):delete this.observers[t])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.observers[e]&&[].concat(this.observers[e]).forEach(function(t){t.apply(void 0,n)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(function(t){t.apply(t,[e].concat(n))})}}]),Et);function Et(){ct(this,Et),this.observers={}}function St(){var n,r,t=new Promise(function(t,e){n=t,r=e});return t.resolve=n,t.reject=r,t}function Tt(t){return null==t?"":""+t}function At(t,e,n){function r(t){return t&&-1<t.indexOf("###")?t.replace(/###/g,"."):t}function i(){return!t||"string"==typeof t}for(var o="string"!=typeof e?[].concat(e):e.split(".");1<o.length;){if(i())return{};var a=r(o.shift());!t[a]&&n&&(t[a]=new n),t=Object.prototype.hasOwnProperty.call(t,a)?t[a]:{}}return i()?{}:{obj:t,k:r(o.shift())}}function It(t,e,n){t=At(t,e,Object);t.obj[t.k]=n}function Lt(t,e){t=At(t,e),e=t.obj;if(e)return e[t.k]}function kt(t,e,n){t=Lt(t,n);return void 0!==t?t:Lt(e,n)}function xt(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var Dt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Nt(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,function(t){return Dt[t]}):t}var Rt="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&-1<window.navigator.userAgent.indexOf("MSIE"),Pt=(vt(Ot,Ct),dt(Ot,[{key:"addNamespaces",value:function(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}},{key:"removeNamespaces",value:function(t){t=this.options.ns.indexOf(t);-1<t&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},r=(void 0!==r.keySeparator?r:this.options).keySeparator,e=[t,e];return n&&"string"!=typeof n&&(e=e.concat(n)),n&&"string"==typeof n&&(e=e.concat(r?n.split(r):n)),-1<t.indexOf(".")&&(e=t.split(".")),Lt(this.data,e)}},{key:"addResource",value:function(t,e,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=this.options.keySeparator,a=(void 0===o&&(o="."),[t,e]);n&&(a=a.concat(o?n.split(o):n)),-1<t.indexOf(".")&&(r=e,e=(a=t.split("."))[1]),this.addNamespaces(e),It(this.data,a,r),i.silent||this.emit("added",t,e,n,r)}},{key:"addResources",value:function(t,e,n){var r,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(r in n)"string"!=typeof n[r]&&"[object Array]"!==Object.prototype.toString.apply(n[r])||this.addResource(t,e,r,n[r],{silent:!0});i.silent||this.emit("added",t,e,n)}},{key:"addResourceBundle",value:function(t,e,n,r,i){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{silent:!1},a=[t,e],s=(-1<t.indexOf(".")&&(r=n,n=e,e=(a=t.split("."))[1]),this.addNamespaces(e),Lt(this.data,a)||{});r?function t(e,n,r){for(var i in n)"__proto__"!==i&&"constructor"!==i&&(i in e?"string"==typeof e[i]||e[i]instanceof String||"string"==typeof n[i]||n[i]instanceof String?r&&(e[i]=n[i]):t(e[i],n[i],r):e[i]=n[i])}(s,n,i):s=ut({},s,n),It(this.data,a,s),o.silent||this.emit("added",t,e,n)}},{key:"removeResourceBundle",value:function(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}},{key:"hasResourceBundle",value:function(t,e){return void 0!==this.getResource(t,e)}},{key:"getResourceBundle",value:function(t,e){return e=e||this.options.defaultNS,"v1"===this.options.compatibilityAPI?ut({},{},this.getResource(t,e)):this.getResource(t,e)}},{key:"getDataByLanguage",value:function(t){return this.data[t]}},{key:"toJSON",value:function(){return this.data}}]),Ot);function Ot(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return ct(this,Ot),e=gt(this,mt(Ot).call(this)),Rt&&Ct.call(ft(e)),e.data=t||{},e.options=n,void 0===e.options.keySeparator&&(e.options.keySeparator="."),e}var Mt={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,e,n,r,i){var o=this;return t.forEach(function(t){o.processors[t]&&(e=o.processors[t].process(e,n,r,i))}),e}},Bt={},Ut=(vt(Ft,Ct),dt(Ft,[{key:"changeLanguage",value:function(t){t&&(this.language=t)}},{key:"exists",value:function(t){t=this.resolve(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{interpolation:{}});return t&&void 0!==t.res}},{key:"extractFromKey",value:function(t,e){var n=(void 0!==e.nsSeparator?e:this.options).nsSeparator,r=(void 0!==e.keySeparator?e:this.options).keySeparator,e=e.ns||this.options.defaultNS;if((n=void 0===n?":":n)&&-1<t.indexOf(n)){var i=t.match(this.interpolator.nestingRegexp);if(i&&0<i.length)return{key:t,namespaces:e};i=t.split(n);(n!==r||n===r&&-1<this.options.ns.indexOf(i[0]))&&(e=i.shift()),t=i.join(r)}return{key:t,namespaces:e="string"==typeof e?[e]:e}}},{key:"translate",value:function(t,r,e){var i=this;if(r=(r="object"!==st(r)&&this.options.overloadTranslationOptionHandler?this.options.overloadTranslationOptionHandler(arguments):r)||{},null==t)return"";Array.isArray(t)||(t=[String(t)]);var n=(void 0!==r.keySeparator?r:this.options).keySeparator,o=this.extractFromKey(t[t.length-1],r),a=o.key,s=o.namespaces,l=s[s.length-1],o=r.lng||this.language,u=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(o&&"cimode"===o.toLowerCase())return u?(u=r.nsSeparator||this.options.nsSeparator,l+u+a):a;var u=this.resolve(t,r),c=u&&u.res,h=u&&u.usedKey||a,d=u&&u.exactUsedKey||a,p=Object.prototype.toString.apply(c),f=(void 0!==r.joinArrays?r:this.options).joinArrays,g=!this.i18nFormat||this.i18nFormat.handleAsObject;if(g&&c&&("string"!=typeof c&&"boolean"!=typeof c&&"number"!=typeof c)&&["[object Number]","[object Function]","[object RegExp]"].indexOf(p)<0&&("string"!=typeof f||"[object Array]"!==p)){if(!r.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(h,c,r):"key '".concat(a," (").concat(this.language,")' returned an object instead of string.");if(n){var m,y,v="[object Array]"===p,_=v?[]:{},w=v?d:h;for(m in c)Object.prototype.hasOwnProperty.call(c,m)&&(y="".concat(w).concat(n).concat(m),_[m]=this.translate(y,ut({},r,{joinArrays:!1,ns:s})),_[m]===y)&&(_[m]=c[m]);c=_}}else if(g&&"string"==typeof f&&"[object Array]"===p)c=(c=c.join(f))&&this.extendTranslation(c,t,r,e);else{var v=!1,d=!1,h=void 0!==r.count&&"string"!=typeof r.count,g=Ft.hasDefaultValue(r),p=h?this.pluralResolver.getSuffix(o,r.count):"",b=r["defaultValue".concat(p)]||r.defaultValue,C=(!this.isValidLookup(c)&&g&&(v=!0,c=b),this.isValidLookup(c)||(d=!0,c=a),g&&b!==c&&this.options.updateMissing);if(d||v||C){this.logger.log(C?"updateKey":"missingKey",o,l,a,C?b:c),n&&(f=this.resolve(a,ut({},r,{keySeparator:!1})))&&f.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.");var E=[],S=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if("fallback"===this.options.saveMissingTo&&S&&S[0])for(var T=0;T<S.length;T++)E.push(S[T]);else"all"===this.options.saveMissingTo?E=this.languageUtils.toResolveHierarchy(r.lng||this.language):E.push(r.lng||this.language);var A=function(t,e,n){i.options.missingKeyHandler?i.options.missingKeyHandler(t,l,e,C?n:c,C,r):i.backendConnector&&i.backendConnector.saveMissing&&i.backendConnector.saveMissing(t,l,e,C?n:c,C,r),i.emit("missingKey",t,l,e,c)};this.options.saveMissing&&(this.options.saveMissingPlurals&&h?E.forEach(function(e){i.pluralResolver.getSuffixes(e).forEach(function(t){A([e],a+t,r["defaultValue".concat(t)]||b)})}):A(E,a,b))}c=this.extendTranslation(c,t,r,u,e),d&&c===a&&this.options.appendNamespaceToMissingKey&&(c="".concat(l,":").concat(a)),d&&this.options.parseMissingKeyHandler&&(c=this.options.parseMissingKeyHandler(c))}return c}},{key:"extendTranslation",value:function(t,r,i,e,o){var n,a=this,s=(this.i18nFormat&&this.i18nFormat.parse?t=this.i18nFormat.parse(t,i,e.usedLng,e.usedNS,e.usedKey,{resolved:e}):i.skipInterpolation||(i.interpolation&&this.interpolator.init(ut({},i,{interpolation:ut({},this.options.interpolation,i.interpolation)})),(s=i.interpolation&&i.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables)&&(l=(l=t.match(this.interpolator.nestingRegexp))&&l.length),n=i.replace&&"string"!=typeof i.replace?i.replace:i,this.options.interpolation.defaultVariables&&(n=ut({},this.options.interpolation.defaultVariables,n)),t=this.interpolator.interpolate(t,n,i.lng||this.language,i),s&&l<((n=t.match(this.interpolator.nestingRegexp))&&n.length)&&(i.nest=!1),!1!==i.nest&&(t=this.interpolator.nest(t,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o&&o[0]===e[0]&&!i.context?(a.logger.warn("It seems you are nesting recursively key: ".concat(e[0]," in key: ").concat(r[0])),null):a.translate.apply(a,e.concat([r]))},i)),i.interpolation&&this.interpolator.reset()),i.postProcess||this.options.postProcess),l="string"==typeof s?[s]:s;return t=null!=t&&l&&l.length&&!1!==i.applyPostProcessor?Mt.handle(l,t,r,this.options&&this.options.postProcessPassResolved?ut({i18nResolved:e},i):i,this):t}},{key:"resolve",value:function(t){var u,n,c,h,r,d=this,p=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return(t="string"==typeof t?[t]:t).forEach(function(t){var a,s,l,e;d.isValidLookup(u)||(t=d.extractFromKey(t,p),a=t.key,n=a,t=t.namespaces,d.options.fallbackNS&&(t=t.concat(d.options.fallbackNS)),s=void 0!==p.count&&"string"!=typeof p.count,l=void 0!==p.context&&"string"==typeof p.context&&""!==p.context,e=p.lngs||d.languageUtils.toResolveHierarchy(p.lng||d.language,p.fallbackLng),t.forEach(function(o){d.isValidLookup(u)||(r=o,!Bt["".concat(e[0],"-").concat(o)]&&d.utils&&d.utils.hasLoadedNamespace&&!d.utils.hasLoadedNamespace(r)&&(Bt["".concat(e[0],"-").concat(o)]=!0,d.logger.warn('key "'.concat(n,'" for languages "').concat(e.join(", "),'" won\'t get resolved as namespace "').concat(r,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),e.forEach(function(t){if(!d.isValidLookup(u)){h=t;var e,n,r=a,i=[r];for(d.i18nFormat&&d.i18nFormat.addLookupKeys?d.i18nFormat.addLookupKeys(i,a,t,o,p):(s&&(e=d.pluralResolver.getSuffix(t,p.count)),s&&l&&i.push(r+e),l&&i.push(r+="".concat(d.options.contextSeparator).concat(p.context)),s&&i.push(r+=e));n=i.pop();)d.isValidLookup(u)||(c=n,u=d.getResource(t,o,n,p))}}))}))}),{res:u,usedKey:n,exactUsedKey:c,usedLng:h,usedNS:r}}},{key:"isValidLookup",value:function(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}},{key:"getResource",value:function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return(this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat:this.resourceStore).getResource(t,e,n,r)}}],[{key:"hasDefaultValue",value:function(t){var e,n="defaultValue";for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&n===e.substring(0,n.length)&&void 0!==t[e])return!0;return!1}}]),Ft);function Ft(t){var e,n,r,i,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return ct(this,Ft),e=gt(this,mt(Ft).call(this)),Rt&&Ct.call(ft(e)),n=["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],r=t,i=ft(e),n.forEach(function(t){r[t]&&(i[t]=r[t])}),e.options=o,void 0===e.options.keySeparator&&(e.options.keySeparator="."),e.logger=bt.create("translator"),e}function Vt(t){return t.charAt(0).toUpperCase()+t.slice(1)}dt(zt,[{key:"getScriptPartFromCode",value:function(t){return!t||t.indexOf("-")<0||2===(t=t.split("-")).length||(t.pop(),"x"===t[t.length-1].toLowerCase())?null:this.formatLanguageCode(t.join("-"))}},{key:"getLanguagePartFromCode",value:function(t){return!t||t.indexOf("-")<0?t:(t=t.split("-"),this.formatLanguageCode(t[0]))}},{key:"formatLanguageCode",value:function(t){var e,n;return"string"==typeof t&&-1<t.indexOf("-")?(e=["hans","hant","latn","cyrl","cans","mong","arab"],n=t.split("-"),this.options.lowerCaseLng?n=n.map(function(t){return t.toLowerCase()}):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),-1<e.indexOf(n[1].toLowerCase())&&(n[1]=Vt(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),-1<e.indexOf(n[1].toLowerCase())&&(n[1]=Vt(n[1].toLowerCase())),-1<e.indexOf(n[2].toLowerCase()))&&(n[2]=Vt(n[2].toLowerCase())),n.join("-")):this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}},{key:"isWhitelisted",value:function(t){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(t)}},{key:"isSupportedCode",value:function(t){return"languageOnly"!==this.options.load&&!this.options.nonExplicitSupportedLngs||(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||-1<this.supportedLngs.indexOf(t)}},{key:"getBestMatchFromCodes",value:function(t){var n,r=this;return t?(t.forEach(function(t){n||(t=r.formatLanguageCode(t),r.options.supportedLngs&&!r.isSupportedCode(t))||(n=t)}),!n&&this.options.supportedLngs&&t.forEach(function(t){var e;if(!n)return e=r.getLanguagePartFromCode(t),r.isSupportedCode(e)?n=e:void(n=r.options.supportedLngs.find(function(t){if(0===t.indexOf(e))return t}))}),n=n||this.getFallbackCodes(this.options.fallbackLng)[0]):null}},{key:"getFallbackCodes",value:function(t,e){return t?("string"==typeof(t="function"==typeof t?t(e):t)&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t)?t:e?t[e]||t[this.getScriptPartFromCode(e)]||t[this.formatLanguageCode(e)]||t[this.getLanguagePartFromCode(e)]||t.default||[]:t.default||[]):[]}},{key:"toResolveHierarchy",value:function(t,e){function n(t){t&&(r.isSupportedCode(t)?i.push(t):r.logger.warn("rejecting language code not found in supportedLngs: ".concat(t)))}var r=this,e=this.getFallbackCodes(e||this.options.fallbackLng||[],t),i=[];return"string"==typeof t&&-1<t.indexOf("-")?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(t))):"string"==typeof t&&n(this.formatLanguageCode(t)),e.forEach(function(t){i.indexOf(t)<0&&n(r.formatLanguageCode(t))}),i}}]);var Ht=zt;function zt(t){ct(this,zt),this.options=t,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=bt.create("languageUtils")}var jt=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],qt={1:function(t){return Number(1<t)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:3<=t%100&&t%100<=10?3:11<=t%100?4:5)},6:function(t){return Number(1==t?0:2<=t&&t<=4?1:2)},7:function(t){return Number(1==t?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(2<=t)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:2<t&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:2<=t%10&&(t%100<10||20<=t%100)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||1<t%100&&t%100<11?1:10<t%100&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||0<t%100&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||10<t)&&t%10==0?2:3)}},Wt=(dt(Gt,[{key:"addRule",value:function(t,e){this.rules[t]=e}},{key:"getRule",value:function(t){return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}},{key:"needsPlural",value:function(t){t=this.getRule(t);return t&&1<t.numbers.length}},{key:"getPluralFormsOfKey",value:function(t,e){return this.getSuffixes(t).map(function(t){return e+t})}},{key:"getSuffixes",value:function(e){var n=this,t=this.getRule(e);return t?t.numbers.map(function(t){return n.getSuffix(e,t)}):[]}},{key:"getSuffix",value:function(t,e){var n,r,i=this,o=this.getRule(t);return o?(e=o.noAbs?o.plurals(e):o.plurals(Math.abs(e)),n=o.numbers[e],this.options.simplifyPluralSuffix&&2===o.numbers.length&&1===o.numbers[0]&&(2===n?n="plural":1===n&&(n="")),r=function(){return i.options.prepend&&n.toString()?i.options.prepend+n.toString():n.toString()},"v1"===this.options.compatibilityJSON?1===n?"":"number"==typeof n?"_plural_".concat(n.toString()):r():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===o.numbers.length&&1===o.numbers[0]?r():this.options.prepend&&e.toString()?this.options.prepend+e.toString():e.toString()):(this.logger.warn("no plural rule found for: ".concat(t)),"")}}]),Gt);function Gt(t){var n,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};ct(this,Gt),this.languageUtils=t,this.options=e,this.logger=bt.create("pluralResolver"),this.rules=(n={},jt.forEach(function(e){e.lngs.forEach(function(t){n[t]={numbers:e.nr,plurals:qt[e.fc]}})}),n)}dt(Kt,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(t.interpolation||(t.interpolation={escapeValue:!0}),t.interpolation);this.escape=void 0!==t.escape?t.escape:Nt,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?xt(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?xt(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator||(t.formatSeparator,","),this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=!this.unescapePrefix&&t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?xt(t.nestingPrefix):t.nestingPrefixEscaped||xt("$t("),this.nestingSuffix=t.nestingSuffix?xt(t.nestingSuffix):t.nestingSuffixEscaped||xt(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator||(t.nestingOptionsSeparator,","),this.maxReplaces=t.maxReplaces||1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var t="".concat(this.prefix,"(.+?)").concat(this.suffix),t=(this.regexp=new RegExp(t,"g"),"".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix)),t=(this.regexpUnescape=new RegExp(t,"g"),"".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix));this.nestingRegexp=new RegExp(t,"g")}},{key:"interpolate",value:function(r,i,o,a){var s,l,u,c=this,h=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function e(t){return t.replace(/\$/g,"$$$$")}this.resetRegExp();var d=a&&a.missingInterpolationHandler||this.options.missingInterpolationHandler,p=a&&a.interpolation&&a.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e},{regex:this.regexp,safeValue:function(t){return c.escapeValue?e(c.escape(t)):e(t)}}].forEach(function(t){for(u=0;s=t.regex.exec(r);){if(e=s[1].trim(),(n=void 0)===(l=e.indexOf(c.formatSeparator)<0?(n=kt(i,h,e),c.alwaysFormat?c.format(n,void 0,o):n):(e=(n=e.split(c.formatSeparator)).shift().trim(),n=n.join(c.formatSeparator).trim(),c.format(kt(i,h,e),n,o,a))))if("function"==typeof d){e=d(r,s,a);l="string"==typeof e?e:""}else{if(p){l=s[0];continue}c.logger.warn("missed to pass in variable ".concat(s[1]," for interpolating ").concat(r)),l=""}else"string"==typeof l||c.useRawValueToEscape||(l=Tt(l));if(r=r.replace(s[0],t.safeValue(l)),t.regex.lastIndex=0,++u>=c.maxReplaces)break}var e,n}),r}},{key:"nest",value:function(t,e){var n,r=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=ut({},i);function a(e,t){var n=this.nestingOptionsSeparator;if(!(e.indexOf(n)<0)){var r=e.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(r[1]);e=r[0],i=(i=this.interpolate(i,o)).replace(/'/g,'"');try{o=JSON.parse(i),t&&(o=ut({},t,o))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(i)}delete o.defaultValue}return e}for(o.applyPostProcessor=!1,delete o.defaultValue;n=this.nestingRegexp.exec(t);){var s,l=[],u=!1;if(n[0].includes(this.formatSeparator)&&!/{.*}/.test(n[1])&&(s=n[1].split(this.formatSeparator).map(function(t){return t.trim()}),n[1]=s.shift(),l=s,u=!0),(s=e(a.call(this,n[1].trim(),o),o))&&n[0]===t&&"string"!=typeof s)return s;(s="string"!=typeof s?Tt(s):s)||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(t)),s=""),u&&(s=l.reduce(function(t,e){return r.format(t,e,i.lng,i)},s.trim())),t=t.replace(n[0],s),this.regexp.lastIndex=0}return t}}]);var $t=Kt;function Kt(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};ct(this,Kt),this.logger=bt.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(t){return t},this.init(t)}vt(Zt,Ct),dt(Zt,[{key:"queueLoad",value:function(t,e,i,n){var o=this,a=[],s=[],l=[],u=[];return t.forEach(function(n){var r=!0;e.forEach(function(t){var e="".concat(n,"|").concat(t);!i.reload&&o.store.hasResourceBundle(n,t)?o.state[e]=2:o.state[e]<0||(1===o.state[e]?s.indexOf(e)<0&&s.push(e):(o.state[e]=1,r=!1,s.indexOf(e)<0&&s.push(e),a.indexOf(e)<0&&a.push(e),u.indexOf(t)<0&&u.push(t)))}),r||l.push(n)}),(a.length||s.length)&&this.queue.push({pending:s,loaded:{},errors:[],callback:n}),{toLoad:a,pending:s,toLoadLanguages:l,toLoadNamespaces:u}}},{key:"loaded",value:function(l,u,t){var e=l.split("|"),c=e[0],h=e[1],d=(u&&this.emit("failedLoading",c,h,u),t&&this.store.addResourceBundle(c,h,t),this.state[l]=u?-1:2,{});this.queue.forEach(function(t){e=t.loaded,r=h,(n=(e=At(e,n=[c],Object)).obj)[e=e.k]=n[e]||[],i&&(n[e]=n[e].concat(r)),i||n[e].push(r);for(var e,n,r,i,o=t.pending,a=l,s=o.indexOf(a);-1!==s;)o.splice(s,1),s=o.indexOf(a);u&&t.errors.push(u),0!==t.pending.length||t.done||(Object.keys(t.loaded).forEach(function(e){d[e]||(d[e]=[]),t.loaded[e].length&&t.loaded[e].forEach(function(t){d[e].indexOf(t)<0&&d[e].push(t)})}),t.done=!0,t.errors.length?t.callback(t.errors):t.callback())}),this.emit("loaded",d),this.queue=this.queue.filter(function(t){return!t.done})}},{key:"read",value:function(n,r,i){var o=this,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:350,l=5<arguments.length?arguments[5]:void 0;return n.length?this.backend[i](n,r,function(t,e){t&&e&&a<5?setTimeout(function(){o.read.call(o,n,r,i,a+1,2*s,l)},s):l(t,e)}):l(null,{})}},{key:"prepareLoading",value:function(t,e){var n=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=3<arguments.length?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t));t=this.queueLoad(t,e="string"==typeof e?[e]:e,r,i);if(!t.toLoad.length)return t.pending.length||i(),null;t.toLoad.forEach(function(t){n.loadOne(t)})}},{key:"load",value:function(t,e,n){this.prepareLoading(t,e,{},n)}},{key:"reload",value:function(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}},{key:"loadOne",value:function(n){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",t=n.split("|"),o=t[0],a=t[1];this.read(o,a,"read",void 0,void 0,function(t,e){t&&r.logger.warn("".concat(i,"loading namespace ").concat(a," for language ").concat(o," failed"),t),!t&&e&&r.logger.log("".concat(i,"loaded namespace ").concat(a," for language ").concat(o),e),r.loaded(n,t,e)})}},{key:"saveMissing",value:function(t,e,n,r,i){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(t,e,n,r,null,ut({},o,{isUpdate:i})),t)&&t[0]&&this.store.addResource(t[0],e,n,r)}}]);var Xt=Zt;function Zt(t,e,n){var r,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return ct(this,Zt),r=gt(this,mt(Zt).call(this)),Rt&&Ct.call(ft(r)),r.backend=t,r.store=e,r.services=n,r.languageUtils=n.languageUtils,r.options=i,r.logger=bt.create("backendConnector"),r.state={},r.queue=[],r.backend&&r.backend.init&&r.backend.init(n,i.backend,i),r}function Yt(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.whitelist&&(t.whitelist,t.whitelist.indexOf("cimode")<0&&(t.whitelist=t.whitelist.concat(["cimode"])),t.supportedLngs=t.whitelist),t.nonExplicitWhitelist&&(t.nonExplicitSupportedLngs=t.nonExplicitWhitelist),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function Qt(){}function Jt(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;if(ct(this,Jt),t=gt(this,mt(Jt).call(this)),Rt&&Ct.call(ft(t)),t.options=Yt(e),t.services={},t.logger=bt,t.modules={external:[]},n&&!t.isInitialized&&!e.isClone){if(!t.options.initImmediate)return t.init(e,n),gt(t,ft(t));setTimeout(function(){t.init(e,n)},0)}return t}vt(Jt,Ct),dt(Jt,[{key:"init",value:function(){var t,i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;function r(t){return t?"function"==typeof t?new t:t:null}"function"==typeof e&&(n=e,e={}),e.whitelist&&!e.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),e.nonExplicitWhitelist&&!e.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=ut({},{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var e,n={};return"object"===st(t[1])&&(n=t[1]),"string"==typeof t[1]&&(n.defaultValue=t[1]),"string"==typeof t[2]&&(n.tDescription=t[2]),"object"!==st(t[2])&&"object"!==st(t[3])||(e=t[3]||t[2],Object.keys(e).forEach(function(t){n[t]=e[t]})),n},interpolation:{escapeValue:!0,format:function(t,e,n,r){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}},this.options,Yt(e)),this.format=this.options.interpolation.format,n=n||Qt,this.options.isClone||(this.modules.logger?bt.init(r(this.modules.logger),this.options):bt.init(null,this.options),e=new Ht(this.options),this.store=new Pt(this.options.resources,this.options),(t=this.services).logger=bt,t.resourceStore=this.store,t.languageUtils=e,t.pluralResolver=new Wt(e,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),t.interpolator=new $t(this.options),t.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},t.backendConnector=new Xt(r(this.modules.backend),t.resourceStore,t,this.options),t.backendConnector.on("*",function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i.emit.apply(i,[t].concat(n))}),this.modules.languageDetector&&(t.languageDetector=r(this.modules.languageDetector),t.languageDetector.init(t,this.options.detection,this.options)),this.modules.i18nFormat&&(t.i18nFormat=r(this.modules.i18nFormat),t.i18nFormat.init)&&t.i18nFormat.init(this),this.translator=new Ut(this.services,this.options),this.translator.on("*",function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i.emit.apply(i,[t].concat(n))}),this.modules.external.forEach(function(t){t.init&&t.init(i)})),!this.options.fallbackLng||this.services.languageDetector||this.options.lng||0<(e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng)).length&&"dev"!==e[0]&&(this.options.lng=e[0]),this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(function(e){i[e]=function(){var t;return(t=i.store)[e].apply(t,arguments)}});function o(){function t(t,e){i.isInitialized&&i.logger.warn("init: i18next is already initialized. You should call init just once!"),i.isInitialized=!0,i.options.isClone||i.logger.log("initialized",i.options),i.emit("initialized",i.options),a.resolve(e),n(t,e)}if(i.languages&&"v1"!==i.options.compatibilityAPI&&!i.isInitialized)return t(null,i.t.bind(i));i.changeLanguage(i.options.lng,t)}["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(function(e){i[e]=function(){var t;return(t=i.store)[e].apply(t,arguments),i}});var a=St();return this.options.resources||!this.options.initImmediate?o():setTimeout(o,0),a}},{key:"loadResources",value:function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Qt,r="string"==typeof t?t:this.language;if("function"==typeof t&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return n();var i=[],t=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach(function(t){i.indexOf(t)<0&&i.push(t)})};r?t(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(t),this.options.preload&&this.options.preload.forEach(t),this.services.backendConnector.load(i,this.options.ns,n)}else n(null)}},{key:"reloadResources",value:function(t,e,n){var r=St();return t=t||this.languages,e=e||this.options.ns,n=n||Qt,this.services.backendConnector.reload(t,e,function(t){r.resolve(),n(t)}),r}},{key:"use",value:function(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(t.type)return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&Mt.addPostProcessor(t),"3rdParty"===t.type&&this.modules.external.push(t),this;throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()")}},{key:"changeLanguage",value:function(t,n){function e(t){var e="string"==typeof t?t:r.services.languageUtils.getBestMatchFromCodes(t);e&&(r.language||(r.language=e,r.languages=r.services.languageUtils.toResolveHierarchy(e)),r.translator.language||r.translator.changeLanguage(e),r.services.languageDetector)&&r.services.languageDetector.cacheUserLanguage(e),r.loadResources(e,function(t){o(t,e)})}var r=this,i=(this.isLanguageChangingTo=t,St()),o=(this.emit("languageChanging",t),function(t,e){e?(r.language=e,r.languages=r.services.languageUtils.toResolveHierarchy(e),r.translator.changeLanguage(e),r.isLanguageChangingTo=void 0,r.emit("languageChanged",e),r.logger.log("languageChanged",e)):r.isLanguageChangingTo=void 0,i.resolve(function(){return r.t.apply(r,arguments)}),n&&n(t,function(){return r.t.apply(r,arguments)})});return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(e):e(t):e(this.services.languageDetector.detect()),i}},{key:"getFixedT",value:function(t,e){function a(t,e){var n;if("object"!==st(e)){for(var r=arguments.length,i=new Array(2<r?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=s.options.overloadTranslationOptionHandler([t,e].concat(i))}else n=ut({},e);return n.lng=n.lng||a.lng,n.lngs=n.lngs||a.lngs,n.ns=n.ns||a.ns,s.t(t,n)}var s=this;return"string"==typeof t?a.lng=t:a.lngs=t,a.ns=e,a}},{key:"t",value:function(){var t;return this.translator&&(t=this.translator).translate.apply(t,arguments)}},{key:"exists",value:function(){var t;return this.translator&&(t=this.translator).exists.apply(t,arguments)}},{key:"setDefaultNamespace",value:function(t){this.options.defaultNS=t}},{key:"hasLoadedNamespace",value:function(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.languages[0],i=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;function a(t,e){return-1===(t=n.services.backendConnector.state["".concat(t,"|").concat(e)])||2===t}if(e.precheck){e=e.precheck(this,a);if(void 0!==e)return e}return!!this.hasResourceBundle(r,t)||!this.services.backendConnector.backend||!(!a(r,t)||i&&!a(o,t))}},{key:"loadNamespaces",value:function(t,e){var n=this,r=St();return this.options.ns?((t="string"==typeof t?[t]:t).forEach(function(t){n.options.ns.indexOf(t)<0&&n.options.ns.push(t)}),this.loadResources(function(t){r.resolve(),e&&e(t)}),r):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(t,e){var n=St(),r=this.options.preload||[],t=(t="string"==typeof t?[t]:t).filter(function(t){return r.indexOf(t)<0});return t.length?(this.options.preload=r.concat(t),this.loadResources(function(t){n.resolve(),e&&e(t)}),n):(e&&e(),Promise.resolve())}},{key:"dir",value:function(t){return!(t=t||(this.languages&&0<this.languages.length?this.languages[0]:this.language))||0<=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(t))?"rtl":"ltr"}},{key:"createInstance",value:function(){return new Jt(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)}},{key:"cloneInstance",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Qt,t=ut({},this.options,t,{isClone:!0}),i=new Jt(t);return["store","services","language"].forEach(function(t){i[t]=e[t]}),i.services=ut({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new Ut(i.services,i.options),i.translator.on("*",function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i.emit.apply(i,[t].concat(n))}),i.init(t,n),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}}]);var te=new Jt,ee=(u=[]).forEach,ne=u.slice;function re(t,e){if(e&&"object"===st(e)){var n,r="",i=encodeURIComponent;for(n in e)r+="&"+i(n)+"="+i(e[n]);if(!r)return t;t=t+(-1!==t.indexOf("?")?"&":"?")+r.slice(1)}return t}function ie(t,e,n,r,i){r&&"object"===st(r)&&(i||(r._t=new Date),r=re("",r).slice(1)),e.queryStringParams&&(t=re(t,e.queryStringParams));try{var o=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0"),a=(o.open(r?"POST":"GET",t,1),e.crossDomain||o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.withCredentials=!!e.withCredentials,r&&o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.overrideMimeType&&o.overrideMimeType("application/json"),e.customHeaders);if(a="function"==typeof a?a():a)for(var s in a)o.setRequestHeader(s,a[s]);o.onreadystatechange=function(){3<o.readyState&&n&&n(o.responseText,o)},o.send(r)}catch(t){console&&console.log(t)}}var oe=(()=>{function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};ct(this,n),this.init(t,e),this.type="backend"}return dt(n,[{key:"init",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.services=t,this.options=function(n){return ee.call(ne.call(arguments,1),function(t){if(t)for(var e in t)void 0===n[e]&&(n[e]=t[e])}),n}(e,this.options||{},{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:JSON.parse,parsePayload:function(t,e,n){return lt({},e,n||"")},crossDomain:!1,ajax:ie})}},{key:"readMulti",value:function(t,e,n){var r=this.options.loadPath,r=("function"==typeof this.options.loadPath&&(r=this.options.loadPath(t,e)),this.services.interpolator.interpolate(r,{lng:t.join("+"),ns:e.join("+")}));this.loadUrl(r,n)}},{key:"read",value:function(t,e,n){var r=this.options.loadPath,r=("function"==typeof this.options.loadPath&&(r=this.options.loadPath([t],[e])),this.services.interpolator.interpolate(r,{lng:t,ns:e}));this.loadUrl(r,n)}},{key:"loadUrl",value:function(i,o){var a=this;this.options.ajax(i,this.options,function(t,e){if(500<=e.status&&e.status<600)return o("failed loading "+i,!0);if(400<=e.status&&e.status<500)return o("failed loading "+i,!1);var n,r;try{n=a.options.parse(t,i)}catch(t){r="failed parsing "+i+" to json"}if(r)return o(r,!1);o(null,n)})}},{key:"create",value:function(t,e,n,r){var i=this,o=("string"==typeof t&&(t=[t]),this.options.parsePayload(e,n,r));t.forEach(function(t){t=i.services.interpolator.interpolate(i.options.addPath,{lng:t,ns:e});i.options.ajax(t,i.options,function(t,e){},o)})}}]),n})();oe.type="backend";var ae=(u=[]).forEach,se=u.slice,le=function(t,e,n,r){var i,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{path:"/"},n=n?((i=new Date).setTime(i.getTime()+60*n*1e3),"; expires="+i.toUTCString()):"";r=r?"domain="+r+";":"",o=Object.keys(o).reduce(function(t,e){return t+";"+e.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})+"="+o[e]},""),document.cookie=t+"="+encodeURIComponent(e)+n+";"+r+o},ue=function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return null},ce={name:"cookie",lookup:function(t){var e;return e=t.lookupCookie&&"undefined"!=typeof document&&(t=ue(t.lookupCookie))?t:e},cacheUserLanguage:function(t,e){e.lookupCookie&&"undefined"!=typeof document&&le(e.lookupCookie,t,e.cookieMinutes,e.cookieDomain,e.cookieOptions)}},he={name:"querystring",lookup:function(t){var e;if("undefined"!=typeof window)for(var n=window.location.search.substring(1).split("&"),r=0;r<n.length;r++){var i=n[r].indexOf("=");0<i&&n[r].substring(0,i)===t.lookupQuerystring&&(e=n[r].substring(i+1))}return e}};try{var de="undefined"!==window&&null!==window.localStorage,pe="i18next.translate.boo";window.localStorage.setItem(pe,"foo"),window.localStorage.removeItem(pe)}catch(t){de=!1}var fe={name:"localStorage",lookup:function(t){var e;return e=t.lookupLocalStorage&&de&&(t=window.localStorage.getItem(t.lookupLocalStorage))?t:e},cacheUserLanguage:function(t,e){e.lookupLocalStorage&&de&&window.localStorage.setItem(e.lookupLocalStorage,t)}};try{var ge="undefined"!==window&&null!==window.sessionStorage,me="i18next.translate.boo";window.sessionStorage.setItem(me,"foo"),window.sessionStorage.removeItem(me)}catch(t){ge=!1}var C,ye,ve,_e={name:"sessionStorage",lookup:function(t){var e;return e=t.lookupsessionStorage&&ge&&(t=window.sessionStorage.getItem(t.lookupsessionStorage))?t:e},cacheUserLanguage:function(t,e){e.lookupsessionStorage&&ge&&window.sessionStorage.setItem(e.lookupsessionStorage,t)}},we={name:"navigator",lookup:function(t){var e=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var n=0;n<navigator.languages.length;n++)e.push(navigator.languages[n]);navigator.userLanguage&&e.push(navigator.userLanguage),navigator.language&&e.push(navigator.language)}return 0<e.length?e:void 0}},be={name:"htmlTag",lookup:function(t){var e,t=t.htmlTag||("undefined"!=typeof document?document.documentElement:null);return e=t&&"function"==typeof t.getAttribute?t.getAttribute("lang"):e}},Ce={name:"path",lookup:function(t){var e;if("undefined"!=typeof window){var n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(n instanceof Array)if("number"==typeof t.lookupFromPathIndex){if("string"!=typeof n[t.lookupFromPathIndex])return;e=n[t.lookupFromPathIndex].replace("/","")}else e=n[0].replace("/","")}return e}},Ee={name:"subdomain",lookup:function(t){var e,n;return e="undefined"!=typeof window&&(n=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi))instanceof Array?("number"==typeof t.lookupFromSubdomainIndex?n[t.lookupFromSubdomainIndex]:n[0]).replace("http://","").replace("https://","").replace(".",""):e}},Se=(()=>{function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};ct(this,n),this.type="languageDetector",this.detectors={},this.init(t,e)}return dt(n,[{key:"init",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.services=t,this.options=function(n){return ae.call(se.call(arguments,1),function(t){if(t)for(var e in t)void 0===n[e]&&(n[e]=t[e])}),n}(e,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],checkWhitelist:!0,checkForSimilarInWhitelist:!1}),this.options.checkForSimilarInWhitelist&&(this.options.checkWhitelist=!0),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(ce),this.addDetector(he),this.addDetector(fe),this.addDetector(_e),this.addDetector(we),this.addDetector(be),this.addDetector(Ce),this.addDetector(Ee)}},{key:"addDetector",value:function(t){this.detectors[t.name]=t}},{key:"detect",value:function(t){var e,n=this,r=(t=t||this.options.order,[]);return t.forEach(function(t){n.detectors[t]&&(t=(t=n.detectors[t].lookup(n.options))&&"string"==typeof t?[t]:t)&&(r=r.concat(t))}),r.forEach(function(t){e||(t=n.services.languageUtils.formatLanguageCode(t),!(e=n.options.checkWhitelist&&!n.services.languageUtils.isWhitelisted(t)?e:t)&&n.options.checkForSimilarInWhitelist&&(e=n.getSimilarInWhitelist(t)))}),e||(t=(t="string"==typeof(t=this.i18nOptions.fallbackLng)?[t]:t)||[],e="[object Array]"===Object.prototype.toString.apply(t)?t[0]:t[0]||t.default&&t.default[0]),e}},{key:"cacheUserLanguage",value:function(e,t){var n=this;!(t=t||this.options.caches)||this.options.excludeCacheFor&&-1<this.options.excludeCacheFor.indexOf(e)||t.forEach(function(t){n.detectors[t]&&n.detectors[t].cacheUserLanguage(e,n.options)})}},{key:"getSimilarInWhitelist",value:function(e){var n=this;if(this.i18nOptions.whitelist){if(e.includes("-")){var t=e.split("-")[0],t=this.services.languageUtils.formatLanguageCode(t);if(this.services.languageUtils.isWhitelisted(t))return t;e=t}t=this.i18nOptions.whitelist.find(function(t){t=n.services.languageUtils.formatLanguageCode(t);if(t.startsWith(e))return t});return t||void 0}}}]),n})(),Te=(Se.type="languageDetector",ye={type:"postProcessor",name:"htmlParagraphsPostProcessor",process:function(t){var e=t.split("\n");return 1<e.length?"<p>"+e.join("</p><p>")+"</p>":t}},(C=function(t,e){return te.t(t,e)}).init=function(t){return ve.then(function(){return t})},ve=new Promise(function(e,n){te.use(oe).use(Se).use(ye).init({whitelist:ot.languagesSupported,fallbackLng:"en",joinArrays:"\n",backend:{loadPath:"/build/locales/__lng__/translation.json"},load:"languageOnly",lowerCaseLng:!0,detection:{order:["querystring","navigator"],lookupQuerystring:"lang",caches:!1},interpolation:{prefix:"__",suffix:"__"},postProcess:["htmlParagraphsPostProcessor"]},function(t){t?n(t):e()})}),F(function(t,e){t.exports=function(t){var c,s,l,u,h,a,d,p,f,g,m={pfx:"_",psr:"http://www.w3.org/1999/xhtml",xpe:"http://www.w3.org/2000/xmlns/"},y=this,v=(y.Init=function(t){return void 0===(t="object"!=typeof t?{}:t).stay?void 0===p&&(p=["all"]):p=t.stay?"object"==typeof t.stay&&t.stay instanceof Array?t.stay:[t.stay]:[],void 0===t.join?void 0===f&&(f=["root"]):f=t.join?[String(t.join)]:[!1],f[1]=!1,void 0!==t.updn?g=t.updn:void 0===g&&(g=!0),y.dom=null,y.nsp={},y.count=0,c&&(y.error={code:"",text:""}),c},y.AddFile=function(t){t=c&&(t&&t.target?t.target.result?y.AddSource(t.target.result):S("emf"):S("nof"));return t},y.AddSource=function(t){var e;if(c)if("object"==typeof t)(e=!!y.Get(1,t)&&t)&&(1<c&&!DOMParser||1===c&&!e.selectSingleNode("/"))&&(e=null);else try{e=v(t)}catch(t){e=!1}return c&&(null===e?S("nob"):!1===e?S("inv"):!0===e?(y.nsp=b(y.dom.documentElement),y.count=1,y.dom):!!r(e)&&(_(e,"/"),!0===f[1]&&(t=y.dom.createTextNode("\r\n"),y.dom.documentElement.appendChild(t)),y.count++,y.dom))},function(t){var e=1<c?(d=!1,y.dom?(e=l.parseFromString(t,"text/xml"),!!n(e)&&e):(y.dom=l.parseFromString(t,"text/xml"),!!n(y.dom))):y.dom?((e=new ActiveXObject(s)).async=!1,!!e.loadXML(t)&&e):(y.dom=new ActiveXObject(s),y.dom.async=!1,y.dom.setProperty("SelectionLanguage","XPath"),!!y.dom.loadXML(t));return e}),n=function(t){return!d&&!t.getElementsByTagNameNS(m.psr,"parsererror").length},r=function(t){var e,n=!0,r=y.dom.characterSet||y.dom.inputEncoding||y.dom.xmlEncoding;if((t.characterSet||t.inputEncoding||t.xmlEncoding)!==r?n=S("enc"):t.documentElement.namespaceURI!==y.dom.documentElement.namespaceURI?n=S("nse"):t.documentElement.nodeName!==y.dom.documentElement.nodeName&&(f[0]?f[1]||(r='<?xml version="'+(y.dom.xmlVersion||"1.0")+'" encoding="'+(void 0!==r?r:"UTF-8")+'"?>\r\n<'+f[0]+">\r\n</"+f[0]+">",(r=v(r))?(e=y.dom.documentElement.cloneNode(!0),r.documentElement.appendChild(e),e=r.createTextNode("\r\n"),r.documentElement.appendChild(e),y.dom=r,f[1]=!0):(n=S("jne"),f[1]=null)):n=S("dif")),n){var i,o=b(t.documentElement);for(i in o)y.nsp[i]||(void 0!==y.dom.documentElement.setAttributeNS?y.dom.documentElement.setAttributeNS(m.xpe,"xmlns:"+i,o[i]):y.dom.documentElement.setAttribute("xmlns:"+i,o[i]),y.nsp[i]=o[i]);g?1===c?C():a=3===c?y:y.lookupNamespaceURI:a=null}return n},_=function(t,e){for(var n=0;n<t.childNodes.length;n++){var r,i=t.childNodes[n],o=w(t.childNodes,i,e,n),a=y.Query(o);if(1===i.nodeType){var s=!0;if(null===a||a.namespaceURI!==i.namespaceURI)r=i.cloneNode(!0),(a=y.Query(e)).appendChild(r);else if(s=!1!==E(a.getAttribute("stay"),p)?!1:s)try{for(var l=0;l<i.attributes.length;l++)i.attributes[l].namespaceURI&&void 0!==i.setAttributeNS?a.setAttributeNS(i.attributes[l].namespaceURI,i.attributes[l].nodeName,i.attributes[l].nodeValue):a.setAttribute(i.attributes[l].nodeName,i.attributes[l].nodeValue)}catch(t){}i.hasChildNodes()&&s&&_(i,o)}else 3!==i.nodeType&&8!==i.nodeType||(null===a||a.nodeType!==i.nodeType?(a=y.Query(e),r=3===i.nodeType?y.dom.createTextNode(i.nodeValue):y.dom.createComment(i.nodeValue),a.appendChild(r)):(a.nodeValue=i.nodeValue,a.data=i.data))}},w=function(t,e,n,r){var i,o,a=0;if(1===e.nodeType){for(o=0;o<=r;o++)(g&&t[o].nodeType===e.nodeType&&t[o].nodeName===e.nodeName||!g&&7!==t[o].nodeType)&&a++;if(g){var s,l=!1,u=b(e);for(s in u)s!==m.pfx&&(y.nsp[s]=u[s],l=1===c);l&&C(),i=e.prefix?e.prefix+":":y.nsp[m.pfx]?m.pfx+":":"",i+=e.localName||e.baseName}else i="node()"}else if(3===e.nodeType||8===e.nodeType){for(o=0;o<=r;o++)t[o].nodeType===e.nodeType&&a++;i=3===e.nodeType?"text()":"comment()"}else i=n;return i=a?n+("/"===n.slice(-1)?"":"/")+i+"["+a+"]":i},b=function(t){for(var e={},n=t.attributes,r=0;r<n.length;++r){var i=n[r].name.split(":");"xmlns"===i[0]&&(e[i[1]||m.pfx]=n[r].value)}return e},C=(y.Query=function(t){if(!c)return null;var e;f[1]&&(t="/"+y.dom.documentElement.nodeName+("/"===t?"":t));try{e=1<c?(e=u.evaluate(t,y.dom,a,h.FIRST_ORDERED_NODE_TYPE,null)).singleNodeValue:y.dom.selectSingleNode(t)}catch(t){e=null}return e},y.lookupNamespaceURI=function(t){return y.nsp[t]||null},function(){var t,e="";for(t in y.nsp)e+=" xmlns:"+t+"='"+y.nsp[t]+"'";e&&y.dom.setProperty("SelectionNamespaces",e.substr(1))}),E=function(t,e){var n,r=!1;for(n in e)if(e[n]===t){r=n;break}return r},S=(y.Get=function(e,t){var n;if(e&&!t&&(t=y.dom),c)if(e)if(t)if(t.xml)n=t.xml;else try{n=(new XMLSerializer).serializeToString(t)}catch(t){n=t.message,e=null}else n="";else n=y.dom;else n=y.error.text;return n&&2===e&&(f[1]&&(t=n.indexOf("<"+f[0]),n=n.substr(0,t)+"\r\n"+n.substr(t)),n=(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ |\t/g,"&nbsp;")).replace(/(\r\n|\n|\r)/g,"<br>")),n},function(t){var e={nod:"XML DOM is not supported",nos:"Serializer is not supported",nox:"xPath is not supported",nob:"Incompatible source object",nof:"File not found",emf:"File is empty",inv:"Invalid XML source",enc:"Different encoding",dif:"Different root nodes",jne:"Invalid join parameter",nse:"Namespace incompatibility",und:"Undefined error"};return y.error.code=e[t]?t:"und",y.error.text=e[y.error.code],!1});(()=>{if(y.error={},"undefined"!=typeof process&&process.versions&&process.versions.node){"object"==typeof t&&"string"==typeof t.path&&t.path;try{B.XPathEvaluator=U(),B.DOMParser=U().DOMParser,B.XMLSerializer=U().XMLSerializer}catch(t){console.log(t.message)}}c=(()=>{for(var t,e,n=!1,r=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","Microsoft.XmlDom"],i=r.length,o=0;o<i;o++)try{var a=new ActiveXObject(r[o]);if(a.async=!1,n=!0,a.loadXML("<x></x>")&&a.selectSingleNode("/"))break}catch(t){}return n?t=o<i?(s=r[o],1):"nox":("undefined"!=typeof window?(e=window,t=2):void 0!==B?(e=B,t=3):e={},e.DOMParser?e.XMLSerializer?e.XPathEvaluator?2===t?(l=new e.DOMParser,u=new e.XPathEvaluator,h=e.XPathResult,n=l.parseFromString("<invalid","text/xml"),m.psr=n.getElementsByTagName("parsererror")[0].namespaceURI):(l=new e.DOMParser({xmlns:m.psr,errorHandler:function(){d=!0}}),u=e.XPathEvaluator,h=e.XPathEvaluator.XPathResult,m.xpe=u.XPath.XMLNS_NAMESPACE_URI):t="nox":t="nos":t="nod"),"string"==typeof t?S(t):t})(),y.Init(t)})()}}));let Ae;function Ie(r,t){var i=new RegExp(t+"\\s*\\(","g"),o=[];if(r&&t)for(;null!==(s=i.exec(r));){var a=[];let t=1;var s=s.index;let e=i.lastIndex,n=e-1;for(;0!==t&&n<r.length;)"("===r[++n]?t++:")"===r[n]?t--:","===r[n]&&1===t&&(a.push(r.substring(e,n).trim()),e=n+1);e<n&&a.push(r.substring(e,n).trim()),o.push([r.substring(s,n+1),a])}return o}function Le(t){return/^".+"$/.test(t)||/^'.+'$/.test(t)?t.substring(1,t.length-1):t}function ke(t,e){return"object"==typeof t&&null!==t&&t.name?(e=e||"",1<(t=t.name.split(".")).length?t[t.length-2]+=e:1===t.length&&(t[0]+=e),t.join(".")):""}function xe(t){return!isNaN(parseFloat(t))&&isFinite(t)}function De(t){var e=atob(t.split(",")[1]),t=t.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(e.length),r=new Uint8Array(n);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return new Blob([r],{type:t})}function Ne(t){t=t.clipboardData||window.clipboardData;return t?t.getData("text"):null}function Re(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Pe(t,e){return Be(t,e,!0)}function Oe(t,e){return Be(t,e)}function Me(t,e="*"){let n,r=t.parentElement.firstElementChild;for(;r&&!n;)r!==t&&r.matches(e)&&(n=r),r=r.nextElementSibling;return n}function Be(t,e="*",n=!1){var r=[];let i=t.parentElement.firstElementChild;for(;i;)(i===t&&n||i!==t&&i.matches(e))&&r.push(i),i=i.nextElementSibling;return r}function Ue(t,e="*",n){var r=[];let i=t.parentElement;for(;i;)i.matches(e)&&r.unshift(i),i=n&&i.matches(n)?null:i.parentElement;return r}function Fe(t,e="*",n){let r=t.parentElement,i=null;for(;r&&!i;)r.matches(e)&&(i=r),r=n&&r.matches(n)?null:r.parentElement;return i}function Ve(t,e="*"){return[...t.children].filter(t=>t.matches(e))}function He(t,e="*"){return[...t.children].find(t=>t.matches(e))}function ze(t,e="#document",n=!1){let r;var i=[];let o="";if(!t||1!==t.nodeType)return null;var a=t.nodeName;let s=t.parentElement,l=s?s.nodeName:null;for(n&&0<(r=je(t))&&(o=`[${r+1}]`),i.push(a+o);s&&l!==e&&"#document"!==l;)n&&(r=je(s),o=0<r?`[${r+1}]`:""),i.push(l+o),s=s.parentElement,l=s?s.nodeName:null;return"/"+i.reverse().join("/")}function je(t){let e=0;var n=t.nodeName;let r=t.previousSibling;for(;r;)r.nodeName&&r.nodeName===n&&e++,r=r.previousSibling;return e}let qe={_storage:new WeakMap,put:function(t,e,n){this._storage.has(t)||this._storage.set(t,new Map),this._storage.get(t).set(e,n)},get:function(t,e){t=this._storage.get(t);return t&&t.get(e)},has:function(t,e){t=this._storage.get(t);return t&&t.has(e)},remove:function(t,e){var n=this._storage.get(t).delete(e);return 0===!this._storage.get(e).size&&this._storage.delete(t),n}};class We{constructor(t=document.documentElement){this.classChanges=new WeakMap,this.quiet=!0;let e=new MutationObserver(t=>{t.forEach(n=>{if(t++,"attributes"===n.type&&"class"===n.attributeName){let e=this.classChanges.get(n.target)||[];e.forEach(t=>{n.target.classList.contains(t.className)&&(t.completed=!0,this.classChanges.set(n.target,e))})}})}),n=(e.observe(t,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),setInterval(()=>{this.quiet=!0,e.disconnect(),clearInterval(n)},100))}_resolveWhenTrue(n){return"function"!=typeof n?Promise.reject():new Promise(t=>{let e=setInterval(()=>{n.call(this)&&(clearInterval(e),t())},10)})}waitForClassChange(t,e){var n=this.classChanges.get(t)||[];return n.some(t=>t.className===e)||(n.push({className:e}),this.classChanges.set(t,n)),this._resolveWhenTrue(()=>this.classChanges.get(t).find(t=>t.className===e).completed)}waitForQuietness(){return this._resolveWhenTrue(()=>this.quiet)}}function Ge(t){this.message=t||"unknown",this.name="FormLogicError",this.stack=(new Error).stack}(Ge.prototype=Object.create(Error.prototype)).constructor=Ge;let $e=navigator.language,Ke=(u="[:0-9Ù -Ù©]+",pe="[^: 0-9Ù -Ù©]+",new RegExp(`^(${u} ?(${pe}))|((${pe}) ?${u})$`));function Xe(t){return Ze((t=void 0===t?new Date:t).toLocaleTimeString($e))}function Ze(t){return t.replace(/[\u200E\u200F]/g,"")}let Ye={get hour12(){return this.hasMeridian(Xe())},get pmNotation(){return this.meridianNotation(new Date(2e3,1,1,23,0,0))},get amNotation(){return this.meridianNotation(new Date(2e3,1,1,1,0,0))},meridianNotation(t){let e=Xe(t).match(Ke);return e&&e.length?(e=e.filter(t=>!!t))[e.length-1].trim():null},hasMeridian(t){return Ke.test(Ze(t))}},Qe={string:{convert(t){return t.replace(/^\s+$/,"")},validate(){return!0}},select:{validate(){return!0}},select1:{validate(){return!0}},decimal:{convert(t){t=Number(t);return isNaN(t)||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY?"":t},validate(t){t=Number(t);return!isNaN(t)&&t!==Number.POSITIVE_INFINITY&&t!==Number.NEGATIVE_INFINITY}},int:{convert(t){t=Number(t);return isNaN(t)||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY?"":0<=t?Math.floor(t):-Math.floor(Math.abs(t))},validate(t){var e=Number(t);return!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY&&Math.round(e)===e&&e.toString()===t.toString()}},date:{validate(t){var e,n,r,t=/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/.exec(t);return!(!t||4!==t.length)&&(e=Number(t[1]),n=Number(t[2])-1,t=Number(t[3]),(r=new Date(e,n,t)).getFullYear()===e)&&r.getMonth()===n&&r.getDate()===t},convert(t){var e;return xe(t)?"Invalid Date"===(e=new Date(24*t*60*60*1e3)).toString()?"":`${e.getFullYear().toString().padStart(4,"0")}-${(e.getMonth()+1).toString().padStart(2,"0")}-`+e.getDate().toString().padStart(2,"0"):(/[0-9]T[0-9]/.test(t)&&(t=t.split("T")[0]),this.validate(t)?t:"")}},datetime:{validate(t){var e=t.split("T");return 2!==e.length&&2!==(e=t.split(" ")).length||Qe.date.validate(e[0])&&Qe.time.validate(e[1],!1)},convert(t){let e="Invalid Date";var n=t.split("T");if(xe(t))e=new Date(24*t*60*60*1e3);else if(/[0-9]T[0-9]/.test(t)&&2===n.length){var t=Qe.date.convert(n[0]),r=Qe.time.convert(n[1],!1);if(t&&r)return t+"T"+r}else{t=Qe.date.convert(n[0]);if(t)return t+"T00:00:00.000"+(new Date).getTimezoneOffsetAsTime()}return"Invalid Date"!==e.toString()?e.toISOLocalString():""}},time:{validate(t,e){let n=t.match(/^(\d\d):(\d\d):(\d\d)\.\d\d\d(\+|-)(\d\d):(\d\d)$/);return e="boolean"!=typeof e||e,!!(n=n||e?n:t.match(/^(\d\d):(\d\d):(\d\d)(\+|-)(\d\d):(\d\d)$/))&&n[1]<24&&0<=n[1]&&n[2]<60&&0<=n[2]&&n[3]<60&&0<=n[3]&&n[5]<24&&0<=n[5]&&n[6]<60&&0<=n[6]},convert(t,e){var n,r,i={};let o;if(e="boolean"!=typeof e||e,!/^[0-9]{1,2}:[0-9]{1,2}(:[0-9.]*)?/.test(t)){if("Invalid Date"===(r=new Date(t)).toString())return"";t=`${r.getHours()}:${r.getMinutes()}:${r.getSeconds()}.`+r.getMilliseconds()+r.getTimezoneOffsetAsTime()}return!((r=t.toString().split(/(\+|-|Z)/)).length<1)&&(n=r[0].split(":"),r=r[2]?[r[1]].concat(r[2].split(":")):"Z"===r[1]?["+","00","00"]:[],i.hours=n[0].padStart(2,"0"),i.minutes=n[1].padStart(2,"0"),n=n[2]?n[2].split("."):["00"],i.seconds=n[0],i.milliseconds=n[1]||(e?"000":void 0),o=0===r.length?(new Date).getTimezoneOffsetAsTime():r[0]+r[1].padStart(2,"0")+":"+(r[2]?r[2].padStart(2,"0"):"00"),t=i.hours+`:${i.minutes}:`+i.seconds+(i.milliseconds?"."+i.milliseconds:"")+o,this.validate(t,e))?t:""},convertMeridian(t){var e,n;return t=t.trim(),Ye.hasMeridian(t)&&(n=(e=t.split(" "))[0].split(":"),0<e.length)&&(e[1]===Ye.pmNotation?n[0]=(Number(n[0])%12+12).toString().padStart(2,"0"):e[1]===Ye.amNotation&&(n[0]=(Number(n[0])%12).toString().padStart(2,"0")),t=n.join(":")),t}},barcode:{validate(){return!0}},geopoint:{validate(t){t=t.toString().trim().split(" ");return""!==t[0]&&-90<=t[0]&&t[0]<=90&&""!==t[1]&&-360<=t[1]&&t[1]<=360&&(void 0===t[2]||!isNaN(t[2]))&&(void 0===t[3]||!isNaN(t[3])&&0<=t[3])},convert(t){return t.toString().trim()}},geotrace:{validate(t){t=t.toString().split(";");return 2<=t.length&&t.every(t=>Qe.geopoint.validate(t))},convert(t){return t.toString().trim()}},geoshape:{validate(t){t=t.toString().split(";");return 4<=t.length&&t[0]===t[t.length-1]&&t.every(t=>Qe.geopoint.validate(t))},convert(t){return t.toString().trim()}},binary:{validate(){return!0}}};var E={DataUpdate:function(t){return new CustomEvent("dataupdate",{detail:t})},FakeFocus:function(){return new CustomEvent("fakefocus",{bubbles:!0})},ApplyFocus:function(){return new CustomEvent("applyfocus")},PageFlip:function(){return new CustomEvent("pageflip",{bubbles:!0})},Removed:function(t){return new CustomEvent("removed",{detail:t,bubbles:!0})},InstanceFirstLoad:function(){return new CustomEvent("odk-instance-first-load",{bubbles:!0})},NewRepeat:function(t){return new CustomEvent("odk-new-repeat",{detail:t,bubbles:!0})},AddRepeat:function(t){return new CustomEvent("addrepeat",{detail:t,bubbles:!0})},RemoveRepeat:function(){return new CustomEvent("removerepeat",{bubbles:!0})},ChangeLanguage:function(){return new CustomEvent("changelanguage",{bubbles:!0})},Change:function(){return new Event("change",{bubbles:!0})},Input:function(){return new Event("input",{bubbles:!0})},InputUpdate:function(){return new CustomEvent("inputupdate",{bubbles:!0})},Edited:function(){return new CustomEvent("edited",{bubbles:!0})},BeforeSave:function(){return new CustomEvent("before-save",{bubbles:!0})},ValidationComplete:function(){return new CustomEvent("validation-complete",{bubbles:!0})},Invalidated:function(){return new CustomEvent("invalidated",{bubbles:!0})},ProgressUpdate:function(t){return new CustomEvent("progress-update",{detail:t,bubbles:!0})},GoToIrrelevant:function(){return new CustomEvent("goto-irrelevant",{bubbles:!0})},GoToInvisible:function(){return new CustomEvent("goto-invisible",{bubbles:!0})},XFormsValueChanged:function(t){return new CustomEvent("xforms-value-changed",{detail:t,bubbles:!0})},ChangeOption:function(){return new CustomEvent("change-option",{bubbles:!0})},Printify:function(){return new CustomEvent("printify",{bubbles:!0})},DePrintify:function(){return new CustomEvent("deprintify",{bubbles:!0})},UpdateMaxSize:function(){return new CustomEvent("update-max-size",{bubbles:!0})}};function Je(t,e,n,r){var i=r.hasInstance?"/model/instance[1]//*":"//*";this.model=r,this.originalSelector=t,this.selector="string"==typeof t&&0<t.length?t:i,this.filter=n=null!=n?n:{},this.filter.onlyLeaf=void 0!==n.onlyLeaf&&n.onlyLeaf,this.filter.noEmpty=void 0!==n.noEmpty&&n.noEmpty,this.index=e}Je.prototype.getElement=function(){return this.getElements()[0]},Je.prototype.getElements=function(){let t,e;return this._nodes||(this._nodes=this.model.evaluate(this.selector,"nodes",null,null,!0),!0===this.filter.noEmpty?this._nodes=this._nodes.filter(t=>(e=t.textContent,0===t.children.length&&0<e.trim().length)):!0===this.filter.onlyLeaf&&(this._nodes=this._nodes.filter(t=>0===t.children.length))),t=this._nodes,t=null!=this.index?void 0===t[this.index]?[]:[t[this.index]]:t},Je.prototype.setIndex=function(t){this.index=t},Je.prototype.setVal=function(t,e){let n,r;var i,o=this.getVal(),t=(n=null!=t?Array.isArray(t)?t.join(" "):t.toString():"",n=this.convert(n,e),this.getElements());return 1===t.length&&n.toString()!==o.toString()?((o=t[0]).textContent=n.toString(),(r=this.getClosestRepeat()).nodes=[o.nodeName],i=this.model.getUpdateEventData(o,e),r=i?m.extend({},r,i):r,this.model.events.dispatchEvent(E.DataUpdate(r)),"binary"===e&&(0<n.length?(o.setAttribute("type","file"),o.removeAttribute("src")):o.removeAttribute("type")),r):(1<t.length?console.error("nodeset.setVal expected nodeset with one node, but received multiple"):0===t.length&&console.warn(`Data node: ${this.selector} with null-based index: ${this.index} not found. Ignored.`),null)},Je.prototype.getVal=function(){var t=this.getElements();return t.length?t[0].textContent:void 0},Je.prototype.getClosestRepeat=function(){let t=this.getElement(),e=t.nodeName;for(;e&&"instance"!==e&&(!t.nextElementSibling||t.nextElementSibling.nodeName!==e)&&(!t.previousElementSibling||t.previousElementSibling.nodeName!==e);)t=t.parentElement,e=t?t.nodeName:null;return e&&"instance"!==e?{repeatPath:ze(t,"instance"),repeatIndex:this.model.determineIndex(t)}:{}},Je.prototype.remove=function(){var n=this.getElement();if(n){var r=n.nodeName,i=ze(n,"instance");let t=this.model.determineIndex(n);var o=this.model.getRemovalEventData(n);this.model.templates[i]||this.model.extractFakeTemplates([i]);let e=n.nextElementSibling;for(n.remove(),this._nodes=null,this.model.events.dispatchEvent(E.DataUpdate({nodes:null,repeatPath:i,repeatIndex:t}));e&&e.nodeName==r;)e=e.nextElementSibling,this.model.events.dispatchEvent(E.DataUpdate({nodes:null,repeatPath:i,repeatIndex:t++}));this.model.events.dispatchEvent(E.Removed(o))}else console.error(`could not find node ${this.selector} with index ${this.index} to remove `)},Je.prototype.convert=(t,e)=>""!==t.toString()&&null!=e&&void 0!==Qe[e.toLowerCase()]&&void 0!==Qe[e.toLowerCase()].convert?Qe[e.toLowerCase()].convert(t):t,Je.prototype.validate=function(e,t,n){let r=this,i={};return this.validateRequired(t).then(t=>!1===(i.requiredValid=t)?null:r.validateConstraintAndType(e,n)).then(t=>(i.constraintValid=t,i))},Je.prototype.validateConstraintAndType=function(e,t){let n=this,r;return t&&void 0!==Qe[t.toLowerCase()]||(t="string"),!(e||"string"!==t&&"select"!==t&&"select1"!==t&&"binary"!==t)||""===(r=n.getVal()).toString()?Promise.resolve(!0):Promise.resolve().then(()=>Qe[t.toLowerCase()].validate(r)).then(t=>!!t&&(!e||n.model.evaluate(e,"boolean",n.originalSelector,n.index)))},Je.prototype.isRequired=function(t){return!(!t||"false()"===t.trim())&&("true()"===t.trim()||this.model.evaluate(t,"boolean",this.originalSelector,this.index))},Je.prototype.validateRequired=function(t){let e=this;return!t||this.getVal()?Promise.resolve(!0):Promise.resolve().then(()=>!e.isRequired(t))};class tn extends Date{constructor(){super(NaN)}toString(){return""}}let en=t=>["Invalid Date",""].includes(t.toString())?t.toString():0<(t=new Date(t.getTime()-60*t.getTimezoneOffset()*1e3).toISOString().replace("Z",nn(t))).indexOf("T00:00:00.000")?t.split("T")[0]:t,nn=t=>{function e(t){return t<10?"0"+t:t}return"Invalid Date"===t.toString()?t.toString():((t=t.getTimezoneOffset())<0?"+":"-")+e(Math.floor(Math.abs(t/60)))+":"+e(Math.floor(Math.abs(t%60)))};function rn(t){return t.getTime()/864e5}Date.prototype.toISOLocalString=function(){return en(this)},Date.prototype.getTimezoneOffsetAsTime=function(){return nn(this)},me={BlankDate:tn,getTimezoneOffsetAsTime:nn,toISOLocalString:en};let{DATE_STRING:on,dateToDays:an,dateStringToDays:sn}=pe={DATE_STRING:/^\d\d\d\d-\d{1,2}-\d{1,2}(?:T\d\d:\d\d:\d\d\.?\d?\d?(?:Z|[+-]\d\d:\d\d)|.*)?$/,dateToDays:rn,dateStringToDays:function(t){var e=null;return rn(e=0<t.indexOf("T")?new Date(t):(e=t.split("-"),new Date(e[0],e[1]-1,e[2])))},isValidDate:function(t,e,n){return 0<=(e=parseInt(e,10)-1)&&e<12&&0<n&&n<=((t,e)=>{switch(t){case 1:return e%4==0&&e%100||e%400==0?29:28;case 8:case 3:case 5:case 10:return 30;default:return 31}})(e,t)}},ln=me.toISOLocalString,un={asBoolean:function(t){if(hn(t))return!!cn(t).trim();switch(t.t){case"arr":return!!t.v.length;case"date":return!isNaN(t.v);default:return!!t.v}},asNumber:function(t){if("num"===t.t)return t.v;if("bool"===t.t)return t.v?1:0;if("date"===t.t)return an(t.v);t=cn(t).trim();return""===t?NaN:on.test(t)?sn(t):+t},asString:cn};function cn(t){if(hn(t)){var e=t;switch(e.nodeType){case Node.DOCUMENT_NODE:return e.documentElement.textContent;case Node.TEXT_NODE:case Node.CDATA_SECTION_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.COMMENT_NODE:case Node.ELEMENT_NODE:return e.textContent;case Node.ATTRIBUTE_NODE:return e.value;default:throw new Error("TODO No handling for node type: "+e.nodeType)}}else switch(t.t){case"str":return t.v;case"arr":return t.v.length&&t.v[0].textContent||"";case"date":return ln(t.v).replace(/T00:00:00.000.*/,"");default:return t.v.toString()}}function hn(t){return t instanceof Node}var{asBoolean:dn,asNumber:pn,asString:fn}=un;let gn=0,mn=4,yn=8,vn=9,_n=12,wn=13,bn=14,Cn=15,En=16,Sn=17,Tn=20,An=21,In=22,Ln=24;function kn(t,e,n){return t.t===n&&e.t===n}function xn(t,e,n){return t.t===n||e.t===n}function Dn(t){switch(t.t){case"num":return pn;case"str":return fn;default:throw new Error("No cast for type: "+t.t)}}function Nn(e,n,r){var t,i;if(kn(e,n,"arr")){for(t=e.v.length-1;0<=t;--t)for(i=n.v.length-1;0<=i;--i)if(r(pn(e.v[t]),pn(n.v[i])))return!0;return!1}return"arr"===e.t?(n=pn(n),e.v.map(pn).some(t=>r(t,n))):"arr"===n.t?(e=pn(e),n.v.map(pn).some(t=>r(e,t))):r(pn(e),pn(n))}function Rn(e,n,r){var t,i,o;if(kn(e,n,"arr")){for(t=e.v.length-1;0<=t;--t)for(i=n.v.length-1;0<=i;--i)if(r(e.v[t].textContent,n.v[i].textContent))return!0;return!1}if(xn(e,n,"bool"))return r(dn(e),dn(n));if("arr"===e.t)return o=Dn(n),n=o(n),e.v.map(o).some(t=>r(t,n));if("arr"===n.t)return o=Dn(e),e=o(e),n.v.map(o).some(t=>r(t,e));if(xn(e,n,"num"))return r(pn(e),pn(n));if(xn(e,n,"str"))return r(fn(e),fn(n));throw new Error("not handled yet for these types: "+r.toString())}var v={boolean:t=>({t:"bool",v:t}),number:t=>({t:"num",v:t}),string:t=>({t:"str",v:t}),date:t=>({t:"date",v:t})};v.number;let{asNumber:Pn,asString:On}=un,Mn={preprocessNativeArgs:function(t,e){let n=Un[t];if(n){if(e.length<n.min)throw new Error("too few args");if(e.length>n.max)throw new Error("too many args");if(n.conv)return n.conv(...e);if(n.cast)return e.map((t,e)=>{e=n.cast[e];return{t:e,v:Bn[e](t)}})}return e}},Bn={num:Pn,str:On},Un={ceiling:{min:1,max:1,cast:["num"]},contains:{min:2,max:2,cast:["str","str"]},floor:{min:1,max:1,cast:["num"]},id:{min:1,max:1,conv:t=>[v.string("arr"===t.t?t.v.map(On).join(" "):On(t))]},lang:{min:1,max:1,cast:["str"]},"starts-with":{min:2,max:2,cast:["str","str"]},substring:{min:2,max:3,conv:function(t,e,n){return t=v.string(On(t)),e=Pn(e),void 0!==n?[t,v.number(e),v.number(Pn(n))]:[t,v.number(Math.max(0,e))]}},"substring-after":{min:2,max:2,cast:["str","str"]},"substring-before":{min:2,max:2,cast:["str","str"]},translate:{min:3,max:3,cast:["str","str","str"]}};var Fn=function(t){t.ordrd||t.v.sort(Vn)};function Vn(t,e){t=t.compareDocumentPosition(e);return t&Node.DOCUMENT_POSITION_PRECEDING?1:t&Node.DOCUMENT_POSITION_FOLLOWING?-1:0}let Hn={handleOperation:function(t,e,n){switch(e){case gn:return dn(t)||dn(n);case mn:return dn(t)&&dn(n);case yn:return Rn(t,n,(t,e)=>t===e);case vn:return Rn(t,n,(t,e)=>t!==e);case _n:return Nn(t,n,(t,e)=>t<e);case wn:return Nn(t,n,(t,e)=>t<=e);case bn:return Nn(t,n,(t,e)=>e<t);case Cn:return Nn(t,n,(t,e)=>e<=t);case En:return pn(t)+pn(n);case Sn:return pn(t)-pn(n);case Tn:return pn(t)*pn(n);case An:return pn(t)/pn(n);case In:return pn(t)%pn(n);case Ln:return[...t.v,...n.v];default:throw new Error("No handling for op "+e)}}}.handleOperation,zn=Mn.preprocessNativeArgs,jn={toSnapshotResult:function(e,n,r){n!==XPathResult.ORDERED_NODE_ITERATOR_TYPE&&n!==XPathResult.ORDERED_NODE_SNAPSHOT_TYPE||Fn(e);{var i=e.v;let t=0;return{resultType:n,singleNodeValue:r||i[0]||null,snapshotLength:i.length,snapshotItem:t=>i[t]||null,iterateNext:()=>i[t++]||null}}}}.toSnapshotResult,{asBoolean:qn,asNumber:Wn,asString:Gn}=un,$n=0,Kn=4,Xn=8,Zn=9,Yn=12,Qn=13,Jn=14,tr=15,er=16,nr=17,rr=20,ir=21,or=22,ar=24,sr=/^[a-z]/,lr=57005;var ur=function(L,t){function k(t){let e,n,r;switch(t.resultType){case XPathResult.NUMBER_TYPE:return{t:"num",v:t.numberValue};case XPathResult.BOOLEAN_TYPE:return{t:"bool",v:t.booleanValue};case XPathResult.STRING_TYPE:return{t:"str",v:t.stringValue};case XPathResult.ORDERED_NODE_ITERATOR_TYPE:r=!0;case XPathResult.UNORDERED_NODE_ITERATOR_TYPE:for(e=[];n=t.iterateNext();)e.push(n);return{t:"arr",v:e,ordrd:r};case XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:r=!0;case XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:for(e=[],n=0;n<t.snapshotLength;++n)e.push(t.snapshotItem(n));return{t:"arr",v:e,ordrd:r};case XPathResult.ANY_UNORDERED_NODE_TYPE:case XPathResult.FIRST_ORDERED_NODE_TYPE:return{t:"arr",v:[t.singleNodeValue]};default:throw new Error("no handling for result type: "+t.resultType)}}function x(t,e){if(N.toExternalResult){var n=N.toExternalResult(t,e);if(n)return n}switch(e){case null:case void 0:case XPathResult.ANY_TYPE:switch(t.t){case"num":return x(t,XPathResult.NUMBER_TYPE);case"str":return x(t,XPathResult.STRING_TYPE);case"bool":return x(t,XPathResult.BOOLEAN_TYPE);case"arr":return x(t,XPathResult.UNORDERED_NODE_ITERATOR_TYPE);default:throw new Error("unrecognised internal type: "+t.t)}case XPathResult.NUMBER_TYPE:return{resultType:e,stringValue:Gn(t),numberValue:Wn(t)};case XPathResult.STRING_TYPE:return{resultType:e,stringValue:Gn(t)};case XPathResult.BOOLEAN_TYPE:return{resultType:e,stringValue:Gn(t),booleanValue:qn(t)};case XPathResult.UNORDERED_NODE_ITERATOR_TYPE:case XPathResult.ORDERED_NODE_ITERATOR_TYPE:case XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:case XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:t.ordrd=!0;case XPathResult.ANY_UNORDERED_NODE_TYPE:case XPathResult.FIRST_ORDERED_NODE_TYPE:return jn(t,e);default:throw new Error("unrecognised return type:",e)}}let D=t.func||{},N=t.process||{},R=this.evaluate=function(t,a,s,e,n,r=1,i=1){function o(t){var e;t<=Kn&&C(t),m({t:"op",v:t}),t<=Kn&&(e=g().tokens,e=qn(e[e.length-2]),t===$n?e:!e)&&m(lr),_()}function l(){if(!y()){let n=p.v;var t=E();if(t&&"arr"===t.t){"/"!==n.charAt(0)&&v("not sure how to handle expression called on nodeset that doesn't start with a '/': "+n),n=L.createExpression("."+n,s);let e=[];t.v.forEach(t=>{t=k(n.evaluate(t));e.push(...t.v)}),t.v=e}else{t=a?.nodeType===Node.ATTRIBUTE_NODE&&n.startsWith("/")?a.ownerDocument:a;m(k(L.evaluate(n,t,s,XPathResult.ANY_TYPE,null)))}}_()}function u(){return t.charAt(d+1)}function c(){p.v=parseFloat(p.str),m(p),_()}function h(t){return"0"<=t&&t<="9"}let d,p,f=[{t:"root",tokens:[]}],g=()=>f[f.length-1],m=t=>{var e=g().tokens;E()===lr&&t===lr||e.push(t)},y=()=>{var{dead:t,t:e,tokens:n}=g();return!!t||("fn"===e?E()===lr:n.includes(lr))},v=t=>{throw new Error((t||"")+JSON.stringify({stack:f,cur:p}))},_=function(){p={v:""}},w=function(e,n){let r=e+"(";for(let t=0;t<n.length;++t){t&&(r+=",");var i=n[t];switch(i.t){case"arr":throw new Error(`callNative() can't handle nodeset functions yet for ${e}()`);case"bool":r+=i.v+"()";break;case"num":i.v===1/0?r+="( 1 div 0)":i.v===-1/0?r+="(-1 div 0)":r+=i.v.toFixed(20);break;case"str":var o=i.quote||(-1===i.v.indexOf('"')?'"':"'");if(-1!==i.v.indexOf(o))throw new Error("Quote character found in String Literal: "+JSON.stringify(i.v));r+=o+i.v+o}}return k(L.evaluate(r+")",a,s,XPathResult.ANY_TYPE,null))},b=function(e,n,r){if(n>Kn&&(e===lr||r===lr))return lr;if(N.handleInfix){let t=N.handleInfix(v,e,n,r);if(t&&"continue"===t.t&&(e=t.lhs,n=t.op,r=t.rhs,t=null),null!=t)return t}return Hn(e,n,r)},C=function(t){var e,n,r=g().tokens;if(!(r.length<2)){r[2]===lr&&r[1].v>=t&&(e=r.indexOf(",",2),r.splice(0,-1===e?r.length:e,{t:"bool",v:qn(r[0])}));for(let e=ar;e>=t;e-=4){let t=1;for(;t<r.length-1;)"op"===r[t].t&&r[t].v>=e?(n=b(r[t-1],r[t].v,r[t+1]),r.splice(t,2),r[t-1]={t:(t=>{if(N.typefor){var e=N.typefor(t);if(e)return e}return"boolean"==typeof t?"bool":"number"==typeof t?"num":"str"})(n),v:n}):++t}}},E=function(){var t=g().tokens;return t[t.length-1]};for(_(),d=0;d<t.length;++d){var S=t.charAt(d);if("sq"===p.t){if(p.inString)p.inString===S&&delete p.inString;else if("["===S)++p.depth;else if("'"===S||'"'===S)p.inString=S;else if("]"===S){if(--p.depth)p.v+=S;else{if(y()){_();continue}let n;var T=E();if("arr"!==T.t)throw new Error("Not sure how to handle context node for predicate in this situation.");n=T.v;let r=p.v;var A=n.filter((t,e)=>{t=k(R(r,t,s,XPathResult.ANY_TYPE,null,n.length,e+1));return"num"===t.t?Wn(t)===1+e:qn(t)});T.v=A,_()}continue}p.v+=S}else if("str"===p.t)S===p.quote?(m(p),_()):p.v+=S;else{if("num"===p.t){if(h(S)||"e"===S||"-"===S&&"e"===t[d-1]){p.str+=S;continue}if(" "===S&&"-"===p.str)continue;"."!==S||p.decimal?c():(p.decimal=1,p.str+=S)}if(h(S))""===p.v?p={t:"num",str:S}:p.v+=S;else switch(S){case"'":case'"':""===p.v?p={t:"str",quote:S,v:""}:v("Not sure how to handle: "+S);break;case"(":f.push({v:p.v,t:"fn",dead:y(),tokens:[]}),_();break;case")":""!==p.v&&l(),C($n),"fn"!==(p=f.pop()).t&&v('")" outside function!'),p.dead?m(lr):p.v?"/"===p.v.charAt(0)?(p.tokens.length&&v("Unexpected args for node test function!"),p.v+="()",l()):m(((t,e)=>{var n=[];for(let t=0;t<e.length;++t)if(t%2){if(","!==e[t])throw new Error("Weird args (should be separated by commas):"+JSON.stringify(e))}else n.push(e[t]);return Object.prototype.hasOwnProperty.call(D,t)?D[t].apply({cN:a,contextSize:r,contextPosition:i},n):w(t,zn(t,n))})(p.v,p.tokens)):(1!==p.tokens.length&&v("Expected one token, but found: "+p.tokens.length),m(p.tokens[0])),_();break;case",":"fn"!==g().t&&v("Unexpected comma outside function arguments."),p.v&&l(),m(",");break;case"*":var I=E();!I||","===I||"op"===I.t||p.v?p.v+=S:o(rr);break;case"-":I=E();""!==p.v&&" "!==u()&&" "!==t.charAt(d-1)?p.v+=S:""!==p.v||I&&"op"!==I.t&&","!==I?o(nr):p={t:"num",str:"-"};break;case"=":switch(p.v){case"<":o(Qn);break;case">":o(tr);break;case"!":o(Zn);break;default:p.v&&l(),o(Xn)}break;case"!":p.v&&l(),p.v=S;break;case">":case"<":p.v&&l(),"="===u()?p.v=S:o(">"===S?Jn:Yn);break;case"+":p.v&&l(),o(er);break;case"|":p.v&&l(),o(ar);break;case"\n":case"\r":case"\t":case" ":""===p.v||sr.test(p.v)||l();break;case"v":"di"===p.v?o(ir):p.v+=S;break;case"r":"o"===p.v?o($n):p.v+=S;break;case"d":"an"===p.v?o(Kn):"mo"===p.v?o(or):p.v+=S;break;case"[":p.v&&(l(),_()),p.t="sq",p.depth=1;break;case".":if(""===p.v&&h(u())){p={t:"num",str:S};break}default:p.v+=S}}}return"num"===p.t&&c(),p.v&&l(),1!==f.length&&v("Stuff left on stack."),"root"!==f[0].t&&v("Weird stuff on stack."),0===f[0].tokens.length&&v("No tokens."),C($n),1!==f[0].tokens.length&&v("Too many tokens."),x(f[0].tokens[0],e)}},cr=6378100,hr=un.asString;function dr(t){return t.map(function(t){return t.trim().split(" ")})}function pr(t){return t*Math.PI/180}function fr(t){return t.every(function(t){return""!==t[0]&&-90<=t[0]&&t[0]<=90&&""!==t[1]&&-180<=t[1]&&t[1]<=180&&(void 0===t[2]||!isNaN(t[2]))&&(void 0===t[3]||!isNaN(t[3])&&0<=t[3])})}var D={options:{usePureJavaScript:!(u={asGeopoints:function(t){if("arr"===t.t&&1<t.v.length)return t.v.map(hr);return hr(t).split(";")},area:function(t){var e=dr(t);if(!fr(e))return Number.NaN;var n=e.length,r=0;if(2<n){for(var i=0;i<n;i++){var o={lat:e[i][0],lng:e[i][1]},a={lat:e[(i+1)%n][0],lng:e[(i+1)%n][1]};r+=pr(a.lng-o.lng)*(2+Math.sin(pr(o.lat))+Math.sin(pr(a.lat)))}r=r*cr*cr/2}return Math.abs(Math.round(100*r))/100},distance:function(t){var e=dr(t);if(!fr(e))return Number.NaN;var n,r=e.length,i=0;if(1<r)for(var o=1;o<r;o++){var a={lat:e[o-1][0],lng:e[o-1][1]},s={lat:e[o][0],lng:e[o][1]};i+=(n=void 0,n=pr((a=a).lng-(s=s).lng),a=pr(a.lat),s=pr(s.lat),Math.acos(Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos(n))*cr)}return Math.abs(Math.round(100*i))/100}})}};D.options;var gr=t={},mr={};function yr(t,e){D.cipher.registerAlgorithm(t,function(){return new D.aes.Algorithm(t,e)})}t.encode=function(t,e,n){if("string"!=typeof e)throw new TypeError('"alphabet" must be a string.');if(void 0!==n&&"number"!=typeof n)throw new TypeError('"maxline" must be a number.');var r="";if(t instanceof Uint8Array){for(var i=0,o=e.length,a=e.charAt(0),s=[0],i=0;i<t.length;++i){for(var l=0,u=t[i];l<s.length;++l)s[l]=(u+=s[l]<<8)%o,u=u/o|0;for(;0<u;)s.push(u%o),u=u/o|0}for(i=0;0===t[i]&&i<t.length-1;++i)r+=a;for(i=s.length-1;0<=i;--i)r+=e[s[i]]}else r=((t,e)=>{var n=0,r=e.length,i=e.charAt(0),o=[0];for(n=0;n<t.length();++n){for(var a=0,s=t.at(n);a<o.length;++a)o[a]=(s+=o[a]<<8)%r,s=s/r|0;for(;0<s;)o.push(s%r),s=s/r|0}var l="";for(n=0;0===t.at(n)&&n<t.length()-1;++n)l+=i;for(n=o.length-1;0<=n;--n)l+=e[o[n]];return l})(t,e);return n&&(n=new RegExp(".{1,"+n+"}","g"),r=r.match(n).join("\r\n")),r},t.decode=function(t,e){if("string"!=typeof t)throw new TypeError('"input" must be a string.');if("string"!=typeof e)throw new TypeError('"alphabet" must be a string.');if(!(n=mr[e]))for(var n=mr[e]=[],r=0;r<e.length;++r)n[e.charCodeAt(r)]=r;t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),a=[0],r=0;r<t.length;r++){var s=n[t.charCodeAt(r)];if(void 0===s)return;for(var l=0,u=s;l<a.length;++l)a[l]=255&(u+=a[l]*i),u>>=8;for(;0<u;)a.push(255&u),u>>=8}for(var c=0;t[c]===o&&c<t.length-1;++c)a.push(0);return"undefined"!=typeof Buffer?Buffer.from(a.reverse()):new Uint8Array(a.reverse())},F(function(t){var e,n,r,i,o,a,u=t.exports=D.util=D.util||{};function s(t){if(8!==t&&16!==t&&24!==t&&32!==t)throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}function l(t){if(this.data="",this.read=0,"string"==typeof t)this.data=t;else if(u.isArrayBuffer(t)||u.isArrayBufferView(t))if("undefined"!=typeof Buffer&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(t){for(var n=0;n<e.length;++n)this.putByte(e[n])}}else(t instanceof l||"object"==typeof t&&"string"==typeof t.data&&"number"==typeof t.read)&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}"undefined"!=typeof process&&process.nextTick&&!process.browser?(u.nextTick=process.nextTick,"function"==typeof setImmediate?u.setImmediate=setImmediate:u.setImmediate=u.nextTick):"function"==typeof setImmediate?(u.setImmediate=function(){return setImmediate.apply(void 0,arguments)},u.nextTick=function(t){return setImmediate(t)}):(u.setImmediate=function(t){setTimeout(t,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage&&(e="forge.setImmediate",o=[],u.setImmediate=function(t){o.push(t),1===o.length&&window.postMessage(e,"*")},window.addEventListener("message",function(t){t.source===window&&t.data===e&&(t.stopPropagation(),t=o.slice(),o.length=0,t.forEach(function(t){t()}))},!0)),"undefined"!=typeof MutationObserver&&(n=Date.now(),r=!0,i=document.createElement("div"),o=[],new MutationObserver(function(){var t=o.slice();o.length=0,t.forEach(function(t){t()})}).observe(i,{attributes:!0}),a=u.setImmediate,u.setImmediate=function(t){15<Date.now()-n?(n=Date.now(),a(t)):(o.push(t),1===o.length&&i.setAttribute("a",r=!r))}),u.nextTick=u.setImmediate),u.isNodejs="undefined"!=typeof process&&process.versions&&process.versions.node,u.globalScope=u.isNodejs?B:"undefined"==typeof self?window:self,u.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},u.isArrayBuffer=function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer},u.isArrayBufferView=function(t){return t&&u.isArrayBuffer(t.buffer)&&void 0!==t.byteLength},u.ByteBuffer=l,u.ByteStringBuffer=l;u.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,4096<this._constructedStringLength&&(this.data.substr(0,1),this._constructedStringLength=0)},u.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},u.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},u.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))},u.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var n=this.data;0<e;)1&e&&(n+=t),0<(e>>>=1)&&(t+=t);return this.data=n,this._optimizeConstructedString(e),this},u.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this},u.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(u.encodeUtf8(t))},u.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},u.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},u.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},u.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255))},u.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))},u.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))},u.ByteStringBuffer.prototype.putInt=function(t,e){s(e);for(var n="";e-=8,n+=String.fromCharCode(t>>e&255),0<e;);return this.putBytes(n)},u.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)},u.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())},u.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},u.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t},u.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t},u.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t},u.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t},u.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t},u.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t},u.ByteStringBuffer.prototype.getInt=function(t){s(t);for(var e=0;e=(e<<8)+this.data.charCodeAt(this.read++),0<(t-=8););return e},u.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),t=2<<t-2;return t<=e&&(e-=t<<1),e},u.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},u.ByteStringBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},u.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)},u.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this},u.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},u.ByteStringBuffer.prototype.copy=function(){var t=u.createBuffer(this.data);return t.read=this.read,t},u.ByteStringBuffer.prototype.compact=function(){return 0<this.read&&(this.data=this.data.slice(this.read),this.read=0),this},u.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},u.ByteStringBuffer.prototype.truncate=function(t){t=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,t),this.read=0,this},u.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var n=this.data.charCodeAt(e);n<16&&(t+="0"),t+=n.toString(16)}return t},u.ByteStringBuffer.prototype.toString=function(){return u.decodeUtf8(this.bytes())},u.DataBuffer=function(t,e){this.read=(e=e||{}).readOffset||0,this.growSize=e.growSize||1024;var n=u.isArrayBuffer(t),r=u.isArrayBufferView(t);n||r?(this.data=n?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=t&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset))},u.DataBuffer.prototype.length=function(){return this.write-this.read},u.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},u.DataBuffer.prototype.accommodate=function(t,e){return this.length()>=t||(e=Math.max(e||this.growSize,t),t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),(e=new Uint8Array(this.length()+e)).set(t),this.data=new DataView(e.buffer)),this},u.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this},u.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var n=0;n<e;++n)this.data.setUint8(t);return this},u.DataBuffer.prototype.putBytes=function(t,e){var n,r,i;if(u.isArrayBufferView(t))return n=(r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)).byteLength-r.byteOffset,this.accommodate(n),new Uint8Array(this.data.buffer,this.write).set(r),this.write+=n,this;if(u.isArrayBuffer(t))return r=new Uint8Array(t),this.accommodate(r.byteLength),new Uint8Array(this.data.buffer).set(r,this.write),this.write+=r.byteLength,this;if(t instanceof u.DataBuffer||"object"==typeof t&&"number"==typeof t.read&&"number"==typeof t.write&&u.isArrayBufferView(t.data))return r=new Uint8Array(t.data.byteLength,t.read,t.length()),this.accommodate(r.byteLength),new Uint8Array(t.data.byteLength,this.write).set(r),this.write+=r.byteLength,this;if(t instanceof u.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary","string"!=typeof t)throw Error("Invalid parameter: "+t);if("hex"===e)return this.accommodate(Math.ceil(t.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.hex.decode(t,i,this.write),this;if("base64"===e)return this.accommodate(3*Math.ceil(t.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.base64.decode(t,i,this.write),this;if("utf8"===e&&(t=u.encodeUtf8(t),e="binary"),"binary"===e||"raw"===e)return this.accommodate(t.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.raw.decode(i),this;if("utf16"===e)return this.accommodate(2*t.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=u.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+e)},u.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this},u.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")},u.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this},u.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this},u.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this},u.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this},u.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this},u.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this},u.DataBuffer.prototype.putInt=function(t,e){for(s(e),this.accommodate(e/8);e-=8,this.data.setInt8(this.write++,t>>e&255),0<e;);return this},u.DataBuffer.prototype.putSignedInt=function(t,e){return s(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)},u.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},u.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t},u.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t},u.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t},u.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t},u.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t},u.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t},u.DataBuffer.prototype.getInt=function(t){s(t);for(var e=0;e=(e<<8)+this.data.getInt8(this.read++),0<(t-=8););return e},u.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),t=2<<t-2;return t<=e&&(e-=t<<1),e},u.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},u.DataBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},u.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)},u.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this},u.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},u.DataBuffer.prototype.copy=function(){return new u.DataBuffer(this)},u.DataBuffer.prototype.compact=function(){var t,e;return 0<this.read&&(t=new Uint8Array(this.data.buffer,this.read),(e=new Uint8Array(t.byteLength)).set(t),this.data=new DataView(e),this.write-=this.read,this.read=0),this},u.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},u.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this},u.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var n=this.data.getUint8(e);n<16&&(t+="0"),t+=n.toString(16)}return t},u.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if("binary"===(t=t||"utf8")||"raw"===t)return u.binary.raw.encode(e);if("hex"===t)return u.binary.hex.encode(e);if("base64"===t)return u.binary.base64.encode(e);if("utf8"===t)return u.text.utf8.decode(e);if("utf16"===t)return u.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)},u.createBuffer=function(t,e){return e=e||"raw",void 0!==t&&"utf8"===e&&(t=u.encodeUtf8(t)),new u.ByteBuffer(t)},u.fillString=function(t,e){for(var n="";0<e;)1&e&&(n+=t),0<(e>>>=1)&&(t+=t);return n},u.xorBytes=function(t,e,n){for(var r,i="",o="",a=0,s=0;0<n;--n,++a)r=t.charCodeAt(a)^e.charCodeAt(a),10<=s&&(i+=o,o="",s=0),o+=String.fromCharCode(r),++s;return i+=o},u.hexToBytes=function(t){var e="",n=0;for(!0&t.length&&(n=1,e+=String.fromCharCode(parseInt(t[0],16)));n<t.length;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e},u.bytesToHex=function(t){return u.createBuffer(t).toHex()},u.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)};function c(t,e,n){if(!t)throw new Error("WebStorage not available.");if(void 0!==(t=null===n?t.removeItem(e):(n=u.encode64(JSON.stringify(n)),t.setItem(e,n)))&&!0!==t.rval)throw(e=new Error(t.error.message)).id=t.error.id,e.name=t.error.name,e}function h(t,e){if(!t)throw new Error("WebStorage not available.");if(e=t.getItem(e),t.init)if(null===e.rval){if(e.error)throw(t=new Error(e.error.message)).id=e.error.id,t.name=e.error.name,t;e=null}else e=e.rval;return e=null!==e?JSON.parse(u.decode64(e)):e}function d(t,e,n,r){var i=h(t,e);(i=null===i?{}:i)[n]=r,c(t,e,i)}function p(t,e,n){return t=null!==(t=h(t,e))?n in t?t[n]:null:t}function f(t,e,n){var r=h(t,e);if(null!==r&&n in r){delete r[n];var i,o=!0;for(i in r){o=!1;break}c(t,e,r=o?null:r)}}function g(t,e){c(t,e,null)}function m(t,e,n){var r,i,o=null,a=!1,s=null;for(i in n=void 0===n?["web","flash"]:n){r=n[i];try{if("flash"===r||"both"===r){if(null===e[0])throw new Error("Flash local storage not available.");o=t.apply(this,e),a="flash"===r}"web"!==r&&"both"!==r||(e[0]=localStorage,o=t.apply(this,e),a=!0)}catch(t){s=t}if(a)break}if(a)return o;throw s}var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",w=(u.encode64=function(t,e){for(var n,r,i,o="",a="",s=0;s<t.length;)n=t.charCodeAt(s++),r=t.charCodeAt(s++),i=t.charCodeAt(s++),o=(o+=y.charAt(n>>2))+y.charAt((3&n)<<4|r>>4),isNaN(r)?o+="==":o=(o+=y.charAt((15&r)<<2|i>>6))+(isNaN(i)?"=":y.charAt(63&i)),e&&o.length>e&&(a+=o.substr(0,e)+"\r\n",o=o.substr(e));return a+=o},u.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e,n,r,i,o="",a=0;a<t.length;)e=v[t.charCodeAt(a++)-43],n=v[t.charCodeAt(a++)-43],r=v[t.charCodeAt(a++)-43],i=v[t.charCodeAt(a++)-43],o+=String.fromCharCode(e<<2|n>>4),64!==r&&(o+=String.fromCharCode((15&n)<<4|r>>2),64!==i)&&(o+=String.fromCharCode((3&r)<<6|i));return o},u.encodeUtf8=function(t){return unescape(encodeURIComponent(t))},u.decodeUtf8=function(t){return decodeURIComponent(escape(t))},u.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:gr.encode,decode:gr.decode}},u.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)},u.binary.raw.decode=function(t,e,n){for(var r=(r=e)||new Uint8Array(t.length),i=n=n||0,o=0;o<t.length;++o)r[i++]=t.charCodeAt(o);return e?i-n:r},u.binary.hex.encode=u.bytesToHex,u.binary.hex.decode=function(t,e,n){var r=(r=e)||new Uint8Array(Math.ceil(t.length/2)),i=0,o=n=n||0;for(1&t.length&&(i=1,r[o++]=parseInt(t[0],16));i<t.length;i+=2)r[o++]=parseInt(t.substr(i,2),16);return e?o-n:r},u.binary.base64.encode=function(t,e){for(var n,r,i,o="",a="",s=0;s<t.byteLength;)n=t[s++],r=t[s++],i=t[s++],o=(o+=y.charAt(n>>2))+y.charAt((3&n)<<4|r>>4),isNaN(r)?o+="==":o=(o+=y.charAt((15&r)<<2|i>>6))+(isNaN(i)?"=":y.charAt(63&i)),e&&o.length>e&&(a+=o.substr(0,e)+"\r\n",o=o.substr(e));return a+=o},u.binary.base64.decode=function(t,e,n){var r,i,o,a,s=(s=e)||new Uint8Array(3*Math.ceil(t.length/4));t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var l=0,u=n=n||0;l<t.length;)r=v[t.charCodeAt(l++)-43],i=v[t.charCodeAt(l++)-43],o=v[t.charCodeAt(l++)-43],a=v[t.charCodeAt(l++)-43],s[u++]=r<<2|i>>4,64!==o&&(s[u++]=(15&i)<<4|o>>2,64!==a)&&(s[u++]=(3&o)<<6|a);return e?u-n:s.subarray(0,u)},u.binary.base58.encode=function(t,e){return u.binary.baseN.encode(t,_,e)},u.binary.base58.decode=function(t,e){return u.binary.baseN.decode(t,_,e)},u.text={utf8:{},utf16:{}},u.text.utf8.encode=function(t,e,n){t=u.encodeUtf8(t);for(var r=(r=e)||new Uint8Array(t.length),i=n=n||0,o=0;o<t.length;++o)r[i++]=t.charCodeAt(o);return e?i-n:r},u.text.utf8.decode=function(t){return u.decodeUtf8(String.fromCharCode.apply(null,t))},u.text.utf16.encode=function(t,e,n){for(var r=(r=e)||new Uint8Array(2*t.length),i=new Uint16Array(r.buffer),o=n=n||0,a=n,s=0;s<t.length;++s)i[a++]=t.charCodeAt(s),o+=2;return e?o-n:r},u.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))},u.deflate=function(t,e,n){return e=u.decode64(t.deflate(u.encode64(e)).rval),n&&(t=2,n=e.charCodeAt(1),e=e.substring(t=32&n?6:t,e.length-4)),e},u.inflate=function(t,e,n){t=t.inflate(u.encode64(e)).rval;return null===t?null:u.decode64(t)},u.setItem=function(t,e,n,r,i){m(d,arguments,i)},u.getItem=function(t,e,n,r){return m(p,arguments,r)},u.removeItem=function(t,e,n,r){m(f,arguments,r)},u.clearItems=function(t,e,n){m(g,arguments,n)},u.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g,e=(e.lastIndex=0,e.exec(t)),t=null===e?null:{full:t,scheme:e[1],host:e[2],port:e[3],path:e[4]};return t&&(t.fullHost=t.host,t.port?(80!==t.port&&"http"===t.scheme||443!==t.port&&"https"===t.scheme)&&(t.fullHost+=":"+t.port):"http"===t.scheme?t.port=80:"https"===t.scheme&&(t.port=443),t.full=t.scheme+"://"+t.fullHost),t},null);u.getQueryVariables=function(t){function e(t){for(var e={},n=t.split("&"),r=0;r<n.length;r++){var i,o=n[r].indexOf("="),o=0<o?(i=n[r].substring(0,o),n[r].substring(o+1)):(i=n[r],null);i in e||(e[i]=[]),i in Object.prototype||null===o||e[i].push(unescape(o))}return e}t=void 0===t?w=null===w?"undefined"!=typeof window&&window.location&&window.location.search?e(window.location.search.substring(1)):{}:w:e(t);return t},u.parseFragment=function(t){var e=t,n="",r=t.indexOf("?"),t=(0<r&&(e=t.substring(0,r),n=t.substring(r+1)),e.split("/")),r=(0<t.length&&""===t[0]&&t.shift(),""===n?{}:u.getQueryVariables(n));return{pathString:e,queryString:n,path:t,query:r}},u.makeRequest=function(t){var r=u.parseFragment(t),n={path:r.pathString,query:r.queryString,getPath:function(t){return void 0===t?r.path:r.path[t]},getQuery:function(t,e){var n;return void 0===t?n=r.query:(n=r.query[t])&&void 0!==e&&(n=n[e]),n},getQueryLast:function(t,e){t=n.getQuery(t),t=t?t[t.length-1]:e;return t}};return n},u.makeLink=function(t,e,n){t=jQuery.isArray(t)?t.join("/"):t;e=jQuery.param(e||{});return t+(0<e.length?"?"+e:"")+(0<(n=n||"").length?"#"+n:"")},u.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},u.format=function(t){for(var e,n,r=/%./g,i=0,o=[],a=0;e=r.exec(t);){0<(n=t.substring(a,r.lastIndex-2)).length&&o.push(n);var a=r.lastIndex,s=e[0][1];switch(s){case"s":case"o":o.push(i<arguments.length?arguments[1+i++]:"<?>");break;case"%":o.push("%");break;default:o.push("<%"+s+"?>")}}return o.push(t.substring(a)),o.join("")},u.formatNumber=function(t,e,n,r){var e=isNaN(e=Math.abs(e))?2:e,n=void 0===n?",":n,r=void 0===r?".":r,i=t<0?"-":"",o=parseInt(t=Math.abs(+t||0).toFixed(e),10)+"",a=3<o.length?o.length%3:0;return i+(a?o.substr(0,a)+r:"")+o.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+r)+(e?n+Math.abs(t-o).toFixed(e).slice(2):"")},u.formatSize=function(t){return t=1073741824<=t?u.formatNumber(t/1073741824,2,".","")+" GiB":1048576<=t?u.formatNumber(t/1048576,2,".","")+" MiB":1024<=t?u.formatNumber(t/1024,0)+" KiB":u.formatNumber(t,0)+" bytes"},u.bytesFromIP=function(t){return-1!==t.indexOf(".")?u.bytesFromIPv4(t):-1!==t.indexOf(":")?u.bytesFromIPv6(t):null},u.bytesFromIPv4=function(t){if(4!==(t=t.split(".")).length)return null;for(var e=u.createBuffer(),n=0;n<t.length;++n){var r=parseInt(t[n],10);if(isNaN(r))return null;e.putByte(r)}return e.getBytes()},u.bytesFromIPv6=function(t){for(var e,n=0,r=2*(8-(t=t.split(":").filter(function(t){return 0===t.length&&++n,!0})).length+n),i=u.createBuffer(),o=0;o<8;++o)t[o]&&0!==t[o].length?((e=u.hexToBytes(t[o])).length<2&&i.putByte(0),i.putBytes(e)):(i.fillWithByte(0,r),r=0);return i.getBytes()},u.bytesToIP=function(t){return 4===t.length?u.bytesToIPv4(t):16===t.length?u.bytesToIPv6(t):null},u.bytesToIPv4=function(t){if(4!==t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e.join(".")},u.bytesToIPv6=function(t){if(16!==t.length)return null;for(var e,n=[],r=[],i=0,o=0;o<t.length;o+=2){for(var a,s,l=u.bytesToHex(t[o]+t[o+1]);"0"===l[0]&&"0"!==l;)l=l.substr(1);"0"===l&&(a=r[r.length-1],s=n.length,a&&s===a.end+1?(a.end=s,a.end-a.start>r[i].end-r[i].start&&(i=r.length-1)):r.push({start:s,end:s})),n.push(l)}return 0<r.length&&0<(e=r[i]).end-e.start&&(n.splice(e.start,e.end-e.start+1,""),0===e.start&&n.unshift(""),7===e.end)&&n.push(""),n.join(":")},u.estimateCores=function(t,e){var a;return"function"==typeof t&&(e=t,t={}),t=t||{},"cores"in u&&!t.update?e(null,u.cores):"undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&0<navigator.hardwareConcurrency?(u.cores=navigator.hardwareConcurrency,e(null,u.cores)):"undefined"==typeof Worker?(u.cores=1,e(null,u.cores)):"undefined"==typeof Blob?(u.cores=2,e(null,u.cores)):(a=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(t){var e=Date.now();self.postMessage({st:e,et:e+4})})}.toString(),")()"],{type:"application/javascript"})),void function n(r,i,o){{var t;if(0===i)return t=Math.floor(r.reduce(function(t,e){return t+e},0)/r.length),u.cores=Math.max(1,t),URL.revokeObjectURL(a),e(null,u.cores)}s(o,function(t,e){r.push(l(o,e)),n(r,i-1,o)})}([],5,16));function s(n,r){for(var i=[],o=[],t=0;t<n;++t){var e=new Worker(a);e.addEventListener("message",function(t){if(o.push(t.data),o.length===n){for(var e=0;e<n;++e)i[e].terminate();r(null,o)}}),i.push(e)}for(t=0;t<n;++t)i[t].postMessage(t)}function l(t,e){for(var n=[],r=0;r<t;++r)for(var i,o=e[r],a=n[r]=[],s=0;s<t;++s)r!==s&&(i=e[s],o.st>i.st&&o.st<i.et||i.st>o.st&&i.st<o.et)&&a.push(s);return n.reduce(function(t,e){return Math.max(t,e.length)},0)}}}),D.cipher=D.cipher||{},D.cipher.algorithms=D.cipher.algorithms||{},D.cipher.createCipher=function(t,e){var n=t;if(n="string"==typeof n?(n=D.cipher.getAlgorithm(n))&&n():n)return new D.cipher.BlockCipher({algorithm:n,key:e,decrypt:!1});throw new Error("Unsupported algorithm: "+t)},D.cipher.createDecipher=function(t,e){var n=t;if(n="string"==typeof n?(n=D.cipher.getAlgorithm(n))&&n():n)return new D.cipher.BlockCipher({algorithm:n,key:e,decrypt:!0});throw new Error("Unsupported algorithm: "+t)},D.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),D.cipher.algorithms[t]=e},D.cipher.getAlgorithm=function(t){return(t=t.toUpperCase())in D.cipher.algorithms?D.cipher.algorithms[t]:null},(t=D.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)}).prototype.start=function(t){var e,n={};for(e in t=t||{})n[e]=t[e];n.decrypt=this._decrypt,this._finish=!1,this._input=D.util.createBuffer(),this.output=t.output||D.util.createBuffer(),this.mode.start(n)},t.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},t.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))},F(function(t){D.cipher=D.cipher||{};t=t.exports=D.cipher.modes=D.cipher.modes||{};function e(t,e){if("string"==typeof t&&(t=D.util.createBuffer(t)),D.util.isArray(t)&&4<t.length){var n=t;t=D.util.createBuffer();for(var r=0;r<n.length;++r)t.putByte(n[r])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!D.util.isArray(t)){for(var i=[],o=e/4,r=0;r<o;++r)i.push(t.getInt32());t=i}return t}function s(t){t[t.length-1]=t[t.length-1]+1&4294967295}function o(t){return[t/4294967296|0,4294967295&t]}t.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},t.ecb.prototype.start=function(t){},t.ecb.prototype.encrypt=function(t,e,n){if(t.length()<this.blockSize&&!(n&&0<t.length()))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)e.putInt32(this._outBlock[r])},t.ecb.prototype.decrypt=function(t,e,n){if(t.length()<this.blockSize&&!(n&&0<t.length()))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)e.putInt32(this._outBlock[r])},t.ecb.prototype.pad=function(t,e){var n=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(n,n),!0},t.ecb.prototype.unpad=function(t,e){return!(0<e.overflow||(e=t.length(),(e=t.at(e-1))>this.blockSize<<2)||(t.truncate(e),0))},t.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},t.cbc.prototype.start=function(t){if(null===t.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=e(t.iv,this.blockSize),this._prev=this._iv.slice(0)}},t.cbc.prototype.encrypt=function(t,e,n){if(t.length()<this.blockSize&&!(n&&0<t.length()))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)e.putInt32(this._outBlock[r]);this._prev=this._outBlock},t.cbc.prototype.decrypt=function(t,e,n){if(t.length()<this.blockSize&&!(n&&0<t.length()))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)e.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)},t.cbc.prototype.pad=function(t,e){var n=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(n,n),!0},t.cbc.prototype.unpad=function(t,e){return!(0<e.overflow||(e=t.length(),(e=t.at(e-1))>this.blockSize<<2)||(t.truncate(e),0))},t.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=D.util.createBuffer(),this._partialBytes=0},t.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=e(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.cfb.prototype.encrypt=function(t,e,n){var r=t.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(0<o)t.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!n)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},t.cfb.prototype.decrypt=function(t,e,n){var r=t.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(0<o)t.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!n)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},t.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=D.util.createBuffer(),this._partialBytes=0},t.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=e(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.ofb.prototype.encrypt=function(t,e,n){var r=t.length();if(0===t.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(0<o)t.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!n)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},t.ofb.prototype.decrypt=t.ofb.prototype.encrypt,t.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=D.util.createBuffer(),this._partialBytes=0},t.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=e(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.ctr.prototype.encrypt=function(t,e,n){var r=t.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(0<o&&(t.read-=this.blockSize),0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!n)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},t.ctr.prototype.decrypt=t.ctr.prototype.encrypt,t.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=D.util.createBuffer(),this._partialBytes=0,this._R=3774873600},t.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e,n=D.util.createBuffer(t.iv);if(this._cipherLength=0,e="additionalData"in t?D.util.createBuffer(t.additionalData):D.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=D.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);t=n.length();if(12===t)this._j0=[n.getInt32(),n.getInt32(),n.getInt32(),1];else{for(this._j0=[0,0,0,0];0<n.length();)this._j0=this.ghash(this._hashSubkey,this._j0,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(o(8*t)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,e=D.util.createBuffer(e),this._aDataLength=o(8*e.length());t=e.length()%this.blockSize;for(t&&e.fillWithByte(0,this.blockSize-t),this._s=[0,0,0,0];0<e.length();)this._s=this.ghash(this._hashSubkey,this._s,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()])},t.gcm.prototype.encrypt=function(t,e,n){var r=t.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(var a,i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||n){n?(a=r%this.blockSize,this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)):this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!n)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},t.gcm.prototype.decrypt=function(t,e,n){var r=t.length();if(r<this.blockSize&&!(n&&0<r))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize},t.gcm.prototype.afterFinish=function(t,e){var n=!0,t=(e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=D.util.createBuffer(),this._aDataLength.concat(o(8*this._cipherLength))),r=(this._s=this.ghash(this._hashSubkey,this._s,t),[]);this.cipher.encrypt(this._j0,r);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^r[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),n=e.decrypt&&this.tag.bytes()!==this._tag?!1:n},t.gcm.prototype.multiply=function(t,e){for(var n=[0,0,0,0],r=e.slice(0),i=0;i<128;++i)t[i/32|0]&1<<31-i%32&&(n[0]^=r[0],n[1]^=r[1],n[2]^=r[2],n[3]^=r[3]),this.pow(r,r);return n},t.gcm.prototype.pow=function(t,e){for(var n=1&t[3],r=3;0<r;--r)e[r]=t[r]>>>1|(1&t[r-1])<<31;e[0]=t[0]>>>1,n&&(e[0]^=this._R)},t.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],n=0;n<32;++n){var r=t[n/8|0]>>>4*(7-n%8)&15,r=this._m[n][r];e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3]}return e},t.gcm.prototype.ghash=function(t,e,n){return e[0]^=n[0],e[1]^=n[1],e[2]^=n[2],e[3]^=n[3],this.tableMultiply(e)},t.gcm.prototype.generateHashTable=function(t,e){for(var n=8/e,r=4*n,i=16*n,o=new Array(i),a=0;a<i;++a){var s=[0,0,0,0];s[a/r|0]=1<<e-1<<(r-1-a%r)*e,o[a]=this.generateSubHashTable(this.multiply(s,t),e)}return o},t.gcm.prototype.generateSubHashTable=function(t,e){for(var n=1<<e,r=n>>>1,i=new Array(n),o=(i[r]=t.slice(0),r>>>1);0<o;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<r;){for(var a=1;a<o;++a){var s=i[o],l=i[a];i[o+a]=[s[0]^l[0],s[1]^l[1],s[2]^l[2],s[3]^l[3]]}o*=2}for(i[0]=[0,0,0,0],o=1+r;o<n;++o){var u=i[o^r];i[o]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i}}),D.aes=D.aes||{},D.aes.startEncrypting=function(t,e,n,r){t=Lr({key:t,output:n,decrypt:!1,mode:r});return t.start(e),t},D.aes.createEncryptionCipher=function(t,e){return Lr({key:t,output:null,decrypt:!1,mode:e})},D.aes.startDecrypting=function(t,e,n,r){t=Lr({key:t,output:n,decrypt:!0,mode:r});return t.start(e),t},D.aes.createDecryptionCipher=function(t,e){return Lr({key:t,output:null,decrypt:!0,mode:e})},D.aes.Algorithm=function(t,e){Er||Tr();var n=this;n.name=t,n.mode=new e({blockSize:16,cipher:{encrypt:function(t,e){return Ir(n._w,t,e,!1)},decrypt:function(t,e){return Ir(n._w,t,e,!0)}}}),n._init=!1},D.aes.Algorithm.prototype.initialize=function(t){if(!this._init){if("string"!=typeof(n=t.key)||16!==n.length&&24!==n.length&&32!==n.length){if(D.util.isArray(n)&&(16===n.length||24===n.length||32===n.length))for(var e=n,n=D.util.createBuffer(),r=0;r<e.length;++r)n.putByte(e[r])}else n=D.util.createBuffer(n);if(!D.util.isArray(n)){e=n,n=[];var i=e.length();if(16===i||24===i||32===i){i>>>=2;for(r=0;r<i;++r)n.push(e.getInt32())}}if(!D.util.isArray(n)||4!==n.length&&6!==n.length&&8!==n.length)throw new Error("Invalid key parameter.");var o=this.mode.name,o=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=Ar(n,t.decrypt&&!o),this._init=!0}},D.aes._expandKey=function(t,e){return Er||Tr(),Ar(t,e)},D.aes._updateBlock=Ir,yr("AES-ECB",D.cipher.modes.ecb),yr("AES-CBC",D.cipher.modes.cbc),yr("AES-CFB",D.cipher.modes.cfb),yr("AES-OFB",D.cipher.modes.ofb),yr("AES-CTR",D.cipher.modes.ctr),yr("AES-GCM",D.cipher.modes.gcm);var vr,_r,wr,br,Cr,Er=!1,Sr=4;function Tr(){Er=!0,wr=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;vr=new Array(256),_r=new Array(256),br=new Array(4),Cr=new Array(4);for(e=0;e<4;++e)br[e]=new Array(256),Cr[e]=new Array(256);for(var n,r=0,i=0,e=0;e<256;++e){vr[r]=n=(n=i^i<<1^i<<2^i<<3^i<<4)>>8^255&n^99,_r[n]=r;for(var o,a,s,l=(o=t[n])<<24^n<<16^n<<8^n^o,u=((o=t[r])^(a=t[o])^(s=t[a]))<<24^(r^s)<<16^(r^a^s)<<8^r^o^s,c=0;c<4;++c)l=(br[c][r]=l)<<24|l>>>8,u=(Cr[c][n]=u)<<24|u>>>8;0===r?r=i=1:(r=o^t[t[t[o^s]]],i^=t[t[i]])}}function Ar(t,e){for(var n,r=t.slice(0),i=1,o=r.length,a=Sr*(o+6+1),s=o;s<a;++s)n=r[s-1],s%o==0?(n=vr[n>>>16&255]<<24^vr[n>>>8&255]<<16^vr[255&n]<<8^vr[n>>>24]^wr[i]<<24,i++):6<o&&s%o==4&&(n=vr[n>>>24]<<24^vr[n>>>16&255]<<16^vr[n>>>8&255]<<8^vr[255&n]),r[s]=r[s-o]^n;if(e){for(var l,u=Cr[0],c=Cr[1],h=Cr[2],d=Cr[3],p=r.slice(0),s=0,f=(a=r.length)-Sr;s<a;s+=Sr,f-=Sr)if(0===s||s===a-Sr)p[s]=r[f],p[s+1]=r[f+3],p[s+2]=r[f+2],p[s+3]=r[f+1];else for(var g=0;g<Sr;++g)l=r[f+g],p[s+(3&-g)]=u[vr[l>>>24]]^c[vr[l>>>16&255]]^h[vr[l>>>8&255]]^d[vr[255&l]];r=p}return r}function Ir(t,e,n,r){for(var i,o,a,s,l,u,c,h=t.length/4-1,d=r?(i=Cr[0],o=Cr[1],a=Cr[2],s=Cr[3],_r):(i=br[0],o=br[1],a=br[2],s=br[3],vr),p=e[0]^t[0],f=e[r?3:1]^t[1],g=e[2]^t[2],m=e[r?1:3]^t[3],y=3,v=1;v<h;++v)l=i[p>>>24]^o[f>>>16&255]^a[g>>>8&255]^s[255&m]^t[++y],u=i[f>>>24]^o[g>>>16&255]^a[m>>>8&255]^s[255&p]^t[++y],c=i[g>>>24]^o[m>>>16&255]^a[p>>>8&255]^s[255&f]^t[++y],m=i[m>>>24]^o[p>>>16&255]^a[f>>>8&255]^s[255&g]^t[++y],p=l,f=u,g=c;n[0]=d[p>>>24]<<24^d[f>>>16&255]<<16^d[g>>>8&255]<<8^d[255&m]^t[++y],n[r?3:1]=d[f>>>24]<<24^d[g>>>16&255]<<16^d[m>>>8&255]<<8^d[255&p]^t[++y],n[2]=d[g>>>24]<<24^d[m>>>16&255]<<16^d[p>>>8&255]<<8^d[255&f]^t[++y],n[r?1:3]=d[m>>>24]<<24^d[p>>>16&255]<<16^d[f>>>8&255]<<8^d[255&g]^t[++y]}function Lr(t){var e="AES-"+((t=t||{}).mode||"CBC").toUpperCase(),r=t.decrypt?D.cipher.createDecipher(e,t.key):D.cipher.createCipher(e,t.key),i=r.start;return r.start=function(t,e){var n=null;e instanceof D.util.ByteBuffer&&(n=e,e={}),(e=e||{}).output=n,e.iv=t,i.call(r,e)},r}function kr(t,e){D.cipher.registerAlgorithm(t,function(){return new D.des.Algorithm(t,e)})}F(function(t){D.pki=D.pki||{};var n=t.exports=D.pki.oids=D.oids=D.oids||{};function e(t,e){n[t]=e,n[e]=t}function r(t,e){n[t]=e}e("1.2.840.113549.1.1.1","rsaEncryption"),e("1.2.840.113549.1.1.4","md5WithRSAEncryption"),e("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),e("1.2.840.113549.1.1.7","RSAES-OAEP"),e("1.2.840.113549.1.1.8","mgf1"),e("1.2.840.113549.1.1.9","pSpecified"),e("1.2.840.113549.1.1.10","RSASSA-PSS"),e("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),e("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),e("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),e("1.3.101.112","EdDSA25519"),e("1.2.840.10040.4.3","dsa-with-sha1"),e("1.3.14.3.2.7","desCBC"),e("1.3.14.3.2.26","sha1"),e("2.16.840.1.101.3.4.2.1","sha256"),e("2.16.840.1.101.3.4.2.2","sha384"),e("2.16.840.1.101.3.4.2.3","sha512"),e("1.2.840.113549.2.5","md5"),e("1.2.840.113549.1.7.1","data"),e("1.2.840.113549.1.7.2","signedData"),e("1.2.840.113549.1.7.3","envelopedData"),e("1.2.840.113549.1.7.4","signedAndEnvelopedData"),e("1.2.840.113549.1.7.5","digestedData"),e("1.2.840.113549.1.7.6","encryptedData"),e("1.2.840.113549.1.9.1","emailAddress"),e("1.2.840.113549.1.9.2","unstructuredName"),e("1.2.840.113549.1.9.3","contentType"),e("1.2.840.113549.1.9.4","messageDigest"),e("1.2.840.113549.1.9.5","signingTime"),e("1.2.840.113549.1.9.6","counterSignature"),e("1.2.840.113549.1.9.7","challengePassword"),e("1.2.840.113549.1.9.8","unstructuredAddress"),e("1.2.840.113549.1.9.14","extensionRequest"),e("1.2.840.113549.1.9.20","friendlyName"),e("1.2.840.113549.1.9.21","localKeyId"),e("1.2.840.113549.1.9.22.1","x509Certificate"),e("1.2.840.113549.1.12.10.1.1","keyBag"),e("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),e("1.2.840.113549.1.12.10.1.3","certBag"),e("1.2.840.113549.1.12.10.1.4","crlBag"),e("1.2.840.113549.1.12.10.1.5","secretBag"),e("1.2.840.113549.1.12.10.1.6","safeContentsBag"),e("1.2.840.113549.1.5.13","pkcs5PBES2"),e("1.2.840.113549.1.5.12","pkcs5PBKDF2"),e("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),e("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),e("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),e("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),e("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),e("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),e("1.2.840.113549.2.7","hmacWithSHA1"),e("1.2.840.113549.2.8","hmacWithSHA224"),e("1.2.840.113549.2.9","hmacWithSHA256"),e("1.2.840.113549.2.10","hmacWithSHA384"),e("1.2.840.113549.2.11","hmacWithSHA512"),e("1.2.840.113549.3.7","des-EDE3-CBC"),e("2.16.840.1.101.3.4.1.2","aes128-CBC"),e("2.16.840.1.101.3.4.1.22","aes192-CBC"),e("2.16.840.1.101.3.4.1.42","aes256-CBC"),e("2.5.4.3","commonName"),e("2.5.4.5","serialName"),e("2.5.4.6","countryName"),e("2.5.4.7","localityName"),e("2.5.4.8","stateOrProvinceName"),e("2.5.4.9","streetAddress"),e("2.5.4.10","organizationName"),e("2.5.4.11","organizationalUnitName"),e("2.5.4.13","description"),e("2.5.4.15","businessCategory"),e("2.5.4.17","postalCode"),e("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),e("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),e("2.16.840.1.113730.1.1","nsCertType"),e("2.16.840.1.113730.1.13","nsComment"),r("2.5.29.1","authorityKeyIdentifier"),r("2.5.29.2","keyAttributes"),r("2.5.29.3","certificatePolicies"),r("2.5.29.4","keyUsageRestriction"),r("2.5.29.5","policyMapping"),r("2.5.29.6","subtreesConstraint"),r("2.5.29.7","subjectAltName"),r("2.5.29.8","issuerAltName"),r("2.5.29.9","subjectDirectoryAttributes"),r("2.5.29.10","basicConstraints"),r("2.5.29.11","nameConstraints"),r("2.5.29.12","policyConstraints"),r("2.5.29.13","basicConstraints"),e("2.5.29.14","subjectKeyIdentifier"),e("2.5.29.15","keyUsage"),r("2.5.29.16","privateKeyUsagePeriod"),e("2.5.29.17","subjectAltName"),e("2.5.29.18","issuerAltName"),e("2.5.29.19","basicConstraints"),r("2.5.29.20","cRLNumber"),r("2.5.29.21","cRLReason"),r("2.5.29.22","expirationDate"),r("2.5.29.23","instructionCode"),r("2.5.29.24","invalidityDate"),r("2.5.29.25","cRLDistributionPoints"),r("2.5.29.26","issuingDistributionPoint"),r("2.5.29.27","deltaCRLIndicator"),r("2.5.29.28","issuingDistributionPoint"),r("2.5.29.29","certificateIssuer"),r("2.5.29.30","nameConstraints"),e("2.5.29.31","cRLDistributionPoints"),e("2.5.29.32","certificatePolicies"),r("2.5.29.33","policyMappings"),r("2.5.29.34","policyConstraints"),e("2.5.29.35","authorityKeyIdentifier"),r("2.5.29.36","policyConstraints"),e("2.5.29.37","extKeyUsage"),r("2.5.29.46","freshestCRL"),r("2.5.29.54","inhibitAnyPolicy"),e("1.3.6.1.4.1.11129.2.4.2","timestampList"),e("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),e("1.3.6.1.5.5.7.3.1","serverAuth"),e("1.3.6.1.5.5.7.3.2","clientAuth"),e("1.3.6.1.5.5.7.3.3","codeSigning"),e("1.3.6.1.5.5.7.3.4","emailProtection"),e("1.3.6.1.5.5.7.3.8","timeStamping")}),F(function(t){var _=t.exports=D.asn1=D.asn1||{};function w(t,e,n){var r;if(e<n)throw(r=new Error("Too few bytes to parse DER.")).available=t.length(),r.remaining=e,r.requested=n,r}_.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},_.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},_.create=function(t,e,n,r,i){if(D.util.isArray(r)){for(var o=[],a=0;a<r.length;++a)void 0!==r[a]&&o.push(r[a]);r=o}t={tagClass:t,type:e,constructed:n,composed:n||D.util.isArray(r),value:r};return i&&"bitStringContents"in i&&(t.bitStringContents=i.bitStringContents,t.original=_.copy(t)),t},_.copy=function(t,e){if(D.util.isArray(t))for(var n=[],r=0;r<t.length;++r)n.push(_.copy(t[r],e));else{if("string"==typeof t)return t;n={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:_.copy(t.value,e)},e&&!e.excludeBitStringContents&&(n.bitStringContents=t.bitStringContents)}return n},_.equals=function(t,e,n){if(D.util.isArray(t)){if(!D.util.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!_.equals(t[r],e[r]))return!1;return!0}var i;return typeof t==typeof e&&("string"==typeof t?t===e:(i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&_.equals(t.value,e.value),n&&n.includeBitStringContents?i&&t.bitStringContents===e.bitStringContents:i))},_.getBerValueLength=function(t){var e=t.getByte();if(128!==e)return 128&e?t.getInt((127&e)<<3):e};function b(t,e){var n=t.getByte();if(e--,128!==n){t=128&n?(w(t,e,e=127&n),t.getInt(e<<3)):n;if(t<0)throw new Error("Negative length: "+t);return t}}_.fromDer=function(t,e){return"strict"in(e="boolean"==typeof(e=void 0===e?{strict:!0,decodeBitStrings:!0}:e)?{strict:e,decodeBitStrings:!0}:e)||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),function t(e,n,r,i){var o;w(e,n,2);var a=e.getByte();n--;var s=192&a;var l=31&a;o=e.length();var u=b(e,n);n-=o-e.length();if(void 0!==u&&n<u){if(i.strict)throw(d=new Error("Too few bytes to read ASN.1 value.")).available=e.length(),d.remaining=n,d.requested=u,d;u=n}var c;var h;var d=32==(32&a);if(d)if(c=[],void 0===u)for(;;){if(w(e,n,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),n-=2;break}o=e.length(),c.push(t(e,n,r+1,i)),n-=o-e.length()}else for(;0<u;)o=e.length(),c.push(t(e,u,r+1,i)),n-=o-e.length(),u-=o-e.length();void 0===c&&s===_.Class.UNIVERSAL&&l===_.Type.BITSTRING&&(h=e.bytes(u));if(void 0===c&&i.decodeBitStrings&&s===_.Class.UNIVERSAL&&l===_.Type.BITSTRING&&1<u){var a=e.read,p=n,f=0;if(l===_.Type.BITSTRING&&(w(e,n,1),f=e.getByte(),n--),0===f)try{o=e.length();var g={verbose:i.verbose,strict:!0,decodeBitStrings:!0},m=t(e,n,r+1,g),y=o-e.length(),v=(n-=y,l==_.Type.BITSTRING&&y++,m.tagClass);y!==u||v!==_.Class.UNIVERSAL&&v!==_.Class.CONTEXT_SPECIFIC||(c=[m])}catch(t){}void 0===c&&(e.read=a,n=p)}if(void 0===c){if(void 0===u){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=n}if(l===_.Type.BMPSTRING)for(c="";0<u;u-=2)w(e,n,2),c+=String.fromCharCode(e.getInt16()),n-=2;else c=e.getBytes(u)}f=void 0===h?null:{bitStringContents:h};return _.create(s,l,d,c,f)}(t="string"==typeof t?D.util.createBuffer(t):t,t.length(),0,e)},_.toDer=function(t){var e=D.util.createBuffer(),n=t.tagClass|t.type,r=D.util.createBuffer(),i=!1;if(i="bitStringContents"in t&&(i=!0,t.original)?_.equals(t,t.original):i)r.putBytes(t.bitStringContents);else if(t.composed){t.constructed?n|=32:r.putByte(0);for(var o=0;o<t.value.length;++o)void 0!==t.value[o]&&r.putBuffer(_.toDer(t.value[o]))}else if(t.type===_.Type.BMPSTRING)for(o=0;o<t.value.length;++o)r.putInt16(t.value.charCodeAt(o));else t.type===_.Type.INTEGER&&1<t.value.length&&(0===t.value.charCodeAt(0)&&0==(128&t.value.charCodeAt(1))||255===t.value.charCodeAt(0)&&128==(128&t.value.charCodeAt(1)))?r.putBytes(t.value.substr(1)):r.putBytes(t.value);if(e.putByte(n),r.length()<=127)e.putByte(127&r.length());else{for(var a=r.length(),s="";s+=String.fromCharCode(255&a),0<(a>>>=8););e.putByte(128|s.length);for(o=s.length-1;0<=o;--o)e.putByte(s.charCodeAt(o))}return e.putBuffer(r),e},_.oidToDer=function(t){var e,n,r,i,o=t.split("."),a=D.util.createBuffer();a.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var s=2;s<o.length;++s){for(e=!0,n=[],r=parseInt(o[s],10);i=127&r,r>>>=7,e||(i|=128),n.push(i),e=!1,0<r;);for(var l=n.length-1;0<=l;--l)a.putByte(n[l])}return a},_.derToOid=function(t){for(var e=(t="string"==typeof t?D.util.createBuffer(t):t).getByte(),n=Math.floor(e/40)+"."+e%40,r=0;0<t.length();)r<<=7,128&(e=t.getByte())?r+=127&e:(n+="."+(r+e),r=0);return n},_.utcTimeToDate=function(t){var e,n,r=new Date,i=50<=(i=parseInt(t.substr(0,2),10))?1900+i:2e3+i,o=parseInt(t.substr(2,2),10)-1,a=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),l=parseInt(t.substr(8,2),10),u=0;return 11<t.length&&"+"!==(n=t.charAt(e=10))&&"-"!==n&&(u=parseInt(t.substr(10,2),10),e+=2),r.setUTCFullYear(i,o,a),r.setUTCHours(s,l,u,0),!e||"+"!==(n=t.charAt(e))&&"-"!==n||(i=60*parseInt(t.substr(e+1,2),10)+parseInt(t.substr(e+4,2),10),i*=6e4,"+"===n?r.setTime(+r-i):r.setTime(+r+i)),r},_.generalizedTimeToDate=function(t){var e=new Date,n=parseInt(t.substr(0,4),10),r=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),s=parseInt(t.substr(12,2),10),l=0,u=0,c=!1,h=("Z"===t.charAt(t.length-1)&&(c=!0),t.length-5),d=t.charAt(h);return"+"!==d&&"-"!==d||(u=60*parseInt(t.substr(1+h,2),10)+parseInt(t.substr(4+h,2),10),u*=6e4,"+"===d&&(u*=-1),c=!0),"."===t.charAt(14)&&(l=1e3*parseFloat(t.substr(14),10)),c?(e.setUTCFullYear(n,r,i),e.setUTCHours(o,a,s,l),e.setTime(+e+u)):(e.setFullYear(n,r,i),e.setHours(o,a,s,l)),e},_.dateToUtcTime=function(t){if("string"==typeof t)return t;var e="",n=[];n.push((""+t.getUTCFullYear()).substr(2)),n.push(""+(t.getUTCMonth()+1)),n.push(""+t.getUTCDate()),n.push(""+t.getUTCHours()),n.push(""+t.getUTCMinutes()),n.push(""+t.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(e+="0"),e+=n[r];return e+="Z"},_.dateToGeneralizedTime=function(t){if("string"==typeof t)return t;var e="",n=[];n.push(""+t.getUTCFullYear()),n.push(""+(t.getUTCMonth()+1)),n.push(""+t.getUTCDate()),n.push(""+t.getUTCHours()),n.push(""+t.getUTCMinutes()),n.push(""+t.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(e+="0"),e+=n[r];return e+="Z"},_.integerToDer=function(t){var e=D.util.createBuffer();if(-128<=t&&t<128)return e.putSignedInt(t,8);if(-32768<=t&&t<32768)return e.putSignedInt(t,16);if(-8388608<=t&&t<8388608)return e.putSignedInt(t,24);if(-2147483648<=t&&t<2147483648)return e.putSignedInt(t,32);e=new Error("Integer too large; max is 32-bits.");throw e.integer=t,e},_.derToInteger=function(t){var e=8*(t="string"==typeof t?D.util.createBuffer(t):t).length();if(32<e)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)},_.validate=function(t,e,n,r){var i=!1;if(t.tagClass!==e.tagClass&&void 0!==e.tagClass||t.type!==e.type&&void 0!==e.type)r&&(t.tagClass!==e.tagClass&&r.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type)&&r.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"');else if(t.constructed===e.constructed||void 0===e.constructed){if(i=!0,e.value&&D.util.isArray(e.value))for(var o=0,a=0;i&&a<e.value.length;++a)i=e.value[a].optional||!1,t.value[o]&&((i=_.validate(t.value[o],e.value[a],n,r))?++o:e.value[a].optional&&(i=!0)),!i&&r&&r.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&n&&(e.capture&&(n[e.capture]=t.value),e.captureAsn1&&(n[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(n[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue)&&"bitStringContents"in t)if(t.bitStringContents.length<2)n[e.captureBitStringValue]="";else{if(0!==t.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");n[e.captureBitStringValue]=t.bitStringContents.slice(1)}}else r&&r.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');return i};var u=/[^\\u0000-\\u00ff]/;_.prettyPrint=function(e,t,n){for(var r,i="",o=(n=n||2,0<(t=t||0)&&(i+="\n"),""),a=0;a<t*n;++a)o+=" ";switch(i+=o+"Tag: ",e.tagClass){case _.Class.UNIVERSAL:i+="Universal:";break;case _.Class.APPLICATION:i+="Application:";break;case _.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case _.Class.PRIVATE:i+="Private:"}if(e.tagClass===_.Class.UNIVERSAL)switch(i+=e.type,e.type){case _.Type.NONE:i+=" (None)";break;case _.Type.BOOLEAN:i+=" (Boolean)";break;case _.Type.INTEGER:i+=" (Integer)";break;case _.Type.BITSTRING:i+=" (Bit string)";break;case _.Type.OCTETSTRING:i+=" (Octet string)";break;case _.Type.NULL:i+=" (Null)";break;case _.Type.OID:i+=" (Object Identifier)";break;case _.Type.ODESC:i+=" (Object Descriptor)";break;case _.Type.EXTERNAL:i+=" (External or Instance of)";break;case _.Type.REAL:i+=" (Real)";break;case _.Type.ENUMERATED:i+=" (Enumerated)";break;case _.Type.EMBEDDED:i+=" (Embedded PDV)";break;case _.Type.UTF8:i+=" (UTF8)";break;case _.Type.ROID:i+=" (Relative Object Identifier)";break;case _.Type.SEQUENCE:i+=" (Sequence)";break;case _.Type.SET:i+=" (Set)";break;case _.Type.PRINTABLESTRING:i+=" (Printable String)";break;case _.Type.IA5String:i+=" (IA5String (ASCII))";break;case _.Type.UTCTIME:i+=" (UTC time)";break;case _.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case _.Type.BMPSTRING:i+=" (BMP String)"}else i+=e.type;if(i=i+"\n"+(o+"Constructed: "+e.constructed+"\n"),e.composed){for(var s=0,l="",a=0;a<e.value.length;++a)void 0!==e.value[a]&&(s+=1,l+=_.prettyPrint(e.value[a],t+1,n),a+1<e.value.length)&&(l+=",");i+=o+"Sub values: "+s+l}else if(i+=o+"Value: ",e.type===_.Type.OID&&(i+=r=_.derToOid(e.value),D.pki)&&D.pki.oids&&r in D.pki.oids&&(i+=" ("+D.pki.oids[r]+") "),e.type===_.Type.INTEGER)try{i+=_.derToInteger(e.value)}catch(t){i+="0x"+D.util.bytesToHex(e.value)}else e.type===_.Type.BITSTRING?(1<e.value.length?i+="0x"+D.util.bytesToHex(e.value.slice(1)):i+="(none)",0<e.value.length&&(1==(r=e.value.charCodeAt(0))?i+=" (1 unused bit shown)":1<r&&(i+=" ("+r+" unused bits shown)"))):e.type===_.Type.OCTETSTRING?(u.test(e.value)||(i+="("+e.value+") "),i+="0x"+D.util.bytesToHex(e.value)):e.type===_.Type.UTF8?i+=D.util.decodeUtf8(e.value):e.type===_.Type.PRINTABLESTRING||e.type===_.Type.IA5String?i+=e.value:u.test(e.value)?i+="0x"+D.util.bytesToHex(e.value):0===e.value.length?i+="[null]":i+=e.value;return i}}),D.md=D.md||{},D.md.algorithms=D.md.algorithms||{},F(function(t){(t.exports=D.hmac=D.hmac||{}).create=function(){var o=null,a=null,s=null,l=null,t={start:function(t,e){if(null!==t)if("string"==typeof t){if(!((t=t.toLowerCase())in D.md.algorithms))throw new Error('Unknown hash algorithm "'+t+'"');a=D.md.algorithms[t].create()}else a=t;if(null===e)e=o;else{if("string"==typeof e)e=D.util.createBuffer(e);else if(D.util.isArray(e)){var n=e;e=D.util.createBuffer();for(var r=0;r<n.length;++r)e.putByte(n[r])}e.length()>a.blockLength&&(a.start(),a.update(e.bytes()),e=a.digest()),s=D.util.createBuffer(),l=D.util.createBuffer();for(var i=e.length(),r=0;r<i;++r){n=e.at(r);s.putByte(54^n),l.putByte(92^n)}if(i<a.blockLength)for(n=a.blockLength-i,r=0;r<n;++r)s.putByte(54),l.putByte(92);o=e,s=s.bytes(),l=l.bytes()}a.start(),a.update(s)},update:function(t){a.update(t)},getMac:function(){var t=a.digest().bytes();return a.start(),a.update(l),a.update(t),a.digest()}};return t.digest=t.getMac,t}}),F(function(t){var t=t.exports=D.md5=D.md5||{},c=((D.md.md5=D.md.algorithms.md5=t).create=function(){if(!e){c=String.fromCharCode(128),c+=D.util.fillString(String.fromCharCode(0),64),h=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],d=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],p=new Array(64);for(var t=0;t<64;++t)p[t]=Math.floor(4294967296*Math.abs(Math.sin(t+1)));e=!0}var a=null,s=D.util.createBuffer(),l=new Array(16),u={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){u.messageLength=0,u.fullMessageLength=u.messageLength64=[];for(var t=u.messageLengthSize/4,e=0;e<t;++e)u.fullMessageLength.push(0);return s=D.util.createBuffer(),a={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},u}};return u.start(),u.update=function(t,e){var n=(t="utf8"===e?D.util.encodeUtf8(t):t).length;u.messageLength+=n;for(var n=[n/4294967296>>>0,n>>>0],r=u.fullMessageLength.length-1;0<=r;--r)u.fullMessageLength[r]+=n[1],n[1]=n[0]+(u.fullMessageLength[r]/4294967296>>>0),u.fullMessageLength[r]=u.fullMessageLength[r]>>>0,n[0]=n[1]/4294967296>>>0;return s.putBytes(t),f(a,l,s),(2048<s.read||0===s.length())&&s.compact(),u},u.digest=function(){var t=D.util.createBuffer(),e=(t.putBytes(s.bytes()),u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize);t.putBytes(c.substr(0,u.blockLength-(e&u.blockLength-1)));for(var n,r=0,i=u.fullMessageLength.length-1;0<=i;--i)r=(n=8*u.fullMessageLength[i]+r)/4294967296>>>0,t.putInt32Le(n>>>0);var e={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3},o=(f(e,l,t),D.util.createBuffer());return o.putInt32Le(e.h0),o.putInt32Le(e.h1),o.putInt32Le(e.h2),o.putInt32Le(e.h3),o},u},null),h=null,d=null,p=null,e=!1;function f(t,e,n){for(var r,i,o,a,s,l,u,c=n.length();64<=c;){for(i=t.h0,o=t.h1,a=t.h2,s=t.h3,u=0;u<16;++u)e[u]=n.getInt32Le(),r=i+(s^o&(a^s))+p[u]+e[u],i=s,s=a,a=o,o+=r<<(l=d[u])|r>>>32-l;for(;u<32;++u)r=i+(a^s&(o^a))+p[u]+e[h[u]],i=s,s=a,a=o,o+=r<<(l=d[u])|r>>>32-l;for(;u<48;++u)r=i+(o^a^s)+p[u]+e[h[u]],i=s,s=a,a=o,o+=r<<(l=d[u])|r>>>32-l;for(;u<64;++u)r=i+(a^(o|~s))+p[u]+e[h[u]],i=s,s=a,a=o,o+=r<<(l=d[u])|r>>>32-l;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+a|0,t.h3=t.h3+s|0,c-=64}}}),F(function(t){t=t.exports=D.pem=D.pem||{};function o(t){for(var e=t.name+": ",n=[],r=function(t,e){return" "+e},i=0;i<t.values.length;++i)n.push(t.values[i].replace(/^(\S+\r\n)/,r));e+=n.join(",")+"\r\n";for(var o,a=0,s=-1,i=0;i<e.length;++i,++a)65<a&&-1!==s?(e=","===(o=e[s])?(++s,e.substr(0,s)+"\r\n "+e.substr(s)):e.substr(0,s)+"\r\n"+o+e.substr(s+1),a=i-s-1,s=-1,++i):" "!==e[i]&&"\t"!==e[i]&&","!==e[i]||(s=i);return e}t.encode=function(t,e){e=e||{};var n,r="-----BEGIN "+t.type+"-----\r\n";if(t.procType&&(r+=o(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]})),t.contentDomain&&(r+=o(n={name:"Content-Domain",values:[t.contentDomain]})),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=o(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=o(t.headers[i]);return t.procType&&(r+="\r\n"),r=(r+=D.util.encode64(t.body,e.maxline||64)+"\r\n")+("-----END "+t.type+"-----\r\n")},t.decode=function(t){for(var e,n=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/;e=r.exec(t);){var a={type:e[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:D.util.decode64(e[3])};if(n.push(a),e[2]){for(var s=e[2].split(o),l=0;e&&l<s.length;){for(var u=s[l].replace(/\s+$/,""),c=l+1;c<s.length;++c){var h=s[c];if(!/\s/.test(h[0]))break;u+=h,l=c}if(e=u.match(i)){for(var d={name:e[1],values:[]},p=e[2].split(","),f=0;f<p.length;++f)d.values.push(p[f].replace(/^\s+/,""));if(a.procType)if(a.contentDomain||"Content-Domain"!==d.name)if(a.dekInfo||"DEK-Info"!==d.name)a.headers.push(d);else{if(0===d.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.contentDomain=p[0]||"";else{if("Proc-Type"!==d.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==d.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++l}if("ENCRYPTED"===a.procType&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===n.length)throw new Error("Invalid PEM formatted message.");return n}}),D.des=D.des||{},D.des.startEncrypting=function(t,e,n,r){t=Fr({key:t,output:n,decrypt:!1,mode:r||(null===e?"ECB":"CBC")});return t.start(e),t},D.des.createEncryptionCipher=function(t,e){return Fr({key:t,output:null,decrypt:!1,mode:e})},D.des.startDecrypting=function(t,e,n,r){t=Fr({key:t,output:n,decrypt:!0,mode:r||(null===e?"ECB":"CBC")});return t.start(e),t},D.des.createDecryptionCipher=function(t,e){return Fr({key:t,output:null,decrypt:!0,mode:e})},D.des.Algorithm=function(t,e){var n=this;n.name=t,n.mode=new e({blockSize:8,cipher:{encrypt:function(t,e){return Ur(n._keys,t,e,!1)},decrypt:function(t,e){return Ur(n._keys,t,e,!0)}}}),n._init=!1},D.des.Algorithm.prototype.initialize=function(t){if(!this._init){t=D.util.createBuffer(t.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=(t=>{for(var e,n=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],l=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],f=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=8<t.length()?3:1,y=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],_=0,w=0;w<m;w++){var b=t.getInt32(),C=t.getInt32();e=(b=(b=(b=(b=(b=(b=(b^=(e=252645135&(b>>>4^C))<<4)^(e=65535&((C^=e)>>>-16^b)))^(e=858993459&(b>>>2^(C^=e<<-16)))<<2)^(e=65535&((C^=e)>>>-16^b)))^(e=1431655765&(b>>>1^(C^=e<<-16)))<<1)^(e=16711935&((C^=e)>>>8^b)))^(e=1431655765&(b>>>1^(C^=e<<8)))<<1)<<8|(C^=e)>>>20&240,b=C<<24|C<<8&16711680|C>>>8&65280|C>>>24&240,C=e;for(var E=0;E<v.length;++E){C=v[E]?(b=b<<2|b>>>26,C<<2|C>>>26):(b=b<<1|b>>>27,C<<1|C>>>27);var S=n[(b&=-15)>>>28]|r[b>>>24&15]|i[b>>>20&15]|o[b>>>16&15]|a[b>>>12&15]|s[b>>>8&15]|l[b>>>4&15],T=u[(C&=-15)>>>28]|c[C>>>24&15]|h[C>>>20&15]|d[C>>>16&15]|p[C>>>12&15]|f[C>>>8&15]|g[C>>>4&15];y[_++]=S^(e=65535&(T>>>16^S)),y[_++]=T^e<<16}}return y})(t),this._init=!0}},kr("DES-ECB",D.cipher.modes.ecb),kr("DES-CBC",D.cipher.modes.cbc),kr("DES-CFB",D.cipher.modes.cfb),kr("DES-OFB",D.cipher.modes.ofb),kr("DES-CTR",D.cipher.modes.ctr),kr("3DES-ECB",D.cipher.modes.ecb),kr("3DES-CBC",D.cipher.modes.cbc),kr("3DES-CFB",D.cipher.modes.cfb),kr("3DES-OFB",D.cipher.modes.ofb),kr("3DES-CTR",D.cipher.modes.ctr);var xr=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Dr=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Nr=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Rr=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Pr=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Or=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Mr=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Br=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Ur(t,e,n,r){var i=32===t.length?3:9,o=3==i?r?[30,-2,-2]:[0,32,2]:r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2],a=e[0];a=(a=(a=(a=(a=(a^=(p=252645135&(a>>>4^(f=e[1])))<<4)^(p=65535&(a>>>16^(f^=p)))<<16)^(p=858993459&((f^=p)>>>2^a)))^(p=16711935&((f^=p<<2)>>>8^a)))^(p=1431655765&(a>>>1^(f^=p<<8)))<<1)<<1|a>>>31,f=(f^=p)<<1|f>>>31;for(var s=0;s<i;s+=3){for(var l=o[s+1],u=o[s+2],c=o[s];c!=l;c+=u)var h=f^t[c],d=(f>>>4|f<<28)^t[c+1],p=a,a=f,f=p^(Dr[h>>>24&63]|Rr[h>>>16&63]|Or[h>>>8&63]|Br[63&h]|xr[d>>>24&63]|Nr[d>>>16&63]|Pr[d>>>8&63]|Mr[63&d]);p=a,a=f,f=p}f=f>>>1|f<<31,f=(f=(f=(f=(f^=p=1431655765&((a=a>>>1|a<<31)>>>1^f))^(p=16711935&(f>>>8^(a^=p<<1)))<<8)^(p=858993459&(f>>>2^(a^=p)))<<2)^(p=65535&((a^=p)>>>16^f)))^(p=252645135&((a^=p<<16)>>>4^f)),n[0]=a^=p<<4,n[1]=f}function Fr(t){var e="DES-"+((t=t||{}).mode||"CBC").toUpperCase(),r=t.decrypt?D.cipher.createDecipher(e,t.key):D.cipher.createCipher(e,t.key),i=r.start;return r.start=function(t,e){var n=null;e instanceof D.util.ByteBuffer&&(n=e,e={}),(e=e||{}).output=n,e.iv=t,i.call(r,e)},r}function Vr(t,e,a){var s,l,u,c=!1,h=null,d=null,p=null,r=[];for(t=D.rc2.expandKey(t,e),l=0;l<64;l++)r.push(t.getInt16Le());var f=a?(s=function(t){for(l=0;l<4;l++)t[l]+=r[u]+(t[(l+3)%4]&t[(l+2)%4])+(~t[(l+3)%4]&t[(l+1)%4]),t[l]=(e=t[l])<<(n=qr[l])&65535|(65535&e)>>16-n,u++;var e,n},function(t){for(l=0;l<4;l++)t[l]+=r[63&t[(l+3)%4]]}):(s=function(t){for(l=3;0<=l;l--)t[l]=(65535&(e=t[l]))>>(n=qr[l])|e<<16-n&65535,t[l]-=r[u]+(t[(l+3)%4]&t[(l+2)%4])+(~t[(l+3)%4]&t[(l+1)%4]),u--;var e,n},function(t){for(l=3;0<=l;l--)t[l]-=r[63&t[(l+3)%4]]}),i=null;return i={start:function(t,e){t&&"string"==typeof t&&(t=D.util.createBuffer(t)),c=!1,h=D.util.createBuffer(),d=e||new D.util.createBuffer,p=t,i.output=d},update:function(t){for(c||h.putBuffer(t);8<=h.length();){o=i=r=n=e=void 0;var e=[[5,s],[1,f],[6,s],[1,f],[5,s]],n=[];for(l=0;l<4;l++){var r=h.getInt16Le();null!==p&&(a?r^=p.getInt16Le():p.putInt16Le(r)),n.push(65535&r)}u=a?0:63;for(var i=0;i<e.length;i++)for(var o=0;o<e[i][0];o++)e[i][1](n);for(l=0;l<4;l++)null!==p&&(a?p.putInt16Le(n[l]):n[l]^=p.getInt16Le()),d.putInt16Le(n[l])}},finish:function(t){var e,n=!0;return a&&(t?n=t(8,h,!a):(e=8===h.length()?8:8-h.length(),h.fillWithByte(e,e))),n&&(c=!0,i.update()),a||(n=0===h.length())&&(t?n=t(8,d,!a):(e=d.length())<(t=d.at(e-1))?n=!1:d.truncate(t)),n}}}var Hr,zr=(t=Object.freeze({__proto__:null,default:{}}))&&t.default||t,t=D.pkcs5=D.pkcs5||{},jr=(D.util.isNodejs&&!D.options.usePureJavaScript&&(Hr=zr),D.pbkdf2=t.pbkdf2=function(t,e,n,r,i,o){if("function"==typeof i&&(o=i,i=null),D.util.isNodejs&&!D.options.usePureJavaScript&&Hr.pbkdf2&&(null===i||"object"!=typeof i)&&(4<Hr.pbkdf2Sync.length||!i||"sha1"===i))return"string"!=typeof i&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?4===Hr.pbkdf2Sync.length?Hr.pbkdf2(t,e,n,r,function(t,e){if(t)return o(t);o(null,e.toString("binary"))}):Hr.pbkdf2(t,e,n,r,i,function(t,e){if(t)return o(t);o(null,e.toString("binary"))}):(4===Hr.pbkdf2Sync.length?Hr.pbkdf2Sync(t,e,n,r):Hr.pbkdf2Sync(t,e,n,r,i)).toString("binary");if("string"==typeof(i=null==i?"sha1":i)){if(!(i in D.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=D.md[i].create()}var a=i.digestLength;if(4294967295*a<r){var s=new Error("Derived key is too long.");if(o)return o(s);throw s}var l,u,c=Math.ceil(r/a),h=r-(c-1)*a,d=D.hmac.create(),p=(d.start(i,t),"");if(!o){for(var f=1;f<=c;++f){d.start(null,null),d.update(e),d.update(D.util.int32ToBytes(f));for(var g=u=d.digest().getBytes(),m=2;m<=n;++m)d.start(null,null),d.update(u),l=d.digest().getBytes(),g=D.util.xorBytes(g,l,a),u=l;p+=f<c?g:g.substr(0,h)}return p}f=1;function y(){if(c<f)return o(null,p);d.start(null,null),d.update(e),d.update(D.util.int32ToBytes(f)),g=u=d.digest().getBytes(),m=2,v()}function v(){if(m<=n)return d.start(null,null),d.update(u),l=d.digest().getBytes(),g=D.util.xorBytes(g,l,a),u=l,++m,D.util.setImmediate(v);p+=f<c?g:g.substr(0,h),++f,y()}y()},F(function(t){var t=t.exports=D.sha256=D.sha256||{},c=((D.md.sha256=D.md.algorithms.sha256=t).create=function(){e||(c=String.fromCharCode(128),c+=D.util.fillString(String.fromCharCode(0),64),m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],e=!0);var a=null,s=D.util.createBuffer(),l=new Array(64),u={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){u.messageLength=0,u.fullMessageLength=u.messageLength64=[];for(var t=u.messageLengthSize/4,e=0;e<t;++e)u.fullMessageLength.push(0);return s=D.util.createBuffer(),a={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},u}};return u.start(),u.update=function(t,e){var n=(t="utf8"===e?D.util.encodeUtf8(t):t).length;u.messageLength+=n;for(var n=[n/4294967296>>>0,n>>>0],r=u.fullMessageLength.length-1;0<=r;--r)u.fullMessageLength[r]+=n[1],n[1]=n[0]+(u.fullMessageLength[r]/4294967296>>>0),u.fullMessageLength[r]=u.fullMessageLength[r]>>>0,n[0]=n[1]/4294967296>>>0;return s.putBytes(t),h(a,l,s),(2048<s.read||0===s.length())&&s.compact(),u},u.digest=function(){for(var t,e=D.util.createBuffer(),n=(e.putBytes(s.bytes()),u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize),r=(e.putBytes(c.substr(0,u.blockLength-(n&u.blockLength-1))),8*u.fullMessageLength[0]),i=0;i<u.fullMessageLength.length-1;++i)r+=(t=8*u.fullMessageLength[i+1])/4294967296>>>0,e.putInt32(r>>>0),r=t>>>0;e.putInt32(r);var n={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3,h4:a.h4,h5:a.h5,h6:a.h6,h7:a.h7},o=(h(n,l,e),D.util.createBuffer());return o.putInt32(n.h0),o.putInt32(n.h1),o.putInt32(n.h2),o.putInt32(n.h3),o.putInt32(n.h4),o.putInt32(n.h5),o.putInt32(n.h6),o.putInt32(n.h7),o},u},null),e=!1,m=null;function h(t,e,n){for(var r,i,o,a,s,l,u,c,h,d,p,f,g=n.length();64<=g;){for(a=0;a<16;++a)e[a]=n.getInt32();for(;a<64;++a)r=e[a-2],e[a]=(r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)+e[a-7]+(i=((i=e[a-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)+e[a-16]|0;for(s=t.h0,l=t.h1,u=t.h2,c=t.h3,h=t.h4,d=t.h5,p=t.h6,f=t.h7,a=0;a<64;++a)o=s&l|u&(s^l),r=f+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(p^h&(d^p))+m[a]+e[a],f=p,p=d,d=h,h=c+r>>>0,c=u,u=l,s=r+(i=(((l=s)>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+o)>>>0;t.h0=t.h0+s|0,t.h1=t.h1+l|0,t.h2=t.h2+u|0,t.h3=t.h3+c|0,t.h4=t.h4+h|0,t.h5=t.h5+d|0,t.h6=t.h6+p|0,t.h7=t.h7+f|0,g-=64}}}),F(function(t){var o=null;!D.util.isNodejs||D.options.usePureJavaScript||process.versions["node-webkit"]||(o=zr),(t.exports=D.prng=D.prng||{}).create=function(t){for(var u={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},e=t.md,n=new Array(32),r=0;r<32;++r)n[r]=e.create();function c(n){if(32<=u.pools[0].messageLength)return s(),n();var t=32-u.pools[0].messageLength<<5;u.seedFile(t,function(t,e){if(t)return n(t);u.collect(e),s(),n()})}function s(){u.reseeds=4294967295===u.reseeds?0:u.reseeds+1;for(var t=u.plugin.md.create(),e=(t.update(u.keyBytes),1),n=0;n<32;++n)u.reseeds%e==0&&(t.update(u.pools[n].digest().getBytes()),u.pools[n].start()),e<<=1;u.keyBytes=t.digest().getBytes(),t.start(),t.update(u.keyBytes);var r=t.digest().getBytes();u.key=u.plugin.formatKey(u.keyBytes),u.seed=u.plugin.formatSeed(r),u.generated=0}function i(t){var e=null,n=D.util.globalScope,r=n.crypto||n.msCrypto,i=(r&&r.getRandomValues&&(e=function(t){return r.getRandomValues(t)}),D.util.createBuffer());if(e)for(;i.length()<t;){var o=Math.max(1,Math.min(t-i.length(),65536)/4),a=new Uint32Array(Math.floor(o));try{e(a);for(var s=0;s<a.length;++s)i.putInt32(a[s])}catch(t){if(!("undefined"!=typeof QuotaExceededError&&t instanceof QuotaExceededError))throw t}}if(i.length()<t)for(var l,u,c=Math.floor(65536*Math.random());i.length()<t;)for(var h,c=4294967295&(h=(2147483647&(h=(h=16807*(65535&c))+((32767&(l=16807*(c>>16)))<<16)+(l>>15)))+(h>>31)),s=0;s<3;++s)u=c>>>(s<<3),u^=Math.floor(256*Math.random()),i.putByte(String.fromCharCode(255&u));return i.getBytes(t)}return u.pools=n,u.pool=0,u.generate=function(n,r){if(!r)return u.generateSync(n);var i=u.plugin.cipher,o=u.plugin.increment,a=u.plugin.formatKey,s=u.plugin.formatSeed,l=D.util.createBuffer();u.key=null,function t(e){if(e)return r(e);if(l.length()>=n)return r(null,l.getBytes(n));1048575<u.generated&&(u.key=null);if(null===u.key)return D.util.nextTick(function(){c(t)});e=i(u.key,u.seed);u.generated+=e.length;l.putBytes(e);u.key=a(i(u.key,o(u.seed)));u.seed=s(i(u.key,u.seed));D.util.setImmediate(t)}()},u.generateSync=function(t){for(var e=u.plugin.cipher,n=u.plugin.increment,r=u.plugin.formatKey,i=u.plugin.formatSeed,o=(u.key=null,D.util.createBuffer());o.length()<t;){1048575<u.generated&&(u.key=null),null===u.key&&(()=>{if(32<=u.pools[0].messageLength)return s();var t=32-u.pools[0].messageLength<<5;u.collect(u.seedFileSync(t)),s()})();var a=e(u.key,u.seed);u.generated+=a.length,o.putBytes(a),u.key=r(e(u.key,n(u.seed))),u.seed=i(e(u.key,u.seed))}return o.getBytes(t)},o?(u.seedFile=function(t,n){o.randomBytes(t,function(t,e){if(t)return n(t);n(null,e.toString())})},u.seedFileSync=function(t){return o.randomBytes(t).toString()}):(u.seedFile=function(t,e){try{e(null,i(t))}catch(t){e(t)}},u.seedFileSync=i),u.collect=function(t){for(var e=t.length,n=0;n<e;++n)u.pools[u.pool].update(t.substr(n,1)),u.pool=31===u.pool?0:u.pool+1},u.collectInt=function(t,e){for(var n="",r=0;r<e;r+=8)n+=String.fromCharCode(t>>r&255);u.collect(n)},u.registerWorker=function(n){n===self?u.seedFile=function(t,n){self.addEventListener("message",function t(e){e=e.data;e.forge&&e.forge.prng&&(self.removeEventListener("message",t),n(e.forge.prng.err,e.forge.prng.bytes))}),self.postMessage({forge:{prng:{needed:t}}})}:n.addEventListener("message",function(t){t=t.data;t.forge&&t.forge.prng&&u.seedFile(t.forge.prng.needed,function(t,e){n.postMessage({forge:{prng:{err:t,bytes:e}}})})})},u}}),F(function(t){if(!D.random||!D.random.getBytes){var e="undefined"!=typeof jQuery?jQuery:null,r={},n=new Array(4),i=D.util.createBuffer();function o(){var n=D.prng.create(r);return n.getBytes=function(t,e){return n.generate(t,e)},n.getBytesSync=function(t){return n.generate(t)},n}r.formatKey=function(t){var e=D.util.createBuffer(t);return(t=new Array(4))[0]=e.getInt32(),t[1]=e.getInt32(),t[2]=e.getInt32(),t[3]=e.getInt32(),D.aes._expandKey(t,!1)},r.formatSeed=function(t){var e=D.util.createBuffer(t);return(t=new Array(4))[0]=e.getInt32(),t[1]=e.getInt32(),t[2]=e.getInt32(),t[3]=e.getInt32(),t},r.cipher=function(t,e){return D.aes._updateBlock(t,e,n,!1),i.putInt32(n[0]),i.putInt32(n[1]),i.putInt32(n[2]),i.putInt32(n[3]),i.getBytes()},r.increment=function(t){return++t[3],t},r.md=D.md.sha256;var a=o(),s=null,l=D.util.globalScope,u=l.crypto||l.msCrypto;if(u&&u.getRandomValues&&(s=function(t){return u.getRandomValues(t)}),D.options.usePureJavaScript||!D.util.isNodejs&&!s){if(a.collectInt(+new Date,32),"undefined"!=typeof navigator){var c="";for(h in navigator)try{"string"==typeof navigator[h]&&(c+=navigator[h])}catch(t){}a.collect(c),c=null}e&&(e().mousemove(function(t){a.collectInt(t.clientX,16),a.collectInt(t.clientY,16)}),e().keypress(function(t){a.collectInt(t.charCode,8)}))}if(D.random)for(var h in a)D.random[h]=a[h];else D.random=a;D.random.createInstance=o}t.exports=D.random}),[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173]),qr=[1,2,3,5];function y(t,e,n){this.data=[],null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function Wr(){return new y(null)}function Gr(t,e,n,r,i,o){for(var a=16383&e,s=e>>14;0<=--o;){var l=16383&this.data[t],u=this.data[t++]>>14,c=s*l+u*a;i=((l=a*l+((16383&c)<<14)+n.data[r]+i)>>28)+(c>>14)+s*u,n.data[r++]=268435455&l}return i}D.rc2=D.rc2||{},D.rc2.expandKey=function(t,e){e=e||128;for(var n=t="string"==typeof t?D.util.createBuffer(t):t,r=t.length(),t=e,i=Math.ceil(t/8),e=255>>(7&t),o=r;o<128;o++)n.putByte(jr[n.at(o-1)+n.at(o-r)&255]);for(n.setAt(128-i,jr[n.at(128-i)&e]),o=127-i;0<=o;o--)n.setAt(o,jr[n.at(o+1)^n.at(o+i)]);return n},D.rc2.startEncrypting=function(t,e,n){t=D.rc2.createEncryptionCipher(t,128);return t.start(e,n),t},D.rc2.createEncryptionCipher=function(t,e){return Vr(t,e,!0)},D.rc2.startDecrypting=function(t,e,n){t=D.rc2.createDecryptionCipher(t,128);return t.start(e,n),t},D.rc2.createDecryptionCipher=function(t,e){return Vr(t,e,!1)},D.jsbn=D.jsbn||{},D.jsbn.BigInteger=y,t="undefined"==typeof navigator?(y.prototype.am=Gr,28):"Microsoft Internet Explorer"==navigator.appName?(y.prototype.am=function(t,e,n,r,i,o){for(var a=32767&e,s=e>>15;0<=--o;){var l=32767&this.data[t],u=this.data[t++]>>15,c=s*l+u*a;i=((l=a*l+((32767&c)<<15)+n.data[r]+(1073741823&i))>>>30)+(c>>>15)+s*u+(i>>>30),n.data[r++]=1073741823&l}return i},30):"Netscape"!=navigator.appName?(y.prototype.am=function(t,e,n,r,i,o){for(;0<=--o;){var a=e*this.data[t++]+n.data[r]+i;i=Math.floor(a/67108864),n.data[r++]=67108863&a}return i},26):(y.prototype.am=Gr,28),y.prototype.DB=t,y.prototype.DM=(1<<t)-1,y.prototype.DV=1<<t,y.prototype.FV=Math.pow(2,52),y.prototype.F1=52-t,y.prototype.F2=2*t-52;for(var $r="0123456789abcdefghijklmnopqrstuvwxyz",Kr=new Array,Xr="0".charCodeAt(0),Zr=0;Zr<=9;++Zr)Kr[Xr++]=Zr;for(Xr="a".charCodeAt(0),Zr=10;Zr<36;++Zr)Kr[Xr++]=Zr;for(Xr="A".charCodeAt(0),Zr=10;Zr<36;++Zr)Kr[Xr++]=Zr;function Yr(t){return $r.charAt(t)}function Qr(t,e){t=Kr[t.charCodeAt(e)];return null==t?-1:t}function Jr(t){var e=Wr();return e.fromInt(t),e}function ti(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function ei(t){this.m=t}function ni(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function ri(t,e){return t&e}function ii(t,e){return t|e}function oi(t,e){return t^e}function ai(t,e){return t&~e}function si(){}function li(t){return t}function ui(t){this.r2=Wr(),this.q3=Wr(),y.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}ei.prototype.convert=function(t){return t.s<0||0<=t.compareTo(this.m)?t.mod(this.m):t},ei.prototype.revert=function(t){return t},ei.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},ei.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},ei.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},ni.prototype.convert=function(t){var e=Wr();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&0<e.compareTo(y.ZERO)&&this.m.subTo(e,e),e},ni.prototype.revert=function(t){var e=Wr();return t.copyTo(e),this.reduce(e),e},ni.prototype.reduce=function(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=(r=32767&t.data[e])*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM,r=e+this.m.t;for(t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)},ni.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},ni.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},y.prototype.copyTo=function(t){for(var e=this.t-1;0<=e;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s},y.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,0<t?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0},y.prototype.fromString=function(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var r=t.length,i=!1,o=0;0<=--r;){var a=8==n?255&t[r]:Qr(t,r);a<0?"-"==t.charAt(r)&&(i=!0):(i=!1,0==o?this.data[this.t++]=a:o+n>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this.data[this.t++]=a>>this.DB-o):this.data[this.t-1]|=a<<o,(o+=n)>=this.DB&&(o-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,0<o)&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o),this.clamp(),i&&y.ZERO.subTo(this,this)},y.prototype.clamp=function(){for(var t=this.s&this.DM;0<this.t&&this.data[this.t-1]==t;)--this.t},y.prototype.dlShiftTo=function(t,e){for(var n=this.t-1;0<=n;--n)e.data[n+t]=this.data[n];for(n=t-1;0<=n;--n)e.data[n]=0;e.t=this.t+t,e.s=this.s},y.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e.data[n-t]=this.data[n];e.t=Math.max(this.t-t,0),e.s=this.s},y.prototype.lShiftTo=function(t,e){for(var n=t%this.DB,r=this.DB-n,i=(1<<r)-1,o=Math.floor(t/this.DB),a=this.s<<n&this.DM,s=this.t-1;0<=s;--s)e.data[s+o+1]=this.data[s]>>r|a,a=(this.data[s]&i)<<n;for(s=o-1;0<=s;--s)e.data[s]=0;e.data[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()},y.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var r=t%this.DB,i=this.DB-r,o=(1<<r)-1;e.data[0]=this.data[n]>>r;for(var a=n+1;a<this.t;++a)e.data[a-n-1]|=(this.data[a]&o)<<i,e.data[a-n]=this.data[a]>>r;0<r&&(e.data[this.t-n-1]|=(this.s&o)<<i),e.t=this.t-n,e.clamp()}},y.prototype.subTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this.data[n]-t.data[n],e.data[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;n<this.t;)r+=this.data[n],e.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r-=t.data[n],e.data[n++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e.data[n++]=this.DV+r:0<r&&(e.data[n++]=r),e.t=n,e.clamp()},y.prototype.multiplyTo=function(t,e){var n=this.abs(),r=t.abs(),i=n.t;for(e.t=i+r.t;0<=--i;)e.data[i]=0;for(i=0;i<r.t;++i)e.data[i+n.t]=n.am(0,r.data[i],e,i,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&y.ZERO.subTo(e,e)},y.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;0<=--n;)t.data[n]=0;for(n=0;n<e.t-1;++n){var r=e.am(n,e.data[n],t,2*n,0,1);(t.data[n+e.t]+=e.am(n+1,2*e.data[n],t,2*n+1,r,e.t-n-1))>=e.DV&&(t.data[n+e.t]-=e.DV,t.data[n+e.t+1]=1)}0<t.t&&(t.data[t.t-1]+=e.am(n,e.data[n],t,2*n,0,1)),t.s=0,t.clamp()},y.prototype.divRemTo=function(t,e,n){var r=t.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)null!=e&&e.fromInt(0),null!=n&&this.copyTo(n);else{null==n&&(n=Wr());var o=Wr(),a=this.s,t=t.s,s=this.DB-ti(r.data[r.t-1]),l=(0<s?(r.lShiftTo(s,o),i.lShiftTo(s,n)):(r.copyTo(o),i.copyTo(n)),o.t),u=o.data[l-1];if(0!=u){var r=u*(1<<this.F1)+(1<l?o.data[l-2]>>this.F2:0),c=this.FV/r,h=(1<<this.F1)/r,d=1<<this.F2,p=n.t,f=p-l,g=null==e?Wr():e;for(o.dlShiftTo(f,g),0<=n.compareTo(g)&&(n.data[n.t++]=1,n.subTo(g,n)),y.ONE.dlShiftTo(l,g),g.subTo(o,o);o.t<l;)o.data[o.t++]=0;for(;0<=--f;){var m=n.data[--p]==u?this.DM:Math.floor(n.data[p]*c+(n.data[p-1]+d)*h);if((n.data[p]+=o.am(0,m,n,f,0,l))<m)for(o.dlShiftTo(f,g),n.subTo(g,n);n.data[p]<--m;)n.subTo(g,n)}null!=e&&(n.drShiftTo(l,e),a!=t)&&y.ZERO.subTo(e,e),n.t=l,n.clamp(),0<s&&n.rShiftTo(s,n),a<0&&y.ZERO.subTo(n,n)}}}},y.prototype.invDigit=function(){var t,e;return this.t<1||0==(1&(t=this.data[0]))?0:0<(e=(e=(e=(e=(e=3&t)*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)?this.DV-e:-e},y.prototype.isEven=function(){return 0==(0<this.t?1&this.data[0]:this.s)},y.prototype.exp=function(t,e){if(4294967295<t||t<1)return y.ONE;var n,r=Wr(),i=Wr(),o=e.convert(this),a=ti(t)-1;for(o.copyTo(r);0<=--a;)e.sqrTo(r,i),0<(t&1<<a)?e.mulTo(i,o,r):(n=r,r=i,i=n);return e.revert(r)},y.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,r=(1<<e)-1,i=!1,o="",a=this.t,s=this.DB-a*this.DB%e;if(0<a--)for(s<this.DB&&0<(n=this.data[a]>>s)&&(i=!0,o=Yr(n));0<=a;)s<e?(n=(this.data[a]&(1<<s)-1)<<e-s,n|=this.data[--a]>>(s+=this.DB-e)):(n=this.data[a]>>(s-=e)&r,s<=0&&(s+=this.DB,--a)),(i=0<n?!0:i)&&(o+=Yr(n));return i?o:"0"},y.prototype.negate=function(){var t=Wr();return y.ZERO.subTo(this,t),t},y.prototype.abs=function(){return this.s<0?this.negate():this},y.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;0<=--n;)if(0!=(e=this.data[n]-t.data[n]))return e;return 0},y.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+ti(this.data[this.t-1]^this.s&this.DM)},y.prototype.mod=function(t){var e=Wr();return this.abs().divRemTo(t,null,e),this.s<0&&0<e.compareTo(y.ZERO)&&t.subTo(e,e),e},y.prototype.modPowInt=function(t,e){return e=new(t<256||e.isEven()?ei:ni)(e),this.exp(t,e)},y.ZERO=Jr(0),y.ONE=Jr(1),si.prototype.convert=li,si.prototype.revert=li,si.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},si.prototype.sqrTo=function(t,e){t.squareTo(e)},ui.prototype.convert=function(t){var e;return t.s<0||t.t>2*this.m.t?t.mod(this.m):t.compareTo(this.m)<0?t:(e=Wr(),t.copyTo(e),this.reduce(e),e)},ui.prototype.revert=function(t){return t},ui.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)},ui.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},ui.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var ci,hi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],di=(1<<26)/hi[hi.length-1];function pi(t){var e,n,r;if(t.algorithm in yi.oids)return r=yi.oids[t.algorithm],r=h.oidToDer(r).getBytes(),e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),(n=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[])).value.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,r)),n.value.push(h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")),r=h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,t.digest().getBytes()),e.value.push(n),e.value.push(r),h.toDer(e).getBytes();throw(n=new Error("Unknown message digest algorithm.")).algorithm=t.algorithm,n}function fi(t,e,n){if(n)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);var r;for(e.dP||(e.dP=e.d.mod(e.p.subtract(ci.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(ci.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));0<=(r=new ci(D.util.bytesToHex(D.random.getBytes(e.n.bitLength()/8)),16)).compareTo(e.n)||!r.gcd(e.n).equals(ci.ONE););for(var i=(t=t.multiply(r.modPow(e.e,e.n)).mod(e.n)).mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);return i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o).multiply(r.modInverse(e.n)).mod(e.n)}y.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},y.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||36<t)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),r=Jr(n),i=Wr(),o=Wr(),a="";for(this.divRemTo(r,i,o);0<i.signum();)a=(n+o.intValue()).toString(t).substr(1)+a,i.divRemTo(r,i,o);return o.intValue().toString(t)+a},y.prototype.fromRadix=function(t,e){this.fromInt(0);for(var n=this.chunkSize(e=null==e?10:e),r=Math.pow(e,n),i=!1,o=0,a=0,s=0;s<t.length;++s){var l=Qr(t,s);l<0?"-"==t.charAt(s)&&0==this.signum()&&(i=!0):(a=e*a+l,++o>=n&&(this.dMultiply(r),this.dAddOffset(a,0),a=o=0))}0<o&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(a,0)),i&&y.ZERO.subTo(this,this)},y.prototype.fromNumber=function(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(y.ONE.shiftLeft(t-1),ii,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(y.ONE.shiftLeft(t-1),this);else{var n=new Array,r=7&t;n.length=1+(t>>3),e.nextBytes(n),0<r?n[0]&=(1<<r)-1:n[0]=0,this.fromString(n,256)}},y.prototype.bitwiseTo=function(t,e,n){for(var r,i=Math.min(t.t,this.t),o=0;o<i;++o)n.data[o]=e(this.data[o],t.data[o]);if(t.t<this.t){for(r=t.s&this.DM,o=i;o<this.t;++o)n.data[o]=e(this.data[o],r);n.t=this.t}else{for(r=this.s&this.DM,o=i;o<t.t;++o)n.data[o]=e(r,t.data[o]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},y.prototype.changeBit=function(t,e){return t=y.ONE.shiftLeft(t),this.bitwiseTo(t,e,t),t},y.prototype.addTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this.data[n]+t.data[n],e.data[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;n<this.t;)r+=this.data[n],e.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r+=t.data[n],e.data[n++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,0<r?e.data[n++]=r:r<-1&&(e.data[n++]=this.DV+r),e.t=n,e.clamp()},y.prototype.dMultiply=function(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},y.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}},y.prototype.multiplyLowerTo=function(t,e,n){var r,i=Math.min(this.t+t.t,e);for(n.s=0,n.t=i;0<i;)n.data[--i]=0;for(r=n.t-this.t;i<r;++i)n.data[i+this.t]=this.am(0,t.data[i],n,i,0,this.t);for(r=Math.min(t.t,e);i<r;++i)this.am(0,t.data[i],n,i,0,e-i);n.clamp()},y.prototype.multiplyUpperTo=function(t,e,n){var r=n.t=this.t+t.t- --e;for(n.s=0;0<=--r;)n.data[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)n.data[this.t+r-e]=this.am(e-r,t.data[r],n,0,0,this.t+r-e);n.clamp(),n.drShiftTo(1,n)},y.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(0<this.t)if(0==e)n=this.data[0]%t;else for(var r=this.t-1;0<=r;--r)n=(e*n+this.data[r])%t;return n},y.prototype.millerRabin=function(t){var e=this.subtract(y.ONE),n=e.getLowestSetBit();if(n<=0)return!1;for(var r,i=e.shiftRight(n),o={nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(256*Math.random())}},a=0;a<t;++a){for(;(r=new y(this.bitLength(),o)).compareTo(y.ONE)<=0||0<=r.compareTo(e););var s=r.modPow(i,this);if(0!=s.compareTo(y.ONE)&&0!=s.compareTo(e)){for(var l=1;l++<n&&0!=s.compareTo(e);)if(0==(s=s.modPowInt(2,this)).compareTo(y.ONE))return!1;if(0!=s.compareTo(e))return!1}}return!0},y.prototype.clone=function(){var t=Wr();return this.copyTo(t),t},y.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},y.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},y.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},y.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},y.prototype.toByteArray=function(){var t,e=this.t,n=new Array,r=(n[0]=this.s,this.DB-e*this.DB%8),i=0;if(0<e--)for(r<this.DB&&(t=this.data[e]>>r)!=(this.s&this.DM)>>r&&(n[i++]=t|this.s<<this.DB-r);0<=e;)r<8?(t=(this.data[e]&(1<<r)-1)<<8-r,t|=this.data[--e]>>(r+=this.DB-8)):(t=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),0!=(128&t)&&(t|=-256),0==i&&(128&this.s)!=(128&t)&&++i,(0<i||t!=this.s)&&(n[i++]=t);return n},y.prototype.equals=function(t){return 0==this.compareTo(t)},y.prototype.min=function(t){return this.compareTo(t)<0?this:t},y.prototype.max=function(t){return 0<this.compareTo(t)?this:t},y.prototype.and=function(t){var e=Wr();return this.bitwiseTo(t,ri,e),e},y.prototype.or=function(t){var e=Wr();return this.bitwiseTo(t,ii,e),e},y.prototype.xor=function(t){var e=Wr();return this.bitwiseTo(t,oi,e),e},y.prototype.andNot=function(t){var e=Wr();return this.bitwiseTo(t,ai,e),e},y.prototype.not=function(){for(var t=Wr(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t},y.prototype.shiftLeft=function(t){var e=Wr();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},y.prototype.shiftRight=function(t){var e=Wr();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},y.prototype.getLowestSetBit=function(){for(var t,e,n=0;n<this.t;++n)if(0!=this.data[n])return n*this.DB+(t=this.data[n],e=void 0,0==t?-1:((e=0)==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e));return this.s<0?this.t*this.DB:-1},y.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=(t=>{for(var e=0;0!=t;)t&=t-1,++e;return e})(this.data[n]^e);return t},y.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this.data[e]&1<<t%this.DB)},y.prototype.setBit=function(t){return this.changeBit(t,ii)},y.prototype.clearBit=function(t){return this.changeBit(t,ai)},y.prototype.flipBit=function(t){return this.changeBit(t,oi)},y.prototype.add=function(t){var e=Wr();return this.addTo(t,e),e},y.prototype.subtract=function(t){var e=Wr();return this.subTo(t,e),e},y.prototype.multiply=function(t){var e=Wr();return this.multiplyTo(t,e),e},y.prototype.divide=function(t){var e=Wr();return this.divRemTo(t,e,null),e},y.prototype.remainder=function(t){var e=Wr();return this.divRemTo(t,null,e),e},y.prototype.divideAndRemainder=function(t){var e=Wr(),n=Wr();return this.divRemTo(t,e,n),new Array(e,n)},y.prototype.modPow=function(t,e){var n=t.bitLength(),r=Jr(1);if(n<=0)return r;var i=n<18?1:n<48?3:n<144?4:n<768?5:6,o=new(n<8?ei:e.isEven()?ui:ni)(e),a=new Array,s=3,l=i-1,u=(1<<i)-1;if(a[1]=o.convert(this),1<i){var c=Wr();for(o.sqrTo(a[1],c);s<=u;)a[s]=Wr(),o.mulTo(c,a[s-2],a[s]),s+=2}for(var h,d,p=t.t-1,f=!0,g=Wr(),n=ti(t.data[p])-1;0<=p;){for(l<=n?h=t.data[p]>>n-l&u:(h=(t.data[p]&(1<<n+1)-1)<<l-n,0<p&&(h|=t.data[p-1]>>this.DB+n-l)),s=i;0==(1&h);)h>>=1,--s;if((n-=s)<0&&(n+=this.DB,--p),f)a[h].copyTo(r),f=!1;else{for(;1<s;)o.sqrTo(r,g),o.sqrTo(g,r),s-=2;0<s?o.sqrTo(r,g):(d=r,r=g,g=d),o.mulTo(g,a[h],r)}for(;0<=p&&0==(t.data[p]&1<<n);)o.sqrTo(r,g),d=r,r=g,g=d,--n<0&&(n=this.DB-1,--p)}return o.revert(r)},y.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return y.ZERO;for(var n=t.clone(),r=this.clone(),i=Jr(1),o=Jr(0),a=Jr(0),s=Jr(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;r.isEven();)r.rShiftTo(1,r),e?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(t,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);0<=n.compareTo(r)?(n.subTo(r,n),e&&i.subTo(a,i),o.subTo(s,o)):(r.subTo(n,r),e&&a.subTo(i,a),s.subTo(o,s))}return 0!=r.compareTo(y.ONE)?y.ZERO:0<=s.compareTo(t)?s.subtract(t):s.signum()<0&&(s.addTo(t,s),s.signum()<0)?s.add(t):s},y.prototype.pow=function(t){return this.exp(t,new si)},y.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone(),r=(e.compareTo(n)<0&&(t=e,e=n,n=t),e.getLowestSetBit());if((t=n.getLowestSetBit())<0)return e;for(0<(t=r<t?r:t)&&(e.rShiftTo(t,e),n.rShiftTo(t,n));0<e.signum();)0<(r=e.getLowestSetBit())&&e.rShiftTo(r,e),0<(r=n.getLowestSetBit())&&n.rShiftTo(r,n),0<=e.compareTo(n)?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return 0<t&&n.lShiftTo(t,n),n},y.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n.data[0]<=hi[hi.length-1]){for(e=0;e<hi.length;++e)if(n.data[0]==hi[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<hi.length;){for(var r=hi[e],i=e+1;i<hi.length&&r<di;)r*=hi[i++];for(r=n.modInt(r);e<i;)if(r%hi[e++]==0)return!1}return n.millerRabin(t)},F(function(t){var t=t.exports=D.sha1=D.sha1||{},c=((D.md.sha1=D.md.algorithms.sha1=t).create=function(){e||(c=String.fromCharCode(128),c+=D.util.fillString(String.fromCharCode(0),64),e=!0);var a=null,s=D.util.createBuffer(),l=new Array(80),u={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){u.messageLength=0,u.fullMessageLength=u.messageLength64=[];for(var t=u.messageLengthSize/4,e=0;e<t;++e)u.fullMessageLength.push(0);return s=D.util.createBuffer(),a={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},u}};return u.start(),u.update=function(t,e){var n=(t="utf8"===e?D.util.encodeUtf8(t):t).length;u.messageLength+=n;for(var n=[n/4294967296>>>0,n>>>0],r=u.fullMessageLength.length-1;0<=r;--r)u.fullMessageLength[r]+=n[1],n[1]=n[0]+(u.fullMessageLength[r]/4294967296>>>0),u.fullMessageLength[r]=u.fullMessageLength[r]>>>0,n[0]=n[1]/4294967296>>>0;return s.putBytes(t),h(a,l,s),(2048<s.read||0===s.length())&&s.compact(),u},u.digest=function(){for(var t,e=D.util.createBuffer(),n=(e.putBytes(s.bytes()),u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize),r=(e.putBytes(c.substr(0,u.blockLength-(n&u.blockLength-1))),8*u.fullMessageLength[0]),i=0;i<u.fullMessageLength.length-1;++i)r+=(t=8*u.fullMessageLength[i+1])/4294967296>>>0,e.putInt32(r>>>0),r=t>>>0;e.putInt32(r);var n={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3,h4:a.h4},o=(h(n,l,e),D.util.createBuffer());return o.putInt32(n.h0),o.putInt32(n.h1),o.putInt32(n.h2),o.putInt32(n.h3),o.putInt32(n.h4),o},u},null),e=!1;function h(t,e,n){for(var r,i,o,a,s,l,u,c=n.length();64<=c;){for(i=t.h0,o=t.h1,a=t.h2,s=t.h3,l=t.h4,u=0;u<16;++u)r=n.getInt32(),r=(i<<5|i>>>27)+(s^o&(a^s))+l+1518500249+(e[u]=r),l=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=r;for(;u<20;++u)r=e[u-3]^e[u-8]^e[u-14]^e[u-16],r=(i<<5|i>>>27)+(s^o&(a^s))+l+1518500249+(e[u]=r=r<<1|r>>>31),l=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=r;for(;u<32;++u)r=e[u-3]^e[u-8]^e[u-14]^e[u-16],r=(i<<5|i>>>27)+(o^a^s)+l+1859775393+(e[u]=r=r<<1|r>>>31),l=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=r;for(;u<40;++u)r=e[u-6]^e[u-16]^e[u-28]^e[u-32],r=(i<<5|i>>>27)+(o^a^s)+l+1859775393+(e[u]=r=r<<2|r>>>30),l=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=r;for(;u<60;++u)r=e[u-6]^e[u-16]^e[u-28]^e[u-32],r=(i<<5|i>>>27)+(o&a|s&(o^a))+l+2400959708+(e[u]=r=r<<2|r>>>30),l=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=r;for(;u<80;++u)r=e[u-6]^e[u-16]^e[u-28]^e[u-32],r=(i<<5|i>>>27)+(o^a^s)+l+3395469782+(e[u]=r=r<<2|r>>>30),l=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=r;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+a|0,t.h3=t.h3+s|0,t.h4=t.h4+l|0,c-=64}}}),F(function(t){t=t.exports=D.pkcs1=D.pkcs1||{};function m(t,e,n){n=n||D.md.sha1.create();for(var r="",i=Math.ceil(e/n.digestLength),o=0;o<i;++o){var a=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);n.start(),n.update(t+a),r+=n.digest().getBytes()}return r.substring(0,e)}t.encode_rsa_oaep=function(t,e,n){"string"==typeof n?(a=n,r=arguments[3]||void 0,i=arguments[4]||void 0):n&&(a=n.label||void 0,r=n.seed||void 0,i=n.md||void 0,n.mgf1)&&n.mgf1.md&&(o=n.mgf1.md),i?i.start():i=D.md.sha1.create(),o=o||i;var r,i,o,n=Math.ceil(t.n.bitLength()/8),t=n-2*i.digestLength-2;if(e.length>t)throw(c=new Error("RSAES-OAEP input message length is too long.")).length=e.length,c.maxLength=t,c;i.update(a=a||"","raw");for(var a=i.digest(),s="",l=t-e.length,u=0;u<l;u++)s+="\0";t=a.getBytes()+s+""+e;if(r){if(r.length!==i.digestLength)throw(c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=r.length,c.digestLength=i.digestLength,c}else r=D.random.getBytes(i.digestLength);var a=m(r,n-i.digestLength-1,o),e=D.util.xorBytes(t,a,t.length),c=m(e,i.digestLength,o);return"\0"+D.util.xorBytes(r,c,r.length)+e},t.decode_rsa_oaep=function(t,e,n){"string"==typeof n?(a=n,r=arguments[3]||void 0):n&&(a=n.label||void 0,r=n.md||void 0,n.mgf1)&&n.mgf1.md&&(i=n.mgf1.md);var r,i,n=Math.ceil(t.n.bitLength()/8);if(e.length!==n)throw(c=new Error("RSAES-OAEP encoded message length is invalid.")).length=e.length,c.expectedLength=n,c;if(void 0===r?r=D.md.sha1.create():r.start(),i=i||r,n<2*r.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r.update(a=a||"","raw");for(var o=r.digest().getBytes(),t=e.charAt(0),a=e.substring(1,r.digestLength+1),e=e.substring(1+r.digestLength),s=m(e,r.digestLength,i),s=m(D.util.xorBytes(a,s,a.length),n-r.digestLength-1,i),l=D.util.xorBytes(e,s,e.length),u=l.substring(0,r.digestLength),c="\0"!==t,h=0;h<r.digestLength;++h)c|=o.charAt(h)!==u.charAt(h);for(var d=1,p=r.digestLength,f=r.digestLength;f<l.length;f++){var g=l.charCodeAt(f);c|=g&(d?65534:0),p+=d&=1&g^1}if(c||1!==l.charCodeAt(p))throw new Error("Invalid RSAES-OAEP padding.");return l.substring(p+1)}}),F(function(t){function m(t,e,n,r){var i=y(t,e),o=(o=i.bitLength())<=100?27:o<=150?18:o<=200?15:o<=250?12:o<=300?9:o<=350?8:o<=400?7:o<=500?6:o<=600?5:o<=800?4:o<=1250?3:2,a=10;!function t(e,n,r,i,o,a,s){var l=+new Date;do{if((e=e.bitLength()>n?y(n,r):e).isProbablePrime(o))return s(null,e)}while(e.dAddOffset(u[i++%8],0),a<0||+new Date-l<a);D.util.setImmediate(function(){t(e,n,r,i,o,a,s)})}(i,t,e,0,o="millerRabinTests"in n?n.millerRabinTests:o,a="maxBlockTime"in n?n.maxBlockTime:a,r)}function y(t,e){e=new v(t,e),t-=1;return e.testBit(t)||e.bitwiseTo(v.ONE.shiftLeft(t),r,e),e.dAddOffset(31-e.mod(n).byteValue(),0),e}var v,u,n,r;D.prime?t.exports=D.prime:(t=t.exports=D.prime=D.prime||{},v=D.jsbn.BigInteger,u=[6,4,2,4,2,4,6,2],(n=new v(null)).fromInt(30),r=function(t,e){return t|e},t.generateProbablePrime=function(t,e,n){"function"==typeof e&&(n=e,e={});var r,o,a,i,s,l,u,c,h,d,p=(e=e||{}).algorithm||"PRIMEINC",f=((p="string"==typeof p?{name:p}:p).options=p.options||{},e.prng||D.random);if("PRIMEINC"===p.name){return e=t,t={nextBytes:function(t){for(var e=f.getBytesSync(t.length),n=0;n<t.length;++n)t[n]=e.charCodeAt(n)}},r=p.options,n=n,"workers"in r?(o=e,a=t,i=r,s=n,"undefined"==typeof Worker?m(o,a,i,s):(l=y(o,a),u=i.workers,h=30*(c=i.workLoad||100)/8,d=i.workerScript||"forge/prime.worker.js",-1===u?D.util.estimateCores(function(t,e){u=(e=t?2:e)-1,g()}):void g())):m(e,t,r,n);function g(){u=Math.max(1,u);for(var r=[],t=0;t<u;++t)r[t]=new Worker(d);for(t=0;t<u;++t)r[t].addEventListener("message",e);var i=!1;function e(t){if(!i){var e=t.data;if(e.found){for(var n=0;n<r.length;++n)r[n].terminate();return i=!0,s(null,new v(e.prime,16))}e=(l=l.bitLength()>o?y(o,a):l).toString(16);t.target.postMessage({hex:e,workLoad:c}),l.dAddOffset(h,0)}}}}throw new Error("Invalid prime generation algorithm: "+p.name)})}),void 0===ci&&(ci=D.jsbn.BigInteger);var gi=D.util.isNodejs?zr:null,h=D.asn1,mi=D.util,yi=(D.pki=D.pki||{},D.pki.rsa=D.rsa=D.rsa||{},D.pki),vi=[6,4,2,4,2,4,6,2],_i={name:"PrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},wi={name:"RSAPrivateKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},bi={name:"RSAPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Ci=D.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]};function Ei(t,e,n){var r,i=D.util.createBuffer(),e=Math.ceil(e.n.bitLength()/8);if(t.length>e-11)throw(r=new Error("Message is too long for PKCS#1 v1.5 padding.")).length=t.length,r.max=e-11,r;i.putByte(0),i.putByte(n);var o=e-3-t.length;if(0===n||1===n)for(var a=0===n?0:255,s=0;s<o;++s)i.putByte(a);else for(;0<o;){for(var l=0,u=D.random.getBytes(o),s=0;s<o;++s)0===(a=u.charCodeAt(s))?++l:i.putByte(a);o=l}return i.putByte(0),i.putBytes(t),i}function Si(t,e,n,r){var e=Math.ceil(e.n.bitLength()/8),i=D.util.createBuffer(t),t=i.getByte(),o=i.getByte();if(0!==t||n&&0!==o&&1!==o||!n&&2!=o||n&&0===o&&void 0===r)throw new Error("Encryption block is invalid.");var a=0;if(0===o){for(var a=e-3-r,s=0;s<a;++s)if(0!==i.getByte())throw new Error("Encryption block is invalid.")}else if(1===o)for(a=0;1<i.length();){if(255!==i.getByte()){--i.read;break}++a}else if(2===o)for(a=0;1<i.length();){if(0===i.getByte()){--i.read;break}++a}if(0!==i.getByte()||a!==e-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function Ti(t){t=t.toString(16),"8"<=t[0]&&(t="00"+t),t=D.util.hexToBytes(t);return 1<t.length&&(0===t.charCodeAt(0)&&0==(128&t.charCodeAt(1))||255===t.charCodeAt(0)&&128==(128&t.charCodeAt(1)))?t.substr(1):t}function Ai(t){return D.util.isNodejs&&"function"==typeof gi[t]}function Ii(t){return void 0!==mi.globalScope&&"object"==typeof mi.globalScope.crypto&&"object"==typeof mi.globalScope.crypto.subtle&&"function"==typeof mi.globalScope.crypto.subtle[t]}function Li(t){return void 0!==mi.globalScope&&"object"==typeof mi.globalScope.msCrypto&&"object"==typeof mi.globalScope.msCrypto.subtle&&"function"==typeof mi.globalScope.msCrypto.subtle[t]}function ki(t){for(var e=D.util.hexToBytes(t.toString(16)),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n}yi.rsa.encrypt=function(t,e,n){for(var r,i=n,o=Math.ceil(e.n.bitLength()/8),n=(!1!==n&&!0!==n?(i=2===n,r=Ei(t,e,n)):(r=D.util.createBuffer()).putBytes(t),new ci(r.toHex(),16)),t=fi(n,e,i).toString(16),a=D.util.createBuffer(),s=o-Math.ceil(t.length/2);0<s;)a.putByte(0),--s;return a.putBytes(D.util.hexToBytes(t)),a.getBytes()},yi.rsa.decrypt=function(t,e,n,r){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i)throw(o=new Error("Encrypted message length is invalid.")).length=t.length,o.expected=i,o;var o=new ci(D.util.createBuffer(t).toHex(),16);if(0<=o.compareTo(e.n))throw new Error("Encrypted message is invalid.");for(var t=fi(o,e,n).toString(16),a=D.util.createBuffer(),s=i-Math.ceil(t.length/2);0<s;)a.putByte(0),--s;return a.putBytes(D.util.hexToBytes(t)),!1!==r?Si(a.getBytes(),e,n):a.getBytes()},yi.rsa.createKeyPairGenerationState=function(t,e,n){t=(t="string"==typeof t?parseInt(t,10):t)||2048;var r=(n=n||{}).prng||D.random,i={nextBytes:function(t){for(var e=r.getBytesSync(t.length),n=0;n<t.length;++n)t[n]=e.charCodeAt(n)}},n=n.algorithm||"PRIMEINC";if("PRIMEINC"!==n)throw new Error("Invalid key generation algorithm: "+n);return(n={algorithm:n,state:0,bits:t,rng:i,eInt:e||65537,e:new ci(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null}).e.fromInt(n.eInt),n},yi.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");for(var n,r,i=new ci(null),o=(i.fromInt(30),0),a=function(t,e){return t|e},s=+new Date,l=0;null===t.keys&&(e<=0||l<e);)0===t.state?(r=(n=null===t.p?t.pBits:t.qBits)-1,0===t.pqState?(t.num=new ci(n,t.rng),t.num.testBit(r)||t.num.bitwiseTo(ci.ONE.shiftLeft(r),a,t.num),t.num.dAddOffset(31-t.num.mod(i).byteValue(),0),o=0,++t.pqState):1===t.pqState?t.num.bitLength()>n?t.pqState=0:t.num.isProbablePrime((r=t.num.bitLength())<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2)?++t.pqState:t.num.dAddOffset(vi[o++%8],0):2===t.pqState?t.pqState=0===t.num.subtract(ci.ONE).gcd(t.e).compareTo(ci.ONE)?3:0:3===t.pqState&&(t.pqState=0,null===t.p?t.p=t.num:t.q=t.num,null!==t.p&&null!==t.q&&++t.state,t.num=null)):1===t.state?(t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state):2===t.state?(t.p1=t.p.subtract(ci.ONE),t.q1=t.q.subtract(ci.ONE),t.phi=t.p1.multiply(t.q1),++t.state):3===t.state?0===t.phi.gcd(t.e).compareTo(ci.ONE)?++t.state:(t.p=null,t.q=null,t.state=0):4===t.state?(t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0)):5===t.state&&(n=t.e.modInverse(t.phi),t.keys={privateKey:yi.rsa.setPrivateKey(t.n,t.e,n,t.p,t.q,n.mod(t.p1),n.mod(t.q1),t.q.modInverse(t.p)),publicKey:yi.rsa.setPublicKey(t.n,t.e)}),l+=(r=+new Date)-s,s=r;return null!==t.keys},yi.rsa.generateKeyPair=function(t,e,n,r){if(1===arguments.length?"object"==typeof t?(n=t,t=void 0):"function"==typeof t&&(r=t,t=void 0):2===arguments.length?"number"==typeof t?"function"==typeof e?(r=e,e=void 0):"number"!=typeof e&&(n=e,e=void 0):(n=t,r=e,e=t=void 0):3===arguments.length&&("number"==typeof e?"function"==typeof n&&(r=n,n=void 0):(r=n,n=e,e=void 0)),n=n||{},void 0===t&&(t=n.bits||2048),void 0===e&&(e=n.e||65537),!D.options.usePureJavaScript&&!n.prng&&256<=t&&t<=16384&&(65537===e||3===e))if(r){if(Ai("generateKeyPair"))return gi.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(t,e,n){if(t)return r(t);r(null,{privateKey:yi.privateKeyFromPem(n),publicKey:yi.publicKeyFromPem(e)})});if(Ii("generateKey")&&Ii("exportKey"))return mi.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:ki(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(t){return mi.globalScope.crypto.subtle.exportKey("pkcs8",t.privateKey)}).then(void 0,function(t){r(t)}).then(function(t){t&&(t=yi.privateKeyFromAsn1(h.fromDer(D.util.createBuffer(t))),r(null,{privateKey:t,publicKey:yi.setRsaPublicKey(t.n,t.e)}))});if(Li("generateKey")&&Li("exportKey"))return(i=mi.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:ki(e),hash:{name:"SHA-256"}},!0,["sign","verify"])).oncomplete=function(t){t=t.target.result,t=mi.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);t.oncomplete=function(t){t=t.target.result,t=yi.privateKeyFromAsn1(h.fromDer(D.util.createBuffer(t)));r(null,{privateKey:t,publicKey:yi.setRsaPublicKey(t.n,t.e)})},t.onerror=function(t){r(t)}},void(i.onerror=function(t){r(t)})}else if(Ai("generateKeyPairSync"))return i=gi.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),{privateKey:yi.privateKeyFromPem(i.privateKey),publicKey:yi.publicKeyFromPem(i.publicKey)};var i=yi.rsa.createKeyPairGenerationState(t,e,n);if(!r)return yi.rsa.stepKeyPairGenerationState(i,0),i.keys;var o=i,t=n,a=r,s=("function"==typeof t&&(a=t,t={}),{algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}});function l(){u(o.pBits,function(t,e){return t?a(t):(o.p=e,null!==o.q?c(t,o.q):void u(o.qBits,c))})}function u(t,e){D.prime.generateProbablePrime(t,s,e)}function c(t,e){if(t)return a(t);o.q=e,o.p.compareTo(o.q)<0&&(t=o.p,o.p=o.q,o.q=t),0!==o.p.subtract(ci.ONE).gcd(o.e).compareTo(ci.ONE)?(o.p=null,l()):0!==o.q.subtract(ci.ONE).gcd(o.e).compareTo(ci.ONE)?(o.q=null,u(o.qBits,c)):(o.p1=o.p.subtract(ci.ONE),o.q1=o.q.subtract(ci.ONE),o.phi=o.p1.multiply(o.q1),0!==o.phi.gcd(o.e).compareTo(ci.ONE)?(o.p=o.q=null,l()):(o.n=o.p.multiply(o.q),o.n.bitLength()!==o.bits?(o.q=null,u(o.qBits,c)):(e=o.e.modInverse(o.phi),o.keys={privateKey:yi.rsa.setPrivateKey(o.n,o.e,e,o.p,o.q,e.mod(o.p1),e.mod(o.q1),o.q.modInverse(o.p)),publicKey:yi.rsa.setPublicKey(o.n,o.e)},a(null,o.keys))))}"prng"in t&&(s.prng=t.prng),l()},yi.setRsaPublicKey=yi.rsa.setPublicKey=function(t,e){var r={n:t,e:e,encrypt:function(t,e,n){if("string"==typeof e?e=e.toUpperCase():void 0===e&&(e="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===e)e={encode:function(t,e,n){return Ei(t,e,2).getBytes()}};else if("RSA-OAEP"===e||"RSAES-OAEP"===e)e={encode:function(t,e){return D.pkcs1.encode_rsa_oaep(e,t,n)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(e))e={encode:function(t){return t}};else if("string"==typeof e)throw new Error('Unsupported encryption scheme: "'+e+'".');e=e.encode(t,r,!0);return yi.rsa.encrypt(e,r,!0)},verify:function(t,e,n){"string"==typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(t,e){return e=Si(e,r,!0),t===h.fromDer(e).value[1].value}}:"NONE"!==n&&"NULL"!==n&&null!==n||(n={verify:function(t,e){return t===(e=Si(e,r,!0))}});e=yi.rsa.decrypt(e,r,!0,!1);return n.verify(t,e,r.n.bitLength())}};return r},yi.setRsaPrivateKey=yi.rsa.setPrivateKey=function(t,e,n,r,i,o,a,s){var l={n:t,e:e,d:n,p:r,q:i,dP:o,dQ:a,qInv:s,decrypt:function(t,e,n){"string"==typeof e?e=e.toUpperCase():void 0===e&&(e="RSAES-PKCS1-V1_5");t=yi.rsa.decrypt(t,l,!1,!1);if("RSAES-PKCS1-V1_5"===e)e={decode:Si};else if("RSA-OAEP"===e||"RSAES-OAEP"===e)e={decode:function(t,e){return D.pkcs1.decode_rsa_oaep(e,t,n)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(e))throw new Error('Unsupported encryption scheme: "'+e+'".');e={decode:function(t){return t}}}return e.decode(t,l,!1)},sign:function(t,e){var n=!1,e=(void 0===(e="string"==typeof e?e.toUpperCase():e)||"RSASSA-PKCS1-V1_5"===e?(e={encode:pi},n=1):"NONE"!==e&&"NULL"!==e&&null!==e||(e={encode:function(){return t}},n=1),e.encode(t,l.n.bitLength()));return yi.rsa.encrypt(e,l,n)}};return l},yi.wrapRsaPrivateKey=function(t){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(yi.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(t).getBytes())])},yi.privateKeyFromAsn1=function(t){var e,n,r,i,o,a,s,l={};if(h.validate(t,_i,l,[])&&(t=h.fromDer(D.util.createBuffer(l.privateKey))),h.validate(t,wi,l={},t=[]))return e=D.util.createBuffer(l.privateKeyModulus).toHex(),n=D.util.createBuffer(l.privateKeyPublicExponent).toHex(),r=D.util.createBuffer(l.privateKeyPrivateExponent).toHex(),i=D.util.createBuffer(l.privateKeyPrime1).toHex(),o=D.util.createBuffer(l.privateKeyPrime2).toHex(),a=D.util.createBuffer(l.privateKeyExponent1).toHex(),s=D.util.createBuffer(l.privateKeyExponent2).toHex(),l=D.util.createBuffer(l.privateKeyCoefficient).toHex(),yi.setRsaPrivateKey(new ci(e,16),new ci(n,16),new ci(r,16),new ci(i,16),new ci(o,16),new ci(a,16),new ci(s,16),new ci(l,16));throw(e=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.")).errors=t,e},yi.privateKeyToAsn1=yi.privateKeyToRSAPrivateKey=function(t){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.n)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.e)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.d)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.p)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.q)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.dP)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.dQ)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.qInv))])},yi.publicKeyFromAsn1=function(t){var e={};if(h.validate(t,Ci,e,[])){var n,r=h.derToOid(e.publicKeyOid);if(r!==yi.oids.rsaEncryption)throw(n=new Error("Cannot read public key. Unknown OID.")).oid=r,n;t=e.rsaPublicKey}if(h.validate(t,bi,e,r=[]))return t=D.util.createBuffer(e.publicKeyModulus).toHex(),e=D.util.createBuffer(e.publicKeyExponent).toHex(),yi.setRsaPublicKey(new ci(t,16),new ci(e,16));throw(n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,n},yi.publicKeyToAsn1=yi.publicKeyToSubjectPublicKeyInfo=function(t){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(yi.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,[yi.publicKeyToRSAPublicKey(t)])])},yi.publicKeyToRSAPublicKey=function(t){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.n)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,Ti(t.e))])},D.jsbn.BigInteger;var _=D.asn1,xi=D.pki=D.pki||{},Di=(xi.pbe=D.pbe=D.pbe||{},xi.oids),Ni={name:"EncryptedPrivateKeyInfo",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Ri={name:"PBES2Algorithms",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Pi={name:"pkcs-12PbeParams",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"iterations"}]};function Oi(t,e){return t.start().update(e).digest().getBytes()}function Mi(t){var e,n;if(t){if(!(n=xi.oids[_.derToOid(t)]))throw(e=new Error("Unsupported PRF OID.")).oid=t,e.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],e}else n="hmacWithSHA1";return Bi(n)}function Bi(t){var e=D.md;switch(t){case"hmacWithSHA224":e=D.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var n=new Error("Unsupported PRF algorithm.");throw n.algorithm=t,n.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],n}if(e&&t in e)return e[t].create();throw new Error("Unknown hash algorithm: "+t)}function Ui(t,e,n,r){var i=D.util.createBuffer(),o=t.length>>1,a=o+(1&t.length),s=t.substr(0,a),t=t.substr(o,a),l=D.util.createBuffer(),u=D.hmac.create(),c=(n=e+n,Math.ceil(r/16)),h=Math.ceil(r/20),d=(u.start("MD5",s),D.util.createBuffer());l.putBytes(n);for(var p=0;p<c;++p)u.start(null,null),u.update(l.getBytes()),l.putBuffer(u.digest()),u.start(null,null),u.update(l.bytes()+n),d.putBuffer(u.digest());u.start("SHA1",t);var f=D.util.createBuffer();for(l.clear(),l.putBytes(n),p=0;p<h;++p)u.start(null,null),u.update(l.getBytes()),l.putBuffer(u.digest()),u.start(null,null),u.update(l.bytes()+n),f.putBuffer(u.digest());return i.putBytes(D.util.xorBytes(d.getBytes(),f.getBytes(),r)),i}function Fi(t,e,n){var r=!1;try{var i=t.deflate(e.fragment.getBytes());e.fragment=D.util.createBuffer(i),e.length=i.length,r=!0}catch(t){}return r}function Vi(t,e,n){var r=!1;try{var i=t.inflate(e.fragment.getBytes());e.fragment=D.util.createBuffer(i),e.length=i.length,r=!0}catch(t){}return r}function Hi(t,e){var n=0;switch(e){case 1:n=t.getByte();break;case 2:n=t.getInt16();break;case 3:n=t.getInt24();break;case 4:n=t.getInt32()}return D.util.createBuffer(t.getBytes(n))}function zi(t,e,n){t.putInt(n.length(),e<<3),t.putBuffer(n)}function ji(t){switch(t){case!0:return!0;case D.pki.certificateError.bad_certificate:return d.Alert.Description.bad_certificate;case D.pki.certificateError.unsupported_certificate:return d.Alert.Description.unsupported_certificate;case D.pki.certificateError.certificate_revoked:return d.Alert.Description.certificate_revoked;case D.pki.certificateError.certificate_expired:return d.Alert.Description.certificate_expired;case D.pki.certificateError.certificate_unknown:return d.Alert.Description.certificate_unknown;case D.pki.certificateError.unknown_ca:return d.Alert.Description.unknown_ca;default:return d.Alert.Description.bad_certificate}}xi.encryptPrivateKeyInfo=function(t,e,n){(n=n||{}).saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||"aes128",n.prfAlgorithm=n.prfAlgorithm||"sha1";var r,i,o,a,s,l,u,c=D.random.getBytesSync(n.saltSize),h=n.count,d=_.integerToDer(h);if(0===n.algorithm.indexOf("aes")||"des"===n.algorithm){switch(n.algorithm){case"aes128":i=s=16,o=Di["aes128-CBC"],a=D.aes.createEncryptionCipher;break;case"aes192":s=24,i=16,o=Di["aes192-CBC"],a=D.aes.createEncryptionCipher;break;case"aes256":s=32,i=16,o=Di["aes256-CBC"],a=D.aes.createEncryptionCipher;break;case"des":i=s=8,o=Di.desCBC,a=D.des.createEncryptionCipher;break;default:throw(u=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=n.algorithm,u}var p,f="hmacWith"+n.prfAlgorithm.toUpperCase(),g=Bi(f),g=D.pkcs5.pbkdf2(e,c,h,s,g),m=D.random.getBytesSync(i),f=((p=a(g)).start(m),p.update(_.toDer(t)),p.finish(),r=p.output.getBytes(),((t,e,n,r)=>(t=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,t),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,e.getBytes())]),"hmacWithSHA1"!==r&&t.value.push(_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,D.util.hexToBytes(n.toString(16))),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(xi.oids[r]).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.NULL,!1,"")])),t))(c,d,s,f)),f=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(Di.pkcs5PBES2).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(Di.pkcs5PBKDF2).getBytes()),f]),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(o).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,m)])])])}else{if("3des"!==n.algorithm)throw(u=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=n.algorithm,u;s=24,l=new D.util.ByteBuffer(c),g=xi.pbe.generatePkcs12Key(e,l,1,h,s),m=xi.pbe.generatePkcs12Key(e,l,2,h,s),(p=D.des.createEncryptionCipher(g)).start(m),p.update(_.toDer(t)),p.finish(),r=p.output.getBytes(),f=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(Di["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,c),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,d.getBytes())])])}return _.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[f,_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,r)])},xi.decryptPrivateKeyInfo=function(t,e){var n=null,r={},i=[];if(_.validate(t,Ni,r,i))return t=_.derToOid(r.encryptionOid),t=xi.pbe.getCipher(t,r.encryptionParams,e),e=D.util.createBuffer(r.encryptedData),t.update(e),t.finish()?_.fromDer(t.output):n;throw(r=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=i,r},xi.encryptedPrivateKeyToPem=function(t,e){t={type:"ENCRYPTED PRIVATE KEY",body:_.toDer(t).getBytes()};return D.pem.encode(t,{maxline:e})},xi.encryptedPrivateKeyFromPem=function(t){var e,t=D.pem.decode(t)[0];if("ENCRYPTED PRIVATE KEY"!==t.type)throw(e=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".')).headerType=t.type,e;if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return _.fromDer(t.body)},xi.encryptRsaPrivateKey=function(t,e,n){var r,i,o,a;if(!(n=n||{}).legacy)return l=xi.wrapRsaPrivateKey(xi.privateKeyToAsn1(t)),l=xi.encryptPrivateKeyInfo(l,e,n),xi.encryptedPrivateKeyToPem(l);switch(n.algorithm){case"aes128":r="AES-128-CBC",i=D.random.getBytesSync(o=16),a=D.aes.createEncryptionCipher;break;case"aes192":r="AES-192-CBC",o=24,i=D.random.getBytesSync(16),a=D.aes.createEncryptionCipher;break;case"aes256":r="AES-256-CBC",o=32,i=D.random.getBytesSync(16),a=D.aes.createEncryptionCipher;break;case"3des":r="DES-EDE3-CBC",o=24,i=D.random.getBytesSync(8),a=D.des.createEncryptionCipher;break;case"des":r="DES-CBC",i=D.random.getBytesSync(o=8),a=D.des.createEncryptionCipher;break;default:var s=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+n.algorithm+'".');throw s.algorithm=n.algorithm,s}var l=a(D.pbe.opensslDeriveBytes(e,i.substr(0,8),o)),e=(l.start(i),l.update(_.toDer(xi.privateKeyToAsn1(t))),l.finish(),{type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:r,parameters:D.util.bytesToHex(i).toUpperCase()},body:l.output.getBytes()});return D.pem.encode(e)},xi.decryptRsaPrivateKey=function(t,e){var n,r,i,o=null,a=D.pem.decode(t)[0];if("ENCRYPTED PRIVATE KEY"!==a.type&&"PRIVATE KEY"!==a.type&&"RSA PRIVATE KEY"!==a.type)throw(i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=i;if(a.procType&&"ENCRYPTED"===a.procType.type){switch(a.dekInfo.algorithm){case"DES-CBC":n=8,r=D.des.createDecryptionCipher;break;case"DES-EDE3-CBC":n=24,r=D.des.createDecryptionCipher;break;case"AES-128-CBC":n=16,r=D.aes.createDecryptionCipher;break;case"AES-192-CBC":n=24,r=D.aes.createDecryptionCipher;break;case"AES-256-CBC":n=32,r=D.aes.createDecryptionCipher;break;case"RC2-40-CBC":n=5,r=function(t){return D.rc2.createDecryptionCipher(t,40)};break;case"RC2-64-CBC":n=8,r=function(t){return D.rc2.createDecryptionCipher(t,64)};break;case"RC2-128-CBC":n=16,r=function(t){return D.rc2.createDecryptionCipher(t,128)};break;default:throw(i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+a.dekInfo.algorithm+'".')).algorithm=a.dekInfo.algorithm,i}var t=D.util.hexToBytes(a.dekInfo.parameters),s=r(D.pbe.opensslDeriveBytes(e,t.substr(0,8),n));if(s.start(t),s.update(D.util.createBuffer(a.body)),!s.finish())return o;o=s.output.getBytes()}else o=a.body;return o=null!==(o="ENCRYPTED PRIVATE KEY"===a.type?xi.decryptPrivateKeyInfo(_.fromDer(o),e):_.fromDer(o))?xi.privateKeyFromAsn1(o):o},xi.pbe.generatePkcs12Key=function(t,e,n,r,i,o){if(null==o){if(!("sha1"in D.md))throw new Error('"sha1" hash algorithm unavailable.');o=D.md.sha1.create()}var a=o.digestLength,s=o.blockLength,l=new D.util.ByteBuffer,u=new D.util.ByteBuffer;if(null!=t){for(L=0;L<t.length;L++)u.putInt16(t.charCodeAt(L));u.putInt16(0)}var c=u.length(),h=e.length(),d=new D.util.ByteBuffer,p=(d.fillWithByte(n,s),s*Math.ceil(h/s)),f=new D.util.ByteBuffer;for(L=0;L<p;L++)f.putByte(e.at(L%h));var g=s*Math.ceil(c/s),m=new D.util.ByteBuffer;for(L=0;L<g;L++)m.putByte(u.at(L%c));for(var y=f,v=(y.putBuffer(m),Math.ceil(i/a)),_=1;_<=v;_++){var w=new D.util.ByteBuffer;w.putBytes(d.bytes()),w.putBytes(y.bytes());for(var b=0;b<r;b++)o.start(),o.update(w.getBytes()),w=o.digest();var C=new D.util.ByteBuffer;for(L=0;L<s;L++)C.putByte(w.at(L%a));for(var E=Math.ceil(h/s)+Math.ceil(c/s),S=new D.util.ByteBuffer,T=0;T<E;T++){for(var A=new D.util.ByteBuffer(y.getBytes(s)),I=511,L=C.length()-1;0<=L;L--)I=(I>>=8)+(C.at(L)+A.at(L)),A.setAt(L,255&I);S.putBuffer(A)}y=S,l.putBuffer(w)}return l.truncate(l.length()-i),l},xi.pbe.getCipher=function(t,e,n){switch(t){case xi.oids.pkcs5PBES2:return xi.pbe.getCipherForPBES2(t,e,n);case xi.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case xi.oids["pbewithSHAAnd40BitRC2-CBC"]:return xi.pbe.getCipherForPKCS12PBE(t,e,n);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=t,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}},xi.pbe.getCipherForPBES2=function(t,e,n){var r={},i=[];if(!_.validate(e,Ri,r,i))throw(s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=i,s;if((t=_.derToOid(r.kdfOid))!==xi.oids.pkcs5PBKDF2)throw(s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=t,s.supportedOids=["pkcs5PBKDF2"],s;if((t=_.derToOid(r.encOid))!==xi.oids["aes128-CBC"]&&t!==xi.oids["aes192-CBC"]&&t!==xi.oids["aes256-CBC"]&&t!==xi.oids["des-EDE3-CBC"]&&t!==xi.oids.desCBC)throw(s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s;var o,a,e=r.kdfSalt,i=(i=D.util.createBuffer(r.kdfIterationCount)).getInt(i.length()<<3);switch(xi.oids[t]){case"aes128-CBC":o=16,a=D.aes.createDecryptionCipher;break;case"aes192-CBC":o=24,a=D.aes.createDecryptionCipher;break;case"aes256-CBC":o=32,a=D.aes.createDecryptionCipher;break;case"des-EDE3-CBC":o=24,a=D.des.createDecryptionCipher;break;case"desCBC":o=8,a=D.des.createDecryptionCipher}var s=Mi(r.prfOid),t=D.pkcs5.pbkdf2(n,e,i,o,s),n=r.encIv,e=a(t);return e.start(n),e},xi.pbe.getCipherForPKCS12PBE=function(t,e,n){var r={},i=[];if(!_.validate(e,Pi,r,i))throw(l=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=i,l;var o,a,s,l,e=D.util.createBuffer(r.salt),i=(i=D.util.createBuffer(r.iterations)).getInt(i.length()<<3);switch(t){case xi.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:o=24,a=8,s=D.des.startDecrypting;break;case xi.oids["pbewithSHAAnd40BitRC2-CBC"]:o=5,a=8,s=function(t,e){t=D.rc2.createDecryptionCipher(t,40);return t.start(e,null),t};break;default:throw(l=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=t,l}var r=Mi(r.prfOid),u=xi.pbe.generatePkcs12Key(n,e,1,i,o,r);return r.start(),s(u,xi.pbe.generatePkcs12Key(n,e,2,i,a,r))},xi.pbe.opensslDeriveBytes=function(t,e,n,r){if(null==r){if(!("md5"in D.md))throw new Error('"md5" hash algorithm unavailable.');r=D.md.md5.create()}for(var i=[Oi(r,t+(e=null===e?"":e))],o=16,a=1;o<n;++a,o+=16)i.push(Oi(r,i[a-1]+t+e));return i.join("").substr(0,n)},F(function(t){var e=D.asn1,t=t.exports=D.pkcs7asn1=D.pkcs7asn1||{},n=(D.pkcs7=D.pkcs7||{},D.pkcs7.asn1=t,{name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]}),r=(t.contentInfoValidator=n,{name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]}),r=(t.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(r)},t.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(r)},{name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]});t.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},n,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[r]}]},t.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}),F(function(t){D.mgf=D.mgf||{},(t.exports=D.mgf.mgf1=D.mgf1=D.mgf1||{}).create=function(a){return{generate:function(t,e){for(var n=new D.util.ByteBuffer,r=Math.ceil(e/a.digestLength),i=0;i<r;i++){var o=new D.util.ByteBuffer;o.putInt32(i),a.start(),a.update(t+o.getBytes()),n.putBuffer(a.digest())}return n.truncate(n.length()-e),n.getBytes()}}}}),D.mgf=D.mgf||{},D.mgf.mgf1=D.mgf1,F(function(t){(t.exports=D.pss=D.pss||{}).create=function(t){var c,h=(t=3===arguments.length?{md:arguments[0],mgf:arguments[1],saltLength:arguments[2]}:t).md,d=t.mgf,p=h.digestLength,f=t.salt||null;if("string"==typeof f&&(f=D.util.createBuffer(f)),"saltLength"in t)c=t.saltLength;else{if(null===f)throw new Error("Salt length not specified or specific salt not given.");c=f.length()}if(null!==f&&f.length()!==c)throw new Error("Given salt length does not match length of given salt.");var g=t.prng||D.random,t={encode:function(t,e){var e=e-1,n=Math.ceil(e/8),t=t.digest().getBytes();if(n<p+c+2)throw new Error("Message is too long to encrypt.");for(var r=null===f?g.getBytesSync(c):f.bytes(),i=new D.util.ByteBuffer,t=(i.fillWithByte(0,8),i.putBytes(t),i.putBytes(r),h.start(),h.update(i.getBytes()),h.digest().getBytes()),i=new D.util.ByteBuffer,o=(i.fillWithByte(0,n-c-p-2),i.putByte(1),i.putBytes(r),i.getBytes()),a=n-p-1,s=d.generate(t,a),l="",u=0;u<a;u++)l+=String.fromCharCode(o.charCodeAt(u)^s.charCodeAt(u));r=65280>>8*n-e&255;return(l=String.fromCharCode(l.charCodeAt(0)&~r)+l.substr(1))+t+String.fromCharCode(188)},verify:function(t,e,n){var n=n-1,r=Math.ceil(n/8);if(e=e.substr(-r),r<p+c+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==e.charCodeAt(r-1))throw new Error("Encoded message does not end in 0xBC.");var i=r-p-1,o=e.substr(0,i),e=e.substr(i,p),n=65280>>8*r-n&255;if(0!=(o.charCodeAt(0)&n))throw new Error("Bits beyond keysize not zero as expected.");for(var a=d.generate(e,i),s="",l=0;l<i;l++)s+=String.fromCharCode(o.charCodeAt(l)^a.charCodeAt(l));var s=String.fromCharCode(s.charCodeAt(0)&~n)+s.substr(1),u=r-p-c-2;for(l=0;l<u;l++)if(0!==s.charCodeAt(l))throw new Error("Leftmost octets not zero as expected");if(1!==s.charCodeAt(u))throw new Error("Inconsistent PSS signature, 0x01 marker not found");n=s.substr(-c),r=new D.util.ByteBuffer;return r.fillWithByte(0,8),r.putBytes(t),r.putBytes(n),h.start(),h.update(r.getBytes()),e===h.digest().getBytes()}};return t}}),F(function(t){var d=D.asn1,y=t.exports=D.pki=D.pki||{},p=y.oids,u={},t=(u.CN=p.commonName,u.commonName="CN",u.C=p.countryName,u.countryName="C",u.L=p.localityName,u.localityName="L",u.ST=p.stateOrProvinceName,u.stateOrProvinceName="ST",u.O=p.organizationName,u.organizationName="O",u.OU=p.organizationalUnitName,u.organizationalUnitName="OU",u.E=p.emailAddress,D.pki.rsa.publicKeyValidator),a={name:"Certificate",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!(u.emailAddress="E"),capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:d.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:d.Class.UNIVERSAL,type:d.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:d.Class.UNIVERSAL,type:d.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:d.Class.UNIVERSAL,type:d.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:d.Class.UNIVERSAL,type:d.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},t,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:d.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:d.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:d.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:d.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},i={name:"rsapss",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:d.Class.UNIVERSAL,type:d.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:d.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:d.Class.UNIVERSAL,type:d.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:d.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:d.Class.UNIVERSAL,type:d.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:d.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:d.Class.UNIVERSAL,type:d.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},t={name:"CertificationRequestInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},t,{name:"CertificationRequestInfo.attributes",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:d.Class.UNIVERSAL,type:d.Type.SET,constructed:!0}]}]}]},s={name:"CertificationRequest",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[t,{name:"CertificationRequest.signatureAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:d.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function l(t,e){"string"==typeof e&&(e={shortName:e});for(var n,r=null,i=0;null===r&&i<t.attributes.length;++i)n=t.attributes[i],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}y.RDNAttributesAsArray=function(t,e){for(var n,r,i=[],o=0;o<t.value.length;++o)for(var a=t.value[o],s=0;s<a.value.length;++s)n=a.value[s],(r={}).type=d.derToOid(n.value[0].value),r.value=n.value[1].value,r.valueTagClass=n.value[1].type,r.type in p&&(r.name=p[r.type],r.name in u)&&(r.shortName=u[r.name]),e&&(e.update(r.type),e.update(r.value)),i.push(r);return i},y.CRIAttributesAsArray=function(t){for(var e=[],n=0;n<t.length;++n)for(var r=t[n],i=d.derToOid(r.value[0].value),o=r.value[1].value,a=0;a<o.length;++a){var s={};if(s.type=i,s.value=o[a].value,s.valueTagClass=o[a].type,s.type in p&&(s.name=p[s.type],s.name in u)&&(s.shortName=u[s.name]),s.type===p.extensionRequest){s.extensions=[];for(var l=0;l<s.value.length;++l)s.extensions.push(y.certificateExtensionFromAsn1(s.value[l]))}e.push(s)}return e};function c(t,e,n){var r={};if(t===p["RSASSA-PSS"]){n&&(r={hash:{algorithmOid:p.sha1},mgf:{algorithmOid:p.mgf1,hash:{algorithmOid:p.sha1}},saltLength:20});t={},n=[];if(!d.validate(e,i,t,n))throw(e=new Error("Cannot read RSASSA-PSS parameter block.")).errors=n,e;void 0!==t.hashOid&&(r.hash=r.hash||{},r.hash.algorithmOid=d.derToOid(t.hashOid)),void 0!==t.maskGenOid&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=d.derToOid(t.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=d.derToOid(t.maskGenHashOid)),void 0!==t.saltLength&&(r.saltLength=t.saltLength.charCodeAt(0))}return r}function f(t){for(var e=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),n=t.attributes,r=0;r<n.length;++r){var i,o=(i=n[r]).value,a=d.Type.PRINTABLESTRING;"valueTagClass"in i&&(a=i.valueTagClass)===d.Type.UTF8&&(o=D.util.encodeUtf8(o)),i=d.create(d.Class.UNIVERSAL,d.Type.SET,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(i.type).getBytes()),d.create(d.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function h(t){for(var e,n,r=0;r<t.length;++r){if(void 0===(e=t[r]).name&&(e.type&&e.type in y.oids?e.name=y.oids[e.type]:e.shortName&&e.shortName in u&&(e.name=y.oids[u[e.shortName]])),void 0===e.type){if(!(e.name&&e.name in y.oids))throw(n=new Error("Attribute type not specified.")).attribute=e,n;e.type=y.oids[e.name]}if(void 0===e.shortName&&e.name&&e.name in u&&(e.shortName=u[e.name]),e.type===p.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=d.Type.SEQUENCE,!e.value)&&e.extensions){e.value=[];for(var i=0;i<e.extensions.length;++i)e.value.push(y.certificateExtensionToAsn1(o(e.extensions[i])))}if(void 0===e.value)throw(n=new Error("Attribute value not specified.")).attribute=e,n}}function o(t,e){if(e=e||{},void 0===t.name&&t.id&&t.id in y.oids&&(t.name=y.oids[t.id]),void 0===t.id){if(!(t.name&&t.name in y.oids))throw(h=new Error("Extension ID not specified.")).extension=t,h;t.id=y.oids[t.name]}if(void 0===t.value){if("keyUsage"===t.name){var n=0,r=0,i=0,o=(t.digitalSignature&&(r|=128,n=7),t.nonRepudiation&&(r|=64,n=6),t.keyEncipherment&&(r|=32,n=5),t.dataEncipherment&&(r|=16,n=4),t.keyAgreement&&(r|=8,n=3),t.keyCertSign&&(r|=4,n=2),t.cRLSign&&(r|=2,n=1),t.encipherOnly&&(r|=1,n=0),t.decipherOnly&&(i|=128,n=7),String.fromCharCode(n));0!==i?o+=String.fromCharCode(r)+String.fromCharCode(i):0!==r&&(o+=String.fromCharCode(r)),t.value=d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,o)}else if("basicConstraints"===t.name)t.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(d.create(d.Class.UNIVERSAL,d.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(t.pathLenConstraint).getBytes()));else if("extKeyUsage"===t.name){t.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);var a,s=t.value.value;for(a in t)!0===t[a]&&(a in p?s.push(d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(p[a]).getBytes())):-1!==a.indexOf(".")&&s.push(d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(a).getBytes())))}else if("nsCertType"===t.name){n=0,r=0,o=(t.client&&(r|=128,n=7),t.server&&(r|=64,n=6),t.email&&(r|=32,n=5),t.objsign&&(r|=16,n=4),t.reserved&&(r|=8,n=3),t.sslCA&&(r|=4,n=2),t.emailCA&&(r|=2,n=1),t.objCA&&(r|=1,n=0),String.fromCharCode(n));0!==r&&(o+=String.fromCharCode(r)),t.value=d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,o)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){t.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);for(var l=0;l<t.altNames.length;++l){o=(u=t.altNames[l]).value;if(7===u.type&&u.ip){if(null===(o=D.util.bytesFromIP(u.ip)))throw(h=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=t,h}else 8===u.type&&(o=u.oid?d.oidToDer(d.oidToDer(u.oid)):d.oidToDer(o));t.value.value.push(d.create(d.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if("nsComment"===t.name&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||128<t.comment.length)throw new Error('Invalid "nsComment" content.');t.value=d.create(d.Class.UNIVERSAL,d.Type.IA5STRING,!1,t.comment)}else if("subjectKeyIdentifier"===t.name&&e.cert){i=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=i.toHex(),t.value=d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,i.getBytes())}else if("authorityKeyIdentifier"===t.name&&e.cert){t.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);s=t.value.value;t.keyIdentifier&&(n=!0===t.keyIdentifier?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier,s.push(d.create(d.Class.CONTEXT_SPECIFIC,0,!1,n))),t.authorityCertIssuer&&(r=[d.create(d.Class.CONTEXT_SPECIFIC,4,!0,[f(!0===t.authorityCertIssuer?e.cert.issuer:t.authorityCertIssuer)])],s.push(d.create(d.Class.CONTEXT_SPECIFIC,1,!0,r))),t.serialNumber&&(i=D.util.hexToBytes((!0===t.serialNumber?e.cert:t).serialNumber),s.push(d.create(d.Class.CONTEXT_SPECIFIC,2,!1,i)))}else if("cRLDistributionPoints"===t.name){t.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);for(var u,s=t.value.value,n=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),c=d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[]),l=0;l<t.altNames.length;++l){o=(u=t.altNames[l]).value;if(7===u.type&&u.ip){if(null===(o=D.util.bytesFromIP(u.ip)))throw(h=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=t,h}else 8===u.type&&(o=u.oid?d.oidToDer(d.oidToDer(u.oid)):d.oidToDer(o));c.value.push(d.create(d.Class.CONTEXT_SPECIFIC,u.type,!1,o))}n.value.push(d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[c])),s.push(n)}var h;if(void 0===t.value)throw(h=new Error("Extension value not specified.")).extension=t,h}return t}function r(t,e){return t!==p["RSASSA-PSS"]?d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,""):(t=[],void 0!==e.hash.algorithmOid&&t.push(d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(e.hash.algorithmOid).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")])])),void 0!==e.mgf.algorithmOid&&t.push(d.create(d.Class.CONTEXT_SPECIFIC,1,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(e.mgf.algorithmOid).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(e.mgf.hash.algorithmOid).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")])])])),void 0!==e.saltLength&&t.push(d.create(d.Class.CONTEXT_SPECIFIC,2,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(e.saltLength).getBytes())])),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,t))}y.certificateFromPem=function(t,e,n){t=D.pem.decode(t)[0];if("CERTIFICATE"!==t.type&&"X509 CERTIFICATE"!==t.type&&"TRUSTED CERTIFICATE"!==t.type)throw(r=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".')).headerType=t.type,r;if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var r=d.fromDer(t.body,n);return y.certificateFromAsn1(r,e)},y.certificateToPem=function(t,e){t={type:"CERTIFICATE",body:d.toDer(y.certificateToAsn1(t)).getBytes()};return D.pem.encode(t,{maxline:e})},y.publicKeyFromPem=function(t){t=D.pem.decode(t)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type)throw(e=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".')).headerType=t.type,e;if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var e=d.fromDer(t.body);return y.publicKeyFromAsn1(e)},y.publicKeyToPem=function(t,e){t={type:"PUBLIC KEY",body:d.toDer(y.publicKeyToAsn1(t)).getBytes()};return D.pem.encode(t,{maxline:e})},y.publicKeyToRSAPublicKeyPem=function(t,e){t={type:"RSA PUBLIC KEY",body:d.toDer(y.publicKeyToRSAPublicKey(t)).getBytes()};return D.pem.encode(t,{maxline:e})},y.getPublicKeyFingerprint=function(t,e){var n,r=(e=e||{}).md||D.md.sha1.create();switch(e.type||"RSAPublicKey"){case"RSAPublicKey":n=d.toDer(y.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":n=d.toDer(y.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(n);var i,r=r.digest();if("hex"===e.encoding)return i=r.toHex(),e.delimiter?i.match(/.{2}/g).join(e.delimiter):i;if("binary"===e.encoding)return r.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".');return r},y.certificationRequestFromPem=function(t,e,n){t=D.pem.decode(t)[0];if("CERTIFICATE REQUEST"!==t.type)throw(r=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".')).headerType=t.type,r;if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var r=d.fromDer(t.body,n);return y.certificationRequestFromAsn1(r,e)},y.certificationRequestToPem=function(t,e){t={type:"CERTIFICATE REQUEST",body:d.toDer(y.certificationRequestToAsn1(t)).getBytes()};return D.pem.encode(t,{maxline:e})},y.createCertificate=function(){var u={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return u.siginfo.algorithmOid=null,u.validity={},u.validity.notBefore=new Date,u.validity.notAfter=new Date,u.issuer={},u.issuer.getField=function(t){return l(u.issuer,t)},u.issuer.addField=function(t){h([t]),u.issuer.attributes.push(t)},u.issuer.attributes=[],u.issuer.hash=null,u.subject={},u.subject.getField=function(t){return l(u.subject,t)},u.subject.addField=function(t){h([t]),u.subject.attributes.push(t)},u.subject.attributes=[],u.subject.hash=null,u.extensions=[],u.publicKey=null,u.md=null,u.setSubject=function(t,e){h(t),u.subject.attributes=t,delete u.subject.uniqueId,e&&(u.subject.uniqueId=e),u.subject.hash=null},u.setIssuer=function(t,e){h(t),u.issuer.attributes=t,delete u.issuer.uniqueId,e&&(u.issuer.uniqueId=e),u.issuer.hash=null},u.setExtensions=function(t){for(var e=0;e<t.length;++e)o(t[e],{cert:u});u.extensions=t},u.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var e,n=null,r=0;null===n&&r<u.extensions.length;++r)e=u.extensions[r],(t.id&&e.id===t.id||t.name&&e.name===t.name)&&(n=e);return n},u.sign=function(t,e){u.md=e||D.md.sha1.create();e=p[u.md.algorithm+"WithRSAEncryption"];if(!e)throw(n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.")).algorithm=u.md.algorithm,n;u.signatureOid=u.siginfo.algorithmOid=e,u.tbsCertificate=y.getTBSCertificate(u);var n=d.toDer(u.tbsCertificate);u.md.update(n.getBytes()),u.signature=t.sign(u.md)},u.verify=function(t){var e=!1;if(!u.issued(t))throw i=t.issuer,o=u.subject,(s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.")).expectedIssuer=i.attributes,s.actualIssuer=o.attributes,s;var n,r=t.md;if(null===r){if(t.signatureOid in p)switch(p[t.signatureOid]){case"sha1WithRSAEncryption":r=D.md.sha1.create();break;case"md5WithRSAEncryption":r=D.md.md5.create();break;case"sha256WithRSAEncryption":r=D.md.sha256.create();break;case"sha384WithRSAEncryption":r=D.md.sha384.create();break;case"sha512WithRSAEncryption":r=D.md.sha512.create();break;case"RSASSA-PSS":r=D.md.sha256.create()}if(null===r)throw(s=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=t.signatureOid,s;var i=t.tbsCertificate||y.getTBSCertificate(t),o=d.toDer(i);r.update(o.getBytes())}if(null!==r){switch(t.signatureOid){case p.sha1WithRSAEncryption:n=void 0;break;case p["RSASSA-PSS"]:var a,s,l=p[t.signatureParameters.mgf.hash.algorithmOid];if(void 0===l||void 0===D.md[l])throw(s=new Error("Unsupported MGF hash function.")).oid=t.signatureParameters.mgf.hash.algorithmOid,s.name=l,s;if(void 0===(a=p[t.signatureParameters.mgf.algorithmOid])||void 0===D.mgf[a])throw(s=new Error("Unsupported MGF function.")).oid=t.signatureParameters.mgf.algorithmOid,s.name=a,s;if(a=D.mgf[a].create(D.md[l].create()),void 0===(l=p[t.signatureParameters.hash.algorithmOid])||void 0===D.md[l])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:l};n=D.pss.create(D.md[l].create(),a,t.signatureParameters.saltLength)}e=u.publicKey.verify(r.digest().getBytes(),t.signature,n)}return e},u.isIssuer=function(t){var e=!1,n=u.issuer,r=t.subject;if(n.hash&&r.hash)e=n.hash===r.hash;else if(n.attributes.length===r.attributes.length)for(var i,o,e=!0,a=0;e&&a<n.attributes.length;++a)i=n.attributes[a],o=r.attributes[a],i.type===o.type&&i.value===o.value||(e=!1);return e},u.issued=function(t){return t.isIssuer(u)},u.generateSubjectKeyIdentifier=function(){return y.getPublicKeyFingerprint(u.publicKey,{type:"RSAPublicKey"})},u.verifySubjectKeyIdentifier=function(){for(var t=p.subjectKeyIdentifier,e=0;e<u.extensions.length;++e){var n,r=u.extensions[e];if(r.id===t)return n=u.generateSubjectKeyIdentifier().getBytes(),D.util.hexToBytes(r.subjectKeyIdentifier)===n}return!1},u},y.certificateFromAsn1=function(t,e){var n={},r=[];if(!d.validate(t,a,n,r))throw(i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.")).errors=r,i;if(d.derToOid(n.publicKeyOid)!==y.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var i,o=y.createCertificate(),t=(o.version=n.certVersion?n.certVersion.charCodeAt(0):0,D.util.createBuffer(n.certSerialNumber)),r=(o.serialNumber=t.toHex(),o.signatureOid=D.asn1.derToOid(n.certSignatureOid),o.signatureParameters=c(o.signatureOid,n.certSignatureParams,!0),o.siginfo.algorithmOid=D.asn1.derToOid(n.certinfoSignatureOid),o.siginfo.parameters=c(o.siginfo.algorithmOid,n.certinfoSignatureParams,!1),o.signature=n.certSignature,[]);if(void 0!==n.certValidity1UTCTime&&r.push(d.utcTimeToDate(n.certValidity1UTCTime)),void 0!==n.certValidity2GeneralizedTime&&r.push(d.generalizedTimeToDate(n.certValidity2GeneralizedTime)),void 0!==n.certValidity3UTCTime&&r.push(d.utcTimeToDate(n.certValidity3UTCTime)),void 0!==n.certValidity4GeneralizedTime&&r.push(d.generalizedTimeToDate(n.certValidity4GeneralizedTime)),2<r.length)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(r.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=r[0],o.validity.notAfter=r[1],o.tbsCertificate=n.tbsCertificate,e){if(o.md=null,o.signatureOid in p)switch(p[o.signatureOid]){case"sha1WithRSAEncryption":o.md=D.md.sha1.create();break;case"md5WithRSAEncryption":o.md=D.md.md5.create();break;case"sha256WithRSAEncryption":o.md=D.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=D.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=D.md.sha512.create();break;case"RSASSA-PSS":o.md=D.md.sha256.create()}if(null===o.md)throw(i=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=o.signatureOid,i;t=d.toDer(o.tbsCertificate);o.md.update(t.getBytes())}r=D.md.sha1.create(),o.issuer.getField=function(t){return l(o.issuer,t)},o.issuer.addField=function(t){h([t]),o.issuer.attributes.push(t)},o.issuer.attributes=y.RDNAttributesAsArray(n.certIssuer,r),n.certIssuerUniqueId&&(o.issuer.uniqueId=n.certIssuerUniqueId),o.issuer.hash=r.digest().toHex(),e=D.md.sha1.create();return o.subject.getField=function(t){return l(o.subject,t)},o.subject.addField=function(t){h([t]),o.subject.attributes.push(t)},o.subject.attributes=y.RDNAttributesAsArray(n.certSubject,e),n.certSubjectUniqueId&&(o.subject.uniqueId=n.certSubjectUniqueId),o.subject.hash=e.digest().toHex(),n.certExtensions?o.extensions=y.certificateExtensionsFromAsn1(n.certExtensions):o.extensions=[],o.publicKey=y.publicKeyFromAsn1(n.subjectPublicKeyInfo),o},y.certificateExtensionsFromAsn1=function(t){for(var e=[],n=0;n<t.value.length;++n)for(var r=t.value[n],i=0;i<r.value.length;++i)e.push(y.certificateExtensionFromAsn1(r.value[i]));return e},y.certificateExtensionFromAsn1=function(t){var e={};if(e.id=d.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===d.Type.BOOLEAN?(e.critical=0!==t.value[1].value.charCodeAt(0),e.value=t.value[2].value):e.value=t.value[1].value,e.id in p)if(e.name=p[e.id],"keyUsage"===e.name){var n=0,t=0;1<(r=d.fromDer(e.value)).value.length&&(n=r.value.charCodeAt(1),t=2<r.value.length?r.value.charCodeAt(2):0),e.digitalSignature=128==(128&n),e.nonRepudiation=64==(64&n),e.keyEncipherment=32==(32&n),e.dataEncipherment=16==(16&n),e.keyAgreement=8==(8&n),e.keyCertSign=4==(4&n),e.cRLSign=2==(2&n),e.encipherOnly=1==(1&n),e.decipherOnly=128==(128&t)}else if("basicConstraints"===e.name){0<(r=d.fromDer(e.value)).value.length&&r.value[0].type===d.Type.BOOLEAN?e.cA=0!==r.value[0].value.charCodeAt(0):e.cA=!1;t=null;0<r.value.length&&r.value[0].type===d.Type.INTEGER?t=r.value[0].value:1<r.value.length&&(t=r.value[1].value),null!==t&&(e.pathLenConstraint=d.derToInteger(t))}else if("extKeyUsage"===e.name)for(var r=d.fromDer(e.value),i=0;i<r.value.length;++i){var o=d.derToOid(r.value[i].value);o in p?e[p[o]]=!0:e[o]=!0}else if("nsCertType"===e.name){n=0;1<(r=d.fromDer(e.value)).value.length&&(n=r.value.charCodeAt(1)),e.client=128==(128&n),e.server=64==(64&n),e.email=32==(32&n),e.objsign=16==(16&n),e.reserved=8==(8&n),e.sslCA=4==(4&n),e.emailCA=2==(2&n),e.objCA=1==(1&n)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.altNames=[];for(var r=d.fromDer(e.value),a=0;a<r.value.length;++a){var s,l={type:(s=r.value[a]).type,value:s.value};switch(e.altNames.push(l),s.type){case 1:case 2:case 6:break;case 7:l.ip=D.util.bytesToIP(s.value);break;case 8:l.oid=d.derToOid(s.value)}}}else"subjectKeyIdentifier"===e.name&&(r=d.fromDer(e.value),e.subjectKeyIdentifier=D.util.bytesToHex(r.value));return e},y.certificationRequestFromAsn1=function(t,e){var n={},r=[];if(!d.validate(t,s,n,r))throw(i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.")).errors=r,i;if(d.derToOid(n.publicKeyOid)!==y.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var i,o=y.createCertificationRequest();if(o.version=n.csrVersion?n.csrVersion.charCodeAt(0):0,o.signatureOid=D.asn1.derToOid(n.csrSignatureOid),o.signatureParameters=c(o.signatureOid,n.csrSignatureParams,!0),o.siginfo.algorithmOid=D.asn1.derToOid(n.csrSignatureOid),o.siginfo.parameters=c(o.siginfo.algorithmOid,n.csrSignatureParams,!1),o.signature=n.csrSignature,o.certificationRequestInfo=n.certificationRequestInfo,e){if(o.md=null,o.signatureOid in p)switch(p[o.signatureOid]){case"sha1WithRSAEncryption":o.md=D.md.sha1.create();break;case"md5WithRSAEncryption":o.md=D.md.md5.create();break;case"sha256WithRSAEncryption":o.md=D.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=D.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=D.md.sha512.create();break;case"RSASSA-PSS":o.md=D.md.sha256.create()}if(null===o.md)throw(i=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=o.signatureOid,i;t=d.toDer(o.certificationRequestInfo);o.md.update(t.getBytes())}r=D.md.sha1.create();return o.subject.getField=function(t){return l(o.subject,t)},o.subject.addField=function(t){h([t]),o.subject.attributes.push(t)},o.subject.attributes=y.RDNAttributesAsArray(n.certificationRequestInfoSubject,r),o.subject.hash=r.digest().toHex(),o.publicKey=y.publicKeyFromAsn1(n.subjectPublicKeyInfo),o.getAttribute=function(t){return l(o,t)},o.addAttribute=function(t){h([t]),o.attributes.push(t)},o.attributes=y.CRIAttributesAsArray(n.certificationRequestInfoAttributes||[]),o},y.createCertificationRequest=function(){var s={version:0,signatureOid:null,signature:null,siginfo:{}};return s.siginfo.algorithmOid=null,s.subject={},s.subject.getField=function(t){return l(s.subject,t)},s.subject.addField=function(t){h([t]),s.subject.attributes.push(t)},s.subject.attributes=[],s.subject.hash=null,s.publicKey=null,s.attributes=[],s.getAttribute=function(t){return l(s,t)},s.addAttribute=function(t){h([t]),s.attributes.push(t)},s.md=null,s.setSubject=function(t){h(t),s.subject.attributes=t,s.subject.hash=null},s.setAttributes=function(t){h(t),s.attributes=t},s.sign=function(t,e){s.md=e||D.md.sha1.create();e=p[s.md.algorithm+"WithRSAEncryption"];if(!e)throw(n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.")).algorithm=s.md.algorithm,n;s.signatureOid=s.siginfo.algorithmOid=e,s.certificationRequestInfo=y.getCertificationRequestInfo(s);var n=d.toDer(s.certificationRequestInfo);s.md.update(n.getBytes()),s.signature=t.sign(s.md)},s.verify=function(){var t,e=!1,n=s.md;if(null===n){if(s.signatureOid in p)switch(p[s.signatureOid]){case"sha1WithRSAEncryption":n=D.md.sha1.create();break;case"md5WithRSAEncryption":n=D.md.md5.create();break;case"sha256WithRSAEncryption":n=D.md.sha256.create();break;case"sha384WithRSAEncryption":n=D.md.sha384.create();break;case"sha512WithRSAEncryption":n=D.md.sha512.create();break;case"RSASSA-PSS":n=D.md.sha256.create()}if(null===n)throw(o=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=s.signatureOid,o;var r=s.certificationRequestInfo||y.getCertificationRequestInfo(s),r=d.toDer(r);n.update(r.getBytes())}if(null!==n){switch(s.signatureOid){case p.sha1WithRSAEncryption:break;case p["RSASSA-PSS"]:var i,o,a=p[s.signatureParameters.mgf.hash.algorithmOid];if(void 0===a||void 0===D.md[a])throw(o=new Error("Unsupported MGF hash function.")).oid=s.signatureParameters.mgf.hash.algorithmOid,o.name=a,o;if(void 0===(i=p[s.signatureParameters.mgf.algorithmOid])||void 0===D.mgf[i])throw(o=new Error("Unsupported MGF function.")).oid=s.signatureParameters.mgf.algorithmOid,o.name=i,o;if(i=D.mgf[i].create(D.md[a].create()),void 0===(a=p[s.signatureParameters.hash.algorithmOid])||void 0===D.md[a])throw(o=new Error("Unsupported RSASSA-PSS hash function.")).oid=s.signatureParameters.hash.algorithmOid,o.name=a,o;t=D.pss.create(D.md[a].create(),i,s.signatureParameters.saltLength)}e=s.publicKey.verify(n.digest().getBytes(),s.signature,t)}return e},s};var e=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z");function g(t){return e<=t&&t<n?d.create(d.Class.UNIVERSAL,d.Type.UTCTIME,!1,d.dateToUtcTime(t)):d.create(d.Class.UNIVERSAL,d.Type.GENERALIZEDTIME,!1,d.dateToGeneralizedTime(t))}y.getTBSCertificate=function(t){var e=g(t.validity.notBefore),n=g(t.validity.notAfter),e=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(t.version).getBytes())]),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,D.util.hexToBytes(t.serialNumber)),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(t.siginfo.algorithmOid).getBytes()),r(t.siginfo.algorithmOid,t.siginfo.parameters)]),f(t.issuer),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[e,n]),f(t.subject),y.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&e.value.push(d.create(d.Class.CONTEXT_SPECIFIC,1,!0,[d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&e.value.push(d.create(d.Class.CONTEXT_SPECIFIC,2,!0,[d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),0<t.extensions.length&&e.value.push(y.certificateExtensionsToAsn1(t.extensions)),e},y.getCertificationRequestInfo=function(t){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(t.version).getBytes()),f(t.subject),y.publicKeyToAsn1(t.publicKey),(t=>{var e=d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0!==t.attributes.length)for(var n=t.attributes,r=0;r<n.length;++r){var i=n[r],o=i.value,a=d.Type.UTF8,s=((a="valueTagClass"in i?i.valueTagClass:a)===d.Type.UTF8&&(o=D.util.encodeUtf8(o)),!1),i=("valueConstructed"in i&&(s=i.valueConstructed),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(i.type).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SET,!0,[d.create(d.Class.UNIVERSAL,a,s,o)])]));e.value.push(i)}return e})(t)])},y.distinguishedNameToAsn1=f,y.certificateToAsn1=function(t){var e=t.tbsCertificate||y.getTBSCertificate(t);return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[e,d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(t.signatureOid).getBytes()),r(t.signatureOid,t.signatureParameters)]),d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])},y.certificateExtensionsToAsn1=function(t){var e=d.create(d.Class.CONTEXT_SPECIFIC,3,!0,[]),n=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);e.value.push(n);for(var r=0;r<t.length;++r)n.value.push(y.certificateExtensionToAsn1(t[r]));return e},y.certificateExtensionToAsn1=function(t){var e=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),n=(e.value.push(d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(t.id).getBytes())),t.critical&&e.value.push(d.create(d.Class.UNIVERSAL,d.Type.BOOLEAN,!1,String.fromCharCode(255))),t.value);return"string"!=typeof t.value&&(n=d.toDer(n).getBytes()),e.value.push(d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,n)),e},y.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||y.getCertificationRequestInfo(t);return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[e,d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(t.signatureOid).getBytes()),r(t.signatureOid,t.signatureParameters)]),d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])},y.createCaStore=function(t){var o={certs:{}};function a(t){return s(t),o.certs[t.hash]||null}function s(t){var e;t.hash||(e=D.md.sha1.create(),t.attributes=y.RDNAttributesAsArray(f(t),e),t.hash=e.digest().toHex())}if(o.getIssuer=function(t){return a(t.issuer)},o.addCertificate=function(t){var e;s((t="string"==typeof t?D.pki.certificateFromPem(t):t).subject),o.hasCertificate(t)||(t.subject.hash in o.certs?(e=o.certs[t.subject.hash],(e=D.util.isArray(e)?e:[e]).push(t),o.certs[t.subject.hash]=e):o.certs[t.subject.hash]=t)},o.hasCertificate=function(t){var e=a((t="string"==typeof t?D.pki.certificateFromPem(t):t).subject);if(e){D.util.isArray(e)||(e=[e]);for(var n=d.toDer(y.certificateToAsn1(t)).getBytes(),r=0;r<e.length;++r)if(n===d.toDer(y.certificateToAsn1(e[r])).getBytes())return!0}return!1},o.listAllCertificates=function(){var t,e=[];for(t in o.certs)if(o.certs.hasOwnProperty(t)){var n=o.certs[t];if(D.util.isArray(n))for(var r=0;r<n.length;++r)e.push(n[r]);else e.push(n)}return e},o.removeCertificate=function(t){var e;if(s((t="string"==typeof t?D.pki.certificateFromPem(t):t).subject),!o.hasCertificate(t))return null;var n=a(t.subject);if(D.util.isArray(n)){for(var r=d.toDer(y.certificateToAsn1(t)).getBytes(),i=0;i<n.length;++i)r===d.toDer(y.certificateToAsn1(n[i])).getBytes()&&(e=n[i],n.splice(i,1));0===n.length&&delete o.certs[t.subject.hash]}else e=o.certs[t.subject.hash],delete o.certs[t.subject.hash];return e},t)for(var e=0;e<t.length;++e)o.addCertificate(t[e]);return o},y.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},y.verifyCertificateChain=function(t,e,n){n=(n="function"==typeof n?{verify:n}:n)||{};var r=(e=e.slice(0)).slice(0),i=n.validityCheckDate,o=(void 0===i&&(i=new Date),!0),a=null,s=0;do{var l=e.shift(),u=null,c=!1;if(null===(a=i&&(i<l.validity.notBefore||i>l.validity.notAfter)?{message:"Certificate is not valid yet or has expired.",error:y.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:i}:a)){if(null===(u=e[0]||t.getIssuer(l))&&l.isIssuer(l)&&(c=!0,u=l),u){for(var h=u,d=(D.util.isArray(h)||(h=[h]),!1);!d&&0<h.length;){u=h.shift();try{d=u.verify(l)}catch(t){}}d||(a={message:"Certificate signature is invalid.",error:y.certificateError.bad_certificate})}null!==a||u&&!c||t.hasCertificate(l)||(a={message:"Certificate is not trusted.",error:y.certificateError.unknown_ca})}if(null===(a=null===a&&u&&!l.isIssuer(u)?{message:"Certificate issuer is invalid.",error:y.certificateError.bad_certificate}:a))for(var p={keyUsage:!0,basicConstraints:!0},f=0;null===a&&f<l.extensions.length;++f){var g=l.extensions[f];!g.critical||g.name in p||(a={message:"Certificate has an unsupported critical extension.",error:y.certificateError.unsupported_certificate})}null!==a||o&&(0!==e.length||u&&!c)||(c=l.getExtension("basicConstraints"),null===(a=null!==(a=null===(m=l.getExtension("keyUsage"))||m.keyCertSign&&null!==c?a:{message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:y.certificateError.bad_certificate})||null===c||c.cA?a:{message:"Certificate basicConstraints indicates the certificate is not a CA.",error:y.certificateError.bad_certificate})&&null!==m&&"pathLenConstraint"in c&&s-1>c.pathLenConstraint&&(a={message:"Certificate basicConstraints pathLenConstraint violated.",error:y.certificateError.bad_certificate}));var m=null===a||a.error,c=n.verify?n.verify(m,s,r):m;if(!0!==c)throw!0===m&&(a={message:"The application rejected the certificate.",error:y.certificateError.bad_certificate}),!c&&0!==c||("object"!=typeof c||D.util.isArray(c)?"string"==typeof c&&(a.error=c):(c.message&&(a.message=c.message),c.error&&(a.error=c.error))),a}while(a=null,o=!1,++s,0<e.length);return!0}}),F(function(t){var b=D.asn1,C=D.pki,E=t.exports=D.pkcs12=D.pkcs12||{},S={name:"ContentInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:b.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},T={name:"PFX",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},S,{name:"PFX.macData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:b.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},A={name:"SafeBag",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:b.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},I={name:"Attribute",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0,capture:"values"}]},L={name:"CertBag",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:b.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:b.Class.UNIVERSAL,type:b.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function k(t,e,n,r){for(var i=[],o=0;o<t.length;o++)for(var a=0;a<t[o].safeBags.length;a++){var s=t[o].safeBags[a];void 0!==r&&s.type!==r||(null===e||void 0!==s.attributes[e]&&0<=s.attributes[e].indexOf(n))&&i.push(s)}return i}function x(t){if(t.composed||t.constructed){for(var e=D.util.createBuffer(),n=0;n<t.value.length;++n)e.putBytes(t.value[n].value);t.composed=t.constructed=!1,t.value=e.getBytes()}return t}E.pkcs12FromAsn1=function(t,e,n){"string"==typeof e?(n=e,e=!0):void 0===e&&(e=!0);var r={};if(!b.validate(t,T,r,[]))throw(s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=s;var i={version:r.version.charCodeAt(0),safeContents:[],getBags:function(t){var e,n={};return"localKeyId"in t?e=t.localKeyId:"localKeyIdHex"in t&&(e=D.util.hexToBytes(t.localKeyIdHex)),void 0===e&&!("friendlyName"in t)&&"bagType"in t&&(n[t.bagType]=k(i.safeContents,null,null,t.bagType)),void 0!==e&&(n.localKeyId=k(i.safeContents,"localKeyId",e,t.bagType)),"friendlyName"in t&&(n.friendlyName=k(i.safeContents,"friendlyName",t.friendlyName,t.bagType)),n},getBagsByFriendlyName:function(t,e){return k(i.safeContents,"friendlyName",t,e)},getBagsByLocalKeyId:function(t,e){return k(i.safeContents,"localKeyId",t,e)}};if(3!==r.version.charCodeAt(0))throw(s=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=r.version.charCodeAt(0),s;if(b.derToOid(r.contentType)!==C.oids.data)throw(s=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=b.derToOid(r.contentType),s;t=r.content.value[0];if(t.tagClass!==b.Class.UNIVERSAL||t.type!==b.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(t=x(t),r.mac){var o=null,a=0,s=b.derToOid(r.macAlgorithm);switch(s){case C.oids.sha1:o=D.md.sha1.create(),a=20;break;case C.oids.sha256:o=D.md.sha256.create(),a=32;break;case C.oids.sha384:o=D.md.sha384.create(),a=48;break;case C.oids.sha512:o=D.md.sha512.create(),a=64;break;case C.oids.md5:o=D.md.md5.create(),a=16}if(null===o)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+s);var s=new D.util.ByteBuffer(r.macSalt),l="macIterations"in r?parseInt(D.util.bytesToHex(r.macIterations),16):1,s=E.generateKey(n,s,3,l,a,o),l=D.hmac.create();if(l.start(o,s),l.update(t.value),l.getMac().getBytes()!==r.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}var u=i,c=t.value,h=e,d=n;if((c=b.fromDer(c,h)).tagClass!==b.Class.UNIVERSAL||c.type!==b.Type.SEQUENCE||!0!==c.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var p=0;p<c.value.length;p++){var f=c.value[p],g={},m=[];if(!b.validate(f,S,g,m))throw(y=new Error("Cannot read ContentInfo.")).errors=m,y;var y,v={encrypted:!1},_=null,w=g.content.value[0];switch(b.derToOid(g.contentType)){case C.oids.data:if(w.tagClass!==b.Class.UNIVERSAL||w.type!==b.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");_=x(w).value;break;case C.oids.encryptedData:_=((t,e)=>{var n={},r=[];if(!b.validate(t,D.pkcs7.asn1.encryptedDataValidator,n,r))throw(i=new Error("Cannot read EncryptedContentInfo.")).errors=r,i;if((t=b.derToOid(n.contentType))!==C.oids.data)throw(i=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=t,i;t=b.derToOid(n.encAlgorithm);var r=C.pbe.getCipher(t,n.encParameter,e),i=x(n.encryptedContentAsn1),t=D.util.createBuffer(i.value);if(r.update(t),r.finish())return r.output.getBytes();throw new Error("Failed to decrypt PKCS#12 SafeContents.")})(w,d),v.encrypted=!0;break;default:throw(y=new Error("Unsupported PKCS#12 contentType.")).contentType=b.derToOid(g.contentType),y}v.safeBags=((t,n,e)=>{if(!n&&0===t.length)return[];if((t=b.fromDer(t,n)).tagClass!==b.Class.UNIVERSAL||t.type!==b.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r,i,o=[],a=0;a<t.value.length;a++){var s=t.value[a],l={},u=[];if(!b.validate(s,A,l,u))throw(c=new Error("Cannot read SafeBag.")).errors=u,c;var c,h={type:b.derToOid(l.bagId),attributes:(t=>{var e={};if(void 0!==t)for(var n=0;n<t.length;++n){var r,i={},o=[];if(!b.validate(t[n],I,i,o))throw(r=new Error("Cannot read PKCS#12 BagAttribute.")).errors=o,r;var a=b.derToOid(i.oid);if(void 0!==C.oids[a]){e[C.oids[a]]=[];for(var s=0;s<i.values.length;++s)e[C.oids[a]].push(i.values[s].value)}}return e})(l.bagAttributes)},d=(o.push(h),l.bagValue.value[0]);switch(h.type){case C.oids.pkcs8ShroudedKeyBag:if(null===(d=C.decryptPrivateKeyInfo(d,e)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case C.oids.keyBag:try{h.key=C.privateKeyFromAsn1(d)}catch(t){h.key=null,h.asn1=d}continue;case C.oids.certBag:r=L,i=function(){if(b.derToOid(l.certId)!==C.oids.x509Certificate)throw(e=new Error("Unsupported certificate type, only X.509 supported.")).oid=b.derToOid(l.certId),e;var e=b.fromDer(l.cert,n);try{h.cert=C.certificateFromAsn1(e,!0)}catch(t){h.cert=null,h.asn1=e}};break;default:throw(c=new Error("Unsupported PKCS#12 SafeBag type.")).oid=h.type,c}if(void 0!==r&&!b.validate(d,r,l,u))throw(c=new Error("Cannot read PKCS#12 "+r.name)).errors=u,c;i()}return o})(_,h,d),u.safeContents.push(v)}return i},E.toPkcs12Asn1=function(t,e,n,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);for(var i,o=r.localKeyId,a=(null!==o?o=D.util.hexToBytes(o):r.generateLocalKeyId&&(o=e?("string"==typeof(a=D.util.isArray(e)?e[0]:e)&&(a=C.certificateFromPem(a)),(d=D.md.sha1.create()).update(b.toDer(C.certificateToAsn1(a)).getBytes()),d.digest().getBytes()):D.random.getBytes(20)),[]),o=(null!==o&&a.push(b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.localKeyId).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,o)])])),"friendlyName"in r&&a.push(b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.friendlyName).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,[b.create(b.Class.UNIVERSAL,b.Type.BMPSTRING,!1,r.friendlyName)])])),0<a.length&&(i=b.create(b.Class.UNIVERSAL,b.Type.SET,!0,a)),[]),s=[],l=(null!==e&&(s=D.util.isArray(e)?e:[e]),[]),u=0;u<s.length;++u){"string"==typeof(e=s[u])&&(e=C.certificateFromPem(e));var c=0===u?i:void 0,h=C.certificateToAsn1(e),h=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.certBag).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.x509Certificate).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,b.toDer(h).getBytes())])])]),c]);l.push(h)}0<l.length&&(a=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,l),a=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.data).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,b.toDer(a).getBytes())])]),o.push(a));var d,p,a=null,f=(null!==t&&(f=C.wrapRsaPrivateKey(C.privateKeyToAsn1(t)),a=null===n?b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.keyBag).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[f]),i]):b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.pkcs8ShroudedKeyBag).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[C.encryptPrivateKeyInfo(f,n,r)]),i]),f=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[a]),a=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.data).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,b.toDer(f).getBytes())])]),o.push(a)),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,o));return r.useMac&&(d=D.md.sha1.create(),a=new D.util.ByteBuffer(D.random.getBytes(r.saltSize)),o=r.count,t=E.generateKey(n,a,3,o,20),(r=D.hmac.create()).start(d,t),r.update(b.toDer(f).getBytes()),n=r.getMac(),p=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.sha1).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n.getBytes())]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,a.getBytes()),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(o).getBytes())])),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(3).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(C.oids.data).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,b.toDer(f).getBytes())])]),p])},E.generateKey=D.pbe.generatePkcs12Key}),F(function(t){var n=D.asn1,r=t.exports=D.pki=D.pki||{};r.pemToDer=function(t){t=D.pem.decode(t)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return D.util.createBuffer(t.body)},r.privateKeyFromPem=function(t){t=D.pem.decode(t)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type)throw(e=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".')).headerType=t.type,e;if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var e=n.fromDer(t.body);return r.privateKeyFromAsn1(e)},r.privateKeyToPem=function(t,e){t={type:"RSA PRIVATE KEY",body:n.toDer(r.privateKeyToAsn1(t)).getBytes()};return D.pem.encode(t,{maxline:e})},r.privateKeyInfoToPem=function(t,e){t={type:"PRIVATE KEY",body:n.toDer(t).getBytes()};return D.pem.encode(t,{maxline:e})}});var qi,d={Versions:{TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}}},Wi=(d.SupportedVersions=[d.Versions.TLS_1_1,d.Versions.TLS_1_0],d.Version=d.SupportedVersions[0],d.MaxFragment=15360,d.ConnectionEnd={server:0,client:1},d.PRFAlgorithm={tls_prf_sha256:0},d.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},d.CipherType={stream:0,block:1,aead:2},d.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},d.CompressionMethod={none:0,deflate:1},d.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},d.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},d.Alert={},d.Alert.Level={warning:1,fatal:2},d.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},d.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},d.CipherSuites={},d.getCipherSuite=function(t){var e,n=null;for(e in d.CipherSuites){var r=d.CipherSuites[e];if(r.id[0]===t.charCodeAt(0)&&r.id[1]===t.charCodeAt(1)){n=r;break}}return n},d.handleUnexpected=function(t,e){!t.open&&t.entity===d.ConnectionEnd.client||t.error(t,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.unexpected_message}})},d.handleHelloRequest=function(t,e,n){!t.handshaking&&0<t.handshakes&&(d.queue(t,d.createAlert(t,{level:d.Alert.Level.warning,description:d.Alert.Description.no_renegotiation})),d.flush(t)),t.process()},d.parseHelloMessage=function(t,e,n){var r=null,i=t.entity===d.ConnectionEnd.client;if(n<38)t.error(t,{message:i?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});else{var e=e.fragment,o=e.length(),r={version:{major:e.getByte(),minor:e.getByte()},random:D.util.createBuffer(e.getBytes(32)),session_id:Hi(e,1),extensions:[]};if(i?(r.cipher_suite=e.getBytes(2),r.compression_method=e.getByte()):(r.cipher_suites=Hi(e,2),r.compression_methods=Hi(e,1)),0<n-(o-e.length())){for(var a=Hi(e,2);0<a.length();)r.extensions.push({type:[a.getByte(),a.getByte()],data:Hi(a,2)});if(!i)for(var s=0;s<r.extensions.length;++s){var l=r.extensions[s];if(0===l.type[0]&&0===l.type[1])for(var u=Hi(l.data,2);0<u.length();){if(0!==u.getByte())break;t.session.extensions.server_name.serverNameList.push(Hi(u,2).getBytes())}}}if(t.session.version&&(r.version.major!==t.session.version.major||r.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.protocol_version}});if(i)t.session.cipherSuite=d.getCipherSuite(r.cipher_suite);else for(var c=D.util.createBuffer(r.cipher_suites.bytes());0<c.length()&&(t.session.cipherSuite=d.getCipherSuite(c.getBytes(2)),null===t.session.cipherSuite););if(null===t.session.cipherSuite)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.handshake_failure},cipherSuite:D.util.bytesToHex(r.cipher_suite)});t.session.compressionMethod=i?r.compression_method:d.CompressionMethod.none}return r},d.createSecurityParameters=function(t,e){var n=t.entity===d.ConnectionEnd.client,e=e.random.bytes(),r=n?t.session.sp.client_random:e,n=n?e:d.createRandom().getBytes();t.session.sp={entity:t.entity,prf_algorithm:d.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:t.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:r,server_random:n}},d.handleServerHello=function(t,e,n){e=d.parseHelloMessage(t,e,n);if(!t.fail){if(!(e.version.minor<=t.version.minor))return t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.protocol_version}});t.version.minor=e.version.minor,t.session.version=t.version;n=e.session_id.bytes();0<n.length&&n===t.session.id?(t.expect=Xi,t.session.resuming=!0,t.session.sp.server_random=e.random.bytes()):(t.expect=Wi,t.session.resuming=!1,d.createSecurityParameters(t,e)),t.session.id=n,t.process()}},d.handleClientHello=function(t,e,n){var r=d.parseHelloMessage(t,e,n);if(!t.fail){e=r.session_id.bytes(),n=null;if(t.sessionCache&&(null===(n=t.sessionCache.getSession(e))?e="":(n.version.major!==r.version.major||n.version.minor>r.version.minor)&&(n=null,e="")),0===e.length&&(e=D.random.getBytes(32)),t.session.id=e,t.session.clientHelloVersion=r.version,t.session.sp={},n)t.version=t.session.version=n.version,t.session.sp=n.sp;else{for(var i,o=1;o<d.SupportedVersions.length&&!((i=d.SupportedVersions[o]).minor<=r.version.minor);++o);t.version={major:i.major,minor:i.minor},t.session.version=t.version}null!==n?(t.expect=no,t.session.resuming=!0,t.session.sp.client_random=r.random.bytes()):(t.expect=!1!==t.verifyClient?Ji:to,t.session.resuming=!1,d.createSecurityParameters(t,r)),t.open=!0,d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createServerHello(t)})),t.session.resuming?(d.queue(t,d.createRecord(t,{type:d.ContentType.change_cipher_spec,data:d.createChangeCipherSpec()})),t.state.pending=d.createConnectionState(t),t.state.current.write=t.state.pending.write,d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createFinished(t)}))):(d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createCertificate(t)})),t.fail||(d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createServerKeyExchange(t)})),!1!==t.verifyClient&&d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createCertificateRequest(t)})),d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createServerHelloDone(t)})))),d.flush(t),t.process()}},d.handleCertificate=function(e,t,n){if(n<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});var r,i,n=t.fragment,o={certificate_list:Hi(n,3)},a=[];try{for(;0<o.certificate_list.length();)r=Hi(o.certificate_list,3),i=D.asn1.fromDer(r),r=D.pki.certificateFromAsn1(i,!0),a.push(r)}catch(t){return e.error(e,{message:"Could not parse certificate list.",cause:t,send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.bad_certificate}})}t=e.entity===d.ConnectionEnd.client;!t&&!0!==e.verifyClient||0!==a.length?0!==a.length&&(t?e.session.serverCertificate=a[0]:e.session.clientCertificate=a[0],!d.verifyCertificateChain(e,a))||(e.expect=t?Gi:to):e.error(e,{message:t?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}}),e.process()},d.handleServerKeyExchange=function(t,e,n){if(0<n)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.unsupported_certificate}});t.expect=$i,t.process()},d.handleClientKeyExchange=function(e,t,n){if(n<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.unsupported_certificate}});n=t.fragment,t={enc_pre_master_secret:Hi(n,2).getBytes()},n=null;if(e.getPrivateKey)try{n=e.getPrivateKey(e,e.session.serverCertificate),n=D.pki.privateKeyFromPem(n)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}})}if(null===n)return e.error(e,{message:"No private key set.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}});try{var r=e.session.sp,i=(r.pre_master_secret=n.decrypt(t.enc_pre_master_secret),e.session.clientHelloVersion);if(i.major!==r.pre_master_secret.charCodeAt(0)||i.minor!==r.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(t){r.pre_master_secret=D.random.getBytes(48)}e.expect=no,null!==e.session.clientCertificate&&(e.expect=eo),e.process()},d.handleCertificateRequest=function(t,e,n){if(n<3)return t.error(t,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});n=e.fragment,e={certificate_types:Hi(n,1),certificate_authorities:Hi(n,2)};t.session.certificateRequest=e,t.expect=Ki,t.process()},d.handleCertificateVerify=function(e,t,n){if(n<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});var n=t.fragment,t=(n.read-=4,n.bytes()),n=(n.read+=4,{signature:Hi(n,2).getBytes()}),r=D.util.createBuffer();r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest()),r=r.getBytes();try{if(!e.session.clientCertificate.publicKey.verify(r,n.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(t),e.session.sha1.update(t)}catch(t){return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.handshake_failure}})}e.expect=no,e.process()},d.handleServerHelloDone=function(t,e,n){if(0<n)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.record_overflow}});if(null===t.serverCertificate){var n={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.insufficient_security}},r=t.verify(t,n.alert.description,0,[]);if(!0!==r)return!r&&0!==r||("object"!=typeof r||D.util.isArray(r)?"number"==typeof r&&(n.alert.description=r):(r.message&&(n.message=r.message),r.alert&&(n.alert.description=r.alert))),t.error(t,n)}null!==t.session.certificateRequest&&(e=d.createRecord(t,{type:d.ContentType.handshake,data:d.createCertificate(t)}),d.queue(t,e)),e=d.createRecord(t,{type:d.ContentType.handshake,data:d.createClientKeyExchange(t)}),d.queue(t,e),t.expect=Qi;function i(t,e){null!==t.session.certificateRequest&&null!==t.session.clientCertificate&&d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createCertificateVerify(t,e)})),d.queue(t,d.createRecord(t,{type:d.ContentType.change_cipher_spec,data:d.createChangeCipherSpec()})),t.state.pending=d.createConnectionState(t),t.state.current.write=t.state.pending.write,d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createFinished(t)})),t.expect=Xi,d.flush(t),t.process()}if(null===t.session.certificateRequest||null===t.session.clientCertificate)return i(t,null);d.getClientSignature(t,i)},d.handleChangeCipherSpec=function(t,e){if(1!==e.fragment.getByte())return t.error(t,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});e=t.entity===d.ConnectionEnd.client;(t.session.resuming&&e||!t.session.resuming&&!e)&&(t.state.pending=d.createConnectionState(t)),t.state.current.read=t.state.pending.read,(!t.session.resuming&&e||t.session.resuming&&!e)&&(t.state.pending=null),t.expect=e?Zi:ro,t.process()},d.handleFinished=function(t,e,n){var r=e.fragment,i=(r.read-=4,r.bytes()),e=(r.read+=4,e.fragment.getBytes()),o=((r=D.util.createBuffer()).putBuffer(t.session.md5.digest()),r.putBuffer(t.session.sha1.digest()),t.entity===d.ConnectionEnd.client),a=t.session.sp;if((r=Ui(a.master_secret,o?"server finished":"client finished",r.getBytes(),12)).getBytes()!==e)return t.error(t,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.decrypt_error}});t.session.md5.update(i),t.session.sha1.update(i),(t.session.resuming&&o||!t.session.resuming&&!o)&&(d.queue(t,d.createRecord(t,{type:d.ContentType.change_cipher_spec,data:d.createChangeCipherSpec()})),t.state.current.write=t.state.pending.write,t.state.pending=null,d.queue(t,d.createRecord(t,{type:d.ContentType.handshake,data:d.createFinished(t)}))),t.expect=o?Yi:io,t.handshaking=!1,++t.handshakes,t.peerCertificate=o?t.session.serverCertificate:t.session.clientCertificate,d.flush(t),t.isConnected=!0,t.connected(t),t.process()},d.handleAlert=function(t,e){var n,e=e.fragment,e={level:e.getByte(),description:e.getByte()};switch(e.description){case d.Alert.Description.close_notify:n="Connection closed.";break;case d.Alert.Description.unexpected_message:n="Unexpected message.";break;case d.Alert.Description.bad_record_mac:n="Bad record MAC.";break;case d.Alert.Description.decryption_failed:n="Decryption failed.";break;case d.Alert.Description.record_overflow:n="Record overflow.";break;case d.Alert.Description.decompression_failure:n="Decompression failed.";break;case d.Alert.Description.handshake_failure:n="Handshake failure.";break;case d.Alert.Description.bad_certificate:n="Bad certificate.";break;case d.Alert.Description.unsupported_certificate:n="Unsupported certificate.";break;case d.Alert.Description.certificate_revoked:n="Certificate revoked.";break;case d.Alert.Description.certificate_expired:n="Certificate expired.";break;case d.Alert.Description.certificate_unknown:n="Certificate unknown.";break;case d.Alert.Description.illegal_parameter:n="Illegal parameter.";break;case d.Alert.Description.unknown_ca:n="Unknown certificate authority.";break;case d.Alert.Description.access_denied:n="Access denied.";break;case d.Alert.Description.decode_error:n="Decode error.";break;case d.Alert.Description.decrypt_error:n="Decrypt error.";break;case d.Alert.Description.export_restriction:n="Export restriction.";break;case d.Alert.Description.protocol_version:n="Unsupported protocol version.";break;case d.Alert.Description.insufficient_security:n="Insufficient security.";break;case d.Alert.Description.internal_error:n="Internal error.";break;case d.Alert.Description.user_canceled:n="User canceled.";break;case d.Alert.Description.no_renegotiation:n="Renegotiation not supported.";break;default:n="Unknown error."}if(e.description===d.Alert.Description.close_notify)return t.close();t.error(t,{message:n,send:!1,origin:t.entity===d.ConnectionEnd.client?"server":"client",alert:e}),t.process()},d.handleHandshake=function(t,e){var n=e.fragment,r=n.getByte(),i=n.getInt24();if(i>n.length())return(t.fragmented=e).fragment=D.util.createBuffer(),n.read-=4,t.process();t.fragmented=null,n.read-=4;var o=n.bytes(i+4);n.read+=4,r in so[t.entity][t.expect]?(t.entity!==d.ConnectionEnd.server||t.open||t.fail||(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:D.md.md5.create(),sha1:D.md.sha1.create()}),r!==d.HandshakeType.hello_request&&r!==d.HandshakeType.certificate_verify&&r!==d.HandshakeType.finished&&(t.session.md5.update(o),t.session.sha1.update(o)),so[t.entity][t.expect][r](t,e,i)):d.handleUnexpected(t,e)},d.handleApplicationData=function(t,e){t.data.putBuffer(e.fragment),t.dataReady(t),t.process()},d.handleHeartbeat=function(t,e){var e=e.fragment,n=e.getByte(),r=e.getInt16(),e=e.getBytes(r);if(n===d.HeartbeatMessageType.heartbeat_request){if(t.handshaking||r>e.length)return t.process();d.queue(t,d.createRecord(t,{type:d.ContentType.heartbeat,data:d.createHeartbeat(d.HeartbeatMessageType.heartbeat_response,e)})),d.flush(t)}else if(n===d.HeartbeatMessageType.heartbeat_response){if(e!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,D.util.createBuffer(e))}t.process()},1),Gi=2,$i=3,Ki=4,Xi=5,Zi=6,Yi=7,Qi=8,Ji=1,to=2,eo=3,no=4,ro=5,io=6,t=d.handleUnexpected,e=d.handleChangeCipherSpec,n=d.handleAlert,r=d.handleHandshake,oo=d.handleApplicationData,i=d.handleHeartbeat,ao=[],e=(ao[d.ConnectionEnd.client]=[[t,n,r,t,i],[t,n,r,t,i],[t,n,r,t,i],[t,n,r,t,i],[t,n,r,t,i],[e,n,t,t,i],[t,n,r,t,i],[t,n,r,oo,i],[t,n,r,t,i]],ao[d.ConnectionEnd.server]=[[t,n,r,t,i],[t,n,r,t,i],[t,n,r,t,i],[t,n,r,t,i],[e,n,t,t,i],[t,n,r,t,i],[t,n,r,oo,i],[t,n,r,t,i]],d.handleHelloRequest),oo=d.handleCertificate,n=d.handleServerKeyExchange,r=d.handleCertificateRequest,i=d.handleServerHelloDone,o=d.handleFinished,so=[],n=(so[d.ConnectionEnd.client]=[[t,t,d.handleServerHello,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t,oo,n,r,i,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t,t,n,r,i,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t,t,t,r,i,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t,t,t,t,i,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,o],[e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]],d.handleClientHello);for(qi in so[d.ConnectionEnd.server]=[[t,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,oo,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,d.handleClientKeyExchange,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,d.handleCertificateVerify,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,o],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]],d.generateKeys=function(t,e){var n=Ui,r=e.client_random+e.server_random,r=(t.session.resuming||(e.master_secret=n(e.pre_master_secret,"master secret",r,48).bytes(),e.pre_master_secret=null),2*e.mac_key_length+2*e.enc_key_length),t=t.version.major===d.Versions.TLS_1_0.major&&t.version.minor===d.Versions.TLS_1_0.minor,n=(t&&(r+=2*e.fixed_iv_length),n(e.master_secret,"key expansion",e.server_random+e.client_random,r)),r={client_write_MAC_key:n.getBytes(e.mac_key_length),server_write_MAC_key:n.getBytes(e.mac_key_length),client_write_key:n.getBytes(e.enc_key_length),server_write_key:n.getBytes(e.enc_key_length)};return t&&(r.client_write_IV=n.getBytes(e.fixed_iv_length),r.server_write_IV=n.getBytes(e.fixed_iv_length)),r},d.createConnectionState=function(t){function e(){var t={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(t){return!0},compressionState:null,compressFunction:function(t){return!0},updateSequenceNumber:function(){4294967295===t.sequenceNumber[1]?(t.sequenceNumber[1]=0,++t.sequenceNumber[0]):++t.sequenceNumber[1]}};return t}var n=t.entity===d.ConnectionEnd.client,r={read:e(),write:e()};if(r.read.update=function(t,e){return r.read.cipherFunction(e,r.read)?r.read.compressFunction(t,e,r.read)||t.error(t,{message:"Could not decompress record.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.decompression_failure}}):t.error(t,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.bad_record_mac}}),!t.fail},r.write.update=function(t,e){return r.write.compressFunction(t,e,r.write)?r.write.cipherFunction(e,r.write)||t.error(t,{message:"Could not encrypt record.",send:!1,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}}):t.error(t,{message:"Could not compress record.",send:!1,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}}),!t.fail},t.session){var i=t.session.sp;switch(t.session.cipherSuite.initSecurityParameters(i),i.keys=d.generateKeys(t,i),r.read.macKey=n?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,r.write.macKey=n?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,t.session.cipherSuite.initConnectionState(r,t,i),i.compression_algorithm){case d.CompressionMethod.none:break;case d.CompressionMethod.deflate:r.read.compressFunction=Vi,r.write.compressFunction=Fi;break;default:throw new Error("Unsupported compression algorithm.")}}return r},d.createRandom=function(){var t=new Date,t=+t+6e4*t.getTimezoneOffset(),e=D.util.createBuffer();return e.putInt32(t),e.putBytes(D.random.getBytes(28)),e},d.createRecord=function(t,e){return e.data?{type:e.type,version:{major:t.version.major,minor:t.version.minor},length:e.data.length(),fragment:e.data}:null},d.createAlert=function(t,e){var n=D.util.createBuffer();return n.putByte(e.level),n.putByte(e.description),d.createRecord(t,{type:d.ContentType.alert,data:n})},d.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};for(var e=D.util.createBuffer(),n=0;n<t.cipherSuites.length;++n){var r=t.cipherSuites[n];e.putByte(r.id[0]),e.putByte(r.id[1])}var i=e.length(),o=D.util.createBuffer(),a=(o.putByte(d.CompressionMethod.none),o.length()),s=D.util.createBuffer(),l=(t.virtualHost&&((c=D.util.createBuffer()).putByte(0),c.putByte(0),(l=D.util.createBuffer()).putByte(0),zi(l,2,D.util.createBuffer(t.virtualHost)),u=D.util.createBuffer(),zi(u,2,l),zi(c,2,u),s.putBuffer(c)),s.length()),u=(0<l&&(l+=2),t.session.id),c=u.length+1+2+4+28+2+i+1+a+l,i=D.util.createBuffer();return i.putByte(d.HandshakeType.client_hello),i.putInt24(c),i.putByte(t.version.major),i.putByte(t.version.minor),i.putBytes(t.session.sp.client_random),zi(i,1,D.util.createBuffer(u)),zi(i,2,e),zi(i,1,o),0<l&&zi(i,2,s),i},d.createServerHello=function(t){var e=t.session.id,n=e.length+1+2+4+28+2+1,r=D.util.createBuffer();return r.putByte(d.HandshakeType.server_hello),r.putInt24(n),r.putByte(t.version.major),r.putByte(t.version.minor),r.putBytes(t.session.sp.server_random),zi(r,1,D.util.createBuffer(e)),r.putByte(t.session.cipherSuite.id[0]),r.putByte(t.session.cipherSuite.id[1]),r.putByte(t.session.compressionMethod),r},d.createCertificate=function(e){var t=e.entity===d.ConnectionEnd.client,n=null,r=(e.getCertificate&&(c=t?e.session.certificateRequest:e.session.extensions.server_name.serverNameList,n=e.getCertificate(e,c)),D.util.createBuffer());if(null!==n)try{D.util.isArray(n)||(n=[n]);for(var i=null,o=0;o<n.length;++o){var a,s=D.pem.decode(n[o])[0];if("CERTIFICATE"!==s.type&&"X509 CERTIFICATE"!==s.type&&"TRUSTED CERTIFICATE"!==s.type)throw(a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".')).headerType=s.type,a;if(s.procType&&"ENCRYPTED"===s.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var l=D.util.createBuffer(s.body),u=(null===i&&(i=D.asn1.fromDer(l.bytes(),!1)),D.util.createBuffer());zi(u,3,l),r.putBuffer(u)}n=D.pki.certificateFromAsn1(i),t?e.session.clientCertificate=n:e.session.serverCertificate=n}catch(t){return e.error(e,{message:"Could not send certificate list.",cause:t,send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.bad_certificate}})}var c=3+r.length(),t=D.util.createBuffer();return t.putByte(d.HandshakeType.certificate),t.putInt24(c),zi(t,3,r),t},d.createClientKeyExchange=function(t){var e=D.util.createBuffer(),n=(e.putByte(t.session.clientHelloVersion.major),e.putByte(t.session.clientHelloVersion.minor),e.putBytes(D.random.getBytes(46)),t.session.sp);n.pre_master_secret=e.getBytes();t=(e=t.session.serverCertificate.publicKey.encrypt(n.pre_master_secret)).length+2,n=D.util.createBuffer();return n.putByte(d.HandshakeType.client_key_exchange),n.putInt24(t),n.putInt16(e.length),n.putBytes(e),n},d.createServerKeyExchange=function(t){return D.util.createBuffer()},d.getClientSignature=function(t,e){var n=D.util.createBuffer();n.putBuffer(t.session.md5.digest()),n.putBuffer(t.session.sha1.digest()),n=n.getBytes(),t.getSignature=t.getSignature||function(e,t,n){var r=null;if(e.getPrivateKey)try{r=e.getPrivateKey(e,e.session.clientCertificate),r=D.pki.privateKeyFromPem(r)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}})}null===r?e.error(e,{message:"No private key set.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}}):t=r.sign(t,null),n(e,t)},t.getSignature(t,n,e)},d.createCertificateVerify=function(t,e){var n=e.length+2,r=D.util.createBuffer();return r.putByte(d.HandshakeType.certificate_verify),r.putInt24(n),r.putInt16(e.length),r.putBytes(e),r},d.createCertificateRequest=function(t){var e,n=D.util.createBuffer(),r=(n.putByte(1),D.util.createBuffer());for(e in t.caStore.certs){var i=t.caStore.certs[e],i=D.pki.distinguishedNameToAsn1(i.subject),i=D.asn1.toDer(i);r.putInt16(i.length()),r.putBuffer(i)}var o=1+n.length()+2+r.length(),a=D.util.createBuffer();return a.putByte(d.HandshakeType.certificate_request),a.putInt24(o),zi(a,1,n),zi(a,2,r),a},d.createServerHelloDone=function(t){var e=D.util.createBuffer();return e.putByte(d.HandshakeType.server_hello_done),e.putInt24(0),e},d.createChangeCipherSpec=function(){var t=D.util.createBuffer();return t.putByte(1),t},d.createFinished=function(t){(n=D.util.createBuffer()).putBuffer(t.session.md5.digest()),n.putBuffer(t.session.sha1.digest());var e=t.entity===d.ConnectionEnd.client,t=t.session.sp,n=Ui(t.master_secret,e?"client finished":"server finished",n.getBytes(),12),t=D.util.createBuffer();return t.putByte(d.HandshakeType.finished),t.putInt24(n.length()),t.putBuffer(n),t},d.createHeartbeat=function(t,e,n){void 0===n&&(n=e.length);var r=D.util.createBuffer(),t=(r.putByte(t),r.putInt16(n),r.putBytes(e),r.length()),e=Math.max(16,t-n-3);return r.putBytes(D.random.getBytes(e)),r},d.queue=function(t,e){if(e&&(0!==e.fragment.length()||e.type!==d.ContentType.handshake&&e.type!==d.ContentType.alert&&e.type!==d.ContentType.change_cipher_spec)){var n;if(e.type===d.ContentType.handshake&&(n=e.fragment.bytes(),t.session.md5.update(n),t.session.sha1.update(n),n=null),e.fragment.length()<=d.MaxFragment)r=[e];else{for(var r=[],i=e.fragment.bytes();i.length>d.MaxFragment;)r.push(d.createRecord(t,{type:e.type,data:D.util.createBuffer(i.slice(0,d.MaxFragment))})),i=i.slice(d.MaxFragment);0<i.length&&r.push(d.createRecord(t,{type:e.type,data:D.util.createBuffer(i)}))}for(var o=0;o<r.length&&!t.fail;++o){var a=r[o];t.state.current.write.update(t,a)&&t.records.push(a)}}},d.flush=function(t){for(var e=0;e<t.records.length;++e){var n=t.records[e];t.tlsData.putByte(n.type),t.tlsData.putByte(n.version.major),t.tlsData.putByte(n.version.minor),t.tlsData.putInt16(n.fragment.length()),t.tlsData.putBuffer(t.records[e].fragment)}return t.records=[],t.tlsDataReady(t)},d.verifyCertificateChain=function(r,e){try{var t,n={};for(t in r.verifyOptions)n[t]=r.verifyOptions[t];n.verify=function(t,e,n){ji(t);e=r.verify(r,t,e,n);if(!0!==e){if("object"==typeof e&&!D.util.isArray(e))throw(n=new Error("The application rejected the certificate.")).send=!0,n.alert={level:d.Alert.Level.fatal,description:d.Alert.Description.bad_certificate},e.message&&(n.message=e.message),e.alert&&(n.alert.description=e.alert),n;e!==t&&(e=(t=>{switch(t){case!0:return!0;case d.Alert.Description.bad_certificate:return D.pki.certificateError.bad_certificate;case d.Alert.Description.unsupported_certificate:return D.pki.certificateError.unsupported_certificate;case d.Alert.Description.certificate_revoked:return D.pki.certificateError.certificate_revoked;case d.Alert.Description.certificate_expired:return D.pki.certificateError.certificate_expired;case d.Alert.Description.certificate_unknown:return D.pki.certificateError.certificate_unknown;case d.Alert.Description.unknown_ca:return D.pki.certificateError.unknown_ca;default:return D.pki.certificateError.bad_certificate}})(e))}return e},D.pki.verifyCertificateChain(r.caStore,e,n)}catch(t){e=t;"send"in(e="object"==typeof e&&!D.util.isArray(e)?e:{send:!0,alert:{level:d.Alert.Level.fatal,description:ji(t)}})||(e.send=!0),"alert"in e||(e.alert={level:d.Alert.Level.fatal,description:ji(e.error)}),r.error(r,e)}return!r.fail},d.createSessionCache=function(t,e){var i=null;if(t&&t.getSession&&t.setSession&&t.order)i=t;else{for(var n in(i={}).cache=t||{},i.capacity=Math.max(e||100,1),i.order=[],t)i.order.length<=e?i.order.push(n):delete t[n];i.getSession=function(t){var e=null,n=null;if(t?n=D.util.bytesToHex(t):0<i.order.length&&(n=i.order[0]),null!==n&&n in i.cache)for(var r in e=i.cache[n],delete i.cache[n],i.order)if(i.order[r]===n){i.order.splice(r,1);break}return e},i.setSession=function(t,e){i.order.length===i.capacity&&(n=i.order.shift(),delete i.cache[n]);var n=D.util.bytesToHex(t);i.order.push(n),i.cache[n]=e}}return i},d.createConnection=function(r){var t=null,t=r.caStore?D.util.isArray(r.caStore)?D.pki.createCaStore(r.caStore):r.caStore:D.pki.createCaStore(),e=r.cipherSuites||null;if(null===e)for(var n in e=[],d.CipherSuites)e.push(d.CipherSuites[n]);var i=r.server?d.ConnectionEnd.server:d.ConnectionEnd.client,o=r.sessionCache?d.createSessionCache(r.sessionCache):null,l={version:{major:d.Version.major,minor:d.Version.minor},entity:i,sessionId:r.sessionId,caStore:t,sessionCache:o,cipherSuites:e,connected:r.connected,virtualHost:r.virtualHost||null,verifyClient:r.verifyClient||!1,verify:r.verify||function(t,e,n,r){return e},verifyOptions:r.verifyOptions||{},getCertificate:r.getCertificate||null,getPrivateKey:r.getPrivateKey||null,getSignature:r.getSignature||null,input:D.util.createBuffer(),tlsData:D.util.createBuffer(),data:D.util.createBuffer(),tlsDataReady:r.tlsDataReady,dataReady:r.dataReady,heartbeatReceived:r.heartbeatReceived,closed:r.closed,error:function(t,e){e.origin=e.origin||(t.entity===d.ConnectionEnd.client?"client":"server"),e.send&&(d.queue(t,d.createAlert(t,e.alert)),d.flush(t));var n=!1!==e.fatal;n&&(t.fail=!0),r.error(t,e),n&&t.close(!1)},deflate:r.deflate||null,inflate:r.inflate||null,reset:function(t){l.version={major:d.Version.major,minor:d.Version.minor},l.record=null,l.session=null,l.peerCertificate=null,l.state={pending:null,current:null},l.expect=(d.ConnectionEnd.client,0),l.fragmented=null,l.records=[],l.open=!1,l.handshakes=0,l.handshaking=!1,l.isConnected=!1,l.fail=!(t||void 0===t),l.input.clear(),l.tlsData.clear(),l.data.clear(),l.state.current=d.createConnectionState(l)}};l.reset();return l.handshake=function(t){var e;l.entity!==d.ConnectionEnd.client?l.error(l,{message:"Cannot initiate handshake as a server.",fatal:!1}):l.handshaking?l.error(l,{message:"Handshake already in progress.",fatal:!1}):(l.fail&&!l.open&&0===l.handshakes&&(l.fail=!1),l.handshaking=!0,e=null,0===(t=0<(t=t||"").length&&null===(e=l.sessionCache?l.sessionCache.getSession(t):e)?"":t).length&&l.sessionCache&&null!==(e=l.sessionCache.getSession())&&(t=e.id),l.session={id:t,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:D.md.md5.create(),sha1:D.md.sha1.create()},e&&(l.version=e.version,l.session.sp=e.sp),l.session.sp.client_random=d.createRandom().getBytes(),l.open=!0,d.queue(l,d.createRecord(l,{type:d.ContentType.handshake,data:d.createClientHello(l)})),d.flush(l))},l.process=function(t){var e,n,r,i,o,a,s=0;return t&&l.input.putBytes(t),l.fail||(null!==l.record&&l.record.ready&&l.record.fragment.isEmpty()&&(l.record=null),null===l.record&&(t=0,o=(i=l).input,(a=o.length())<5?t=5-a:(i.record={type:o.getByte(),version:{major:o.getByte(),minor:o.getByte()},length:o.getInt16(),fragment:D.util.createBuffer(),ready:!1},(a=(a=i.record.version.major===i.version.major)&&i.session&&i.session.version?i.record.version.minor===i.version.minor:a)||i.error(i,{message:"Incompatible TLS version.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.protocol_version}})),s=t),l.fail||null===l.record||l.record.ready||(o=0,i=(a=l).input,(t=i.length())<a.record.length?o=a.record.length-t:(a.record.fragment.putBytes(i.getBytes(a.record.length)),i.compact(),a.state.current.read.update(a,a.record)&&(null!==a.fragmented&&(a.fragmented.type===a.record.type?(a.fragmented.fragment.putBuffer(a.record.fragment),a.record=a.fragmented):a.error(a,{message:"Invalid fragmented record.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.unexpected_message}})),a.record.ready=!0)),s=o),!l.fail&&null!==l.record&&l.record.ready&&(n=(e=(t=l).record).type-d.ContentType.change_cipher_spec,r=ao[t.entity][t.expect],n in r?r[n](t,e):d.handleUnexpected(t,e))),s},l.prepare=function(t){return d.queue(l,d.createRecord(l,{type:d.ContentType.application_data,data:D.util.createBuffer(t)})),d.flush(l)},l.prepareHeartbeatRequest=function(t,e){return t instanceof D.util.ByteBuffer&&(t=t.bytes()),void 0===e&&(e=t.length),l.expectedHeartbeatPayload=t,d.queue(l,d.createRecord(l,{type:d.ContentType.heartbeat,data:d.createHeartbeat(d.HeartbeatMessageType.heartbeat_request,t,e)})),d.flush(l)},l.close=function(t){var e;!l.fail&&l.sessionCache&&l.session&&((e={id:l.session.id,version:l.session.version,sp:l.session.sp}).sp.keys=null,l.sessionCache.setSession(e.id,e)),l.open&&(l.open=!1,l.input.clear(),(l.isConnected||l.handshaking)&&(l.isConnected=l.handshaking=!1,d.queue(l,d.createAlert(l,{level:d.Alert.Level.warning,description:d.Alert.Description.close_notify})),d.flush(l)),l.closed(l)),l.reset(t)},l},D.tls=D.tls||{},d)"function"!=typeof d[qi]&&(D.tls[qi]=d[qi]);D.tls.prf_tls1=Ui,D.tls.hmac_sha1=function(t,e,n){var r=D.hmac.create(),t=(r.start("SHA1",t),D.util.createBuffer());return t.putInt32(e[0]),t.putInt32(e[1]),t.putByte(n.type),t.putByte(n.version.major),t.putByte(n.version.minor),t.putInt16(n.length),t.putBytes(n.fragment.bytes()),r.update(t.getBytes()),r.digest().getBytes()},D.tls.createSessionCache=d.createSessionCache,D.tls.createConnection=d.createConnection,F(function(t){var s=t.exports=D.tls;function e(t,e,n){e=e.entity===D.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:D.cipher.createDecipher("AES-CBC",e?n.keys.server_write_key:n.keys.client_write_key),iv:e?n.keys.server_write_IV:n.keys.client_write_IV},t.write.cipherState={init:!1,cipher:D.cipher.createCipher("AES-CBC",e?n.keys.client_write_key:n.keys.server_write_key),iv:e?n.keys.client_write_IV:n.keys.server_write_IV},t.read.cipherFunction=o,t.write.cipherFunction=r,t.read.macLength=t.write.macLength=n.mac_length,t.read.macFunction=t.write.macFunction=s.hmac_sha1}function r(t,e){var n=!1,r=e.macFunction(e.macKey,e.sequenceNumber,t),e=(t.fragment.putBytes(r),e.updateSequenceNumber(),r=t.version.minor===s.Versions.TLS_1_0.minor?e.cipherState.init?null:e.cipherState.iv:D.random.getBytesSync(16),e.cipherState.init=!0,e.cipherState.cipher);return e.start({iv:r}),t.version.minor>=s.Versions.TLS_1_1.minor&&e.output.putBytes(r),e.update(t.fragment),e.finish(i)&&(t.fragment=e.output,t.length=t.fragment.length(),n=!0),n}function i(t,e,n){return n||(n=t-e.length()%t,e.fillWithByte(n-1,n)),!0}function l(t,e,n){var r=!0;if(n){for(var i=e.length(),o=e.last(),a=i-1-o;a<i-1;++a)r=r&&e.at(a)==o;r&&e.truncate(o+1)}return r}function o(t,e){var n=t.version.minor===s.Versions.TLS_1_0.minor?e.cipherState.init?null:e.cipherState.iv:t.fragment.getBytes(16),r=(e.cipherState.init=!0,e.cipherState.cipher),i=(r.start({iv:n}),r.update(t.fragment),n=r.finish(l),e.macLength),o=D.random.getBytesSync(i),a=r.output.length(),a=(i<=a?(t.fragment=r.output.getBytes(a-i),o=r.output.getBytes(i)):t.fragment=r.output.getBytes(),t.fragment=D.util.createBuffer(t.fragment),t.length=t.fragment.length(),e.macFunction(e.macKey,e.sequenceNumber,t));return e.updateSequenceNumber(),i=e.macKey,r=o,t=a,(e=D.hmac.create()).start("SHA1",i),e.update(r),r=e.digest().getBytes(),e.start(null,null),e.update(t),t=e.digest().getBytes(),r===t&&n}s.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=s.BulkCipherAlgorithm.aes,t.cipher_type=s.CipherType.block,t.enc_key_length=16,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=s.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:e},s.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=s.BulkCipherAlgorithm.aes,t.cipher_type=s.CipherType.block,t.enc_key_length=32,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=s.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:e}}),D.debug=D.debug||{},D.debug.storage={},D.debug.get=function(t,e){var n;return void 0===t?n=D.debug.storage:t in D.debug.storage&&(n=void 0===e?D.debug.storage[t]:D.debug.storage[t][e]),n},D.debug.set=function(t,e,n){t in D.debug.storage||(D.debug.storage[t]={}),D.debug.storage[t][e]=n},D.debug.clear=function(t,e){void 0===t?D.debug.storage={}:t in D.debug.storage&&(void 0===e?delete D.debug.storage[t]:delete D.debug.storage[t][e])},F(function(t){var e=t.exports=D.sha512=D.sha512||{},t=(D.md.sha512=D.md.algorithms.sha512=e,D.sha384=D.sha512.sha384=D.sha512.sha384||{}),p=(t.create=function(){return e.create("SHA-384")},D.md.sha384=D.md.algorithms.sha384=t,D.sha512.sha256=D.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},D.md["sha512/256"]=D.md.algorithms["sha512/256"]=D.sha512.sha256,D.sha512.sha224=D.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},D.md["sha512/224"]=D.md.algorithms["sha512/224"]=D.sha512.sha224,e.create=function(l){if(r||(p=String.fromCharCode(128),p+=D.util.fillString(String.fromCharCode(0),128),L=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],i={"SHA-512":[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],"SHA-384":[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],"SHA-512/256":[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],"SHA-512/224":[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]]},r=!0),!((l=void 0===l?"SHA-512":l)in i))throw new Error("Invalid SHA-512 algorithm: "+l);for(var n=i[l],u=null,c=D.util.createBuffer(),h=new Array(80),t=0;t<80;++t)h[t]=new Array(2);var e=64;switch(l){case"SHA-384":e=48;break;case"SHA-512/256":e=32;break;case"SHA-512/224":e=28}var d={algorithm:l.replace("-","").toLowerCase(),blockLength:128,digestLength:e,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){d.messageLength=0,d.fullMessageLength=d.messageLength128=[];for(var t=d.messageLengthSize/4,e=0;e<t;++e)d.fullMessageLength.push(0);c=D.util.createBuffer(),u=new Array(n.length);for(e=0;e<n.length;++e)u[e]=n[e].slice(0);return d}};return d.start(),d.update=function(t,e){var n=(t="utf8"===e?D.util.encodeUtf8(t):t).length;d.messageLength+=n;for(var n=[n/4294967296>>>0,n>>>0],r=d.fullMessageLength.length-1;0<=r;--r)d.fullMessageLength[r]+=n[1],n[1]=n[0]+(d.fullMessageLength[r]/4294967296>>>0),d.fullMessageLength[r]=d.fullMessageLength[r]>>>0,n[0]=n[1]/4294967296>>>0;return c.putBytes(t),f(u,h,c),(2048<c.read||0===c.length())&&c.compact(),d},d.digest=function(){for(var t,e=D.util.createBuffer(),n=(e.putBytes(c.bytes()),d.fullMessageLength[d.fullMessageLength.length-1]+d.messageLengthSize),r=(e.putBytes(p.substr(0,d.blockLength-(n&d.blockLength-1))),8*d.fullMessageLength[0]),i=0;i<d.fullMessageLength.length-1;++i)r+=(t=8*d.fullMessageLength[i+1])/4294967296>>>0,e.putInt32(r>>>0),r=t>>>0;e.putInt32(r);for(var o=new Array(u.length),i=0;i<u.length;++i)o[i]=u[i].slice(0);f(o,h,e);for(var a=D.util.createBuffer(),s="SHA-512"===l?o.length:"SHA-384"===l?o.length-2:o.length-4,i=0;i<s;++i)a.putInt32(o[i][0]),i===s-1&&"SHA-512/224"===l||a.putInt32(o[i][1]);return a},d},null),r=!1,L=null,i=null;function f(t,e,n){for(var r,i,o,a,s,l,u,c,h,d,p,f,g,m,y,v,_,w,b,C,E,S,T,A,I=n.length();128<=I;){for(E=0;E<16;++E)e[E][0]=n.getInt32()>>>0,e[E][1]=n.getInt32()>>>0;for(;E<80;++E)r=(((A=(T=e[E-2])[0])>>>19|(S=T[1])<<13)^(S>>>29|A<<3)^A>>>6)>>>0,i=((A<<13|S>>>19)^(S<<3|A>>>29)^(A<<26|S>>>6))>>>0,o=(((A=(T=e[E-15])[0])>>>1|(S=T[1])<<31)^(A>>>8|S<<24)^A>>>7)>>>0,S=i+(T=e[E-7])[1]+(a=((A<<31|S>>>1)^(A<<24|S>>>8)^(A<<25|S>>>7))>>>0)+(A=e[E-16])[1],e[E][0]=r+T[0]+o+A[0]+(S/4294967296>>>0)>>>0,e[E][1]=S>>>0;for(s=t[0][0],l=t[0][1],u=t[1][0],c=t[1][1],h=t[2][0],d=t[2][1],p=t[3][0],f=t[3][1],g=t[4][0],m=t[4][1],y=t[5][0],v=t[5][1],_=t[6][0],w=t[6][1],b=t[7][0],C=t[7][1],E=0;E<80;++E)S=C+(((g<<18|m>>>14)^(g<<14|m>>>18)^(m<<23|g>>>9))>>>0)+((w^m&(v^w))>>>0)+L[E][1]+e[E][1],r=b+(((g>>>14|m<<18)^(g>>>18|m<<14)^(m>>>9|g<<23))>>>0)+((_^g&(y^_))>>>0)+L[E][0]+e[E][0]+(S/4294967296>>>0)>>>0,i=S>>>0,o=(((s>>>28|l<<4)^(l>>>2|s<<30)^(l>>>7|s<<25))>>>0)+((s&u|h&(s^u))>>>0)+((S=(((s<<4|l>>>28)^(l<<30|s>>>2)^(l<<25|s>>>7))>>>0)+((l&c|d&(l^c))>>>0))/4294967296>>>0)>>>0,a=S>>>0,b=_,C=w,_=y,w=v,y=g,v=m,g=p+r+((S=f+i)/4294967296>>>0)>>>0,m=S>>>0,p=h,f=d,h=u,d=c,u=s,c=l,s=r+o+((S=i+a)/4294967296>>>0)>>>0,l=S>>>0;S=t[0][1]+l,t[0][0]=t[0][0]+s+(S/4294967296>>>0)>>>0,t[0][1]=S>>>0,S=t[1][1]+c,t[1][0]=t[1][0]+u+(S/4294967296>>>0)>>>0,t[1][1]=S>>>0,S=t[2][1]+d,t[2][0]=t[2][0]+h+(S/4294967296>>>0)>>>0,t[2][1]=S>>>0,S=t[3][1]+f,t[3][0]=t[3][0]+p+(S/4294967296>>>0)>>>0,t[3][1]=S>>>0,S=t[4][1]+m,t[4][0]=t[4][0]+g+(S/4294967296>>>0)>>>0,t[4][1]=S>>>0,S=t[5][1]+v,t[5][0]=t[5][0]+y+(S/4294967296>>>0)>>>0,t[5][1]=S>>>0,S=t[6][1]+w,t[6][0]=t[6][0]+_+(S/4294967296>>>0)>>>0,t[6][1]=S>>>0,S=t[7][1]+C,t[7][0]=t[7][0]+b+(S/4294967296>>>0)>>>0,t[7][1]=S>>>0,I-=128}}});var r=D.asn1,lo=(i={privateKeyValidator:{name:"PrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},publicKeyValidator:{name:"SubjectPublicKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:r.Class.UNIVERSAL,type:r.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}}).publicKeyValidator,uo=i.privateKeyValidator,co=(D.jsbn.BigInteger,D.util.ByteBuffer),ho="undefined"==typeof Buffer?Uint8Array:Buffer,po=(D.pki=D.pki||{},D.pki.ed25519=D.ed25519=D.ed25519||{},D.ed25519);function fo(t){var e=t.message;if(e instanceof Uint8Array||e instanceof ho)return e;var n=t.encoding;if(void 0===e){if(!t.md)throw new TypeError('"options.message" or "options.md" not specified.');e=t.md.digest().getBytes(),n="binary"}if("string"==typeof e&&!n)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.from(e,n);e=new co(e,n)}else if(!(e instanceof co))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var r=new ho(e.length()),i=0;i<r.length;++i)r[i]=e.at(i);return r}po.constants={},po.constants.PUBLIC_KEY_BYTE_LENGTH=32,po.constants.PRIVATE_KEY_BYTE_LENGTH=64,po.constants.SEED_BYTE_LENGTH=32,po.constants.SIGN_BYTE_LENGTH=64,po.constants.HASH_BYTE_LENGTH=64,po.generateKeyPair=function(t){if(void 0===(e=(t=t||{}).seed))e=D.random.getBytesSync(po.constants.SEED_BYTE_LENGTH);else if("string"==typeof e){if(e.length!==po.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+po.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');for(var e=fo({message:e,encoding:"binary"}),t=new ho(po.constants.PUBLIC_KEY_BYTE_LENGTH),n=new ho(po.constants.PRIVATE_KEY_BYTE_LENGTH),r=0;r<32;++r)n[r]=e[r];var i,o=t,a=n,s=[w(),w(),w(),w()],l=Eo(a,32);for(l[0]&=248,l[31]&=127,l[31]|=64,Po(s,l),Lo(o,s),i=0;i<32;++i)a[i+32]=o[i];return{publicKey:t,privateKey:n}},po.privateKeyFromAsn1=function(t){var e={},n=[];if(!D.asn1.validate(t,uo,e,n))throw(t=new Error("Invalid Key.")).errors=n,t;n=D.asn1.derToOid(e.privateKeyOid),t=D.oids.EdDSA25519;if(n!==t)throw new Error('Invalid OID "'+n+'"; OID must be "'+t+'".');return{privateKeyBytes:fo({message:D.asn1.fromDer(e.privateKey).value,encoding:"binary"})}},po.publicKeyFromAsn1=function(t){var e={},n=[];if(!D.asn1.validate(t,lo,e,n))throw(t=new Error("Invalid Key.")).errors=n,t;n=D.asn1.derToOid(e.publicKeyOid),t=D.oids.EdDSA25519;if(n!==t)throw new Error('Invalid OID "'+n+'"; OID must be "'+t+'".');n=e.ed25519PublicKey;if(n.length!==po.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return fo({message:n,encoding:"binary"})},po.publicKeyFromPrivateKey=function(t){var e=fo({message:(t=t||{}).privateKey,encoding:"binary"});if(e.length!==po.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+po.constants.PRIVATE_KEY_BYTE_LENGTH);for(var n=new ho(po.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<n.length;++r)n[r]=e[32+r];return n},po.sign=function(t){var e=fo(t=t||{});if((t=fo({message:t.privateKey,encoding:"binary"})).length===po.constants.SEED_BYTE_LENGTH)t=po.generateKeyPair({seed:t}).privateKey;else if(t.length!==po.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+po.constants.SEED_BYTE_LENGTH+" or "+po.constants.PRIVATE_KEY_BYTE_LENGTH);var n,r,i=new ho(po.constants.SIGN_BYTE_LENGTH+e.length),o=i,a=e,s=e.length,l=t,u=new Float64Array(64),e=[w(),w(),w(),w()],c=Eo(l,32);c[0]&=248,c[31]&=127,c[31]|=64;for(n=0;n<s;++n)o[64+n]=a[n];for(n=0;n<32;++n)o[32+n]=c[32+n];var h=Eo(o.subarray(32),s+32);for(To(h),Po(e,h),Lo(o,e),n=32;n<64;++n)o[n]=l[n];var d=Eo(o,s+64);for(To(d),n=32;n<64;++n)u[n]=0;for(n=0;n<32;++n)u[n]=h[n];for(n=0;n<32;++n)for(r=0;r<32;r++)u[n+r]+=d[n]*c[r];So(o.subarray(32),u);for(var p=new ho(po.constants.SIGN_BYTE_LENGTH),f=0;f<p.length;++f)p[f]=i[f];return p},po.verify=function(t){var e=fo(t=t||{});if(void 0===t.signature)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var n=fo({message:t.signature,encoding:"binary"});if(n.length!==po.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+po.constants.SIGN_BYTE_LENGTH);t=fo({message:t.publicKey,encoding:"binary"});if(t.length!==po.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+po.constants.PUBLIC_KEY_BYTE_LENGTH);for(var r=new ho(po.constants.SIGN_BYTE_LENGTH+e.length),i=new ho(po.constants.SIGN_BYTE_LENGTH+e.length),o=0;o<po.constants.SIGN_BYTE_LENGTH;++o)r[o]=n[o];for(o=0;o<e.length;++o)r[o+po.constants.SIGN_BYTE_LENGTH]=e[o];return 0<=((t,e,n,r)=>{var i,o=new ho(32),a=[w(),w(),w(),w()],s=[w(),w(),w(),w()];if(n<64)return-1;if(((t,e)=>{var n,r=w(),i=w(),o=w(),a=w(),s=w(),l=w(),u=w(),c=(Oo(t[2],mo),t[1]),h=e;for(n=0;n<16;++n)c[n]=h[2*n]+(h[2*n+1]<<8);c[15]&=32767,Vo(o,t[1]),Ho(a,o,yo),Fo(o,o,t[2]),Uo(a,t[2],a),Vo(s,a),Vo(l,s),Ho(u,l,s),Ho(r,u,o),Ho(r,r,a);var d,p=r,f=r,g=w();for(d=0;d<16;++d)g[d]=f[d];for(d=250;0<=d;--d)Vo(g,g),1!==d&&Ho(g,g,f);for(d=0;d<16;++d)p[d]=g[d];return Ho(r,r,o),Ho(r,r,a),Ho(r,r,a),Ho(t[0],r,a),Vo(i,t[0]),Ho(i,i,a),xo(i,o)&&Ho(t[0],t[0],Co),Vo(i,t[0]),Ho(i,i,a),xo(i,o)||(No(t[0])===e[31]>>7&&Fo(t[0],go,t[0]),Ho(t[3],t[0],t[1]),0)})(s,r))return-1;for(i=0;i<n;++i)t[i]=e[i];for(i=0;i<32;++i)t[i+32]=r[i];var l=Eo(t,n);if(To(l),Ro(a,s,l),Po(s,e.subarray(32)),Ao(a,s),Lo(o,a),n-=64,Do(e,0,o,0)){for(i=0;i<n;++i)t[i]=0;return-1}for(i=0;i<n;++i)t[i]=e[i+64];return n})(i,r,r.length,t)};var go=w(),mo=w([1]),yo=w([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),vo=w([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_o=w([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),wo=w([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),bo=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),Co=w([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Eo(t,e){var n=D.md.sha512.create(),t=new co(t),r=(n.update(t.getBytes(e),"binary"),n.digest().getBytes());if("undefined"!=typeof Buffer)return Buffer.from(r,"binary");for(var i=new ho(po.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)i[o]=r.charCodeAt(o);return i}function So(t,e){for(var n,r,i,o=63;32<=o;--o){for(n=0,r=o-32,i=o-12;r<i;++r)e[r]+=n-16*e[o]*bo[r-(o-32)],e[r]-=256*(n=e[r]+128>>8);e[r]+=n,e[o]=0}for(r=n=0;r<32;++r)e[r]+=n-(e[31]>>4)*bo[r],n=e[r]>>8,e[r]&=255;for(r=0;r<32;++r)e[r]-=n*bo[r];for(o=0;o<32;++o)e[o+1]+=e[o]>>8,t[o]=255&e[o]}function To(t){for(var e=new Float64Array(64),n=0;n<64;++n)e[n]=t[n],t[n]=0;So(t,e)}function Ao(t,e){var n=w(),r=w(),i=w(),o=w(),a=w(),s=w(),l=w(),u=w(),c=w();Fo(n,t[1],t[0]),Fo(c,e[1],e[0]),Ho(n,n,c),Uo(r,t[0],t[1]),Uo(c,e[0],e[1]),Ho(r,r,c),Ho(i,t[3],e[3]),Ho(i,i,vo),Ho(o,t[2],e[2]),Uo(o,o,o),Fo(a,r,n),Fo(s,o,i),Uo(l,o,i),Uo(u,r,n),Ho(t[0],a,s),Ho(t[1],u,l),Ho(t[2],l,s),Ho(t[3],a,u)}function Io(t,e,n){for(var r=0;r<4;++r)Bo(t[r],e[r],n)}function Lo(t,e){var n,r=w(),i=w(),o=w(),a=o,s=e[2],l=w();for(n=0;n<16;++n)l[n]=s[n];for(n=253;0<=n;--n)Vo(l,l),2!==n&&4!==n&&Ho(l,l,s);for(n=0;n<16;++n)a[n]=l[n];Ho(r,e[0],o),Ho(i,e[1],o),ko(t,i),t[31]^=No(r)<<7}function ko(t,e){for(var n,r,i=w(),o=w(),a=0;a<16;++a)o[a]=e[a];for(Mo(o),Mo(o),Mo(o),n=0;n<2;++n){for(i[0]=o[0]-65517,a=1;a<15;++a)i[a]=o[a]-65535-(i[a-1]>>16&1),i[a-1]&=65535;i[15]=o[15]-32767-(i[14]>>16&1),r=i[15]>>16&1,i[14]&=65535,Bo(o,i,1-r)}for(a=0;a<16;a++)t[2*a]=255&o[a],t[2*a+1]=o[a]>>8}function xo(t,e){var n=new ho(32),r=new ho(32);return ko(n,t),ko(r,e),Do(n,0,r,0)}function Do(t,e,n,r){var i,o=t,a=e,s=n,l=r,u=32,c=0;for(i=0;i<u;++i)c|=o[a+i]^s[l+i];return(1&c-1>>>8)-1}function No(t){var e=new ho(32);return ko(e,t),1&e[0]}function Ro(t,e,n){var r,i;for(Oo(t[0],go),Oo(t[1],mo),Oo(t[2],mo),Oo(t[3],go),i=255;0<=i;--i)Io(t,e,r=n[i/8|0]>>(7&i)&1),Ao(e,t),Ao(t,t),Io(t,e,r)}function Po(t,e){var n=[w(),w(),w(),w()];Oo(n[0],_o),Oo(n[1],wo),Oo(n[2],mo),Ho(n[3],_o,wo),Ro(t,n,e)}function Oo(t,e){for(var n=0;n<16;n++)t[n]=0|e[n]}function Mo(t){for(var e,n=1,r=0;r<16;++r)e=t[r]+n+65535,n=Math.floor(e/65536),t[r]=e-65536*n;t[0]+=n-1+37*(n-1)}function Bo(t,e,n){for(var r,i=~(n-1),o=0;o<16;++o)r=i&(t[o]^e[o]),t[o]^=r,e[o]^=r}function w(t){var e,n=new Float64Array(16);if(t)for(e=0;e<t.length;++e)n[e]=t[e];return n}function Uo(t,e,n){for(var r=0;r<16;++r)t[r]=e[r]+n[r]}function Fo(t,e,n){for(var r=0;r<16;++r)t[r]=e[r]-n[r]}function Vo(t,e){Ho(t,e,e)}function Ho(t,e,n){var M=0,B=0,U=0,F=0,r=0,i=0,o=0,a=0,s=0,l=0,u=0,c=0,h=0,d=0,p=0,f=0,g=0,m=0,y=0,v=0,_=0,V=0,H=0,z=0,j=0,q=0,W=0,G=0,$=0,K=0,X=0,w=n[0],b=n[1],C=n[2],E=n[3],S=n[4],T=n[5],A=n[6],I=n[7],L=n[8],k=n[9],x=n[10],D=n[11],N=n[12],R=n[13],P=n[14],n=n[15],O=e[0];M+=O*w,U+=O*C,F+=O*E,r+=O*S,i+=O*T,o+=O*A,a+=O*I,s+=O*L,l+=O*k,u+=O*x,c+=O*D,h+=O*N,d+=O*R,p+=O*P,f+=O*n,B=0+O*b+(O=e[1])*w,F+=O*C,r+=O*E,i+=O*S,o+=O*T,a+=O*A,s+=O*I,l+=O*L,u+=O*k,c+=O*x,h+=O*D,d+=O*N,p+=O*R,f+=O*P,g+=O*n,U=U+O*b+(O=e[2])*w,r+=O*C,i+=O*E,o+=O*S,a+=O*T,s+=O*A,l+=O*I,u+=O*L,c+=O*k,h+=O*x,d+=O*D,p+=O*N,f+=O*R,g+=O*P,m+=O*n,F=F+O*b+(O=e[3])*w,i+=O*C,o+=O*E,a+=O*S,s+=O*T,l+=O*A,u+=O*I,c+=O*L,h+=O*k,d+=O*x,p+=O*D,f+=O*N,g+=O*R,m+=O*P,y+=O*n,r=r+O*b+(O=e[4])*w,o+=O*C,a+=O*E,s+=O*S,l+=O*T,u+=O*A,c+=O*I,h+=O*L,d+=O*k,p+=O*x,f+=O*D,g+=O*N,m+=O*R,y+=O*P,v+=O*n,i=i+O*b+(O=e[5])*w,a+=O*C,s+=O*E,l+=O*S,u+=O*T,c+=O*A,h+=O*I,d+=O*L,p+=O*k,f+=O*x,g+=O*D,m+=O*N,y+=O*R,v+=O*P,_+=O*n,o=o+O*b+(O=e[6])*w,s+=O*C,l+=O*E,u+=O*S,c+=O*T,h+=O*A,d+=O*I,p+=O*L,f+=O*k,g+=O*x,m+=O*D,y+=O*N,v+=O*R,_+=O*P,V+=O*n,a=a+O*b+(O=e[7])*w,l+=O*C,u+=O*E,c+=O*S,h+=O*T,d+=O*A,p+=O*I,f+=O*L,g+=O*k,m+=O*x,y+=O*D,v+=O*N,_+=O*R,V+=O*P,H+=O*n,s=s+O*b+(O=e[8])*w,u+=O*C,c+=O*E,h+=O*S,d+=O*T,p+=O*A,f+=O*I,g+=O*L,m+=O*k,y+=O*x,v+=O*D,_+=O*N,V+=O*R,H+=O*P,z+=O*n,l=l+O*b+(O=e[9])*w,c+=O*C,h+=O*E,d+=O*S,p+=O*T,f+=O*A,g+=O*I,m+=O*L,y+=O*k,v+=O*x,_+=O*D,V+=O*N,H+=O*R,z+=O*P,j+=O*n,u=u+O*b+(O=e[10])*w,h+=O*C,d+=O*E,p+=O*S,f+=O*T,g+=O*A,m+=O*I,y+=O*L,v+=O*k,_+=O*x,V+=O*D,H+=O*N,z+=O*R,j+=O*P,q+=O*n,c=c+O*b+(O=e[11])*w,d+=O*C,p+=O*E,f+=O*S,g+=O*T,m+=O*A,y+=O*I,v+=O*L,_+=O*k,V+=O*x,H+=O*D,z+=O*N,j+=O*R,q+=O*P,W+=O*n,h=h+O*b+(O=e[12])*w,p+=O*C,f+=O*E,g+=O*S,m+=O*T,y+=O*A,v+=O*I,_+=O*L,V+=O*k,H+=O*x,z+=O*D,j+=O*N,q+=O*R,W+=O*P,G+=O*n,d=d+O*b+(O=e[13])*w,f+=O*C,g+=O*E,m+=O*S,y+=O*T,v+=O*A,_+=O*I,V+=O*L,H+=O*k,z+=O*x,j+=O*D,q+=O*N,W+=O*R,G+=O*P,$+=O*n,p=p+O*b+(O=e[14])*w,g+=O*C,m+=O*E,y+=O*S,v+=O*T,_+=O*A,V+=O*I,H+=O*L,z+=O*k,j+=O*x,q+=O*D,W+=O*N,G+=O*R,$+=O*P,K+=O*n,f=f+O*b+(O=e[15])*w,B+=38*(m+=O*C),U+=38*(y+=O*E),F+=38*(v+=O*S),r+=38*(_+=O*T),i+=38*(V+=O*A),o+=38*(H+=O*I),a+=38*(z+=O*L),s+=38*(j+=O*k),l+=38*(q+=O*x),u+=38*(W+=O*D),c+=38*(G+=O*N),h+=38*($+=O*R),d+=38*(K+=O*P),p+=38*(X+=O*n),M=(O=1+(M+=38*(g+=O*b))+65535)-65536*(e=Math.floor(O/65536)),B=(O=B+e+65535)-65536*(e=Math.floor(O/65536)),U=(O=U+e+65535)-65536*(e=Math.floor(O/65536)),F=(O=F+e+65535)-65536*(e=Math.floor(O/65536)),r=(O=r+e+65535)-65536*(e=Math.floor(O/65536)),i=(O=i+e+65535)-65536*(e=Math.floor(O/65536)),o=(O=o+e+65535)-65536*(e=Math.floor(O/65536)),a=(O=a+e+65535)-65536*(e=Math.floor(O/65536)),s=(O=s+e+65535)-65536*(e=Math.floor(O/65536)),l=(O=l+e+65535)-65536*(e=Math.floor(O/65536)),u=(O=u+e+65535)-65536*(e=Math.floor(O/65536)),c=(O=c+e+65535)-65536*(e=Math.floor(O/65536)),h=(O=h+e+65535)-65536*(e=Math.floor(O/65536)),d=(O=d+e+65535)-65536*(e=Math.floor(O/65536)),p=(O=p+e+65535)-65536*(e=Math.floor(O/65536)),f=(O=f+e+65535)-65536*(e=Math.floor(O/65536)),M+=e-1+37*(e-1),M=(O=1+M+65535)-65536*(e=Math.floor(O/65536)),B=(O=B+e+65535)-65536*(e=Math.floor(O/65536)),U=(O=U+e+65535)-65536*(e=Math.floor(O/65536)),F=(O=F+e+65535)-65536*(e=Math.floor(O/65536)),r=(O=r+e+65535)-65536*(e=Math.floor(O/65536)),i=(O=i+e+65535)-65536*(e=Math.floor(O/65536)),o=(O=o+e+65535)-65536*(e=Math.floor(O/65536)),a=(O=a+e+65535)-65536*(e=Math.floor(O/65536)),s=(O=s+e+65535)-65536*(e=Math.floor(O/65536)),l=(O=l+e+65535)-65536*(e=Math.floor(O/65536)),u=(O=u+e+65535)-65536*(e=Math.floor(O/65536)),c=(O=c+e+65535)-65536*(e=Math.floor(O/65536)),h=(O=h+e+65535)-65536*(e=Math.floor(O/65536)),d=(O=d+e+65535)-65536*(e=Math.floor(O/65536)),p=(O=p+e+65535)-65536*(e=Math.floor(O/65536)),f=(O=f+e+65535)-65536*(e=Math.floor(O/65536)),t[0]=M+=e-1+37*(e-1),t[1]=B,t[2]=U,t[3]=F,t[4]=r,t[5]=i,t[6]=o,t[7]=a,t[8]=s,t[9]=l,t[10]=u,t[11]=c,t[12]=h,t[13]=d,t[14]=p,t[15]=f}D.kem=D.kem||{};var zo=D.jsbn.BigInteger;function jo(t,s,l,u){t.generate=function(t,e){for(var n=new D.util.ByteBuffer,r=Math.ceil(e/u)+l,i=new D.util.ByteBuffer,o=l;o<r;++o){i.putInt32(o),s.start(),s.update(t+i.getBytes());var a=s.digest();n.putBytes(a.getBytes(u))}return n.truncate(n.length()-e),n.getBytes()}}D.kem.rsa={},D.kem.rsa.create=function(o,t){var a=(t=t||{}).prng||D.random,t={encrypt:function(t,e){for(var n=Math.ceil(t.n.bitLength()/8);(r=new zo(D.util.bytesToHex(a.getBytesSync(n)),16).mod(t.n)).compareTo(zo.ONE)<=0;);var r,i=n-(r=D.util.hexToBytes(r.toString(16))).length;return 0<i&&(r=D.util.fillString(String.fromCharCode(0),i)+r),{encapsulation:t.encrypt(r,"NONE"),key:o.generate(r,e)}},decrypt:function(t,e,n){t=t.decrypt(e,"NONE");return o.generate(t,n)}};return t},D.kem.kdf1=function(t,e){jo(this,t,0,e||t.digestLength)},D.kem.kdf2=function(t,e){jo(this,t,1,e||t.digestLength)},D.log=D.log||{},D.log.levels=["none","error","warning","info","debug","verbose","max"];var qo={},Wo=[],e=null;D.log.LEVEL_LOCKED=2,D.log.NO_LEVEL_CHECK=4,D.log.INTERPOLATE=8;for(var Go=0;Go<D.log.levels.length;++Go){var $o=D.log.levels[Go];qo[$o]={index:Go,name:$o.toUpperCase()}}D.log.logMessage=function(t){for(var e=qo[t.level].index,n=0;n<Wo.length;++n){var r=Wo[n];r.flags&D.log.NO_LEVEL_CHECK?r.f(t):e<=qo[r.level].index&&r.f(r,t)}},D.log.prepareStandard=function(t){"standard"in t||(t.standard=qo[t.level].name+" ["+t.category+"] "+t.message)},D.log.prepareFull=function(t){var e;"full"in t||(e=(e=[t.message]).concat([]),t.full=D.util.format.apply(this,e))},D.log.prepareStandardFull=function(t){"standardFull"in t||(D.log.prepareStandard(t),t.standardFull=t.standard)};for(var Ko,Xo=["error","warning","info","debug","verbose"],Go=0;Go<Xo.length;++Go)(r=>{D.log[r]=function(t,e){var n=Array.prototype.slice.call(arguments).slice(2),t={timestamp:new Date,level:r,category:t,message:e,arguments:n};D.log.logMessage(t)}})(Xo[Go]);function Zo(t){this.id=-1,this.name=t.name||"?",this.parent=t.parent||null,this.run=t.run,this.subtasks=[],this.error=!1,this.state=ea,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=Jo++,Qo[this.id]=this}D.log.makeLogger=function(t){t={flags:0,f:t};return D.log.setLevel(t,"none"),t},D.log.setLevel=function(t,e){var n=!1;if(t&&!(t.flags&D.log.LEVEL_LOCKED))for(var r=0;r<D.log.levels.length;++r)if(e==D.log.levels[r]){t.level=e,n=!0;break}return n},D.log.lock=function(t,e){void 0===e||e?t.flags|=D.log.LEVEL_LOCKED:t.flags&=~D.log.LEVEL_LOCKED},D.log.addLogger=function(t){Wo.push(t)},"undefined"!=typeof console&&"log"in console?(n=console.error&&console.warn&&console.info&&console.debug?(Ko={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},D.log.makeLogger(function(t,e){D.log.prepareStandard(e);var n=Ko[e.level],r=(r=[e.standard]).concat(e.arguments.slice());n.apply(console,r)})):D.log.makeLogger(function(t,e){D.log.prepareStandardFull(e),console.log(e.standardFull)}),D.log.setLevel(n,"debug"),D.log.addLogger(n),e=n):console={log:function(){}},null!==e&&("console.level"in(oo=D.util.getQueryVariables())&&D.log.setLevel(e,oo["console.level"].slice(-1)[0]),"console.lock"in oo)&&"true"==oo["console.lock"].slice(-1)[0]&&D.log.lock(e),D.log.consoleLogger=e,F(function(t){var f=D.asn1,o=t.exports=D.pkcs7=D.pkcs7||{};function g(t){var e,n,r,i,o;return t.type===D.pki.oids.contentType?e=f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.value).getBytes()):t.type===D.pki.oids.messageDigest?e=f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.value.bytes()):t.type===D.pki.oids.signingTime&&(n=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),"string"==typeof(o=t.value)&&(i=Date.parse(o),o=isNaN(i)?13===o.length?f.utcTimeToDate(o):f.generalizedTimeToDate(o):new Date(i)),e=n<=o&&o<r?f.create(f.Class.UNIVERSAL,f.Type.UTCTIME,!1,f.dateToUtcTime(o)):f.create(f.Class.UNIVERSAL,f.Type.GENERALIZEDTIME,!1,f.dateToGeneralizedTime(o))),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.type).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[e])])}function r(t,e,n){var r={};if(!f.validate(e,n,r,[]))throw(e=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.")).errors=e;if(f.derToOid(r.contentType)!==D.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var i="";if(D.util.isArray(r.encryptedContent))for(var o=0;o<r.encryptedContent.length;++o){if(r.encryptedContent[o].type!==f.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");i+=r.encryptedContent[o].value}else i=r.encryptedContent;t.encryptedContent={algorithm:f.derToOid(r.encAlgorithm),parameter:D.util.createBuffer(r.encParameter.value),content:D.util.createBuffer(i)}}if(r.content){i="";if(D.util.isArray(r.content))for(o=0;o<r.content.length;++o){if(r.content[o].type!==f.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");i+=r.content[o].value}else i=r.content;t.content=D.util.createBuffer(i)}return t.version=r.version.charCodeAt(0),t.rawCapture=r}function i(t){if(void 0===t.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===t.content){var e;switch(t.encryptedContent.algorithm){case D.pki.oids["aes128-CBC"]:case D.pki.oids["aes192-CBC"]:case D.pki.oids["aes256-CBC"]:e=D.aes.createDecryptionCipher(t.encryptedContent.key);break;case D.pki.oids.desCBC:case D.pki.oids["des-EDE3-CBC"]:e=D.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}o.messageFromPem=function(t){t=D.pem.decode(t)[0];if("PKCS7"!==t.type)throw(e=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".')).headerType=t.type,e;if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var e=f.fromDer(t.body);return o.messageFromAsn1(e)},o.messageToPem=function(t,e){t={type:"PKCS7",body:f.toDer(t.toAsn1()).getBytes()};return D.pem.encode(t,{maxline:e})},o.messageFromAsn1=function(t){var e={},n=[];if(!f.validate(t,o.asn1.contentInfoValidator,e,n))throw(t=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.")).errors=n,t;var r,i=f.derToOid(e.contentType);switch(i){case D.pki.oids.envelopedData:r=o.createEnvelopedData();break;case D.pki.oids.encryptedData:r=o.createEncryptedData();break;case D.pki.oids.signedData:r=o.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return r.fromAsn1(e.content.value[0]),r},o.createSignedData=function(){var p=null;return p={type:D.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(r(p,t,o.asn1.signedDataValidator),p.certificates=[],p.crls=[],p.digestAlgorithmIdentifiers=[],p.contentInfo=null,p.signerInfos=[],p.rawCapture.certificates)for(var e=p.rawCapture.certificates.value,n=0;n<e.length;++n)p.certificates.push(D.pki.certificateFromAsn1(e[n]))},toAsn1:function(){p.contentInfo||p.sign();for(var t=[],e=0;e<p.certificates.length;++e)t.push(D.pki.certificateToAsn1(p.certificates[e]));var n=[],r=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(p.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,p.digestAlgorithmIdentifiers),p.contentInfo])]);return 0<t.length&&r.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,t)),0<n.length&&r.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,1,!0,n)),r.value[0].value.push(f.create(f.Class.UNIVERSAL,f.Type.SET,!0,p.signerInfos)),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(p.type).getBytes()),r])},addSigner:function(t){var e=t.issuer,n=t.serialNumber,r=(t.certificate&&(e=(r="string"==typeof(r=t.certificate)?D.pki.certificateFromPem(r):r).issuer.attributes,n=r.serialNumber),t.key);if(!r)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof r&&(r=D.pki.privateKeyFromPem(r));var i=t.digestAlgorithm||D.pki.oids.sha1;switch(i){case D.pki.oids.sha1:case D.pki.oids.sha256:case D.pki.oids.sha384:case D.pki.oids.sha512:case D.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+i)}var o=t.authenticatedAttributes||[];if(0<o.length){for(var a=!1,s=!1,l=0;l<o.length;++l){var u=o[l];if(a||u.type!==D.pki.oids.contentType){if(!s&&u.type===D.pki.oids.messageDigest&&(s=!0,a))break}else if(a=!0,s)break}if(!a||!s)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}p.signers.push({key:r,version:1,issuer:e,serialNumber:n,digestAlgorithm:i,signatureAlgorithm:D.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:o,unauthenticatedAttributes:[]})},sign:function(t){var e;if(t=t||{},"object"==typeof p.content&&null!==p.contentInfo||(p.contentInfo=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(D.pki.oids.data).getBytes())]),"content"in p&&(p.content instanceof D.util.ByteBuffer?e=p.content.bytes():"string"==typeof p.content&&(e=D.util.encodeUtf8(p.content)),t.detached?p.detachedContent=f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,e):p.contentInfo.value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,e)])))),0!==p.signers.length){var n,r=(()=>{for(var t={},e=0;e<p.signers.length;++e){var n,r=p.signers[e];(n=r.digestAlgorithm)in t||(t[n]=D.md[D.pki.oids[n]].create()),0===r.authenticatedAttributes.length?r.md=t[n]:r.md=D.md[D.pki.oids[n]].create()}for(n in p.digestAlgorithmIdentifiers=[],t)p.digestAlgorithmIdentifiers.push(f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(n).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]));return t})();if(!(n=p.detachedContent||(n=p.contentInfo.value[1]).value[0]))throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i,o=f.derToOid(p.contentInfo.value[0].value),a=f.toDer(n);for(i in a.getByte(),f.getBerValueLength(a),a=a.getBytes(),r)r[i].start().update(a);for(var s=new Date,l=0;l<p.signers.length;++l){var u=p.signers[l];if(0===u.authenticatedAttributes.length){if(o!==D.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{u.authenticatedAttributesAsn1=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var c=f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[]),h=0;h<u.authenticatedAttributes.length;++h){var d=u.authenticatedAttributes[h];d.type===D.pki.oids.messageDigest?d.value=r[u.digestAlgorithm].digest():d.type!==D.pki.oids.signingTime||d.value||(d.value=s),c.value.push(g(d)),u.authenticatedAttributesAsn1.value.push(g(d))}a=f.toDer(c).getBytes(),u.md.start().update(a)}u.signature=u.key.sign(u.md,"RSASSA-PKCS1-V1_5")}p.signerInfos=(t=>{for(var e=[],n=0;n<t.length;++n)e.push((t=>{var e=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(t.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[D.pki.distinguishedNameToAsn1({attributes:t.issuer}),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,D.util.hexToBytes(t.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.digestAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.signatureAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])),e.value.push(f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.signature)),0<t.unauthenticatedAttributes.length){for(var n=f.create(f.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<t.unauthenticatedAttributes.length;++r){var i=t.unauthenticatedAttributes[r];n.values.push(g(i))}e.value.push(n)}return e})(t[n]));return e})(p.signers)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=D.pki.certificateFromPem(t)),p.certificates.push(t)},addCertificateRevokationList:function(t){throw new Error("PKCS#7 CRL support not yet implemented.")}}},o.createEncryptedData=function(){var e=null;return e={type:D.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:D.pki.oids["aes256-CBC"]},fromAsn1:function(t){r(e,t,o.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),i(e)}}},o.createEnvelopedData=function(){var s=null;return s={type:D.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:D.pki.oids["aes256-CBC"]},fromAsn1:function(t){t=r(s,t,o.asn1.envelopedDataValidator);s.recipients=(t=>{for(var e=[],n=0;n<t.length;++n)e.push((t=>{var e={},n=[];if(f.validate(t,o.asn1.recipientInfoValidator,e,n))return{version:e.version.charCodeAt(0),issuer:D.pki.RDNAttributesAsArray(e.issuer),serialNumber:D.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:f.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}};throw(t=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.")).errors=n,t})(t[n]));return e})(t.recipientInfos.value)},toAsn1:function(){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(s.type).getBytes()),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(s.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,(t=>{for(var e=[],n=0;n<t.length;++n)e.push((t=>f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(t.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[D.pki.distinguishedNameToAsn1({attributes:t.issuer}),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,D.util.hexToBytes(t.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.encryptedContent.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.encryptedContent.content)]))(t[n]));return e})(s.recipients)),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,(t=s.encryptedContent,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(D.pki.oids.data).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.parameter.getBytes())]),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var e=t.issuer.attributes,n=0;n<s.recipients.length;++n){var r=s.recipients[n],i=r.issuer;if(r.serialNumber===t.serialNumber&&i.length===e.length){for(var o=!0,a=0;a<e.length;++a)if(i[a].type!==e[a].type||i[a].value!==e[a].value){o=!1;break}if(o)return r}}return null},decrypt:function(t,e){if(void 0===s.encryptedContent.key&&void 0!==t&&void 0!==e)switch(t.encryptedContent.algorithm){case D.pki.oids.rsaEncryption:case D.pki.oids.desCBC:var n=e.decrypt(t.encryptedContent.content);s.encryptedContent.key=D.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}i(s)},addRecipient:function(t){s.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:D.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,e){if(void 0===s.encryptedContent.content){var n,r,i;switch(e=e||s.encryptedContent.algorithm,t=t||s.encryptedContent.key,e){case D.pki.oids["aes128-CBC"]:r=n=16,i=D.aes.createEncryptionCipher;break;case D.pki.oids["aes192-CBC"]:n=24,r=16,i=D.aes.createEncryptionCipher;break;case D.pki.oids["aes256-CBC"]:n=32,r=16,i=D.aes.createEncryptionCipher;break;case D.pki.oids["des-EDE3-CBC"]:n=24,r=8,i=D.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+e)}if(void 0===t)t=D.util.createBuffer(D.random.getBytes(n));else if(t.length()!=n)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+n+".");s.encryptedContent.algorithm=e,s.encryptedContent.key=t,s.encryptedContent.parameter=D.util.createBuffer(D.random.getBytes(r));t=i(t);if(t.start(s.encryptedContent.parameter.copy()),t.update(s.content),!t.finish())throw new Error("Symmetric encryption failed.");s.encryptedContent.content=t.output}for(var o=0;o<s.recipients.length;++o){var a=s.recipients[o];if(void 0===a.encryptedContent.content){if(a.encryptedContent.algorithm!==D.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+a.encryptedContent.algorithm);a.encryptedContent.content=a.encryptedContent.key.encrypt(s.encryptedContent.key.data)}}}}}}),F(function(t){t=t.exports=D.ssh=D.ssh||{};function u(t,e){e=e.toString(16),"8"<=e[0]&&(e="00"+e),e=D.util.hexToBytes(e);t.putInt32(e.length),t.putBytes(e)}function c(t,e){t.putInt32(e.length),t.putString(e)}function h(){for(var t=D.md.sha1.create(),e=arguments.length,n=0;n<e;++n)t.update(arguments[n]);return t.digest()}t.privateKeyToPutty=function(t,e,n){var r="ssh-rsa",i=""===(e=e||"")?"none":"aes256-cbc",o="PuTTY-User-Key-File-2: ssh-rsa\r\n",a=(o=o+("Encryption: "+i+"\r\n")+("Comment: "+(n=n||"")+"\r\n"),D.util.createBuffer()),s=(c(a,r),u(a,t.e),u(a,t.n),D.util.encode64(a.bytes(),64)),s=(o=o+("Public-Lines: "+(Math.floor(s.length/66)+1)+"\r\n")+s,D.util.createBuffer()),t=(u(s,t.d),u(s,t.p),u(s,t.q),u(s,t.qInv),l=e?(t=s.length()+16-1,t-=t%16,(l=h(s.bytes())).truncate(l.length()-t+s.length()),s.putBuffer(l),(t=D.util.createBuffer()).putBuffer(h("\0\0\0\0",e)),t.putBuffer(h("\0\0\0",e)),(l=D.aes.createEncryptionCipher(t.truncate(8),"CBC")).start(D.util.createBuffer().fillWithByte(0,16)),l.update(s.copy()),l.finish(),(t=l.output).truncate(16),D.util.encode64(t.bytes(),64)):D.util.encode64(s.bytes(),64),o=o+("\r\nPrivate-Lines: "+(Math.floor(l.length/66)+1)+"\r\n")+l,h("putty-private-key-file-mac-key",e)),l=D.util.createBuffer(),e=(c(l,r),c(l,i),c(l,n),l.putInt32(a.length()),l.putBuffer(a),l.putInt32(s.length()),l.putBuffer(s),D.hmac.create());return e.start("sha1",t),e.update(l.bytes()),o+="\r\nPrivate-MAC: "+e.digest().toHex()+"\r\n"},t.publicKeyToOpenSSH=function(t,e){e=e||"";var n=D.util.createBuffer();return c(n,"ssh-rsa"),u(n,t.e),u(n,t.n),"ssh-rsa "+D.util.encode64(n.bytes())+" "+e},t.privateKeyToOpenSSH=function(t,e){return e?D.pki.encryptRsaPrivateKey(t,e,{legacy:!0,algorithm:"aes128"}):D.pki.privateKeyToPem(t)},t.getPublicKeyFingerprint=function(t,e){var n=(e=e||{}).md||D.md.md5.create(),r=D.util.createBuffer(),t=(c(r,"ssh-rsa"),u(r,t.e),u(r,t.n),n.start(),n.update(r.getBytes()),n.digest());if("hex"===e.encoding)return r=t.toHex(),e.delimiter?r.match(/.{2}/g).join(e.delimiter):r;if("binary"===e.encoding)return t.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".');return t}});var Yo="forge.task",Qo={},Jo=0,ta=(D.debug.set(Yo,"tasks",Qo),{}),ea=(D.debug.set(Yo,"queues",ta),"ready"),na="running",o="blocked",ra="sleeping",ia="done",t="error",oa="stop",aa="start",sa="block",r="unblock",la="sleep",i="wakeup",ua="cancel",n="fail",a={ready:{}},ca=(a[ea][oa]=ea,a[ea][aa]=na,a[ea][ua]=ia,a[ea][n]=t,a[na]={},a[na][oa]=ea,a[na][aa]=na,a[na][sa]=o,a[na][r]=na,a[na][la]=ra,a[na][i]=na,a[na][ua]=ia,a[na][n]=t,a[o]={},a[o][oa]=o,a[o][aa]=o,a[o][sa]=o,a[o][r]=o,a[o][la]=o,a[o][i]=o,a[o][ua]=ia,a[o][n]=t,a[ra]={},a[ra][oa]=ra,a[ra][aa]=ra,a[ra][sa]=ra,a[ra][r]=ra,a[ra][la]=ra,a[ra][i]=ra,a[ra][ua]=ia,a[ra][n]=t,a[ia]={},a[ia][oa]=ia,a[ia][aa]=ia,a[ia][sa]=ia,a[ia][r]=ia,a[ia][la]=ia,a[ia][i]=ia,a[ia][ua]=ia,a[ia][n]=t,a[t]={},a[t][oa]=t,a[t][aa]=t,a[t][sa]=t,a[t][r]=t,a[t][la]=t,a[t][i]=t,a[t][ua]=t,a[t][n]=t,Zo.prototype.debug=function(t){D.log.debug(Yo,t=t||"","[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",ta)},Zo.prototype.next=function(t,e){"function"==typeof t&&(e=t,t=this.name);e=new Zo({run:e,name:t,parent:this});return e.state=na,e.type=this.type,e.successCallback=this.successCallback||null,e.failureCallback=this.failureCallback||null,this.subtasks.push(e),this},Zo.prototype.parallel=function(r,i){return D.util.isArray(r)&&(i=r,r=this.name),this.next(r,function(t){for(var n=t,e=(n.block(i.length),0);e<i.length;e++)((t,e)=>{D.task.start({type:t,run:function(t){i[e](t)},success:function(t){n.unblock()},failure:function(t){n.unblock()}})})(r+"__parallel-"+t.id+"-"+e,e)})},Zo.prototype.stop=function(){this.state=a[this.state][oa]},Zo.prototype.start=function(){this.error=!1,this.state=a[this.state][aa],this.state===na&&(this.start=new Date,this.run(this),ca(this,0))},Zo.prototype.block=function(t){this.blocks+=t=void 0===t?1:t,0<this.blocks&&(this.state=a[this.state][sa])},Zo.prototype.unblock=function(t){return this.blocks-=t=void 0===t?1:t,0===this.blocks&&this.state!==ia&&(this.state=na,ca(this,0)),this.blocks},Zo.prototype.sleep=function(t){t=void 0===t?0:t,this.state=a[this.state][la];var e=this;this.timeoutId=setTimeout(function(){e.timeoutId=null,e.state=na,ca(e,0)},t)},Zo.prototype.wait=function(t){t.wait(this)},Zo.prototype.wakeup=function(){this.state===ra&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=na,ca(this,0))},Zo.prototype.cancel=function(){this.state=a[this.state][ua],this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},Zo.prototype.fail=function(t){if(this.error=!0,ha(this,!0),t)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,ca(t,0);else{if(null!==this.parent){for(var e=this.parent;null!==e.parent;)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,e=e.parent;ha(e,!0)}this.failureCallback&&this.failureCallback(this)}},function(n,t){function e(t){var e;t++,n.state===na&&(r&&(n.swapTime=+new Date),0<n.subtasks.length?((e=n.subtasks.shift()).error=n.error,e.swapTime=n.swapTime,e.userData=n.userData,e.run(e),e.error||ca(e,t)):(ha(n),n.error||null!==n.parent&&(n.parent.error=n.error,n.parent.swapTime=n.swapTime,n.parent.userData=n.userData,ca(n.parent,t))))}var r=30<t||20<+new Date-n.swapTime;r?setTimeout(e,0):e(t)}),ha=function(t,e){t.state=ia,delete Qo[t.id],null===t.parent&&(t.type in ta?0===ta[t.type].length?D.log.error(Yo,"[%s][%s] task queue empty [%s]",t.id,t.name,t.type):ta[t.type][0]!==t?D.log.error(Yo,"[%s][%s] task not first in queue [%s]",t.id,t.name,t.type):(ta[t.type].shift(),0===ta[t.type].length?delete ta[t.type]:ta[t.type][0].start()):D.log.error(Yo,"[%s][%s] task queue missing [%s]",t.id,t.name,t.type),e||(t.error&&t.failureCallback?t.failureCallback(t):!t.error&&t.successCallback&&t.successCallback(t)))},da=(D.task=D.task||{},D.task.start=function(t){var e,n=new Zo({run:t.run,name:t.name||"?"});n.type=t.type,n.successCallback=t.success||null,n.failureCallback=t.failure||null,n.type in ta?ta[t.type].push(n):(ta[n.type]=[n],(e=n).error=!1,e.state=a[e.state][aa],setTimeout(function(){e.state===na&&(e.swapTime=+new Date,e.run(e),ca(e,0))},0))},D.task.cancel=function(t){t in ta&&(ta[t]=[ta[t][0]])},D.task.createCondition=function(){var n={tasks:{},wait:function(t){t.id in n.tasks||(t.block(),n.tasks[t.id]=t)},notify:function(){var t,e=n.tasks;for(t in n.tasks={},e)e[t].unblock()}};return n},D);let pa=un.asString;function fa(){return Math.random().toString(16).substring(2)}var oo={randomToken:function(t){var e=Math.ceil(t/13);return new Array(e).fill(fa).reduce((t,e)=>t+e(),"").substring(0,t)}},ga=2147483647;function ma(t){this._seed=t%ga,this._seed<=0&&(this._seed+=ga-1)}ma.prototype.next=function(){return this._seed=16807*this._seed%ga,this._seed},ma.prototype.nextFloat=function(){return(this.next()-1)/(ga-1)};var ya=function(t,e){var n=[];if(void 0!==e){if(!Number.isInteger(e))throw new Error("Invalid seed argument. Integer required, but got: "+e);var e=new ma(e),r=e.nextFloat.bind(e)}else r=Math.random;for(var i=0;i<t.length;++i){var o=Math.floor(r()*(i+1));o!==i&&(n[i]=n[o]),n[o]=t[i]}return n};let va=me.BlankDate,{asGeopoints:_a,area:wa,distance:ba}=u,Ca=oo.randomToken,{DATE_STRING:Ea,dateStringToDays:Sa,dateToDays:Ta,isValidDate:Aa}=pe,{asBoolean:Ia,asNumber:La,asString:b}=un,ka=/^-?[0-9]+(\.[0-9]+)?$/;var xa=function(){function r(t){return t<0?-Math.round(-t):Math.round(t)}let i=new Error("too many args"),o=new Error("too few args"),t={};var e={get_media:function(t,e){var n,r;if(e)return e=b(e),t=t.v[0],r=(t=>{let e=t.replace(/\[[0-9]\]/g,"");return e})(e),n=(e=>{let n=1,t=[...e.matchAll(/\[[0-9]\]/g)];if(0<t.length){e=t[0];if(0<e.length){let t=e[0];t=t.substring(1,t.length-1),n=parseInt(t,10)}}return n})(e)-1,(r=document.getElementsByName(r)[n])?(n=((t,e)=>{if(t&&t.childNodes)for(var n=0;n<t.childNodes.length;n++)for(var r=t.childNodes[n],i=null!=r.className?r.className.split(" "):[],o=0;o<i.length;o++)if(i[o]==e)return t.childNodes[n]})(r.parentElement,"dynamic-input"))&&(n.value=t.innerHTML,r=new Event("change"),n.dispatchEvent(r)):alert("get_media() cannot find the question: "+e+" that is the second parameter of get_media() function"),v.string("");throw new Error("Invalid call to get_media(url, image). Missing path to image. For example: get_media(${q1}, '/main/image_question')")},lookup_image_labels:function(t){var e,n,r,i,o,a;return window.wfcache||(window.wfcache={}),t&&(t=Ba(t.v[0]),r=(n=document.getElementsByName(t)[0]).files[0]),r&&r.name&&(t=new Blob([r],{type:r.type}),i=window.location.protocol+"//"+window.location.hostname,i+="/surveyKPI/lookup/imagelabels/"+surveyData.surveyIdent,e=i+"/"+r.name,window.wfcache[e]||((o=new FormData).append(r.name,t,r.name),(a=new XMLHttpRequest).onreadystatechange=function(){4==a.readyState&&200==a.status&&(window.wfcache[e]=a.responseText,n.dispatchEvent(new Event("change",{bubbles:!0})))},a.open("post",i),a.send(o))),v.string(window.wfcache[e]||"")},lookup:function(t,e,n,o,a,s){var l,u,r,c,i,h;return window.wfcache||(window.wfcache={},window.wfcache.ongoing={}),u=window.location.protocol+"//"+window.location.hostname,u=(u+="/surveyKPI/lookup/"+surveyData.surveyIdent)+("/"+t.v),s?(u+="/"+n.v,""==(i=o.v[0].innerHTML)&&(i="_none"),u=(u=(u+="/"+encodeURIComponent(i))+"?index="+b(a))+"&searchType="+b(s)):a?(u=(u+="/null/null")+"?index="+b(o)+"&searchType=eval",c=Ua(r=b(n)),r=Fa(r),u+="&expression="+encodeURIComponent(r)):o?(u+="/"+n.v,""==(i=o.v[0].innerHTML)&&(i="_none"),u+="/"+encodeURIComponent(i)):n?(u+="/null/null",r=b(n),c=Ua(r),r=Fa(r),u+="?expression="+encodeURIComponent(r)):u=void 0,u&&(window.wfcache.ongoing[u]||window.wfcache[u]||((h=new XMLHttpRequest).onreadystatechange=function(){var t=u,e=o,n=s,r=a,i=c;if(4==h.readyState&&200==h.status){if(window.wfcache[t]=h.responseText,window.wfcache.ongoing[t]=void 0,n||e&&!r){n=Ba(e.v[0]);document.getElementsByName(n)[0].dispatchEvent(new Event("datarefresh",{bubbles:!0}))}else if(i&&0<i.length)for(l=0;l<i.length;l++)document.getElementsByName(i[l])[0].dispatchEvent(new Event("datarefresh",{bubbles:!0}))}else 4==h.readyState&&(alert(h.responseText),window.wfcache[t]="",window.wfcache.ongoing[t]=void 0)},h.open("get",u),window.wfcache.ongoing[u]="yes",h.send()),window.wfcache[u])?(t=JSON.parse(window.wfcache[u]),s&&a&&"count"===b(a)||a&&"eval"===b(a)&&"count"===b(o)?v.string(t._count):v.string(t[e.v])):v.string("")},lookup_choices:function(t,e,n,r,i,o,a){var s=b(arguments[arguments.length-1]),e=2<arguments.length?b(e):void 0,l="eval"==e?b(n):void 0,u=e&&!l&&4<arguments.length,n=u?b(n):void 0,r=u?b(r):void 0,c=6<arguments.length,i=c?b(i):void 0,o=c?b(o):void 0,h=document.getElementById("form-languages"),d=(d=h.value)||"language",h=(window.wfcache||(window.wfcache={},window.wfcache.ongoing={}),Ba(this.cN));let p=h.endsWith("_mult");var f=h.indexOf("__dynamic");let g=h.substring(0,f);var m,y=window.location.protocol+"//"+window.location.hostname,y=(y=(y+="/surveyKPI/lookup/mlchoices/"+surveyData.surveyIdent)+("/"+b(t)))+("/"+s);return l?(l=l.replaceAll("##","'"),l=Fa(l),y+="?expression="+encodeURIComponent(l)):u&&(y=(y=(y+="?search_type="+e)+"&q_column="+encodeURIComponent(n))+"&q_value="+encodeURIComponent(r)),c&&(y=(y+="&f_column="+encodeURIComponent(i))+"&f_value="+encodeURIComponent(o)),window.wfcache.ongoing[y]||(window.wfcache[y]?(Va(window.wfcache[y],g,d,s,p),console.log("using cache: "+y)):((m=new XMLHttpRequest).onreadystatechange=function(){var t=y;4==m.readyState&&200==m.status?(window.wfcache[t]=m.responseText,window.wfcache.ongoing[t]=void 0,Va(m.responseText,g,d,s,p),console.log("got response: "+y)):4==m.readyState&&(alert(m.responseText),window.wfcache[t]="",window.wfcache.ongoing[t]=void 0,Va("",g,d,s,p))},m.open("get",y),window.wfcache.ongoing[y]="yes",m.send(),console.log("Making request: "+y))),v.string("")},default:function(t){return v.string(b(t))},device:function(){let t="webform";return navigator.userAgent&&(/iPhone/i.test(navigator.userAgent)?t="iPhone":/iPad/i.test(navigator.userAgent)?t="iPad":/iPod/i.test(navigator.userAgent)?t="iPod":/Android/i.test(navigator.userAgent)&&(t="Android")),v.string(t)},abs:function(t){return v.number(Math.abs(La(t)))},acos:function(t){return v.number(Math.acos(La(t)))},asin:function(t){return v.number(Math.asin(La(t)))},atan:function(t){return v.number(Math.atan(La(t)))},atan2:function(t){var e,n;return 1<arguments.length?(e=La(t),n=La(arguments[1]),v.number(Math.atan2(e,n))):v.number(Math.atan2(La(t)))},boolean:function(t){if(0===arguments.length)throw new Error("too few args");if(1<arguments.length)throw new Error("too few args");return v.boolean(Ia(t))},"boolean-from-string":function(t){return"num"===t.t&&0<t.v&&!t.decimal?v.boolean(!0):(t=b(t),v.boolean("1"===t||"true"===t))},area:function(t){if(0===arguments.length)throw o;return v.number(wa(_a(t)))},checklist:function(t,e,...n){t=La(t),e=La(e);n=Da(Ia,...n).reduce((t,e)=>e?t+1:t,0);return v.boolean((t<0||t<=n)&&(e<0||n<=e))},coalesce:function(t,e){return v.string(b(t)||b(e))},concat:function(...t){return v.string(Da(b,...t).join(""))},cos:function(t){return v.number(Math.cos(La(t)))},count:function(t){if(0===arguments.length)throw new Error("too few args");if(1<arguments.length)throw new Error("too few args");if("arr"!==t.t)throw new Error("Unpexpected arg type: '"+t.t+"'");return v.number(t.v.length)},"count-non-empty":function(t){if(0===!arguments.length)throw new Error("too few args");if(1<arguments.length)throw new Error("too many args");if("arr"!==t.t)throw new Error("wrong arg type:"+JSON.stringify(t));return v.number(Da(b,t).reduce((t,e)=>e?t+1:t,0))},"count-selected":function(t){var e=b(t).split(" ");let n=e.length,r=0;for(;0<=--n;)e[n].length&&++r;return v.number(r)},date:function(t){return v.date(Ra(t))},"decimal-date-time":function(t){if(1<arguments.length)throw i;t="num"===t.t?La(t):Sa(b(t));return v.number(t)},"decimal-time":function(t){if(1<arguments.length)throw i;if("num"===t.t)return v.number(NaN);var t=b(t),e=t.match(/^(\d\d):(\d\d):(\d\d)(\.\d\d?\d?)?(\+|-)(\d\d):(\d\d)$/);let n;return n=!(e&&e[1]<24&&0<=e[1]&&e[2]<60&&0<=e[2]&&e[3]<60&&0<=e[3]&&e[6]<24&&0<=e[6]&&e[7]<60&&0<=e[7])||(e=new Date,"Invalid Date"===(e=new Date(e.getFullYear()+"-"+Pa(e.getMonth()+1)+"-"+Pa(e.getDate())+"T"+t)).toString())?NaN:(e.getSeconds()/3600+e.getMinutes()/60+e.getHours())/24,v.number(n)},digest:function(t,e,n){return v.string(((t,e,n)=>{let r;try{r=da}catch(t){throw new Error("Cannot find module 'node-forge'; this is required to use the digest() function.")}if(t=pa(t),e=pa(e).toLowerCase(),n=n&&n.v&&n.v.toLowerCase()||"base64",!e||!/^(md5|sha-1|sha-256|sha-384|sha-512)$/.test(e))throw new Error("Invalid algo.");if(/^(base64|hex)$/.test(n))return(e=r.md[e.replace("-","")].create()).update(t),t=e.digest(),n&&"base64"!==n?e.digest().toHex():r.util.encode64(t.bytes());throw new Error("Invalid encoding.")})(t,e,n))},distance:function(t){if(0===arguments.length)throw o;return v.number(ba(_a(t)))},exp:function(t){return v.number(Math.exp(La(t)))},exp10:function(t){return v.number(Math.pow(10,La(t)))},false:function(){if(arguments.length)throw i;return v.boolean(!1)},"format-date":function(t,e){if(arguments.length<2)throw new Error("format-date() :: not enough args");return v.string(((t,e)=>{if(t=Ra(t),e=b(e),""===t.toString()||isNaN(t))return"";let n,r,i="";var o=1900+t.getYear(),a=1+t.getMonth(),s=t.getDate(),l=t.getHours(),u=globalThis.window?.enketoFormLocale;for(r=0;r<e.length;++r)if("%"===(n=e.charAt(r))){if(++r>=e.length)throw new Error("date format string ends with %");if("%"===(n=e.charAt(r)))i+="%";else if("Y"===n)i+=Pa(o,4);else if("y"===n)i+=Pa(o,4).substring(2);else if("m"===n)i+=Pa(a,2);else if("n"===n)i+=a;else if("b"===n)i+=t.toLocaleDateString(u,{month:"short"});else if("d"===n)i+=Pa(s,2);else if("e"===n)i+=s;else if("H"===n)i+=Pa(l,2);else if("h"===n)i+=l;else if("M"===n)i+=Pa(t.getMinutes(),2);else if("S"===n)i+=Pa(t.getSeconds(),2);else if("3"===n)i+=Pa(t.getMilliseconds(),3);else{if("a"!==n)throw"Z"===n||"A"===n||"B"===n?new Error("unsupported escape in date format string [%"+n+"]"):new Error("unrecognized escape in date format string [%"+n+"]");i+=t.toLocaleDateString(u,{weekday:"short"})}}else i+=n;return i})(t,e))},if:function(t,e,n){return Ia(t)?e:n},"ends-with":function(t,e){if(2<arguments.length)throw i;if(arguments.length<2)throw o;return v.boolean(b(t).endsWith(b(e)))},int:function(t){return v.number(Na(t))},join:function(t,...e){return v.string(Da(b,...e).join(b(t)))},last:function(){if(arguments.length)throw new Error("last() does not take arguments");return v.number(this.contextSize)},"local-name":function(t){t=Oa(this,t);return v.string(t.match(/^(?:[^:]*:)?(.*)/)[1])},name:function(t){return v.string(Oa(this,t))},log:function(t){return v.number(Math.log(La(t)))},log10:function(t){return v.number(Math.log10(La(t)))},max:function(...t){t=Da(La,...t);return!t.length||t.some(t=>isNaN(t))?v.number(NaN):v.number(Math.max(...t))},min:function(...t){t=Da(La,...t);return!t.length||t.some(t=>isNaN(t))?v.number(NaN):v.number(Math.min(...t))},"namespace-uri":function(t){t=Ma(this,t);return v.string(t&&t.namespaceURI||"")},"normalize-space":function(t){if(1<arguments.length)throw new Error("too many args");let e=b(t||this.cN);return e=(e=(e=(e=(e=(e=(e=e.replace(/\f/g,"\\f")).replace(/\r\v/g,"\v")).replace(/\v/g,"\\v")).replace(/\s+/g," ")).replace(/^\s+|\s+$/g,"")).replace(/\\v/g,"\v")).replace(/\\f/g,"\f"),v.string(e)},not:function(t){if(0===arguments.length)throw o;if(1<arguments.length)throw i;return v.boolean(!Ia(t))},now:function(){return v.date(new Date)},number:function(t){if(1<arguments.length)throw new Error(`number() passed wrong arg count (expected 0 or 1, but got ${arguments.length})`);var t=arguments.length?t:this.cN,e=b(t);return Ea.test(e)?v.number(Sa(e)):v.number(La(t))},today:function(){return v.date(t._now())},once:function(t){var e=b(this.cN);return v.string(e||b(t))},pi:function(){return v.number(Math.PI)},position:function(t){if(1<arguments.length)throw new Error("too many args");if(t&&"arr"!==t.t)throw new Error("wrong arg type for position() - expected nodeset, but got: "+t.t);if(t&&!t.v.length)throw new Error("cannot call position() on an empty nodeset");if(!t)return v.number(this.contextPosition);let e=1,n=t.v[0];for(var r=n.tagName;n.previousElementSibling&&n.previousElementSibling.tagName===r;)n=n.previousElementSibling,e++;return v.number(e)},pow:function(t,e){return v.number(Math.pow(La(t),La(e)))},random:function(){return v.number(parseFloat(Math.random().toFixed(15)))},randomize:function(t,e){if(!arguments.length)throw o;if(2<arguments.length)throw i;if(t&&"arr"===t.t)return e=e?La(e):void 0,{t:"arr",v:ya(t.v,e)};throw new Error("randomize() must be called on a nodeset")},regex:function(t,e){return v.boolean(new RegExp(b(e)).test(b(t)))},round:function(t,e){if(0===arguments.length)throw o;if(2<arguments.length)throw i;if(t=La(t),!e)return v.number(r(t));e=Na(e);var n=Math.pow(10,Math.abs(e));return 0<e?v.number(r(t*n)/n):v.number(n*r(t/n))},selected:function(t,e){return v.boolean(-1!==b(t).split(" ").indexOf(b(e).trim()))},"selected-at":function(t,e){if(e)return v.string(b(t).split(" ")[Na(e)]||"");throw new Error("No index provided for selected-at() [index="+e+"; list="+JSON.stringify(t))},sin:function(t){return v.number(Math.sin(La(t)))},sqrt:function(t){return v.number(Math.sqrt(La(t)))},string:function(t){if(1<arguments.length)throw new Error(`string() passed wrong arg count (expected 0 or 1, but got ${arguments.length})`);return v.string(b(t||this.cN))},"string-length":function(t){if(1<arguments.length)throw new Error("too many args");t=b(t||this.cN);return v.number(t.length)},substr:function(t,e,n){return v.string(b(t).slice(La(e),n&&La(n)))},sum:function(t){if(!t||"arr"!==t.t)throw new Error("sum() must be called on a nodeset");let e=0,n=t.v.length;for(;n--;)e+=La(t.v[n]);return v.number(e)},tan:function(t){return v.number(Math.tan(La(t)))},true:function(){if(arguments.length)throw i;return v.boolean(!0)},uuid:function(t){return t?v.string(Ca(La(t))):v.string(([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))},"weighted-checklist":function(t,e,...n){t=La(t),e=La(e);let r=[],i=[],o=0;for(let t=0;t<n.length;t+=2){var a=n[t],s=n[t+1];a&&s&&(r=r.concat(Da(Ia,a)),i=i.concat(Da(La,s)))}for(let t=0;t<r.length;t++)r[t]&&(o+=i[t]||0);return v.boolean((t<0||o>=t)&&(e<0||o<=e))}},n=(e["date-time"]=e.date,e["format-date-time"]=e["format-date"],{toExternalResult:function(t,e){if("arr"===t.t&&e===XPathResult.NUMBER_TYPE){var n=b(t);if(Ea.test(n))return{resultType:e,numberValue:Sa(n)}}if("date"===t.t)switch(e){case XPathResult.BOOLEAN_TYPE:return{resultType:e,booleanValue:!isNaN(t.v)};case XPathResult.NUMBER_TYPE:return{resultType:e,numberValue:La(t)};case XPathResult.ANY_TYPE:case XPathResult.STRING_TYPE:return{resultType:e,stringValue:b(t)};default:throw new Error("toExternalResult() doesn't know how to convert a date to "+e)}},typefor:function(t){if(t instanceof Date)return"date"},handleInfix:function(t,e,n,r){var i,o;return"date"===e.t||"date"===r.t?"bool"===e.t||"bool"===r.t?void 0:("arr"!==e.t&&"str"!==e.t||(e=v.date(Ra(e))),"arr"!==r.t&&"str"!==r.t||(r=v.date(Ra(r))),{t:"continue",lhs:e="date"===e.t?{t:"num",v:Ta(e.v)}:e,op:n,rhs:r="date"===r.t?{t:"num",v:Ta(r.v)}:r}):16===n||17===n?(i=b(e),Ea.test(i)?(i=Sa(i),o=La(r),16===n?i+o:i-o):(i=b(r),Ea.test(i)?(o=Sa(i),i=La(e),16===n?i+o:i-o):void 0)):8<=n&&n<=15?(i=b(e),Ea.test(i)&&(e=v.number(Sa(i))),o=b(r),{t:"continue",lhs:e,op:n,rhs:r=Ea.test(o)?v.number(Sa(o)):r}):void 0}});return t.func=e,t.process=n,t.XPR=v,t._now=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},t};function Da(n){var r=[];for(let e=1;e<arguments.length;++e)if("arr"===arguments[e].t)for(let t=0;t<arguments[e].v.length;++t)r.push(n(arguments[e].v[t]));else r.push(n(arguments[e]));return r}function Na(t){t=La(t);return 0<t?Math.floor(t):Math.ceil(t)}function Ra(n){let r,i;switch(n.t){case"bool":return new Date(NaN);case"date":return n.v;case"num":return(r=new Date(0)).setTime(r.getTime()+24*n.v*60*60*1e3),r;case"arr":case"str":if(0===(n=b(n)).length)return new va;if(ka.test(n))return(r=new Date(0)).setTime(r.getTime()+24*parseInt(n,10)*60*60*1e3),r;if(Ea.test(n)){if(-1!==(r=n.indexOf("T"))){i=n.substring(r);let t,e=(t=0<i.indexOf("+")?i.split("+"):i.split("-"),"T"+Pa((i=(i=(i="T"===(i=t[0])[0]?i.substring(1):i).replace("Z","")).split(":"))[0]));e+=":",0<i.length?e+=Pa(i[1]):e+="00",e+=":",1<i.length?(o=i[2].split("."),e=(e=e+Pa(o[0])+".")+(1<o.length?Pa(o[1],3):"000")):e+="00.000",i=e||"T00:00:00.000"}else i="T00:00:00.000";var o;if(-1!==r&&(n=n.substring(0,r)),r=n.split("-"),Aa(r[0],r[1],r[2]))return o=`${Pa(r[0])}-${Pa(r[1])}-`+Pa(r[2])+i+new Date(n).getTimezoneOffsetAsTime(),new Date(o)}return new Date(n);default:throw new Error(`asDate() can't handle ${n.t}s yet :-(`)}}function Pa(t,e){for(e=e||2,t=t.toString();t.length<e;)t="0"+t;return t}function Oa(t,e){t=Ma(t,e);return t?t.nodeName:""}function Ma(t,e){if(2<arguments.length)throw new Error("too many args");if(!e)return ja(t.cN)?t.cN:null;if("arr"!==e.t)throw new Error("wrong arg type");return e.v.length?(Fn({t:"arr",v:e.v.filter(ja)}),e.v[0]):void 0}function Ba(t){var e=t.tagName;return"main"===e?"/main":Ba(t.parentNode)+"/"+e}function Ua(t){for(var e=[],n=t.split(" "),r=0;r<n.length;r++)0==n[r].indexOf("/main")&&e.push(n[r]);return e}var Fa=function(t){let e="",n,r,i,o;if(t){var a=t.split(" ");for(n=0;n<a.length;n++){if((i=a[n]).startsWith("/main")){var s=document.getElementsByName(i);if(1==s.length)o=s[0];else for(r=0;r<s.length;r++)if(s[r].parentElement.dataset.checked){o=s[r];break}if(o)switch(o.type){case"date":case"datetime-local":i=o.value&&""!==o.value?"'"+new Date(o.value).toISOString()+"'::timestamptz":"";break;case"number":(i=o.value)&&0!=i.length||(i="0");break;default:i="'"+o.value+"'"}}0<i.trim().length&&(0<e.length&&(e+=" "),e+=i)}}return e},Va=function(t,e,n,r,i){for(var t=JSON.parse(t),o=Ha(t,e,n,i),a=document.getElementsByClassName("dchoice_"+r),s=0;s<a.length;s++)a[s].innerHTML=o},Ha=function(t,e,n,r){var i,o=[],a=-1;if(t&&0<t.length)for(i=0;i<t.length;i++){var s,l=t[i];for(s in o[++a]="<label>",o[++a]='<input type="',o[++a]=r?"checkbox":"radio",o[++a]='" data-type-xml="string" name="',o[++a]=e,o[++a]='" data-name="',o[++a]=e,o[++a]='" value="',o[++a]=l.value.trim(),o[++a]='">',l.mlChoices)o[++a]='<span class="option-label',s===n&&(o[++a]=" active"),o[++a]='" lang="',o[++a]=s,o[++a]='">',o[++a]=l.mlChoices[s],o[++a]="</span>";o[++a]="</label>"}return o.join("")};let za={[Node.ELEMENT_NODE]:!0,[Node.ATTRIBUTE_NODE]:!0,[Node.PROCESSING_INSTRUCTION_NODE]:!0,[Node.DOCUMENT_TYPE_NODE]:!0};function ja({nodeType:t}){return za[t]}var{asBoolean:e,asNumber:o,asString:r}=un;let qa={string:r,boolean:e,number:o},Wa=(void 0===console.deprecate&&(console.deprecate=(t,e)=>{console.warn(t+` is deprecated. Use ${e} instead.`)}),"repeat:/"),Ga=/instance\(\s*(["'])((?:(?!\1)[A-z0-9.\-_]+))\1\s*\)/g,$a=/(decimal-date-time\(|pow\(|indexed-repeat\(|format-date\(|coalesce\(|join\(|max\(|min\(|random\(|substr\(|int\(|uuid\(|regex\(|now\(|today\(|date\(|if\(|boolean-from-string\(|checklist\(|selected\(|selected-at\(|round\(|area\(|position\(|get_media\([^)])/,Ka="http://openrosa.org/xforms",Xa="http://openrosa.org/javarosa",Za="http://enketo.org/xforms",Ya="http://www.opendatakit.org/xforms",Qa=new DOMParser,S=function(t,e){(t="string"==typeof t?{modelStr:t}:t).external=t.external||[],t.submitted=void 0===t.submitted||t.submitted,(e=e||{}).full=void 0===e.full||e.full,this.events=document.createElement("div"),this.convertedExpressions={},this.templates={},this.loadErrors=[],this.data=t,this.options=e,this.namespaces={}};S.prototype={get version(){return this.evaluate("/*/@version","string",null,null,!0)},get instanceID(){return this.getMetaNode("instanceID").getVal()},get deprecatedID(){return this.getMetaNode("deprecatedID").getVal()||""},get instanceName(){return this.getMetaNode("instanceName").getVal()}},S.prototype.init=function(){let n,r,i=this;this.data.modelStr=this.data.modelStr.replace(/\s(xmlns=("|')[^\s>]+("|'))/g," data-$1"),this.options.full||(this.data.modelStr=this.data.modelStr.replace(/^(<model\s*><instance((?!<instance).)+<\/instance\s*>\s*)(<instance.+<\/instance\s*>)*/,"$1"));try{n="model",this.xml=Qa.parseFromString(this.data.modelStr,"text/xml"),this.throwParserErrors(this.xml,this.data.modelStr),0<this.data.external.length&&this.data.external.forEach(t=>{n=t.id?`instance "${t.id}"`:'instance "unknown"',r=i.getSecondaryInstance(t.id);let e;(e=t.xml instanceof XMLDocument?i.xml.importNode(t.xml.documentElement,!0):e)&&r.appendChild(e)}),this.createSession("__session",this.data.session)}catch(t){console.error("parseXML error"),this.loadErrors.push(`Error trying to parse XML ${n}. `+t.message)}if(this.xml){try{this.hasInstance=!!this.xml.querySelector("model > instance"),this.rootElement=this.xml.querySelector("instance > *")||this.xml.documentElement,this.setNamespaces(),this.noRepeatRefErrorExpected=this.evaluate(`/model/@${this.getNamespacePrefix(Ya)}:xforms-version`,"boolean",null,null,!0),this.getMetaNode("instanceID").getElement()||i.loadErrors.push("Invalid primary instance. Missing instanceID node."),Array.prototype.slice.call(this.xml.querySelectorAll("model > instance[src]:empty")).forEach(t=>{i.loadErrors.push(`External instance "${t.id}" is empty.`)}),this.trimValues(),this.extractTemplates()}catch(t){console.error(t),this.loadErrors.push(t.name+": "+t.message)}try{n="record",this.data.instanceStr&&this.mergeXml(this.data.instanceStr),this.setInstanceIdAndDeprecatedId(),this.data.instanceStr||this.events.dispatchEvent(E.InstanceFirstLoad())}catch(t){console.error(t),this.loadErrors.push(`Error trying to parse XML ${n}. `+t.message)}}return this.loadErrors},S.prototype.throwParserErrors=(t,e)=>{if(!t||t.querySelector("parsererror"))throw new Error("Invalid XML: "+e)},S.prototype.createSession=function(t,e){let n;var r=this.xml.querySelector("model"),i=["deviceid","username","email","phonenumber","simserial","subscriberid"];r&&(e="object"==typeof e?e:{},(n=r.querySelector("instance#"+CSS.escape(t)))||(n=Qa.parseFromString(`<instance id="${t}"/>`,"text/xml").documentElement,this.xml.adoptNode(n),r.appendChild(n)),i.forEach(t=>{e[t]=e[t]||(t=>{if(Ae)return Ae[t];try{var e=document.cookie.split("; ");Ae={};for(let t=e.length-1;0<=t;t--){var n=e[t].split("=");n[1]=decodeURIComponent(n[1]),"s:"===n[1].substr(0,2)&&(n[1]=n[1].slice(2),n[1]=n[1].slice(0,n[1].lastIndexOf("."))),Ae[n[0]]=decodeURIComponent(n[1])}return Ae[t]}catch(t){return console.error("Cookie error",t),null}})("__enketo_meta_"+t)||window.smapConfig[t]||t+" not found"}),t=Qa.parseFromString(`<session><context>${i.map(t=>`<${t}>${e[t]}</${t}>`).join("")}</context></session>`,"text/xml").documentElement,this.xml.adoptNode(t),n.appendChild(t))},S.prototype.getSecondaryInstance=function(e){let n;return[...this.xml.querySelectorAll("model > instance")].some(t=>t.getAttribute("id")===e&&(n=t,!0)),n},S.prototype.node=function(t,e,n){return new Je(t,e,n,this)},S.prototype.importNode=function(t,e){let n,r;switch(t.nodeType){case document.ELEMENT_NODE:var i=document.createElementNS(t.namespaceURI,t.nodeName);if(t.attributes&&0<t.attributes.length)for(n=0,r=t.attributes.length;n<r;n++){var o=t.attributes[n];o.namespaceURI?i.setAttributeNS(o.namespaceURI,o.nodeName,t.getAttributeNS(o.namespaceURI,o.localName)):i.setAttribute(o.nodeName,t.getAttribute(o.nodeName))}if(e&&t.children.length)for(n=0,r=t.children.length;n<r;n++)i.appendChild(this.importNode(t.children[n],e));return!t.children.length&&t.textContent&&(i.textContent=t.textContent),i;case document.TEXT_NODE:case document.CDATA_SECTION_NODE:case document.COMMENT_NODE:return document.createTextNode(t.nodeValue)}},S.prototype.mergeXml=function(t){var e,n,r,i,o;let a,s=this;if(t){if(r=this.xml.querySelector("instance"),!(a=this.xml.querySelector("instance > *")))throw new Error("Model is corrupt. It does not contain a childnode of instance");t=(t=t.replace(/\s(xmlns=("|')[^\s>]+("|'))/g,"")).replace(/<!--[^>]*-->/g,""),i=(o=Qa.parseFromString(t,"text/xml")).querySelectorAll("[*|template]");for(let t=0;t<i.length;t++)i[t].remove();if(Array.prototype.slice.call(o.querySelectorAll("*")).forEach(t=>{var e,n,r;let i=0;try{e=ze(t,"instance",!1),(void 0!==s.templates[e]||0<je(t))&&(n=ze(t,"instance",!0),s.evaluate(n,"node",null,null,!0)||((r=n.match(/([^[]+)\[(\d+)\]\//g))&&0<r.length&&(i=r[r.length-1].match(/\[(\d+)\]/)[1]-1),s.addRepeat(e,i,!0)))}catch(t){console.warn("Ignored error:",t)}}),Array.prototype.slice.call(o.querySelectorAll("*")).filter(t=>{var e=t.textContent;return 0===t.children.length&&0===e.trim().length}).forEach(t=>{t=ze(t,"instance",!0);s.node(t,0).getElement()&&(0===s.evaluate("./*","nodes",t,0,!0).length?s.evaluate("./text()","nodes",t,0,!0).forEach(t=>{t.textContent=""}):s.evaluate(".//*[not(*)]","nodes",t,0,!0).forEach(t=>{t.textContent=""}))}),n=new Te({join:!1}),e=(new XMLSerializer).serializeToString(a),t=(new XMLSerializer).serializeToString(o),n.AddSource(e),n.AddSource(t),n.error.code)throw new Error(n.error.text);o=Qa.parseFromString(n.Get(1),"text/xml"),this.xml.querySelector("instance").removeChild(a),a=0<=window.navigator.userAgent.indexOf("Trident/")?this.importNode(o.documentElement,!0):this.xml.adoptNode(o.documentElement,!0),r.appendChild(a),this.rootElement=a}},S.prototype.trimValues=function(){this.node(null,null,{noEmpty:!0}).getElements().forEach(t=>{t.textContent=t.textContent.trim()})},S.prototype.setInstanceIdAndDeprecatedId=function(){var t,e,n;let r;e=(t=this.getMetaNode("instanceID")).getElement(),n=t.getVal(),e?(this.data.instanceStr&&this.data.submitted&&(r=this.getMetaNode("deprecatedID").getElement(),e.textContent="",r||(r=Qa.parseFromString("<deprecatedID/>","text/xml").documentElement,this.xml.adoptNode(r),this.xml.querySelector("* > meta").appendChild(r))),t.getVal()||t.setVal(this.evaluate('concat("uuid:", uuid())',"string")),r&&this.getMetaNode("deprecatedID").setVal(n)):console.warn("Model has no instanceID element")},S.prototype.bindJsEvaluator=function(){var t=(()=>{let a=xa();var t=new ur(new XPathEvaluator,a);return t.customXPathFunction={add:(e,{fn:r,args:t,ret:i})=>{if(Object.prototype.hasOwnProperty.call(a.func,e))throw new Error(`There is already a function with the name: '${e}'`);let o=t.map(t=>t.t),n=Object.keys(qa);var t=o.filter(t=>!n.includes(t));if(t.length)throw t=t.map(t=>`'${t}'`),new Error("Unsupported arg type(s): "+t.join(","));if(!Object.keys(v).includes(i))throw new Error(`Unsupported return type: '${i}'`);a.func[e]=(...n)=>{if(n.length!==o.length)throw new Error(`Function "${e}" expected ${o.length} arg(s), but got `+n.length);var t=o.map((t,e)=>qa[t](n[e]));return v[i](r(...t))}}},t})();this.xml.jsEvaluate=t.evaluate},S.prototype.getMetaNode=function(t){var e=this.getNamespacePrefix(Ka);let n=this.node(`/*/${e}:meta/${e}:`+t);return n=n.getElement()?n:this.node("/*/meta/"+t)},S.prototype.getRepeatCommentText=t=>(t=t.trim(),Wa+t),S.prototype.getRepeatCommentSelector=function(t){return`//comment()[self::comment()="${this.getRepeatCommentText(t)}"]`},S.prototype.getRepeatCommentEl=function(t,e){return this.evaluate(this.getRepeatCommentSelector(t),"nodes",null,null,!0)[e]},S.prototype.addRepeat=function(t,e,n){let r=this;this.templates[t]||this.extractFakeTemplates([t]);var i=this.templates[t];let o=this.getRepeatSeries(t,e);t=o.length?o[o.length-1]:this.getRepeatCommentEl(t,e);n||o.forEach(t=>{r.addOrdinalAttribute(t,o[0])}),i&&t?(e=i.cloneNode(!0),t.after(e),this.removeOrdinalAttributes(e),n||this.addOrdinalAttribute(e,o[0]),n&&Array.prototype.slice.call(e.querySelectorAll("*")).filter(t=>0===t.children.length).forEach(t=>{t.textContent=""})):console.error("Could not find template node and/or node to insert the clone after")},S.prototype.addOrdinalAttribute=function(t,e){this.getNamespacePrefix(Za)},S.prototype.removeOrdinalAttributes=t=>{},S.prototype.getRepeatSeries=function(t,e){var n;let r;var t=this.getRepeatCommentEl(t,e),i=[];if(t)for(n=(e=t.textContent.substr(Wa.length).split("/"))[e.length-1],r=t.nextSibling;r;)r.nodeName&&r.nodeName===n&&i.push(r),r=r.nextSibling;return i},S.prototype.determineIndex=function(t){if(t){var n=t.nodeName;let e=ze(t,"instance");n=Array.prototype.slice.call(this.xml.querySelectorAll(n.replace(/\./g,"\\."))).filter(t=>e===ze(t,"instance"));return 1===n.length?null:n.indexOf(t)}return console.error("no node, or multiple nodes, provided to determineIndex function"),-1},S.prototype.extractTemplates=function(){let n=this;this.getTemplateNodes().reverse().forEach(t=>{var e=ze(t,"instance");n.addTemplate(e,t),t.remove()})},S.prototype.extractFakeTemplates=function(t){let e=this,n;t.forEach(t=>{(n=e.evaluate(t,"node",null,null,!0))&&e.addTemplate(t,n,!0)})},S.prototype.addRepeatComments=function(t){let e=this.getRepeatCommentText(t);this.evaluate(t,"nodes",null,null,!0).forEach(t=>{(t=>{let e=!1;var n=t.nodeName;for(t=t.previousSibling;t;){if(t.nodeName&&t.nodeName===n){e=!0;break}t=t.previousSibling}return e})(t)||((t,e)=>{let n=!1;for(t=t.previousSibling;t;){if(t.nodeType===Node.COMMENT_NODE&&t.textContent===e){n=!0;break}t=t.previousSibling}return n})(t,e)||t.before(document.createComment(e))})},S.prototype.addTemplate=function(t,e,n){this.addRepeatComments(t),this.templates[t]||((e=e.cloneNode(!0)).removeAttribute("template"),e.removeAttribute("jr:template"),n&&Array.prototype.slice.call(e.querySelectorAll("*")).filter(t=>0===t.children.length).forEach(t=>{t.textContent=""}),this.templates[t]=e)},S.prototype.getTemplateNodes=function(){var t=this.getNamespacePrefix(Xa);return this.evaluate(`/model/instance[1]/*//*[@${t}:template]`,"nodes",null,null,!0)},S.prototype.getStr=function(){let t=(new XMLSerializer).serializeToString(this.xml.querySelector("instance > *")||this.xml.documentElement,"text/xml");return t=(t=t.replace(/\s(data-)(xmlns=("|')[^\s>]+("|'))/g," $2")).replace(new RegExp(`<!--${Wa}\\/[^>]+-->`,"g"),""),t=-1===navigator.userAgent.indexOf("Trident/")?this.removeDuplicateEnketoNsDeclarations(t):t},S.prototype.removeDuplicateEnketoNsDeclarations=function(t){let e=0;var n=new RegExp(`( xmlns:${this.getNamespacePrefix(Za)}="${Za}")`,"g");return t.replace(n,t=>1<++e?"":t)},S.prototype.makeBugCompliant=function(r,e,n){if(!this.noRepeatRefErrorExpected){let t=this.node(e,n).getElement();if(t){for(var i=[t];t&&t.parentElement&&"instance"!==t.nodeName.toLowerCase();)t=t.parentElement,i.push(t);i.forEach(t=>{var e,n=t.nodeName.replace(/\./g,"\\."),n=Pe(t,n+":not([template])");1<n.length&&(e=ze(t,"instance"),n=n.indexOf(t),r=r.replace(new RegExp(e+"/","g"),e+`[${n+1}]/`))})}}return r},S.prototype.setNamespaces=function(){var t=this.hasInstance?"/model/instance":"",t=this.evaluate(t+"/*","nodes",null,null,!0);let n=this,r;t.forEach(e=>{e.hasAttributes()&&Array.from(e.attributes).forEach(t=>{0===t.name.indexOf("xmlns:")&&(n.namespaces[t.name.substring(6)]=t.value)}),[["orx",Ka,!1],["jr",Xa,!1],["enk",Za,!0===rt.repeatOrdinals],["odk",Ya,!1]].forEach(t=>{n.getNamespacePrefix(t[1])||(r=n.namespaces[t[0]]?"__"+t[0]:t[0],n.namespaces[r]=t[1],t[2]&&e.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:"+r,t[1]))})})},S.prototype.getNamespacePrefix=function(e){var t=Object.entries(this.namespaces).find(t=>t[1]===e);return t?t[0]:void 0},S.prototype.getNsResolver=function(){let e=void 0===this.namespaces?{}:this.namespaces;return{lookupNamespaceURI(t){return e[t]||null}}},S.prototype.shiftRoot=function(t){var e=/"([^"]*)(")|'([^']*)(')/g;return t=this.hasInstance?(t=(t=(t=t.replace(e,(t,e,n,r,i)=>{n=n||i;return n+(void 0!==e?encodeURIComponent(e):encodeURIComponent(r))+n})).replace(/^(\/(?!model\/)[^/][^/\s,"']*\/)/g,"/model/instance[1]$1")).replace(/([^a-zA-Z0-9.\])/*_-])(\/(?!model\/)[^/][^/\s,"']*\/)/g,"$1/model/instance[1]$2")).replace(e,(t,e,n,r,i)=>{n=n||i;return n+(void 0!==e?decodeURIComponent(e):decodeURIComponent(r))+n}):t},S.prototype.replaceInstanceFn=function(t){let r,i=this;return t.replace(Ga,(t,e,n)=>{if(r=`/model/instance[@id="${n}"]`,i.evaluate(r,"nodes",null,null,!0).length)return r;throw new Ge(`instance "${n}" does not exist in model`)})},S.prototype.replaceCurrentFn=(t,e)=>t.replace(/current\(\)/g,""+e),S.prototype.replaceIndexedRepeatFn=function(o,a,s){let l=this;return Ie(o,"indexed-repeat").forEach(t=>{let e,n;var r,i=t[1];if(i.length%2!=1)throw new Ge("indexed repeat with incorrect number of parameters found: "+t[0]);for(n=i[0],e=i.length-1;1<e;e-=2)r=isNaN(i[e])?l.evaluate(i[e],"number",a,s,!0):i[e],n=n.replace(i[e-1],i[e-1]+`[position() = ${r}]`);o=o.replace(t[0],n)}),o},S.prototype.replaceVersionFn=function(e){let n=this,r;return Ie(e,"version").forEach(t=>{r=r||n.evaluate("/*/@version","string",null,0,!0),e=e.replace(t[0],`"${r}"`)}),e},S.prototype.replacePullDataFn=function(e,n,r){var i,o,a=this.convertPullDataFn(e,n,r);for(o in a)if(Object.prototype.hasOwnProperty.call(a,o)){var s=this.getPulldataIndex(o,n,r);let t=s?"nodes":"string";if(i=this.evaluate(a[o],t,n,r,!0),s&&0<i.length){let n="";if("count"==s||"-1"==s)n=i.length;else if("list"==s||"0"==s)for(let t=0;t<i.length;t++)0<t&&(n+=" "),n+=i[t].textContent;else if("sum"==s||"mean"==s){let e=0;for(let t=0;t<i.length;t++)e+=Number(i[t].textContent);"mean"==s&&(e/=i.length),n=e}else if("min"==s){let e=Number.MAX_VALUE;for(let t=0;t<i.length;t++)Number(i[t].textContent)<e&&(e=Number(i[t].textContent));n=e}else if("max"==s){let e=Number.MIN_VALUE;for(let t=0;t<i.length;t++)Number(i[t].textContent)>e&&(e=Number(i[t].textContent));n=e}else{let t=parseInt(s,10);t--,(t=isNaN(t)||t<0?0:t)<i.length&&(n=i[t].textContent)}e=e.replace(o,`"${n}"`)}else e=e.replace(o,`"${i}"`)}return e},S.prototype.convertPullDataFn=function(t,c,h){let d=this;t=Ie(t,"pulldata");let p={};return t.length&&t.forEach(t=>{var n;let e,r;var i=t[1];if(4===i.length||6===i.length)if(i[1]=Le(i[1]),i[2]=Le(i[2]),n=`'${d.evaluate(i[3],"string",c,h,!0)}'`,4===i.length)r=`instance(${i[0]})/root/item[${i[2]} = ${n}]/`+i[1];else{Le(i[4]);var o=Le(i[5]);if("matches"===o)r=`instance(${i[0]})/root/item[${i[2]} = ${n}]/`+i[1];else if("startswith"===o)r=`instance(${i[0]})/root/item[starts-with(${i[2]}, ${n})]/`+i[1];else if("endswith"===o)r=`instance(${i[0]})/root/item[ends-with(${i[2]}, ${n})]/`+i[1];else if("contains"===o)r=`instance(${i[0]})/root/item[contains(${i[2]}, ${n})]/`+i[1];else if("in"===o){var a=n.split(" ");let e="";for(let t=0;t<a.length;t++)0<t&&(e+=" or "),"'"!=a[t][a[t].length-1]&&(a[t]+="'"),"'"!=a[t][0]&&(a[t]="'"+a[t]),e+=i[2]+" = "+a[t];r=`instance(${i[0]})/root/item[${e}]/`+i[1]}else if("not in"===o){var s=n.split(" ");let e="";for(let t=0;t<s.length;t++)0<t&&(e+=" and "),"'"!=s[t][s[t].length-1]&&(s[t]+="'"),"'"!=s[t][0]&&(s[t]="'"+s[t]),e+=i[2]+" != "+s[t];r=`instance(${i[0]})/root/item[${e}]/`+i[1]}}else{if(3!==i.length&&5!==i.length)throw new Ge("pulldata with incorrect number of parameters found: "+t[0]);i[1]=Le(i[1]);var l=(t=>{var e,n=[],r=t.split(" ");for(e=0;e<r.length;e++)0==r[e].indexOf("/main")&&n.push(r[e]);return n})(e=Le((e=i[2]).trim()));for(let t=0;t<l.length;t++){var u=`'${d.evaluate(l[t],"string",c,h,!0)}'`;e=e.replace(l[t],u)}e=(e=(e=(e=e.replaceAll("'#{","")).replaceAll("#{","")).replaceAll("}'","")).replaceAll("}",""),r=`instance(${i[0]})/root/item[${e}]/`+i[1]}p[t[0]]=r}),p},S.prototype.getPulldataIndex=function(t,e,n){var t=Ie(t,"pulldata");let r;return r=t.length&&(5===(t=t[0][1]).length?r=Le(t[3]):6===t.length&&(r=Le(t[4])),r)&&r.startsWith("position")?this.evaluate(r,"string",e,n,!0):r},S.prototype.evaluate=function(e,t,n,r,i){let o,a,s,l,u,c,h,d,p,f,g,m;for(l in g=e,i=i||!1,t=t||"any",r=r||0,s=this.xml,p=null,(a=n?(h=this.node(n).getElements(),p=h.length,h[r]):this.rootElement)||console.error("no context element found",n,r),f=[e,n,r,p].join("|"),e=this.replaceIndexedRepeatFn(e,n,r),m=g===(e=this.replacePullDataFn(e,n,r)),this.convertedExpressions[f]?e=this.convertedExpressions[f]:(e=e.trim(),e=this.replaceInstanceFn(e),e=this.replaceVersionFn(e),e=this.replaceCurrentFn(e,ze(a,"instance",!0)),e=this.shiftRoot(e),e=(e=(e=(e=p&&1<p?this.makeBugCompliant(e,n,r):e).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"'),m&&(this.convertedExpressions[f]=e)),u={0:["any","ANY_TYPE"],1:["number","NUMBER_TYPE","numberValue"],2:["string","STRING_TYPE","stringValue"],3:["boolean","BOOLEAN_TYPE","booleanValue"],7:["nodes","ORDERED_NODE_SNAPSHOT_TYPE"],9:["node","FIRST_ORDERED_NODE_TYPE","singleNodeValue"]})if(Object.prototype.hasOwnProperty.call(u,l)){if(u[l=Number(l)][0]===t)break;l=0}if(i&&void 0!==s.evaluate&&!$a.test(e))try{c=s.evaluate(e,a,this.getNsResolver(),l,null)}catch(t){}if(!c)try{void 0===s.jsEvaluate&&this.bindJsEvaluator(),c=s.jsEvaluate(e,a,this.getNsResolver(),l,null)}catch(t){throw new Ge(`Could not evaluate: ${e}, message: `+t.message)}if(c){if(0===l){for(l in u)if(Object.prototype.hasOwnProperty.call(u,l)&&(l=Number(l))===Number(c.resultType)&&0<l&&l<4){d=c[u[l][2]];break}d||console.error(`Expression: ${e} did not return any boolean, string or number value as expected`)}else if(7===l)for(d=[],o=0;o<c.snapshotLength;o++)d.push(c.snapshotItem(o));else d=c[u[l][2]];return d}},S.prototype.getUpdateEventData=()=>{},S.prototype.getRemovalEventData=()=>{},S.prototype.types=Qe;var Ja={getWrapNode(t){return t.closest(".question, .calculation, .setvalue, .setgeopoint")},getWrapNodes(t){let e=[];return t.forEach(t=>{t=this.getWrapNode(t);e.includes(t)||e.push(t)}),e},getProps(t){return{path:this.getName(t),ind:this.getIndex(t),inputType:this.getInputType(t),xmlType:this.getXmlType(t),constraint:this.getConstraint(t),calculation:this.getCalculation(t),relevant:this.getRelevant(t),readonly:this.getReadonly(t),val:this.getVal(t),required:this.getRequired(t),enabled:this.isEnabled(t),multiple:this.isMultiple(t)}},getInputType(t){var e=t.nodeName.toLowerCase();return"input"===e?t.dataset.drawing?"drawing":t.type?"text"===t.type&&"date"===this.getXmlType(t)?"date":"text"===t.type&&"datetime"===this.getXmlType(t)?"datetime-local":t.type.toLowerCase():console.error("<input> node has no type"):"select"===e?"select":"textarea"===e?"textarea":"fieldset"===e||"section"===e?"fieldset":console.error("unexpected input node type provided")},getConstraint(t){return t.dataset.constraint},getRequired(t){if(!Fe(t,".or-appearance-label",".or"))return t.dataset.required},getRelevant(t){return t.dataset.relevant},getReadonly(t){return t.matches("[readonly]")},getCalculation(t){return t.dataset.calculate},getXmlType(t){return(t.dataset.typeXml||"string").toLowerCase()},getName(t){t=t.dataset.name||t.getAttribute("name");return t||console.error("input node has no name"),t},getIndex(t){return this.form.repeats.getIndex(t.closest(".or-repeat"))},isMultiple(t){return"checkbox"===this.getInputType(t)||t.multiple},isEnabled(t){return!(t.disabled||Fe(t,".disabled",".or"))},getVal(t){let e="";var n=this.getInputType(t),r=this.getName(t);switch(n){case"radio":var i=this.getWrapNode(t).querySelector(`input[type="radio"][data-name="${r}"]:checked`);e=i?i.value:"";break;case"checkbox":e=[...this.getWrapNode(t).querySelectorAll(`input[type="checkbox"][name="${r}"]:checked`)].map(t=>t.value);break;case"select":e=this.isMultiple(t)?[...t.querySelectorAll("option:checked")].map(t=>t.value):(i=t.querySelector("option:checked"))?i.value:"";break;case"datetime-local":t.value&&(i=5===t.value.split("T")[1].length?t.value+":00":t.value,e=i+new Date(i).getTimezoneOffsetAsTime());break;default:e=t.value}return e||""},find(t,e=0){let n="name";var r=`[${n=this.form.view.html.querySelector(`input[type="radio"][data-name="${t}"]:not(.ignore)`)?"data-name":n}="${t}"]:not([data-event="xforms-value-changed"])`,r=this.getWrapNodes(this.form.view.html.querySelectorAll(r))[e];return r?r.querySelector(`[${n}="${t}"]:not(.ignore)`):null},setVal(t,e,n=E.InputUpdate()){let r;var i=this.getInputType(t),o=this.getXmlType(t),a=this.getWrapNode(t),s=this.getName(t);if("radio"===i)r=a.querySelectorAll(`[data-name="${s}"]:not(.ignore)`);else{if(r=a.querySelectorAll(`[name="${s}"]:not(.ignore)`),"file"===i&&e)return t.setAttribute("data-loaded-file-name",e),!1;"date"!==o&&"datetime"!==o||e&&(e=Qe[o.toLowerCase()].convert(e),"datetime"===o)&&(o=(a=(e=new Date(e).toISOLocalString()).split("T"))[0],a=a&&a[1]?a[1].split(/[Z\-+]/)[0]:"00:00",e=o+"T"+a),"time"===i&&/(\+|-)/.test(e)&&(o=(new Date).toLocaleDateString("en",{month:"short",day:"numeric",year:"numeric"}).replace(/\u200E/g,"")+" "+e.replace(/(\d\d:\d\d:\d\d)(\.\d{1,3})(\s?((\+|-)\d\d))(:)?(\d\d)?/,"$1 GMT$3$7"),"Invalid Date"!==(a=new Date(o)).toString()?e=a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0"):console.error("could not parse time:",e))}if(!0===this.isMultiple(t)?e=e.split(" "):"radio"===i&&(e=[e]),r.length){var l,o=this.getVal(t);if(void 0===o||o.toString()!==e.toString()){switch(i){case"radio":""===e.toString()?r.forEach(t=>t.checked=!1):(l=this.getWrapNode(t).querySelector(`input[type="radio"][data-name="${s}"][value="${e}"]`))&&(l.checked=!0);break;case"checkbox":this.getWrapNode(t).querySelectorAll(`input[type="checkbox"][name="${s}"]`).forEach(t=>t.checked=e.includes(t.value));break;case"select":this.isMultiple(t)?t.querySelectorAll("option").forEach(t=>t.selected=e.includes(t.value)):(l=t.querySelector(`option[value="${e}"]`))?l.selected=!0:t.querySelectorAll("option").forEach(t=>t.selected=!1);break;default:t.value=e}n&&(r[0].dispatchEvent(n),n.type===E.InputUpdate().type)&&r[0].dispatchEvent(E.XFormsValueChanged())}}return r[0]},clear(t,e,n){(t.matches(".question")?[t]:t.querySelectorAll(".question")).forEach(t=>{t=t.querySelector("input:not(.ignore), select:not(.ignore), textarea:not(.ignore)");t&&(this.setVal(t,"",e),n)&&t.dispatchEvent(n)})},validate(t){return this.form.validateInput(t)}},ts={alert:function(t){return window.alert(t),Promise.resolve()},confirm:function(t){return t=t.message||t,Promise.resolve(window.confirm(t))},prompt:function(t,e){return Promise.resolve(window.prompt(t,e))}};function es(t){return/^\s*instance\(.+\)/.test(t)&&(!/\[.+\]/.test(t)||/\[\d+\]/.test(t))}var ns={update(e={}){let _=this,w={},t;if(!this.form)throw new Error("Output module not correctly instantiated with form property.");t=e.relevantPath?this.form.getRelatedNodes("data-items-path",".itemset-template").get().filter(t=>t.querySelector(`[type="checkbox"][name^="${e.relevantPath}/"]`)||t.querySelector(`[type="radio"][data-name^="${e.relevantPath}/"]`)||t.parentElement.matches(`select[name^="${e.relevantPath}/"]`)||t.parentElement.parentElement.querySelector(`input[list][name^="${e.relevantPath}/"]`)||t.querySelector(`[type="checkbox"][name="${e.relevantPath}"]`)||t.querySelector(`[type="radio"][data-name="${e.relevantPath}"]`)||t.parentElement.matches(`select[name="${e.relevantPath}"]`)||t.parentElement.parentElement.querySelector(`input[list][name="${e.relevantPath}"]`)):this.form.getRelatedNodes("data-items-path",".itemset-template",e).get();let r=this.form.repeatsPresent&&this.form.view.html.querySelector(".or-repeat.clone"),b=[];t.forEach(n=>{var d=n.parentElement.parentElement.matches(".or-repeat-info");let p={};if(!Fe(n,".disabled",".or")){var f={},g=qe.get(n,"items")||{};let c=n.nodeName.toLowerCase(),h=n.parentElement.matches("select, datalist")?n.parentElement:null,e;if("label"===c?(m=He(n,"input"),[].slice.call(m.attributes).forEach(t=>{p[t.name]=t.value}),e=m.classList.contains("ignore")?Me(m.closest(".option-wrapper"),"input.rank"):m):h&&"select"===h.nodeName.toLowerCase()?e=h:h&&"datalist"===h.nodeName.toLowerCase()&&(e=d?_.form.view.html.querySelector(`input[name="${h.dataset.name}"]`):Me(h,"input:not(.widget)")),e){let a=Me(n.closest("label, select, datalist"),".itemset-labels");var m=n.dataset.itemsPath;let s=a.dataset.labelType,l=a.dataset.labelRef;var y=Ie(l,"translate");y.length&&(l=y[0][1][0],s="langs");let u=a.dataset.valueRef;var y=_.form.input.getName(e),d=!d&&r&&Fe(e,".or-repeat.clone",".or")?_.form.input.getIndex(e):0,v=this.form.model.evaluate(m,"nodes",y,d,!0);if(f.length=v.length,f.text=v.map(t=>t.textContent).join(""),f.length!==g.length||f.text!==g.text){qe.put(n,"items",f);g=n.closest(".question, datalist"),f=([...g.querySelectorAll(c)].filter(t=>t!==n).forEach(t=>t.remove()),g.nextElementSibling),f=f&&f.matches(".or-option-translations")?f:g.querySelector(".or-option-translations");f&&[...f.children].forEach(t=>t.remove());let r=document.createDocumentFragment(),i=document.createDocumentFragment(),o=[];g=y+":"+m;w[g]=void 0,w[g]?(r=w[g].optionsFragment.cloneNode(!0),i=w[g].optionsTranslationsFragment.cloneNode(!0)):(v.forEach(t=>{var e=_.getNodesFromItem(l,t);if(e&&e.length)switch(s){case"itext":o=[...a.querySelectorAll(`[data-itext-id="${e[0].textContent}"]`)].map(t=>{var e=t.getAttribute("lang"),n=t.nodeName,r=t.src;return{language:e,type:n,text:t.textContent,active:t.classList.contains("active"),src:r,alt:t.alt}});break;case"langs":o=e.map(t=>{var e=t.getAttribute("lang"),n=!e&&!_.form.langs.currentLanguage||e===_.form.langs.currentLanguage;return{language:e,type:"span",text:t.textContent,active:n}});break;default:o=[{language:"",type:"span",text:e&&e.length?e[0].textContent:"error",active:!0}]}else o=[{language:"",label:"error",active:!0}];let n=_.getNodeFromItem(u,t).textContent;if(("select"==p["data-type-xml"]&&"checkbox"==p.type||h&&h.multiple)&&-1<n.indexOf(" ")&&(b[b.length]=C("alert.valuehasspaces.multiple",{value:n})),"label"===c)r.appendChild(_.createInput(p,o,n));else if("option"===c){let e="";1<o.length?o.forEach(t=>{t.active&&(e=t.text),i.appendChild(_.createOptionTranslation(t,n))}):e=o[0].text,r.appendChild(_.createOption(e,n))}}),!es(m)||"radio"===e.type&&e.closest(".or-repeat")||(w[g]={optionsFragment:r.cloneNode(!0),optionsTranslationsFragment:i.cloneNode(!0)})),n.parentNode.appendChild(r),f&&f.appendChild(i);let t=_.form.model.node(y,d).getVal();""!==t&&(e.classList.contains("rank")&&(t=""),_.form.input.setVal(e,t,E.Change())),(h||e.classList.contains("rank"))&&e.dispatchEvent(E.ChangeOption())}}}}),0<b.length&&ts.alert(b.join("<br>"))},getNodesFromItem(t,e,n){if(!t)throw new Error("Error: could not query instance item, no expression provided");var r=n?9:7,i=void 0!==this.form.model.xml.evaluate?"evaluate":"jsEvaluate",o=this.form.model.xml[i](t,e,this.form.model.getNsResolver(),r,null),a=[];if(n)a.push(o.singleNodeValue);else for(let t=0;t<o.snapshotLength;t++)a.push(o.snapshotItem(t));return a},getNodeFromItem(t,e){t=this.getNodesFromItem(t,e,!0);return t.length?t[0]:null},createOption(t,e){var n=document.createElement("option");return n.textContent=t,n.value=e,n},createOptionTranslation(t,e){var n=document.createElement(t.type||"span");return t.text&&(n.textContent=t.text,n.classList.add("option-label")),n.classList.toggle("active",t.active),t.language&&(n.lang=t.language),n.dataset.optionValue=e,t.src&&(n.src=t.src,n.alt=t.alt),n},createInput(e,t,n){let r=this,i=document.createElement("label"),o=document.createElement("input");return Object.getOwnPropertyNames(e).forEach(t=>{o.setAttribute(t,e[t])}),o.value=n,i.appendChild(o),t.forEach(t=>{i.appendChild(r.createOptionTranslation(t,n))}),i}};let rs=!0===rt.repeatOrdinals;var is={init(){let n=this;var t;if(this.staticLists=[],this.form)return t=this.form.view.$.find(".or-repeat-info"),this.templates={},t.siblings(".or-repeat").prepend('<span class="repeat-number"></span>').addBack().filter(function(){return this.firstChild&&3===this.firstChild.nodeType&&(this.firstChild.textContent=""),!this.querySelector(".question")}).addClass("empty"),t.filter("*:not([data-repeat-fixed])").append('<button type="button" class="btn btn-default add-repeat-btn"><i class="icon icon-plus"> </i></button>').siblings(".or-repeat").append('<div class="repeat-buttons"><button type="button"  class="btn btn-default remove"><i class="icon icon-minus"> </i></button></div>'),this.form.model.extractFakeTemplates(t.map(function(){return this.dataset.name}).get()),t.siblings(".or-repeat").reverse().each(function(){var t=this.cloneNode(!0),e=t.getAttribute("name");this.remove(),m(t).removeClass("contains-current current").find(".current").removeClass("current"),n.form.input.clear(t),n.templates[e]=t}),t.reverse().each(function(){m(this).closest(".or-repeat").length||n.updateDefaultFirstRepeatInstance(this)}).get().forEach(n.updateViewInstancesFromModel.bind(this)),this.form.view.$.on("click","button.add-repeat-btn:enabled",function(){return n.add(m(this).closest(".or-repeat-info")[0]),!1}),this.form.view.$.on("click","button.remove:enabled",function(){return n.confirmDelete(this.closest(".or-repeat")),!1}),this.countUpdate(),!0;throw new Error("Repeat module not correctly instantiated with form property.")},confirmDelete(e){let n=this;ts.confirm(C("confirm.default.heading")).then(t=>{t&&n.remove(m(e))}).catch(console.error)},getIndex(t){if(!t||!this.form.repeatsPresent)return 0;var e=t.classList.contains("or-repeat-info"),n=e?`.or-repeat-info[data-name="${t.dataset.name}"]`:`.or-repeat[name="${t.getAttribute("name")}"]`;let r=e?0:Number(t.querySelector(".repeat-number").textContent)-1,i=t;for(;i;){for(;i.previousElementSibling&&i.previousElementSibling.matches(".or-repeat");)i=i.previousElementSibling,r+=i.querySelectorAll(n).length;var o=i.parentElement;i=o?o.closest(".or-repeat"):null}return r},updateViewInstancesFromModel(t){var e=t.dataset.name,n=this.getIndex(t),e=this.form.model.getRepeatSeries(e,n),n=Oe(t,".or-repeat");return e.length>n.length&&(this.add(t,e.length-n.length,"model"),Oe(t,".or-repeat").reduce((t,e)=>t.concat([...e.querySelectorAll(".or-repeat-info:not([data-repeat-count])")]),[]).forEach(this.updateViewInstancesFromModel.bind(this))),e.length},updateDefaultFirstRepeatInstance(t){var e,n=t.dataset.name;this.form.model.data.instanceStr||this.templates[n].classList.contains("or-appearance-minimal")||(e=this.getIndex(t),0===this.form.model.getRepeatSeries(n,e).length&&this.add(t,1,"magic"),Oe(t,".or-repeat").reduce((t,e)=>t.concat([...e.querySelectorAll(".or-repeat-info:not([data-repeat-count])")]),[]).forEach(this.updateDefaultFirstRepeatInstance.bind(this)))},updateRepeatInstancesFromCount(e){var n=e.dataset.repeatCount||"";if(n){var r=e.dataset.name,n=this.form.model.evaluate(n,"number",this.form.model.getRepeatCommentSelector(r),this.getIndex(e),!0),n=isNaN(n)?0:n,r=Oe(e,`.or-repeat[name="${r}"]`).length;let t=n-r;if(0<t)this.add(e,t,"count");else if(t<0)for(t=Math.abs(t)>=r?0-r:t;t<0;t++){var i=m(e).siblings(".or-repeat").last();this.remove(i)}Pe(e,".or-repeat").reduce((t,e)=>t.concat(Ve(e,".or-group, .or-group-data")),[]).reduce((t,e)=>t.concat(Ve(e,".or-repeat-info[data-repeat-count]")),[]).forEach(this.updateRepeatInstancesFromCount.bind(this))}},countUpdate(t={}){this.form.getRelatedNodes("data-repeat-count",".or-repeat-info",t).get().forEach(this.updateRepeatInstancesFromCount.bind(this))},add(e,n=1,r="user"){if(!e)return console.error("Nothing to clone"),!1;let i;var o=e.dataset.name,a=Oe(e,".or-repeat");let s=this.templates[o].cloneNode(!0);var l=this.getIndex(e);let u=this.form.model.getRepeatSeries(o,l).length;var t=e.previousElementSibling;let c=t&&t.classList.contains("or-repeat")?Number(t.querySelector(".repeat-number").textContent):0;for(let t=0;t<n;t++){s.querySelectorAll(".option-wrapper").forEach(this.fixRadioName),this.processDatalists(s.querySelectorAll("datalist"),e),e.parentElement.insertBefore(s,e),0<c&&s.classList.add("clone"),s.querySelector(".repeat-number").textContent=c+1,a.push(s),a.length>u&&(this.form.model.addRepeat(o,l),u++);var h={repeatIndex:i=i||this.getIndex(s),repeatPath:o,trigger:r,cloned:!0};"user"!==r&&"count"!==r||s.dispatchEvent(E.NewRepeat(h)),s.dispatchEvent(E.AddRepeat(h)),this.form.widgetsInitialized&&this.form.widgets.init(m(s),this.form.options),s.querySelectorAll(".or-repeat-info:not([data-repeat-count])").forEach(this.updateDefaultFirstRepeatInstance.bind(this)),s=this.templates[o].cloneNode(!0),i++,c++}return this.toggleButtons(e),!0},remove(t){var e=t.next(".or-repeat, .or-repeat-info"),n=t.attr("name"),r=this.getIndex(t[0]),i=t.siblings(".or-repeat-info")[0];t.remove(),this.numberRepeats(i),this.toggleButtons(i),e[0].dispatchEvent(E.RemoveRepeat()),this.form.model.node(n,r).remove()},fixRadioName(t){let e=Math.floor(1e7*Math.random()+1);t.querySelectorAll('input[type="radio"]').forEach(t=>{t.setAttribute("name",e)})},fixDatalistId(t){var e=t.id+Math.floor(1e7*Math.random()+1);t.parentNode.querySelector(`input[list="${t.id}"]`).setAttribute("list",e),t.id=e},processDatalists(t,o){t.forEach(t=>{var e,n,r,i=t.querySelector(".itemset-template[data-items-path]");es(i?i.dataset.itemsPath:null)?(i=t.id,(e=Me(t,"input[list]"))&&(this.staticLists.includes(i)?t.remove():(r=t.parentElement,e=e.name,n=r.querySelector("datalist"),(n=r.removeChild(n)).setAttribute("data-name",e),o.appendChild(n),n=r.querySelector(".or-option-translations"),(n=r.removeChild(n)).setAttribute("data-name",e),o.appendChild(n),n=r.querySelector(".itemset-labels"),(r=r.removeChild(n)).setAttribute("data-name",e),o.appendChild(r),this.staticLists.push(i)))):this.fixDatalistId(t)})},toggleButtons(t){m(t).siblings(".or-repeat").children(".repeat-buttons").find("button.remove").prop("disabled",!1).first().prop("disabled",rs)},numberRepeats(t){m(t).siblings(".or-repeat").each((t,e)=>{m(e).children(".repeat-number").text(t+1)})}},os={tocItems:[],_maxTocLevel:[],generateTocItems(){this.tocItems=[],[...this.form.view.$[0].querySelectorAll('.question:not([role="comment"]), .or-group')].filter(t=>!t.closest(".disabled")&&(t.matches(".question")||t.querySelector(".question:not(.disabled)")||t.matches(".or-repeat-info")&&!Me(t,".or-repeat"))).filter(t=>!t.classList.contains("or-repeat-info")).forEach((t,e)=>{var n=Ue(t,".or-group");this.tocItems.push({element:t,level:n.length,parent:0<n.length?n[n.length-1]:null,tocId:e,tocParentId:null})}),this._maxTocLevel=Math.max.apply(Math,this.tocItems.map(t=>t.level));let n=this.tocItems.filter(t=>t.level<this._maxTocLevel&&t.element.classList.contains("or-group"));this.tocItems.forEach(e=>{var t=n.find(t=>e.parent===t.element);t&&(e.tocParentId=t.tocId)})},getHtmlFragment(){this.generateTocItems();let i=document.createDocumentFragment(),e=0;do{let r=this.tocItems.filter(t=>t.level===e);0===e?this._buildTocHtmlList(r,i):[...new Set(r.map(t=>t.tocParentId))].forEach(e=>{var t=document.createElement("ul"),n=r.filter(t=>t.tocParentId===e);this._buildTocHtmlList(n,t),i.querySelectorAll('[tocId="'+e+'"]')[0].appendChild(t)}),e++}while(e<=this._maxTocLevel);return i},_getTitle(t){let e;var n=t.querySelector(".question-label.active");return n?e=n.textContent:(n=t.querySelector(".or-hint.active"))&&(e=n.textContent),e=e&&20<e.length?e.substring(0,20)+"...":e},_buildTocHtmlList(t,i){0<t.length&&t.forEach(t=>{var e,n,r=document.createElement("li");t.element.classList.contains("or-group")?((n=document.createElement("summary")).textContent=this._getTitle(t.element)||`[${t.tocId+1}]`,(e=document.createElement("details")).setAttribute("tocId",t.tocId),null!==t.tocParentId&&e.setAttribute("tocParentId",t.tocParentId),e.append(n),r.append(e)):((n=document.createElement("a")).textContent=this._getTitle(t.element)||`[${t.tocId+1}]`,r.setAttribute("tocId",t.tocId),r.setAttribute("role","pageLink"),null!==t.tocParentId&&r.setAttribute("tocParentId",t.tocParentId),r.append(n)),i.append(r)})}},as=(F(function(t){function r(M,l){function t(t){if(!(!0===I.data(Nt+"_intouch")||0<st(t.target).closest(l.excludedElements,I).length)){var e,n,r,i=t.originalEvent||t;if(!i.pointerType||"mouse"!=i.pointerType||0!=l.fallbackToMouseEvents)return r=(n=i.touches)?n[0]:i,L=Tt,n?k=n.length:!1!==l.preventDefaultEvents&&t.preventDefault(),T=_=v=null,E=1,S=C=b=w=y=0,(t={})[lt]=s(lt),t[ut]=s(ut),t[ct]=s(ct),t[ht]=s(ht),A=t,Y(),d(0,r),!n||k===l.fingers||l.fingers===Et||c()?(ot=p(),2==k&&(d(1,n[1]),b=C=et(x[0].start,x[1].start)),(l.swipeStatus||l.pinchStatus)&&(e=u(i,L))):e=!1,!1===e?(u(i,L=Lt),e):(l.hold&&(O=setTimeout(st.proxy(function(){I.trigger("hold",[i.target]),l.hold&&(e=l.hold.call(I,i,i.target))},this),l.longTapThreshold)),a(!0),null)}}function e(t){var e=t.originalEvent||t;if(L!==It&&L!==Lt&&!h()){var n,r=e.touches,i=Q(r?r[0]:e);if(D=p(),r&&(k=r.length),l.hold&&clearTimeout(O),L=At,2==k&&(0==b?(d(1,r[1]),b=C=et(x[0].start,x[1].start)):(Q(r[1]),C=et(x[0].end,x[1].end),x[0].end,x[1].end,T=E<1?pt:dt),E=(C/b*1).toFixed(2),S=Math.abs(b-C)),k===l.fingers||l.fingers===Et||!r||c()){v=nt(i.start,i.end),_=nt(i.last,i.end);var o,a=t,r=_;if(!1!==l.preventDefaultEvents)if(l.allowPageScroll===ft)a.preventDefault();else{var s=l.allowPageScroll===gt;switch(r){case lt:(l.swipeLeft&&s||!s&&l.allowPageScroll!=bt)&&a.preventDefault();break;case ut:(l.swipeRight&&s||!s&&l.allowPageScroll!=bt)&&a.preventDefault();break;case ct:(l.swipeUp&&s||!s&&l.allowPageScroll!=Ct)&&a.preventDefault();break;case ht:(l.swipeDown&&s||!s&&l.allowPageScroll!=Ct)&&a.preventDefault()}}t=i.start,r=i.end,y=Math.round(Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))),w=tt(),r=y,(t=v)!=ft&&(r=Math.max(r,J(t)),A[t].distance=r),n=u(e,L),l.triggerOnTouchEnd&&!l.triggerOnTouchLeave||(t=!0,l.triggerOnTouchLeave&&(o={left:(o=(r=st(r=this)).offset()).left,right:o.left+r.outerWidth(),top:o.top,bottom:o.top+r.outerHeight()},r=i.end,i=o,t=r.x>i.left&&r.x<i.right&&r.y>i.top&&r.y<i.bottom),!l.triggerOnTouchEnd&&t?L=F(At):l.triggerOnTouchLeave&&!t&&(L=F(It)),L!=Lt&&L!=It)||u(e,L)}else u(e,L=Lt);!1===n&&u(e,L=Lt)}}function n(t){var e,n=t.originalEvent||t,r=n.touches;if(r){if(r.length&&!h())return e=n,N=p(),at=e.touches.length+1,!0;if(r.length&&h())return!0}return h()&&(k=at),D=p(),w=tt(),H()||!V()?u(n,L=Lt):l.triggerOnTouchEnd||!1===l.triggerOnTouchEnd&&L===At?(!1!==l.preventDefaultEvents&&!1!==t.cancelable&&t.preventDefault(),u(n,L=It)):!l.triggerOnTouchEnd&&K()?o(n,L=It,vt):L===At&&u(n,L=Lt),a(!1),null}function i(){C=b=ot=D=k=0,Y(),a(!(E=1))}function B(t){t=t.originalEvent||t;l.triggerOnTouchLeave&&u(t,L=F(It))}function U(){I.off(f,t),I.off(m,i),I.off(rt,e),I.off(it,n),g&&I.off(g,B),a(!1)}function F(t){var e=t,n=z(),r=V(),i=H();return!n||i?e=Lt:!r||t!=At||l.triggerOnTouchEnd&&!l.triggerOnTouchLeave?!r&&t==It&&l.triggerOnTouchLeave&&(e=Lt):e=It,e}function u(t,e){var n,r=t.touches;return(q()&&W()||W())&&(n=o(t,e,mt)),(j()&&c()||c())&&!1!==n&&(n=o(t,e,yt)),Z()&&X()&&!1!==n?n=o(t,e,_t):w>l.longTapThreshold&&y<St&&l.longTap&&!1!==n?n=o(t,e,wt):1!==k&&kt||!(isNaN(y)||y<l.threshold)||!K()||!1===n||(n=o(t,e,vt)),e===Lt&&i(),e!==It||r&&r.length||i(),n}function o(t,e,n){var r;if(n==mt){if(I.trigger("swipeStatus",[e,v||null,y||0,w||0,k,x,_]),l.swipeStatus&&!1===(r=l.swipeStatus.call(I,t,e,v||null,y||0,w||0,k,x,_)))return!1;if(e==It&&q()){if(clearTimeout(P),clearTimeout(O),I.trigger("swipe",[v,y,w,k,x,_]),l.swipe&&!1===(r=l.swipe.call(I,t,v,y,w,k,x,_)))return!1;switch(v){case lt:I.trigger("swipeLeft",[v,y,w,k,x,_]),l.swipeLeft&&(r=l.swipeLeft.call(I,t,v,y,w,k,x,_));break;case ut:I.trigger("swipeRight",[v,y,w,k,x,_]),l.swipeRight&&(r=l.swipeRight.call(I,t,v,y,w,k,x,_));break;case ct:I.trigger("swipeUp",[v,y,w,k,x,_]),l.swipeUp&&(r=l.swipeUp.call(I,t,v,y,w,k,x,_));break;case ht:I.trigger("swipeDown",[v,y,w,k,x,_]),l.swipeDown&&(r=l.swipeDown.call(I,t,v,y,w,k,x,_))}}}if(n==yt){if(I.trigger("pinchStatus",[e,T||null,S||0,w||0,k,E,x]),l.pinchStatus&&!1===(r=l.pinchStatus.call(I,t,e,T||null,S||0,w||0,k,E,x)))return!1;if(e==It&&j())switch(T){case dt:I.trigger("pinchIn",[T||null,S||0,w||0,k,E,x]),l.pinchIn&&(r=l.pinchIn.call(I,t,T||null,S||0,w||0,k,E,x));break;case pt:I.trigger("pinchOut",[T||null,S||0,w||0,k,E,x]),l.pinchOut&&(r=l.pinchOut.call(I,t,T||null,S||0,w||0,k,E,x))}}return n==vt?e!==Lt&&e!==It||(clearTimeout(P),clearTimeout(O),X()&&!Z()?(R=p(),P=setTimeout(st.proxy(function(){R=null,I.trigger("tap",[t.target]),l.tap&&(r=l.tap.call(I,t,t.target))},this),l.doubleTapThreshold)):(R=null,I.trigger("tap",[t.target]),l.tap&&(r=l.tap.call(I,t,t.target)))):n==_t?e!==Lt&&e!==It||(clearTimeout(P),clearTimeout(O),R=null,I.trigger("doubletap",[t.target]),l.doubleTap&&(r=l.doubleTap.call(I,t,t.target))):n!=wt||e!==Lt&&e!==It||(clearTimeout(P),R=null,I.trigger("longtap",[t.target]),l.longTap&&(r=l.longTap.call(I,t,t.target))),r}function V(){var t=!0;return t=null!==l.threshold?y>=l.threshold:t}function H(){var t=!1;return t=null!==l.cancelThreshold&&null!==v?J(v)-y>=l.cancelThreshold:t}function z(){return!(l.maxTimeThreshold&&w>=l.maxTimeThreshold)}function j(){var t=G(),e=$(),n=null===l.pinchThreshold||S>=l.pinchThreshold;return t&&e&&n}function c(){return l.pinchStatus||l.pinchIn||l.pinchOut}function q(){var t=z(),e=V(),n=G(),r=$();return!H()&&r&&n&&e&&t}function W(){return l.swipe||l.swipeStatus||l.swipeLeft||l.swipeRight||l.swipeUp||l.swipeDown}function G(){return k===l.fingers||l.fingers===Et||!kt}function $(){return 0!==x[0].end.x}function K(){return!!l.tap}function X(){return!!l.doubleTap}function Z(){var t;return null!=R&&(t=p(),X())&&t-R<=l.doubleTapThreshold}function Y(){at=N=0}function h(){var t=!1;return t=N&&p()-N<=l.fingerReleaseThreshold?!0:t}function a(t){I&&(!0===t?(I.on(rt,e),I.on(it,n),g&&I.on(g,B)):(I.off(rt,e,!1),I.off(it,n,!1),g&&I.off(g,B,!1)),I.data(Nt+"_intouch",!0===t))}function d(t,e){var n={start:{x:0,y:0},last:{x:0,y:0},end:{x:0,y:0}};return n.start.x=n.last.x=n.end.x=e.pageX||e.clientX,n.start.y=n.last.y=n.end.y=e.pageY||e.clientY,x[t]=n}function Q(t){var e=void 0!==t.identifier?t.identifier:0,n=x[e]||null;return(n=null===n?d(e,t):n).last.x=n.end.x,n.last.y=n.end.y,n.end.x=t.pageX||t.clientX,n.end.y=t.pageY||t.clientY,n}function J(t){return A[t]?A[t].distance:void 0}function s(t){return{direction:t,distance:0}}function tt(){return D-ot}function et(t,e){var n=Math.abs(t.x-e.x),t=Math.abs(t.y-e.y);return Math.round(Math.sqrt(n*n+t*t))}function nt(t,e){var n,r;return n=e,(r=t).x==n.x&&r.y==n.y?ft:(r=e,t=(n=t).x-e.x,r=Math.atan2(e.y-n.y,t),n=(n=Math.round(180*r/Math.PI))<0?360-Math.abs(n):n,n<=45&&0<=n||n<=360&&315<=n?lt:135<=n&&n<=225?ut:45<n&&n<135?ht:ct)}function p(){return(new Date).getTime()}var l=st.extend({},l),r=kt||Dt||!l.fallbackToMouseEvents,f=r?Dt?xt?"MSPointerDown":"pointerdown":"touchstart":"mousedown",rt=r?Dt?xt?"MSPointerMove":"pointermove":"touchmove":"mousemove",it=r?Dt?xt?"MSPointerUp":"pointerup":"touchend":"mouseup",g=!r||Dt?"mouseleave":null,m=Dt?xt?"MSPointerCancel":"pointercancel":"touchcancel",y=0,v=null,_=null,w=0,b=0,C=0,E=1,S=0,T=0,A=null,I=st(M),L="start",k=0,x={},ot=0,D=0,N=0,at=0,R=0,P=null,O=null;try{I.on(f,t),I.on(m,i)}catch(t){st.error("events not supported "+f+","+m+" on jQuery.swipe")}this.enable=function(){return this.disable(),I.on(f,t),I.on(m,i),I},this.disable=function(){return U(),I},this.destroy=function(){U(),I.data(Nt,null),I=null},this.option=function(t,e){if("object"==typeof t)l=st.extend(l,t);else if(void 0!==l[t]){if(void 0===e)return l[t];l[t]=e}else{if(!t)return l;st.error("Option "+t+" does not exist on jQuery.swipe.options")}return null}}var st,lt,ut,ct,ht,dt,pt,ft,gt,mt,yt,vt,_t,wt,bt,Ct,Et,St,Tt,At,It,Lt,kt,xt,Dt,Nt;st=t.exports?m:jQuery,lt="left",ut="right",ct="up",ht="down",dt="in",pt="out",ft="none",gt="auto",mt="swipe",yt="pinch",vt="tap",_t="doubletap",wt="longtap",bt="horizontal",Ct="vertical",Et="all",St=10,Tt="start",At="move",It="end",Lt="cancel",kt="ontouchstart"in window,xt=window.navigator.msPointerEnabled&&!window.PointerEvent&&!kt,Dt=(window.PointerEvent||window.navigator.msPointerEnabled)&&!kt,Nt="TouchSwipe",st.fn.swipe=function(t){var e=st(this),n=e.data(Nt);if(n&&"string"==typeof t){if(n[t])return n[t].apply(n,Array.prototype.slice.call(arguments,1));st.error("Method "+t+" does not exist on jQuery.swipe")}else if(n&&"object"==typeof t)n.option.apply(n,arguments);else if(!(n||"object"!=typeof t&&t))return function(n){return!n||void 0!==n.allowPageScroll||void 0===n.swipe&&void 0===n.swipeStatus||(n.allowPageScroll=ft),void 0!==n.click&&void 0===n.tap&&(n.tap=n.click),n=n||{},n=st.extend({},st.fn.swipe.defaults,n),this.each(function(){var t,e=st(this);e.data(Nt)||(t=new r(this,n),e.data(Nt,t))})}.apply(this,arguments);return e},st.fn.swipe.version="1.6.18",st.fn.swipe.defaults={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,hold:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:".noSwipe",preventDefaultEvents:!0},st.fn.swipe.phases={PHASE_START:Tt,PHASE_MOVE:At,PHASE_END:It,PHASE_CANCEL:Lt},st.fn.swipe.directions={LEFT:lt,RIGHT:ut,UP:ct,DOWN:ht,IN:dt,OUT:pt},st.fn.swipe.pageScroll={NONE:ft,HORIZONTAL:bt,VERTICAL:Ct,AUTO:gt},st.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,FOUR:4,FIVE:5,ALL:Et}}),{active:!1,current:null,activePages:[],init(){if(!this.form)throw new Error("Repeats module not correctly instantiated with form property.");var t;this.form.view.html.classList.contains("pages")&&(0<(t=[...this.form.view.html.querySelectorAll(".question, .or-appearance-field-list")].concat([...this.form.view.html.querySelectorAll(".or-repeat.or-appearance-field-list + .or-repeat-info")]).filter(t=>!(t.parentElement.closest(".or-appearance-field-list")||t.matches(".question")&&t.querySelector("[data-for]"))).map(t=>(t.setAttribute("role","page"),t))).length||t[0].classList.contains("or-repeat"))&&(this.$formFooter=m(".form-footer"),this.$btnFirst=this.$formFooter.find(".first-page"),this.$btnPrev=this.$formFooter.find(".previous-page"),this.$btnNext=this.$formFooter.find(".next-page"),this.$btnNext.attr("tabindex",2),this.$btnLast=this.$formFooter.find(".last-page"),this.$toc=m(".pages-toc__list"),this._updateAllActive(t),this._updateToc(),this._toggleButtons(0),this._setButtonHandlers(),this._setRepeatHandlers(),this._setBranchHandlers(),this._setSwipeHandlers(),this._setTocHandlers(),this._setLangChangeHandlers(),this.active=!0,this._flipToFirst())},flipToPageContaining(t){var e=t.closest('[role="page"]');(e=0===e.length?t.find('[role="page"]'):e).length&&this._flipTo(e[0]),this.$toc.parent().find(".pages-toc__overlay").click()},_setButtonHandlers(){let t=this;this.$btnFirst.off(".pagemode").on("click.pagemode",()=>(t.form.pageNavigationBlocked||t._flipToFirst(),!1)),this.$btnPrev.off(".pagemode").on("click.pagemode",()=>(t.form.pageNavigationBlocked||t._prev(),!1)),this.$btnNext.off(".pagemode").on("click.pagemode",()=>(t.form.pageNavigationBlocked||t._next(),!1)),this.$btnLast.off(".pagemode").on("click.pagemode",()=>(t.form.pageNavigationBlocked||t._flipToLast(),!1))},_setSwipeHandlers(){let n=this;var t=this.form.view.$.closest(".main");t.swipe("destroy"),t.swipe({allowPageScroll:"vertical",threshold:250,preventDefaultEvents:!1,swipeLeft(){n.$btnNext.click()},swipeRight(){n.$btnPrev.click()},swipeStatus(t,e){"start"===e&&(e=n._getCurrent()?n._getCurrent().querySelector(":focus"):null)&&e.blur()}})},_setTocHandlers(){let n=this;this.$toc.on("click","a",function(){if(!n.form.pageNavigationBlocked&&this.parentElement&&this.parentElement.getAttribute("tocId")){let e=parseInt(this.parentElement.getAttribute("tocId"),10);var t=n.form.toc.tocItems.find(t=>t.tocId===e);t&&t.element&&(t=t.element,n.form.goToTarget(t))}return!1}).parent().find(".pages-toc__overlay").on("click",()=>{n.$toc.parent().find("#toc-toggle").prop("checked",!1)})},_setRepeatHandlers(){this.form.view.html.addEventListener(E.AddRepeat().type,t=>{this._updateAllActive(),"user"===t.detail.trigger||this.activePages[0]===t.target||Ue(this.activePages[0],".or-repeat").includes(t.target)?this.flipToPageContaining(m(t.target)):this._toggleButtons()}),this.form.view.html.addEventListener(E.RemoveRepeat().type,e=>{if(this.current&&!this.current.closest("html")){this._updateAllActive();let t=m(e.target).prev();0===t.length&&(t=m(e.target)),this.flipToPageContaining(t)}})},_setBranchHandlers(){let t=this;this.form.view.$.on("changebranch.pagemode",()=>{t._updateAllActive(),t.activePages.includes(t.current)||t._next(),t._toggleButtons()})},_setLangChangeHandlers(){this.form.view.html.addEventListener(E.ChangeLanguage().type,()=>{this._updateToc()})},_getCurrent(){return this.current},_updateAllActive(t){t=t||[...this.form.view.html.querySelectorAll('[role="page"]')],this.activePages=t.filter(t=>!t.closest(".disabled")&&(t.matches(".question")||t.querySelector(".question:not(.disabled)")||t.matches(".or-repeat-info")&&!Me(t,".or-repeat"))),this._updateToc()},_getPrev(t){return this.activePages[t-1]},_getNext(t){return this.activePages[t+1]},_getCurrentIndex(){return this.activePages.findIndex(t=>t===this.current)},_next(){let n=this,r;return r=this._getCurrentIndex(),(this.current?this.form.validateContent(m(this.current)):Promise.resolve(!0)).then(t=>{var e;return!!t&&((t=n._getNext(r))&&(e=r+1,n._flipTo(t,e)),!0)})},_prev(){var t=this._getCurrentIndex(),e=this._getPrev(t);e&&this._flipTo(e,t-1)},_setToCurrent(t){t.classList.add("current","hidden"),t.classList.remove("hidden"),Ue(t,".or-group, .or-group-data, .or-repeat",".or").forEach(t=>t.classList.add("contains-current")),this.current=t},_flipTo(t,e){this.current&&this.current.closest("html")?this.current!==t&&(this.current.classList.remove("current","fade-out"),Ue(this.current,".or-group, .or-group-data, .or-repeat",".or").forEach(t=>t.classList.remove("contains-current")),this._setToCurrent(t),this._focusOnFirstQuestion(t),this._toggleButtons(e),t.dispatchEvent(E.PageFlip())):t&&(this._setToCurrent(t),this._focusOnFirstQuestion(t),this._toggleButtons(e),t.dispatchEvent(E.PageFlip()),t.setAttribute("tabindex",1))},_flipToFirst(){this._flipTo(this.activePages[0])},_flipToLast(){this._flipTo(this.activePages[this.activePages.length-1])},_focusOnFirstQuestion(t){m(t).find(".question:not(.disabled)").addBack(".question:not(.disabled)").filter(function(){return 0===m(this).parentsUntil(".or",".disabled").length}).eq(0).find("input, select, textarea").eq(0).trigger("fakefocus"),t.focus(),t.scrollIntoView()},_toggleButtons(t=this._getCurrentIndex()){var e=this._getNext(t),t=this._getPrev(t);this.$btnNext.add(this.$btnLast).toggleClass("disabled",!e),this.$btnPrev.add(this.$btnFirst).toggleClass("disabled",!t),this.$formFooter.toggleClass("end",!e),e?(m(".enketo-power, .draft").hide(),0<m('.form-footer [name="draft"]').length?(m('.form-footer [name="draft"]').prop("checked",!0),m("#submit-form").text(C("formfooter.savedraft.btn")).show()):m("#submit-form").text(C("formfooter.submit.btn")).hide()):(m('.form-footer [name="draft"]').prop("checked",!1),m("#submit-form").text(C("formfooter.submit.btn")).show(),m(".enketo-power, .draft").show())},_updateToc(){this.$toc.length&&(this.$toc.empty()[0].append(this.form.toc.getHtmlFragment()),this.$toc.closest(".pages-toc").removeClass("hide"))}}),ss={update(t,e=!1){if(!this.form)throw new Error("Branch module not correctly instantiated with form property.");t=this.form.getRelatedNodes("data-relevant","",t).get();this.updateNodes(t,e)},updateNodes(t,l=!1){let u=!1,c={},h=[],d=this.form.repeatsPresent&&this.form.view.html.querySelector(".or-repeat.clone");t.forEach(r=>{if(-1===h.indexOf(r.getAttribute("name"))){var i=r.closest(".or-branch"),o={};let n=null;if(o.relevant=this.form.input.getRelevant(r),o.path=this.form.input.getName(r),i){var a=o.path.split("/");if(3<a.length){a=a.splice(0,a.length-1).join("/");if(0===[...this.form.view.html.querySelectorAll(`.or-group[name="${a}"],.or-group-data[name="${a}"]`)].filter(t=>He(t,".or-repeat")||!He(t,".or-repeat-info")).length)return}var a=d&&Fe(i,".or-repeat",".or"),s=d&&Fe(i,".or-repeat.clone",".or");let t=o.path;He(r,`.or-repeat-info[data-name="${o.path}"]`)&&!He(r,`.or-repeat[name="${o.path}"]`)&&(t=null),o.ind=t&&s?this.form.input.getIndex(r):0;let e;(n=-1===o.relevant.indexOf("..")?a?`${o.relevant}__${o.path.substring(0,o.path.lastIndexOf("/"))}__`+o.ind:o.relevant:n)&&void 0!==c[n]?e=c[n]:(e=this.evaluate(o.relevant,t,o.ind),c[n]=e),a||h.push(r.getAttribute("name")),!0===this.process(i,o.path,e,l)&&(u=!0)}else Fe(r.parentsUntil(r,"#or-calculated-items",".or"))||console.error("could not find branch node for ",r)}}),u&&this.form.view.$.trigger("changebranch")},evaluate(t,e,n){return this.form.model.evaluate(t,"boolean",e,n)},process(t,e,n,r=!1){return!0===n?this.enable(t,e):this.disable(t,e,r)},selfRelevant(t){return!t.classList.contains("disabled")&&!t.classList.contains("pre-init")},enable(t,e){let n=!1;return this.selfRelevant(t)||(n=!0,t.classList.remove("disabled","pre-init"),this.form.calc.update({relevantPath:e}),this.form.itemset.update({relevantPath:e}),this.form.output.update(),this.form.widgets.enable(t),this.activate(t)),n},disable(t,e,n){let r=!1;return(t.classList.contains("pre-init")||this.selfRelevant(t)||n)&&(r=!0,n&&this.clear(t,e),this.deactivate(t)),r},clear(t,e){this.form.input.clear(t,E.Change(),E.InputUpdate()),t.matches(".or-group, .or-group-data")&&this.form.calc.update({relevantPath:e},"",!0)},setDisabledProperty(t,e){var n=t.nodeName.toLowerCase();"label"===n?Ve(t,"input, select, textarea").forEach(t=>t.disabled=e):"fieldset"===n||"section"===n?t.disabled=e:t.querySelectorAll("fieldset, input, select, textarea").forEach(t=>t.disabled=e)},activate(t){this.setDisabledProperty(t,!1)},deactivate(t){t.classList.add("disabled"),this.form.widgets.disable(t),this.setDisabledProperty(t,!0)}},ls={status:0,lastChanged:null,all:null,updateTotal(){this.all=[...this.form.view.html.querySelectorAll(".question:not(.disabled):not(.or-appearance-comment):not(.or-appearance-dn):not(.readonly)")].filter(t=>!t.closest(".disabled"))},update(t){let e;this.all&&t||this.updateTotal(),this.lastChanged=t||this.lastChanged,0<(e=this.lastChanged?Math.round(100*(this.all.indexOf(this.lastChanged.closest(".question"))+1)/this.all.length):e)&&e!==this.status&&(this.status=e,this.form.view.html.dispatchEvent(E.ProgressUpdate(e)))},get(){return this.status}};let us=document.createRange();class cs{constructor(t,e){return this.element=t,this.options=e||{},this.question=t.closest(".question"),this._props=this._getProps(),this._init()||this}_init(){this.value=this.originalInputValue}_getProps(){let t=this;return{get readonly(){return"select"===t.element.nodeName.toLowerCase()?t.element.hasAttribute("readonly"):!!t.element.readOnly},appearances:[...this.element.closest(".question, form.or").classList].filter(t=>0===t.indexOf("or-appearance-")).map(t=>t.substring(14)),multiple:!!this.element.multiple,disabled:!!this.element.disabled,type:this.element.getAttribute("data-type-xml")}}disable(){}enable(){}update(){}get props(){return this._props}get resetButtonHtml(){return us.createContextualFragment(`<button
                type="button"
                class="btn-icon-only btn-reset"
                aria-label="reset">
                <i class="icon icon-refresh"> </i>
            </button>`)}get downloadButtonHtml(){return us.createContextualFragment(`<a
                class="btn-icon-only btn-download"
                aria-label="download"
                download
                href=""><i class="icon icon-download"> </i></a>`)}get value(){}set value(t){}get originalInputValue(){return Ja.getVal(this.element)}set originalInputValue(t){Ja.setVal(this.element,t,null),this.element.dispatchEvent(E.Change())}static get name(){return this.constructor.name}static get list(){return!1}static condition(){return!0}}let hs=navigator.userAgent,ds=navigator.platform,ps={get ios(){return/iPad|iPhone|iPod/i.test(ds)||/Mac/i.test(ds)&&void 0!==document.documentElement.ontouchstart},get android(){return/android/i.test(hs)},get macos(){return/Mac/.test(hs)}},fs={get safari(){return/^((?!chrome|android).)*safari/i.test(hs)}},gs={},ms=!1;["date","datetime-local","time","month"].forEach(t=>{var e=document.createElement("input");e.setAttribute("type",t),gs[t]="text"!==e.type}),(ps.ios||ps.android)&&(ms=!0,document.documentElement.classList.add("touch"));var ys={get inputTypes(){return gs},get touch(){return ms},set touch(t){ms=t}};function vs(t){m(t).on("click.bs.dropdown",this.toggle)}let _s="[data-toggle=dropdown]";function ws(n){m(".dropdown-backdrop").remove(),m(_s).each(function(){var t=bs(m(this)),e={relatedTarget:this};t.hasClass("open")&&(t.trigger(n=m.Event("hide.bs.dropdown",e)),n.isDefaultPrevented()||t.removeClass("open").trigger("hidden.bs.dropdown",e))})}function bs(t){let e=t.attr("data-target");var n=(e=e||(e=t.attr("href"))&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""))&&m(e);return n&&n.length?n:t.parent()}vs.prototype.toggle=function(t){var e=m(this);if(!e.is(".disabled, :disabled")){var n=bs(e),r=n.hasClass("open");if(ws(),!r){"ontouchstart"in document.documentElement&&!n.closest(".navbar-nav").length&&m('<div class="dropdown-backdrop"/>').insertAfter(m(this)).on("click",ws);r={relatedTarget:this};if(n.trigger(t=m.Event("show.bs.dropdown",r)),t.isDefaultPrevented())return;n.toggleClass("open").trigger("shown.bs.dropdown",r),e.focus()}return!1}},vs.prototype.keydown=function(e){if(/^(38|40|27)$/.test(e.keyCode)){var n=m(this);if(e.preventDefault(),e.stopPropagation(),!n.is(".disabled, :disabled")){var t=bs(n),r=t.hasClass("open");if(!r||27===e.keyCode)return 27===e.which&&t.find(_s).focus(),n.click();r=" li:not(.divider):visible a",n=t.find(`[role=menu]${r}, [role=listbox]`+r);if(n.length){let t=n.index(n.filter(":focus"));38===e.keyCode&&0<t&&t--,40===e.keyCode&&t<n.length-1&&t++,~t||(t=0),n.eq(t).focus()}}}};let Cs=m.fn.dropdown,Es=(m.fn.dropdown=function(n){return this.each(function(){var t=m(this),e=t.data("bs.dropdown");e||t.data("bs.dropdown",new vs(this)),"string"==typeof n&&e[n].call(t)})},m.fn.dropdown.Constructor=vs,m.fn.dropdown.noConflict=function(){return m.fn.dropdown=Cs,this},m(document).on("click.bs.dropdown.data-api",ws).on("click.bs.dropdown.data-api",".dropdown form",t=>{t.stopPropagation()}).on("click.bs.dropdown.data-api",_s,vs.prototype.toggle).on("keydown.bs.dropdown.data-api",_s+", [role=menu], [role=listbox]",vs.prototype.keydown),document.createRange());class Ss extends cs{static get selector(){return".question select"}static get list(){return!0}static condition(){return!ys.touch}_init(){var t=this.element,e=(t.style.display="none",this._getTemplate());t.after(e),this.picker=this.question.querySelector(".bootstrap-select"),this.props.readonly&&this.disable(),this._clickListener(),this._focusListener()}_getTemplate(){var t=Es.createContextualFragment(`
        <div class="btn-group bootstrap-select widget clearfix">
            <button type="button" class="btn btn-default dropdown-toggle clearfix" data-toggle="dropdown">
                <span class="selected"></span><span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">${this._getLisHtml()}</ul>
        </div>`);return this._showSelected(t.querySelector(".selected")),t}_getLisHtml(){let i=this.props.multiple?'type="checkbox"':`type="radio" name="${1e5*Math.random()}"`;return[...this.element.querySelectorAll("option")].map(t=>{var e,n=t.textContent,r=t.matches(":checked"),t=t.value;return t?(e=r?' checked="checked"':"",`
                        <li ${r?'class="active"':""}>
                            <a class="option-wrapper" tabindex="-1" href="#">
                                <label>
                                    <input class="ignore" ${i}${e} value="${Re(t)}" />
                                    <span class="option-label">${Re(n)}</span>
                                </label>
                            </a>
                        </li>`):""}).join("")}_showSelected(t){var e=[...this.element.querySelectorAll("option:checked")].filter(t=>t.getAttribute("value").length).map(t=>t.textContent);0===e.length?(t.textContent=C("selectpicker.noneselected"),t.dataset.i18n="selectpicker.noneselected",delete t.dataset.i18nNumber):1===e.length?(t.textContent=e[0],delete t.dataset.i18n,delete t.dataset.i18nNumber):(e=e.length,t.textContent=C("selectpicker.numberselected",{number:e}),t.dataset.i18n="selectpicker.numberselected",t.dataset.i18nNumber=e)}_clickListener(){let a=this;m(this.picker).on("click","li:not(.disabled)",function(t){let e=this,n=e.querySelector("input"),r=a.element,i=r.querySelector(`option[value="${n.value}"]`),o=i.matches(":checked");"input"!==t.target.nodeName.toLowerCase()&&t.preventDefault(),a.props.multiple?t.stopPropagation():(a.picker.querySelectorAll("li").forEach(t=>t.classList.remove("active")),Pe(i,"option").forEach(t=>{t.selected=!1}),a.picker.querySelectorAll("input").forEach(t=>t.checked=!1)),setTimeout(()=>{o?(e.classList.remove("active"),n.checked=!1,i.selected=!1):(e.classList.add("active"),i.selected=!0,n.checked=!0);var t=a.picker.querySelector(".selected");a._showSelected(t),r.dispatchEvent(new E.Change)},10)}).on("keydown","li:not(.disabled)",t=>{var e=t.keyCode.toString(10);/(13|32)/.test(e)&&(/(32)/.test(e)||t.preventDefault(),(e=m(":focus")).click(),e.focus(),t.preventDefault())}).on("click","li.disabled",t=>(t.stopPropagation(),!1)).on("click","a",t=>{t.preventDefault()})}_focusListener(){let t=this;this.element.addEventListener(E.ApplyFocus().type,()=>{t.picker.querySelector(".dropdown-toggle").focus()})}disable(){this.picker.querySelectorAll("li").forEach(t=>{t.classList.add("disabled");t=t.querySelector("input");t.disabled=!0,t.readOnly=!0})}enable(){this.picker.querySelectorAll("li").forEach(t=>{t.classList.remove("disabled");t=t.querySelector("input");t.disabled=!1,t.readOnly=!1})}update(){this.picker.remove(),this._init()}}class Ts extends cs{static get selector(){return".question select[multiple]"}static condition(){return ys.touch}_init(){var t=document.createRange().createContextualFragment('<span class="widget mobileselect"></span>');this.element.after(t),this.widget=this.element.parentElement.querySelector(".widget"),this.element.addEventListener("change",()=>{this._showSelectedValues()}),this._showSelectedValues()}_showSelectedValues(){this.widget.textContent=this.originalInputValue.join(", ")}update(){this._showSelectedValues()}}let As="relevantDropdown";function Is(t,e,n){this.namespace=As,this.element=t,this.options=m.extend({fadeOutSpeed:"normal",change:null},e),n&&(n.stopPropagation(),n.preventDefault()),this._init()}m.expr[":"].RD_contains=m.expr.createPseudo(e=>t=>0<=m(t).text().toUpperCase().indexOf(e.toUpperCase())),Is.prototype._init=function(){var t=m(this.element);this.listId=t.attr("list"),this.$fakeDatalist=m("<ul />",{class:"datalist widget",id:this.listId}).appendTo(t.parent()),this._updateFakeDatalist(),this._setEventListeners()},Is.prototype._updateFakeDatalist=function(){var t=m("#"+this.listId);let e=document.createDocumentFragment();this.$fakeDatalist.empty(),t.find("option").each(function(){var t=m("<li />",{text:m(this).val()})[0];e.appendChild(t)}),this.$fakeDatalist.append(e),this.$fakeDatalistItems=this.$fakeDatalist.find("li")},Is.prototype._setEventListeners=function(){let o=this,a=m(this.element),e,s=0;a.on("focus",()=>{o.$fakeDatalist.scrollTop(0),s=0}).on("blur",()=>{setTimeout(()=>{o.$fakeDatalist.fadeOut(o.options.fadeOutSpeed),o.$fakeDatalistItems.removeClass("active")},500)}).on("keyup",function(t){e=a.position(),o.$fakeDatalist.show().css({top:e.top+m(this).outerHeight(),left:e.left,width:a.outerWidth()}),o.$fakeDatalistItems.hide(),o.$fakeDatalist.find(`li:RD_contains("${a.val()}")`).show()}),this.$fakeDatalist.on("mouseenter","li",function(){m(this).addClass("active").siblings().removeClass("active")}).on("mouseleave","li",function(){m(this).removeClass("active")}),m(window).resize(function(){e=a.position(),o.$fakeDatalist.css({top:e.top+m(this).outerHeight(),left:e.left,width:a.outerWidth()})}),a.on("keydown",t=>{var e,n=o.$fakeDatalist.find("li.active"),r=o.$fakeDatalist.outerHeight(),i=o.$fakeDatalistItems.outerHeight();38==t.keyCode&&n.length&&(0<(prevAll=n.prevAll("li:visible")).length&&(n.removeClass("active"),prevAll.eq(0).addClass("active")),prevAll.length)&&prevAll.position().top<0&&0<s&&o.$fakeDatalist.scrollTop(s-=i),40==t.keyCode&&(n.length?(0<(e=n.nextAll("li:visible")).length&&(n.removeClass("active"),e.eq(0).addClass("active")),e.length&&e.position().top+i>=r&&o.$fakeDatalist.stop().animate({scrollTop:s+=i},200)):(o.$fakeDatalistItems.removeClass("active"),o.$fakeDatalist.find("li:visible:first").addClass("active"))),13!=t.keyCode&&9!=t.keyCode||(n.length&&a.val(n.text()).trigger("input"),o.$fakeDatalist.fadeOut(o.options.fadeOutSpeed),o.$fakeDatalistItems.removeClass("active")),13!=t.keyCode&&38!=t.keyCode&&40!=t.keyCode&&(o.$fakeDatalistItems.removeClass("active"),o.$fakeDatalist.find("li:visible:first").addClass("active"),o.$fakeDatalist.scrollTop(0),s=0)}),this.$fakeDatalist.on("click","li",function(){m("li.active").length&&a.val(m(this).text()).trigger("input"),o.$fakeDatalist.fadeOut(o.options.fadeOutSpeed),o.$fakeDatalistItems.removeClass("active")})},Is.prototype.update=function(){this._updateFakeDatalist()},m.fn[As]=function(n,r){return n=n||{},this.each(function(){var t=m(this);let e=t.data(As);e||"object"!=typeof n?e&&"string"==typeof n&&e[n](this):t.data(As,e=new Is(this,n,r))})};let Ls=!("list"in document.createElement("input")&&"options"in document.createElement("datalist")&&void 0!==window.HTMLDataListElement);class ks extends cs{static get selector(){return".question input[list]"}static get list(){return!0}_init(){var t=this.element.getAttribute("list"),e=(Me(this.element,"datalist")?this.options=[...this.question.querySelectorAll(`datalist#${CSS.escape(t)} > option`)]:(e=Me(this.element.closest(".or-repeat"),".or-repeat-info"),this.options=e?[...e.querySelectorAll(`datalist#${CSS.escape(t)} > option`)]:[]),this.options.forEach(t=>{var e=t.getAttribute("value");!t.classList.contains("itemset-template")&&t.textContent&&null!=e&&(t.dataset.value=e,t.setAttribute("value",t.textContent),t.textContent="")}),document.createRange().createContextualFragment(`<input type="text" class="ignore widget autocomplete" list="${t}" />`));this.element.classList.add("hide"),this.element.after(e),this.fakeInput=this.element.parentElement.querySelector("input.autocomplete"),this.props.readonly&&this.fakeInput.setAttribute("readonly","readonly"),this.props.disabled&&this.fakeInput.setAttribute("disabled","disabled"),Ls&&m(this.fakeInput).relevantDropdown(),this._setFakeInputListener(),this._setFocusListener(),this._showCurrentLabel()}_showCurrentLabel(){var t=this.originalInputValue,e=this._findLabel(t);this.fakeInput.value=e,t&&!e&&this.fakeInput.dispatchEvent(E.Input())}_setFakeInputListener(){this.fakeInput.addEventListener("input",t=>{var t=t.target,e=t.value,n=this._findValue(e)||"";this.originalInputValue!==n&&(this.originalInputValue=n),t.classList.toggle("notfound",e&&!n)})}_findValue(e){let n="";return e?(this.options.forEach(t=>{if(t.value===e)return n=t.getAttribute("data-value"),!1}),n):""}_findLabel(e){let n="";return e?(this.options.forEach(t=>{if(t.dataset.value===e)return n=t.value,!1}),n):""}_setFocusListener(){this.element.addEventListener(E.ApplyFocus().type,()=>{this.fakeInput.focus()})}disable(){this.fakeInput.classList.add("disabled")}enable(){this.fakeInput.classList.remove("disabled")}update(){this.element.parentElement.querySelector(".widget").remove(),this._init()}}var xs,Ds,Ns,Rs,Ps,Os,Ms,Bs=F(function(B,t){function u(t){for(var e,n,r=1,i=arguments.length;r<i;r++)for(e in n=arguments[r])t[e]=n[e];return t}var U=Object.create||(()=>{function e(){}return function(t){return e.prototype=t,new e}})();function s(t,e){var n,r=Array.prototype.slice;return t.bind?t.bind.apply(t,r.call(arguments,1)):(n=r.call(arguments,2),function(){return t.apply(e,n.length?n.concat(r.call(arguments)):arguments)})}var F=0;function l(t){return"_leaflet_id"in t||(t._leaflet_id=++F),t._leaflet_id}function V(t,e,n){var r,i,o=function(){r=!1,i&&(a.apply(n,i),i=!1)},a=function(){r?i=arguments:(t.apply(n,arguments),setTimeout(o,e),r=!0)};return a}function H(t,e,n){var r=e[1],e=e[0],i=r-e;return t===r&&n?t:((t-e)%i+i)%i+e}function c(){return!1}function n(t,e){return!1===e?t:(e=Math.pow(10,void 0===e?6:e),Math.round(t*e)/e)}function z(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function j(t){return z(t).split(/\s+/)}function h(t,e){for(var n in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?U(t.options):{}),e)t.options[n]=e[n];return t.options}function q(t,e,n){var r,i=[];for(r in t)i.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}var W=/\{ *([\w_ -]+) *\}/g;function G(t,n){return t.replace(W,function(t,e){e=n[e];if(void 0===e)throw new Error("No value provided for variable "+t);return e="function"==typeof e?e(n):e})}var d=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function $(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var K="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function X(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var Z=0;function Y(t){var e=+new Date,n=Math.max(0,16-(e-Z));return Z=e+n,window.setTimeout(t,n)}var Q=window.requestAnimationFrame||X("RequestAnimationFrame")||Y,J=window.cancelAnimationFrame||X("CancelAnimationFrame")||X("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function w(t,e,n){if(!n||Q!==Y)return Q.call(window,s(t,e));t.call(e)}function a(t){t&&J.call(window,t)}var tt={__proto__:null,extend:u,create:U,bind:s,get lastId(){return F},stamp:l,throttle:V,wrapNum:H,falseFn:c,formatNum:n,trim:z,splitWords:j,setOptions:h,getParamString:q,template:G,isArray:d,indexOf:$,emptyImageUrl:K,requestFn:Q,cancelFn:J,requestAnimFrame:w,cancelAnimFrame:a};function et(){}et.extend=function(t){function e(){h(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()}var n,r=e.__super__=this.prototype,i=U(r);for(n in(i.constructor=e).prototype=i,this)Object.prototype.hasOwnProperty.call(this,n)&&"prototype"!==n&&"__super__"!==n&&(e[n]=this[n]);if(t.statics&&u(e,t.statics),t.includes){var o=t.includes;if("undefined"!=typeof L&&L&&L.Mixin){o=d(o)?o:[o];for(var a=0;a<o.length;a++)o[a]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}u.apply(null,[i].concat(t.includes))}return u(i,t),delete i.statics,delete i.includes,i.options&&(i.options=r.options?U(r.options):{},u(i.options,t.options)),i._initHooks=[],i.callInitHooks=function(){if(!this._initHooksCalled){r.callInitHooks&&r.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;t<e;t++)i._initHooks[t].call(this)}},e},et.include=function(t){var e=this.prototype.options;return u(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},et.mergeOptions=function(t){return u(this.prototype.options,t),this},et.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var e={on:function(t,e,n){if("object"==typeof t)for(var r in t)this._on(r,t[r],e);else for(var i=0,o=(t=j(t)).length;i<o;i++)this._on(t[i],e,n);return this},off:function(t,e,n){if(arguments.length)if("object"==typeof t)for(var r in t)this._off(r,t[r],e);else{t=j(t);for(var i=1===arguments.length,o=0,a=t.length;o<a;o++)i?this._off(t[o]):this._off(t[o],e,n)}else delete this._events;return this},_on:function(t,e,n,r){"function"!=typeof e?console.warn("wrong listener type: "+typeof e):!1===this._listens(t,e,n)&&(e={fn:e,ctx:n=n===this?void 0:n},r&&(e.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e))},_off:function(t,e,n){var r,i,o;if(this._events&&(r=this._events[t]))if(1===arguments.length){if(this._firingCount)for(i=0,o=r.length;i<o;i++)r[i].fn=c;delete this._events[t]}else"function"!=typeof e?console.warn("wrong listener type: "+typeof e):!1!==(e=this._listens(t,e,n))&&(n=r[e],this._firingCount&&(n.fn=c,this._events[t]=r=r.slice()),r.splice(e,1))},fire:function(t,e,n){if(this.listens(t,n)){var r=u({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var i=this._events[t];if(i){this._firingCount=this._firingCount+1||1;for(var o=0,a=i.length;o<a;o++){var s=i[o],l=s.fn;s.once&&this.off(t,l,s.ctx),l.call(s.ctx||this,r)}this._firingCount--}}n&&this._propagateEvent(r)}return this},listens:function(t,e,n,r){"string"!=typeof t&&console.warn('"string" type argument expected');var i=e,o=("function"!=typeof e&&(r=!!e,n=i=void 0),this._events&&this._events[t]);if(o&&o.length&&!1!==this._listens(t,i,n))return!0;if(r)for(var a in this._eventParents)if(this._eventParents[a].listens(t,e,n,r))return!0;return!1},_listens:function(t,e,n){if(this._events){var r=this._events[t]||[];if(!e)return!!r.length;n===this&&(n=void 0);for(var i=0,o=r.length;i<o;i++)if(r[i].fn===e&&r[i].ctx===n)return i}return!1},once:function(t,e,n){if("object"==typeof t)for(var r in t)this._on(r,t[r],e,!0);else for(var i=0,o=(t=j(t)).length;i<o;i++)this._on(t[i],e,n,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[l(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[l(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,u({layer:t.target,propagatedFrom:t.target},t),!0)}},nt=(e.addEventListener=e.on,e.removeEventListener=e.clearAllEventListeners=e.off,e.addOneTimeEventListener=e.once,e.fireEvent=e.fire,e.hasEventListeners=e.listens,et.extend(e));function f(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var rt=Math.trunc||function(t){return 0<t?Math.floor(t):Math.ceil(t)};function g(t,e,n){return t instanceof f?t:d(t)?new f(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new f(t.x,t.y):new f(t,e,n)}function m(t,e){if(t)for(var n=e?[t,e]:t,r=0,i=n.length;r<i;r++)this.extend(n[r])}function p(t,e){return!t||t instanceof m?t:new m(t,e)}function o(t,e){if(t)for(var n=e?[t,e]:t,r=0,i=n.length;r<i;r++)this.extend(n[r])}function y(t,e){return t instanceof o?t:new o(t,e)}function v(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function b(t,e,n){return t instanceof v?t:d(t)&&"object"!=typeof t[0]?3===t.length?new v(t[0],t[1],t[2]):2===t.length?new v(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new v(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new v(t,e,n)}f.prototype={clone:function(){return new f(this.x,this.y)},add:function(t){return this.clone()._add(g(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(g(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new f(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new f(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=rt(this.x),this.y=rt(this.y),this},distanceTo:function(t){var e=(t=g(t)).x-this.x,t=t.y-this.y;return Math.sqrt(e*e+t*t)},equals:function(t){return(t=g(t)).x===this.x&&t.y===this.y},contains:function(t){return t=g(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+n(this.x)+", "+n(this.y)+")"}},m.prototype={extend:function(t){var e,n;if(t){if(t instanceof f||"number"==typeof t[0]||"x"in t)e=n=g(t);else if(e=(t=p(t)).min,n=t.max,!e||!n)return this;this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=e.clone(),this.max=n.clone())}return this},getCenter:function(t){return g((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return g(this.min.x,this.max.y)},getTopRight:function(){return g(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t=("number"==typeof t[0]||t instanceof f?g:p)(t))instanceof m?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=p(t);var e=this.min,n=this.max,r=t.min,t=t.max,i=t.x>=e.x&&r.x<=n.x,e=e.y<=t.y&&r.y<=n.y;return i&&e},overlaps:function(t){t=p(t);var e=this.min,n=this.max,r=t.min,t=t.max,i=t.x>e.x&&r.x<n.x,e=e.y<t.y&&r.y<n.y;return i&&e},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var e=this.min,n=this.max,r=Math.abs(e.x-n.x)*t,t=Math.abs(e.y-n.y)*t;return p(g(e.x-r,e.y-t),g(n.x+r,n.y+t))},equals:function(t){return!!t&&(t=p(t),this.min.equals(t.getTopLeft()))&&this.max.equals(t.getBottomRight())}},o.prototype={extend:function(t){var e,n,r=this._southWest,i=this._northEast;if(t instanceof v)n=e=t;else{if(!(t instanceof o))return t?this.extend(b(t)||y(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return r||i?(r.lat=Math.min(e.lat,r.lat),r.lng=Math.min(e.lng,r.lng),i.lat=Math.max(n.lat,i.lat),i.lng=Math.max(n.lng,i.lng)):(this._southWest=new v(e.lat,e.lng),this._northEast=new v(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,r=Math.abs(e.lat-n.lat)*t,t=Math.abs(e.lng-n.lng)*t;return new o(new v(e.lat-r,e.lng-t),new v(n.lat+r,n.lng+t))},getCenter:function(){return new v((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new v(this.getNorth(),this.getWest())},getSouthEast:function(){return new v(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t=("number"==typeof t[0]||t instanceof v||"lat"in t?b:y)(t);var e,n,r=this._southWest,i=this._northEast;return t instanceof o?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=r.lat&&n.lat<=i.lat&&e.lng>=r.lng&&n.lng<=i.lng},intersects:function(t){t=y(t);var e=this._southWest,n=this._northEast,r=t.getSouthWest(),t=t.getNorthEast(),i=t.lat>=e.lat&&r.lat<=n.lat,t=t.lng>=e.lng&&r.lng<=n.lng;return i&&t},overlaps:function(t){t=y(t);var e=this._southWest,n=this._northEast,r=t.getSouthWest(),t=t.getNorthEast(),i=t.lat>e.lat&&r.lat<n.lat,t=t.lng>e.lng&&r.lng<n.lng;return i&&t},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=y(t),this._southWest.equals(t.getSouthWest(),e))&&this._northEast.equals(t.getNorthEast(),e)},isValid:function(){return!(!this._southWest||!this._northEast)}};var it={latLngToPoint:function(t,e){t=this.projection.project(t),e=this.scale(e);return this.transformation._transform(t,e)},pointToLatLng:function(t,e){e=this.scale(e),t=this.transformation.untransform(t,e);return this.projection.unproject(t)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){var e;return this.infinite?null:(e=this.projection.bounds,t=this.scale(t),new m(this.transformation.transform(e.min,t),this.transformation.transform(e.max,t)))},infinite:!(v.prototype={equals:function(t,e){return!!t&&(t=b(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+n(this.lat,t)+", "+n(this.lng,t)+")"},distanceTo:function(t){return ot.distance(this,b(t))},wrap:function(){return ot.wrapLatLng(this)},toBounds:function(t){var t=180*t/40075017,e=t/Math.cos(Math.PI/180*this.lat);return y([this.lat-t,this.lng-e],[this.lat+t,this.lng+e])},clone:function(){return new v(this.lat,this.lng,this.alt)}}),wrapLatLng:function(t){var e=this.wrapLng?H(t.lng,this.wrapLng,!0):t.lng;return new v(this.wrapLat?H(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),r=e.lat-n.lat,e=e.lng-n.lng;return 0==r&&0==e?t:(n=t.getSouthWest(),t=t.getNorthEast(),new o(new v(n.lat-r,n.lng-e),new v(t.lat-r,t.lng-e)))}},ot=u({},it,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,r=t.lat*n,i=e.lat*n,o=Math.sin((e.lat-t.lat)*n/2),e=Math.sin((e.lng-t.lng)*n/2),t=o*o+Math.cos(r)*Math.cos(i)*e*e,n=2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t));return this.R*n}}),at={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,n=Math.max(Math.min(n,t.lat),-n),n=Math.sin(n*e);return new f(this.R*t.lng*e,this.R*Math.log((1+n)/(1-n))/2)},unproject:function(t){var e=180/Math.PI;return new v((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(()=>{var t=6378137*Math.PI;return new m([-t,-t],[t,t])})()};function st(t,e,n,r){d(t)?(this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3]):(this._a=t,this._b=e,this._c=n,this._d=r)}function lt(t,e,n,r){return new st(t,e,n,r)}st.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return t.x=(e=e||1)*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return new f((t.x/(e=e||1)-this._b)/this._a,(t.y/e-this._d)/this._c)}};var ut=u({},ot,{code:"EPSG:3857",projection:at,transformation:(()=>{var t=.5/(Math.PI*at.R);return lt(t,.5,-t,.5)})()}),ct=u({},ut,{code:"EPSG:900913"});function ht(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function dt(t,e){for(var n,r,i,o,a="",s=0,l=t.length;s<l;s++){for(n=0,r=(i=t[s]).length;n<r;n++)a+=(n?"L":"M")+(o=i[n]).x+" "+o.y;a+=e?C.svg?"z":"x":""}return a||"M0 0"}var pt=document.documentElement.style,ft="ActiveXObject"in window,gt=ft&&!document.addEventListener,r="msLaunchUri"in navigator&&!("documentMode"in document),mt=_("webkit"),yt=_("android"),vt=_("android 2")||_("android 3"),_t=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_t=yt&&_("Google")&&_t<537&&!("AudioNode"in window),wt=!!window.opera,bt=!r&&_("chrome"),Ct=_("gecko")&&!mt&&!wt&&!ft,i=!bt&&_("safari"),Et=_("phantom"),St="OTransition"in pt,Tt=0===navigator.platform.indexOf("Win"),At=ft&&"transition"in pt,It="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!vt,pt="MozPerspective"in pt,Lt=!window.L_DISABLE_3D&&(At||It||pt)&&!St&&!Et,kt=(Yn="undefined"!=typeof orientation||_("mobile"))&&mt,xt=Yn&&It,Dt=!window.PointerEvent&&window.MSPointerEvent,Nt=!(!window.PointerEvent&&!Dt),Rt="ontouchstart"in window||!!window.TouchEvent,Pt=!window.L_NO_TOUCH&&(Rt||Nt),Ot=Yn&&wt,Mt=Yn&&Ct,Bt=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),Ut=(()=>{var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",c,e),window.removeEventListener("testPassiveEventSupport",c,e)}catch(t){}return t})(),Ft=!!document.createElement("canvas").getContext,Vt=!(!document.createElementNS||!ht("svg").createSVGRect),Ht=!!Vt&&(()=>{var t=document.createElement("div");return t.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(t.firstChild&&t.firstChild.namespaceURI)})();function _(t){return 0<=navigator.userAgent.toLowerCase().indexOf(t)}var C={ie:ft,ielt9:gt,edge:r,webkit:mt,android:yt,android23:vt,androidStock:_t,opera:wt,chrome:bt,gecko:Ct,safari:i,phantom:Et,opera12:St,win:Tt,ie3d:At,webkit3d:It,gecko3d:pt,any3d:Lt,mobile:Yn,mobileWebkit:kt,mobileWebkit3d:xt,msPointer:Dt,pointer:Nt,touch:Pt,touchNative:Rt,mobileOpera:Ot,mobileGecko:Mt,retina:Bt,passiveEvents:Ut,canvas:Ft,svg:Vt,vml:!Vt&&(()=>{try{var t=document.createElement("div"),e=(t.innerHTML='<v:shape adj="1"/>',t.firstChild);return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}})(),inlineSvg:Ht,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},zt=C.msPointer?"MSPointerDown":"pointerdown",jt=C.msPointer?"MSPointerMove":"pointermove",qt=C.msPointer?"MSPointerUp":"pointerup",Wt=C.msPointer?"MSPointerCancel":"pointercancel",Gt={touchstart:zt,touchmove:jt,touchend:qt,touchcancel:Wt},$t={touchstart:function(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&R(e);te(t,e)},touchmove:te,touchend:te,touchcancel:te},Kt={},Xt=!1;function Zt(t,e,n){return"touchstart"!==e||Xt||(document.addEventListener(zt,Yt,!0),document.addEventListener(jt,Qt,!0),document.addEventListener(qt,Jt,!0),document.addEventListener(Wt,Jt,!0),Xt=!0),$t[e]?(n=$t[e].bind(this,n),t.addEventListener(Gt[e],n,!1),n):(console.warn("wrong event specified:",e),c)}function Yt(t){Kt[t.pointerId]=t}function Qt(t){Kt[t.pointerId]&&(Kt[t.pointerId]=t)}function Jt(t){delete Kt[t.pointerId]}function te(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in e.touches=[],Kt)e.touches.push(Kt[n]);e.changedTouches=[e],t(e)}}var ee=200;function ne(t,n){t.addEventListener("dblclick",n);var r,i=0;function e(t){var e;1!==t.detail?r=t.detail:"mouse"===t.pointerType||t.sourceCapabilities&&!t.sourceCapabilities.firesTouchEvents||(e=Be(t)).some(function(t){return t instanceof HTMLLabelElement&&t.attributes.for})&&!e.some(function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement})||((e=Date.now())-i<=ee?2===++r&&n((t=>{var e,n,r={};for(n in t)e=t[n],r[n]=e&&e.bind?e.bind(t):e;return(t=r).type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r})(t)):r=1,i=e)}return t.addEventListener("click",e),{dblclick:n,simDblclick:e}}var re,ie,oe,ae,se,le,ue=we(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ce=we(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),he="webkitTransition"===ce||"OTransition"===ce?ce+"End":"transitionend";function de(t){return"string"==typeof t?document.getElementById(t):t}function pe(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];return"auto"===(n=n&&"auto"!==n||!document.defaultView?n:(t=document.defaultView.getComputedStyle(t,null))?t[e]:null)?null:n}function E(t,e,n){t=document.createElement(t);return t.className=e||"",n&&n.appendChild(t),t}function S(t){var e=t.parentNode;e&&e.removeChild(t)}function fe(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ge(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function me(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ye(t,e){return void 0!==t.classList?t.classList.contains(e):0<(t=_e(t)).length&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(t)}function T(t,e){var n;if(void 0!==t.classList)for(var r=j(e),i=0,o=r.length;i<o;i++)t.classList.add(r[i]);else ye(t,e)||ve(t,((n=_e(t))?n+" ":"")+e)}function A(t,e){void 0!==t.classList?t.classList.remove(e):ve(t,z((" "+_e(t)+" ").replace(" "+e+" "," ")))}function ve(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function _e(t){return void 0===(t=t.correspondingElement?t.correspondingElement:t).className.baseVal?t.className:t.className.baseVal}function I(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,r="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(r)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+r+"(opacity="+e+")"}}function we(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function be(t,e,n){e=e||new f(0,0);t.style[ue]=(C.ie3d?"translate("+e.x+"px,"+e.y+"px)":"translate3d("+e.x+"px,"+e.y+"px,0)")+(n?" scale("+n+")":"")}function k(t,e){t._leaflet_pos=e,C.any3d?be(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Ce(t){return t._leaflet_pos||new f(0,0)}function Ee(){x(window,"dragstart",R)}function Se(){N(window,"dragstart",R)}function Te(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Ae(),se=(ae=t).style.outlineStyle,t.style.outlineStyle="none",x(window,"keydown",Ae))}function Ae(){ae&&(ae.style.outlineStyle=se,se=ae=void 0,N(window,"keydown",Ae))}function Ie(t){for(;!((t=t.parentNode).offsetWidth&&t.offsetHeight||t===document.body););return t}function Le(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}function x(t,e,n,r){if(e&&"object"==typeof e)for(var i in e)De(t,i,e[i],n);else for(var o=0,a=(e=j(e)).length;o<a;o++)De(t,e[o],n,r);return this}ie="onselectstart"in document?(re=function(){x(window,"selectstart",R)},function(){N(window,"selectstart",R)}):(le=we(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),re=function(){var t;le&&(t=document.documentElement.style,oe=t[le],t[le]="none")},function(){le&&(document.documentElement.style[le]=oe,oe=void 0)}),ft={__proto__:null,TRANSFORM:ue,TRANSITION:ce,TRANSITION_END:he,get:de,getStyle:pe,create:E,remove:S,empty:fe,toFront:ge,toBack:me,hasClass:ye,addClass:T,removeClass:A,setClass:ve,getClass:_e,setOpacity:I,testProp:we,setTransform:be,setPosition:k,getPosition:Ce,get disableTextSelection(){return re},get enableTextSelection(){return ie},disableImageDrag:Ee,enableImageDrag:Se,preventOutline:Te,restoreOutline:Ae,getSizedParentNode:Ie,getScale:Le};var D="_leaflet_events";function N(t,e,n,r){if(1===arguments.length)ke(t),delete t[D];else if(e&&"object"==typeof e)for(var i in e)Ne(t,i,e[i],n);else if(e=j(e),2===arguments.length)ke(t,function(t){return-1!==$(e,t)});else for(var o=0,a=e.length;o<a;o++)Ne(t,e[o],n,r);return this}function ke(t,e){for(var n in t[D]){var r=n.split(/\d/)[0];e&&!e(r)||Ne(t,r,null,null,n)}}var xe={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function De(e,t,n,r){var i,o,a=t+l(n)+(r?"_"+l(r):"");e[D]&&e[D][a]||(o=i=function(t){return n.call(r||e,t||window.event)},!C.touchNative&&C.pointer&&0===t.indexOf("touch")?i=Zt(e,t,i):C.touch&&"dblclick"===t?i=ne(e,i):"addEventListener"in e?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?e.addEventListener(xe[t]||t,i,!!C.passiveEvents&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?e.addEventListener(xe[t],i=function(t){t=t||window.event,He(e,t)&&o(t)},!1):e.addEventListener(t,o,!1):e.attachEvent("on"+t,i),e[D]=e[D]||{},e[D][a]=i)}function Ne(t,e,n,r,i){i=i||e+l(n)+(r?"_"+l(r):"");var o,a,n=t[D]&&t[D][i];n&&(!C.touchNative&&C.pointer&&0===e.indexOf("touch")?(r=t,a=n,Gt[o=e]?r.removeEventListener(Gt[o],a,!1):console.warn("wrong event specified:",o)):C.touch&&"dblclick"===e?(r=n,(a=t).removeEventListener("dblclick",r.dblclick),a.removeEventListener("click",r.simDblclick)):"removeEventListener"in t?t.removeEventListener(xe[e]||e,n,!1):t.detachEvent("on"+e,n),t[D][i]=null)}function Re(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Pe(t){return De(t,"wheel",Re),this}function Oe(t){return x(t,"mousedown touchstart dblclick contextmenu",Re),t._leaflet_disable_click=!0,this}function R(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Me(t){return R(t),Re(t),this}function Be(t){if(t.composedPath)return t.composedPath();for(var e=[],n=t.target;n;)e.push(n),n=n.parentNode;return e}function Ue(t,e){var n,r;return e?(r=(n=Le(e)).boundingClientRect,new f((t.clientX-r.left)/n.x-e.clientLeft,(t.clientY-r.top)/n.y-e.clientTop)):new f(t.clientX,t.clientY)}var Fe=C.linux&&C.chrome?window.devicePixelRatio:C.mac?3*window.devicePixelRatio:0<window.devicePixelRatio?2*window.devicePixelRatio:1;function Ve(t){return C.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Fe:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function He(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}var gt={__proto__:null,on:x,off:N,stopPropagation:Re,disableScrollPropagation:Pe,disableClickPropagation:Oe,preventDefault:R,stop:Me,getPropagationPath:Be,getMousePosition:Ue,getWheelDelta:Ve,isExternalTarget:He,addListener:x,removeListener:N},ze=nt.extend({run:function(t,e,n,r){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(r||.5,.2),this._startPos=Ce(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=w(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){t=this._startPos.add(this._offset.multiplyBy(t));e&&t._round(),k(this._el,t),this.fire("step")},_complete:function(){a(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),P=nt.extend({options:{crs:ut,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=h(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=s(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(b(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ce&&C.any3d&&!C.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),x(this._proxy,he,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,n){if((e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(b(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n)&&(void 0!==n.animate&&(n.zoom=u({animate:n.animate},n.zoom),n.pan=u({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,e,n.pan&&n.pan.noMoveStart),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(C.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(C.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var r=this.getZoomScale(e),i=this.getSize().divideBy(2),t=(t instanceof f?t:this.latLngToContainerPoint(t)).subtract(i).multiplyBy(1-1/r),r=this.containerPointToLatLng(i.add(t));return this.setView(r,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():y(t);var n=g(e.paddingTopLeft||e.padding||[0,0]),r=g(e.paddingBottomRight||e.padding||[0,0]),i=this.getBoundsZoom(t,!1,n.add(r));return(i="number"==typeof e.maxZoom?Math.min(e.maxZoom,i):i)===1/0?{center:t.getCenter(),zoom:i}:(e=r.subtract(n).divideBy(2),r=this.project(t.getSouthWest(),i),n=this.project(t.getNorthEast(),i),{center:this.unproject(r.add(n).divideBy(2).add(e),i),zoom:i})},fitBounds:function(t,e){if((t=y(t)).isValid())return t=this._getBoundsCenterZoom(t,e),this.setView(t.center,t.zoom,e);throw new Error("Bounds are not valid.")},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){var n;return e=e||{},(t=g(t).round()).x||t.y?(!0===e.animate||this.getSize().contains(t)?(this._panAnim||(this._panAnim=new ze,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate?(T(this._mapPane,"leaflet-pan-anim"),n=this._getMapPanePos().subtract(t).round(),this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)):(this._rawPanBy(t),this.fire("move").fire("moveend"))):this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this):this.fire("moveend")},flyTo:function(r,i,t){if(!1===(t=t||{}).animate||!C.any3d)return this.setView(r,i,t);this._stop();var o=this.project(this.getCenter()),a=this.project(r),e=this.getSize(),s=this._zoom,l=(r=b(r),i=void 0===i?s:i,Math.max(e.x,e.y)),n=l*this.getZoomScale(s,i),u=a.distanceTo(o)||1,c=1.42,h=c*c;function d(t){t=(n*n-l*l+(t?-1:1)*h*h*u*u)/(2*(t?n:l)*h*u),t=Math.sqrt(t*t+1)-t;return t<1e-9?-18:Math.log(t)}function p(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t){return(Math.exp(t)+Math.exp(-t))/2}var g=d(0);function m(t){return l*(f(g)*(p(t=g+c*t)/f(t))-p(g))/h}var y=Date.now(),v=(d(1)-g)/c,_=t.duration?1e3*t.duration:1e3*v*.8;return this._moveStart(!0,t.noMoveStart),function t(){var e=(Date.now()-y)/_,n=(1-Math.pow(1-e,1.5))*v;e<=1?(this._flyToFrame=w(t,this),this._move(this.unproject(o.add(a.subtract(o).multiplyBy(m(n)/u)),s),this.getScaleZoom(l/(e=n,l*(f(g)/f(g+c*e))),s),{flyTo:!0})):this._move(r,i)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){t=this._getBoundsCenterZoom(t,e);return this.flyTo(t.center,t.zoom,e)},setMaxBounds:function(t){return t=y(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),t=this._limitCenter(n,this._zoom,y(t));return n.equals(t)||this.panTo(t,e),this._enforcingBounds=!1,this},panInside:function(t,e){var n=g((e=e||{}).paddingTopLeft||e.padding||[0,0]),r=g(e.paddingBottomRight||e.padding||[0,0]),i=this.project(this.getCenter()),t=this.project(t),o=this.getPixelBounds(),n=p([o.min.add(n),o.max.subtract(r)]),o=n.getSize();return n.contains(t)||(this._enforcingBounds=!0,r=t.subtract(n.getCenter()),n=n.extend(t).getSize().subtract(o),i.x+=r.x<0?-n.x:n.x,i.y+=r.y<0?-n.y:n.y,this.panTo(this.unproject(i),e),this._enforcingBounds=!1),this},invalidateSize:function(t){if(!this._loaded)return this;t=u({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize(),n=(this._sizeChanged=!0,this._lastCenter=null,this.getSize()),r=e.divideBy(2).round(),i=n.divideBy(2).round(),r=r.subtract(i);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){var e,n;return t=this._locateOptions=u({timeout:1e4,watch:!1},t),"geolocation"in navigator?(e=s(this._handleGeolocationResponse,this),n=s(this._handleGeolocationError,this),t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t)):this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e;this._container._leaflet_id&&(e=t.code,t=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout"),this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+t+"."}))},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e,n,r=new v(t.coords.latitude,t.coords.longitude),i=r.toBounds(2*t.coords.accuracy),o=this._locateOptions,a=(o.setView&&(e=this.getBoundsZoom(i),this.setView(r,o.maxZoom?Math.min(e,o.maxZoom):e)),{latlng:r,bounds:i,timestamp:t.timestamp});for(n in t.coords)"number"==typeof t.coords[n]&&(a[n]=t.coords[n]);this.fire("locationfound",a)}},addHandler:function(t,e){return e&&(e=this[t]=new e(this),this._handlers.push(e),this.options[t])&&e.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}for(var t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),S(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(a(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)S(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){e=E("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=e),e},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new o(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=y(t),n=g(n||[0,0]);var r=this.getZoom()||0,i=this.getMinZoom(),o=this.getMaxZoom(),a=t.getNorthWest(),t=t.getSouthEast(),n=this.getSize().subtract(n),t=p(this.project(t,r),this.project(a,r)).getSize(),a=C.any3d?this.options.zoomSnap:1,s=n.x/t.x,n=n.y/t.y,t=e?Math.max(s,n):Math.min(s,n),r=this.getScaleZoom(t,r);return a&&(r=Math.round(r/(a/100))*(a/100),r=e?Math.ceil(r/a)*a:Math.floor(r/a)*a),Math.max(i,Math.min(o,r))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new f(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){t=this._getTopLeftPoint(t,e);return new m(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs,t=(e=void 0===e?this._zoom:e,n.zoom(t*n.scale(e)));return isNaN(t)?1/0:t},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(b(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(g(t),e)},layerPointToLatLng:function(t){t=g(t).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(t){return this.project(b(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(b(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(y(t))},distance:function(t,e){return this.options.crs.distance(b(t),b(e))},containerPointToLayerPoint:function(t){return g(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return g(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){t=this.containerPointToLayerPoint(g(t));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(b(t)))},mouseEventToContainerPoint:function(t){return Ue(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){t=this._container=de(t);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");x(t,"scroll",this._onScroll,this),this._containerId=l(t)},_initLayout:function(){var t=this._container,e=(this._fadeAnimated=this.options.fadeAnimation&&C.any3d,T(t,"leaflet-container"+(C.touch?" leaflet-touch":"")+(C.retina?" leaflet-retina":"")+(C.ielt9?" leaflet-oldie":"")+(C.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":"")),pe(t,"position"));"absolute"!==e&&"relative"!==e&&"fixed"!==e&&"sticky"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),k(this._mapPane,new f(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(T(t.markerPane,"leaflet-zoom-hide"),T(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,n){k(this._mapPane,new f(0,0));var r=!this._loaded,i=(this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset"),this._zoom!==e);this._moveStart(i,n)._move(t,e)._moveEnd(i),this.fire("viewreset"),r&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n,r){void 0===e&&(e=this._zoom);var i=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),r?n&&n.pinch&&this.fire("zoom",n):((i||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return a(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){k(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={};var e=t?N:x;e((this._targets[l(this._container)]=this)._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),C.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){a(this._resizeRequest),this._resizeRequest=w(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,r=[],i="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,a=!1;o;){if((n=this._targets[l(o)])&&("click"===e||"preclick"===e)&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(e,!0)){if(i&&!He(o,t))break;if(r.push(n),i)break}if(o===this._container)break;o=o.parentNode}return r=r.length||a||i||!this.listens(e,!0)?r:[this]},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e,n=t.target||t.srcElement;!this._loaded||n._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(n)||("mousedown"===(e=t.type)&&Te(n),this._fireDOMEvent(t,e))},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,n){"click"===t.type&&((s=u({},t)).type="preclick",this._fireDOMEvent(s,s.type,n));var r=this._findEventTargets(t,e);if(n){for(var i=[],o=0;o<n.length;o++)n[o].listens(e,!0)&&i.push(n[o]);r=i.concat(r)}if(r.length){"contextmenu"===e&&R(t);var a,s=r[0],l={originalEvent:t};for("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type&&(a=s.getLatLng&&(!s._radius||s._radius<=10),l.containerPoint=a?this.latLngToContainerPoint(s.getLatLng()):this.mouseEventToContainerPoint(t),l.layerPoint=this.containerPointToLayerPoint(l.containerPoint),l.latlng=a?s.getLatLng():this.layerPointToLatLng(l.layerPoint)),o=0;o<r.length;o++)if(r[o].fire(e,l,!0),l.originalEvent._stopped||!1===r[o].options.bubblingMouseEvents&&-1!==$(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Ce(this._mapPane)||new f(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){n=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,n){n=this._getNewPixelOrigin(n,e);return p([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){var r,i;return!n||(r=this.project(t,e),i=this.getSize().divideBy(2),i=new m(r.subtract(i),r.add(i)),i=this._getBoundsOffset(i,n,e),Math.abs(i.x)<=1&&Math.abs(i.y)<=1)?t:this.unproject(r.add(i),e)},_limitOffset:function(t,e){var n;return e?(n=new m((n=this.getPixelBounds()).min.add(t),n.max.add(t)),t.add(this._getBoundsOffset(n,e))):t},_getBoundsOffset:function(t,e,n){e=p(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),n=e.min.subtract(t.min),e=e.max.subtract(t.max);return new f(this._rebound(n.x,-e.x),this._rebound(n.y,-e.y))},_rebound:function(t,e){return 0<t+e?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),r=C.any3d?this.options.zoomSnap:1;return r&&(t=Math.round(t/r)*r),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){A(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){t=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(t)||(this.panBy(t,e),0))},_createAnimProxy:function(){var t=this._proxy=E("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var e=ue,n=this._proxy.style[e];be(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){S(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();be(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&0<=t.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(!this._animatingZoom){if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var r=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/r);if(!0!==n.animate&&!this.getSize().contains(r))return!1;w(function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(t,e,!0)},this)}return!0},_animateZoom:function(t,e,n,r){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,T(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:r}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(s(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&A(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function je(t){return new O(t)}var O=et.extend({options:{position:"topright"},initialize:function(t){h(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),t=t._controlCorners[n];return T(e,"leaflet-control"),-1!==n.indexOf("bottom")?t.insertBefore(e,t.firstChild):t.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map&&(S(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null),this},_refocusOnMap:function(t){this._map&&t&&0<t.screenX&&0<t.screenY&&this._map.getContainer().focus()}}),qe=(P.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var n=this._controlCorners={},r="leaflet-",i=this._controlContainer=E("div",r+"control-container",this._container);function t(t,e){n[t+e]=E("div",r+t+" "+r+e,i)}t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)S(this._controlCorners[t]);S(this._controlContainer),delete this._controlCorners,delete this._controlContainer}}),O.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,r){return n<r?-1:r<n?1:0}},initialize:function(t,e,n){for(var r in h(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,t)this._addLayer(t[r],r);for(r in e)this._addLayer(e[r],r,!0)},onAdd:function(t){this._initLayout(),this._update(),(this._map=t).on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return O.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);t=this._getLayer(l(t));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){T(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(T(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):A(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return A(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=E("div",t),n=this.options.collapsed,r=(e.setAttribute("aria-haspopup",!0),Oe(e),Pe(e),this._section=E("section",t+"-list")),i=(n&&(this._map.on("click",this.collapse,this),x(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this)),this._layersLink=E("a",t+"-toggle",e));i.href="#",i.title="Layers",i.setAttribute("role","button"),x(i,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){R(t),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=E("div",t+"-base",r),this._separator=E("div",t+"-separator",r),this._overlaysList=E("div",t+"-overlays",r),e.appendChild(r)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&l(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(s(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(this._container){fe(this._baseLayersList),fe(this._overlaysList),this._layerControlInputs=[];for(var t,e,n,r=0,i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,r+=n.overlay?0:1;this.options.hideSingleBase&&(this._baseLayersList.style.display=(t=t&&1<r)?"":"none"),this._separator.style.display=e&&t?"":"none"}return this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(l(t.target)),t=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;t&&this._map.fire(t,e)},_createRadioElement:function(t,e){t='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",e=document.createElement("div");return e.innerHTML=t,e.firstChild},_addItem:function(t){var e,n=document.createElement("label"),r=this._map.hasLayer(t.layer),r=(t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=r):e=this._createRadioElement("leaflet-base-layers_"+l(this),r),this._layerControlInputs.push(e),e.layerId=l(t.layer),x(e,"click",this._onInputClick,this),document.createElement("span")),i=(r.innerHTML=" "+t.name,document.createElement("span"));return n.appendChild(i),i.appendChild(e),i.appendChild(r),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var t,e,n=this._layerControlInputs,r=[],i=[];this._handlingClick=!0;for(var o=n.length-1;0<=o;o--)t=n[o],e=this._getLayer(t.layerId).layer,(t.checked?r:(t.checked,i)).push(e);for(o=0;o<i.length;o++)this._map.hasLayer(i[o])&&this._map.removeLayer(i[o]);for(o=0;o<r.length;o++)this._map.hasLayer(r[o])||this._map.addLayer(r[o]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,r=this._map.getZoom(),i=n.length-1;0<=i;i--)t=n[i],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&r<e.options.minZoom||void 0!==e.options.maxZoom&&r>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section,e=(this._preventClick=!0,x(t,"click",R),this.expand(),this);setTimeout(function(){N(t,"click",R),e._preventClick=!1})}})),We=O.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=E("div",e+" leaflet-bar"),r=this.options;return this._zoomInButton=this._createButton(r.zoomInText,r.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(r.zoomOutText,r.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,r,i){n=E("a",n,r);return n.innerHTML=t,n.href="#",n.title=e,n.setAttribute("role","button"),n.setAttribute("aria-label",e),Oe(n),x(n,"click",Me),x(n,"click",i,this),x(n,"click",this._refocusOnMap,this),n},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";A(this._zoomInButton,e),A(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),!this._disabled&&t._zoom!==t.getMinZoom()||(T(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),!this._disabled&&t._zoom!==t.getMaxZoom()||(T(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}}),Ge=(P.mergeOptions({zoomControl:!0}),P.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new We,this.addControl(this.zoomControl))}),O.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=E("div",e),r=this.options;return this._addScales(r,e+"-line",n),t.on(r.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=E("div",e,n)),t.imperial&&(this._iScale=E("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,t=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(t)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t);this._updateScale(this._mScale,e<1e3?e+" m":e/1e3+" km",e/t)},_updateImperial:function(t){var e,n,t=3.2808399*t;5280<t?(n=this._getRoundNum(e=t/5280),this._updateScale(this._iScale,n+" mi",n/e)):(n=this._getRoundNum(t),this._updateScale(this._iScale,n+" ft",n/t))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),t=t/e;return e*(10<=t?10:5<=t?5:3<=t?3:2<=t?2:1)}})),$e=O.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(C.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(t){h(this,t),this._attributions={}},onAdd:function(t){for(var e in(t.attributionControl=this)._container=E("div","leaflet-control-attribution"),Oe(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t&&(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update()),this},removeAttribution:function(t){return t&&this._attributions[t]&&(this._attributions[t]--,this._update()),this},_update:function(){if(this._map){var t,e=[];for(t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}}),mt=(P.mergeOptions({attributionControl:!0}),P.addInitHook(function(){this.options.attributionControl&&(new $e).addTo(this)}),O.Layers=qe,O.Zoom=We,O.Scale=Ge,O.Attribution=$e,je.layers=function(t,e,n){return new qe(t,e,n)},je.zoom=function(t){return new We(t)},je.scale=function(t){return new Ge(t)},je.attribution=function(t){return new $e(t)},(r=et.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}})).addTo=function(t,e){return t.addHandler(e,this),this},{Events:e}),Ke=C.touch?"touchstart mousedown":"mousedown",Xe=nt.extend({options:{clickTolerance:3},initialize:function(t,e,n,r){h(this,r),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(x(this._dragStartTarget,Ke,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Xe._dragging===this&&this.finishDrag(!0),N(this._dragStartTarget,Ke,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){var e,n;this._enabled&&(this._moved=!1,ye(this._element,"leaflet-zoom-anim")||(t.touches&&1!==t.touches.length?Xe._dragging===this&&this.finishDrag():Xe._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||((Xe._dragging=this)._preventOutline&&Te(this._element),Ee(),re(),this._moving)||(this.fire("down"),n=t.touches?t.touches[0]:t,e=Ie(this._element),this._startPoint=new f(n.clientX,n.clientY),this._startPos=Ce(this._element),this._parentScale=Le(e),n="mousedown"===t.type,x(document,n?"mousemove":"touchmove",this._onMove,this),x(document,n?"mouseup":"touchend touchcancel",this._onUp,this))))},_onMove:function(t){var e;this._enabled&&(t.touches&&1<t.touches.length?this._moved=!0:!(e=new f((e=t.touches&&1===t.touches.length?t.touches[0]:t).clientX,e.clientY)._subtract(this._startPoint)).x&&!e.y||Math.abs(e.x)+Math.abs(e.y)<this.options.clickTolerance||(e.x/=this._parentScale.x,e.y/=this._parentScale.y,R(t),this._moved||(this.fire("dragstart"),this._moved=!0,T(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),T(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(e),this._moving=!0,this._lastEvent=t,this._updatePosition()))},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),k(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){A(document.body,"leaflet-dragging"),this._lastTarget&&(A(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),N(document,"mousemove touchmove",this._onMove,this),N(document,"mouseup touchend touchcancel",this._onUp,this),Se(),ie();var e=this._moved&&this._moving;this._moving=!1,Xe._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Ze(t,e,n){for(var r,i,o,a,s,l,u,c=[1,4,2,8],h=0,d=t.length;h<d;h++)t[h]._code=on(t[h],e);for(o=0;o<4;o++){for(l=c[o],r=[],h=0,i=(d=t.length)-1;h<d;i=h++)a=t[h],s=t[i],a._code&l?s._code&l||((u=rn(s,a,l,e,n))._code=on(u,e),r.push(u)):(s._code&l&&((u=rn(s,a,l,e,n))._code=on(u,e),r.push(u)),r.push(a));t=r}return t}function Ye(t,e){var n,r,i,o,a,s,l;if(!t||0===t.length)throw new Error("latlngs not passed");M(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);for(var u=b([0,0]),c=y(t),h=(c.getNorthWest().distanceTo(c.getSouthWest())*c.getNorthEast().distanceTo(c.getNorthWest())<1700&&(u=Qe(t)),t.length),d=[],p=0;p<h;p++){var f=b(t[p]);d.push(e.project(b([f.lat-u.lat,f.lng-u.lng])))}for(p=a=s=l=0,n=h-1;p<h;n=p++)o=(r=d[p]).y*(i=d[n]).x-i.y*r.x,s+=(r.x+i.x)*o,l+=(r.y+i.y)*o,a+=3*o;c=0===a?d[0]:[s/a,l/a],c=e.unproject(g(c));return b([c.lat+u.lat,c.lng+u.lng])}function Qe(t){for(var e=0,n=0,r=0,i=0;i<t.length;i++){var o=b(t[i]);e+=o.lat,n+=o.lng,r++}return b([e/r,n/r])}var Je,yt={__proto__:null,clipPolygon:Ze,polygonCenter:Ye,centroid:Qe};function tn(t,e){if(e&&t.length){var n=t=((t,e)=>{for(var n=[t[0]],r=1,i=0,o=t.length;r<o;r++)((t,e)=>{var n=e.x-t.x;return n*n+(e=e.y-t.y)*e})(t[r],t[i])>e&&(n.push(t[r]),i=r);return i<o-1&&n.push(t[o-1]),n})(t,e=e*e),r=n.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(r);i[0]=i[r-1]=1,function t(e,n,r,i,o){var a,s,l,u=0;for(s=i+1;s<=o-1;s++)l=an(e[s],e[i],e[o],!0),u<l&&(a=s,u=l);r<u&&(n[a]=1,t(e,n,r,i,a),t(e,n,r,a,o))}(n,i,e,0,r-1);var o,a=[];for(o=0;o<r;o++)i[o]&&a.push(n[o]);return a}return t.slice()}function en(t,e,n){return Math.sqrt(an(t,e,n,!0))}function nn(t,e,n,r,i){var o,a,s,l=r?Je:on(t,n),u=on(e,n);for(Je=u;;){if(!(l|u))return[t,e];if(l&u)return!1;s=on(a=rn(t,e,o=l||u,n,i),n),o===l?(t=a,l=s):(e=a,u=s)}}function rn(t,e,n,r,i){var o,a,s=e.x-t.x,e=e.y-t.y,l=r.min,r=r.max;return 8&n?(o=t.x+s*(r.y-t.y)/e,a=r.y):4&n?(o=t.x+s*(l.y-t.y)/e,a=l.y):2&n?(o=r.x,a=t.y+e*(r.x-t.x)/s):1&n&&(o=l.x,a=t.y+e*(l.x-t.x)/s),new f(o,a,i)}function on(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function an(t,e,n,r){var i=e.x,e=e.y,o=n.x-i,a=n.y-e,s=o*o+a*a;return 0<s&&(1<(s=((t.x-i)*o+(t.y-e)*a)/s)?(i=n.x,e=n.y):0<s&&(i+=o*s,e+=a*s)),o=t.x-i,a=t.y-e,r?o*o+a*a:new f(i,e)}function M(t){return!d(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function sn(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),M(t)}function ln(t,e){var n,r,i,o,a,s;if(!t||0===t.length)throw new Error("latlngs not passed");M(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);for(var l=b([0,0]),u=y(t),c=(u.getNorthWest().distanceTo(u.getSouthWest())*u.getNorthEast().distanceTo(u.getNorthWest())<1700&&(l=Qe(t)),t.length),h=[],d=0;d<c;d++){var p=b(t[d]);h.push(e.project(b([p.lat-l.lat,p.lng-l.lng])))}for(n=d=0;d<c-1;d++)n+=h[d].distanceTo(h[d+1])/2;if(0===n)s=h[0];else for(r=d=0;d<c-1;d++)if(n<(r+=a=(i=h[d]).distanceTo(o=h[d+1]))){s=[o.x-(a=(r-n)/a)*(o.x-i.x),o.y-a*(o.y-i.y)];break}u=e.unproject(g(s));return b([u.lat+l.lat,u.lng+l.lng])}var vt={__proto__:null,simplify:tn,pointToSegmentDistance:en,closestPointOnSegment:function(t,e,n){return an(t,e,n)},clipSegment:nn,_getEdgeIntersection:rn,_getBitCode:on,_sqClosestPointOnSegment:an,isFlat:M,_flat:sn,polylineCenter:ln},_t={project:function(t){return new f(t.lng,t.lat)},unproject:function(t){return new v(t.y,t.x)},bounds:new m([-180,-90],[180,90])},un={R:6378137,R_MINOR:6356752.314245179,bounds:new m([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,r=t.lat*e,i=this.R_MINOR/n,i=Math.sqrt(1-i*i),o=i*Math.sin(r),o=Math.tan(Math.PI/4-r/2)/Math.pow((1-o)/(1+o),i/2),r=-n*Math.log(Math.max(o,1e-10));return new f(t.lng*e*n,r)},unproject:function(t){for(var e,n=180/Math.PI,r=this.R,i=this.R_MINOR/r,o=Math.sqrt(1-i*i),a=Math.exp(-t.y/r),s=Math.PI/2-2*Math.atan(a),l=0,u=.1;l<15&&1e-7<Math.abs(u);l++)e=o*Math.sin(s),e=Math.pow((1-e)/(1+e),o/2),s+=u=Math.PI/2-2*Math.atan(a*e)-s;return new v(s*n,t.x*n/r)}},wt={__proto__:null,LonLat:_t,Mercator:un,SphericalMercator:at},bt=u({},ot,{code:"EPSG:3395",projection:un,transformation:(()=>{var t=.5/(Math.PI*un.R);return lt(t,.5,-t,.5)})()}),cn=u({},ot,{code:"EPSG:4326",projection:_t,transformation:lt(1/180,1,-1/180,.5)}),Ct=u({},it,{projection:_t,transformation:lt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,e=e.lat-t.lat;return Math.sqrt(n*n+e*e)},infinite:!0}),i=(it.Earth=ot,it.EPSG3395=bt,it.EPSG3857=ut,it.EPSG900913=ct,it.EPSG4326=cn,it.Simple=Ct,nt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[l(t)]=this},removeInteractiveTarget:function(t){return delete this._map._targets[l(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e,n=t.target;n.hasLayer(this)&&(this._map=n,this._zoomAnimated=n._zoomAnimated,this.getEvents&&(e=this.getEvents(),n.on(e,this),this.once("remove",function(){n.off(e,this)},this)),this.onAdd(n),this.fire("add"),n.fire("layeradd",{layer:this}))}})),hn=(P.include({addLayer:function(t){var e;if(t._layerAdd)return e=l(t),this._layers[e]||((this._layers[e]=t)._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this;throw new Error("The provided object is not a Layer.")},removeLayer:function(t){var e=l(t);return this._layers[e]&&(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null),this},hasLayer:function(t){return l(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?d(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[l(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){t=l(t);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var t,e=1/0,n=-1/0,r=this._getZoomSpan();for(t in this._zoomBoundLayers)var i=this._zoomBoundLayers[t].options,e=void 0===i.minZoom?e:Math.min(e,i.minZoom),n=void 0===i.maxZoom?n:Math.max(n,i.maxZoom);this._layersMaxZoom=n===-1/0?void 0:n,this._layersMinZoom=e===1/0?void 0:e,r!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}}),i.extend({initialize:function(t,e){var n,r;if(h(this,e),this._layers={},t)for(n=0,r=t.length;n<r;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){t=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,r=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,r);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:l})),dn=hn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),hn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?((t=t in this._layers?this._layers[t]:t).removeEventParent(this),hn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t,e=new o;for(t in this._layers){var n=this._layers[t];e.extend(n.getBounds?n.getBounds():n.getLatLng())}return e}}),pn=et.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){h(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(n)return n=this._createImg(n,e&&"IMG"===e.tagName?e:null),this._setIconStyles(n,t),!this.options.crossOrigin&&""!==this.options.crossOrigin||(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n;if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null},_setIconStyles:function(t,e){var n=this.options,r=n[e+"Size"],r=g(r="number"==typeof r?[r,r]:r),i=g("shadow"===e&&n.shadowAnchor||n.iconAnchor||r&&r.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return C.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),fn=pn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof fn.imagePath&&(fn.imagePath=this._detectIconPath()),(this.options.imagePath||fn.imagePath)+pn.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){function e(t,e,n){return(e=e.exec(t))&&e[n]}return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=E("div","leaflet-default-icon-path",document.body),e=pe(t,"background-image")||pe(t,"backgroundImage");return document.body.removeChild(t),(e=this._stripUrl(e))||((t=document.querySelector('link[href$="leaflet.css"]'))?t.href.substring(0,t.href.length-"leaflet.css".length-1):"")}}),gn=r.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Xe(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),T(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&A(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,r=this._marker.options.autoPanSpeed,i=this._marker.options.autoPanPadding,o=Ce(e._icon),a=n.getPixelBounds(),s=n.getPixelOrigin(),s=p(a.min._subtract(s).add(i),a.max._subtract(s).subtract(i));s.contains(o)||(i=g((Math.max(s.max.x,o.x)-s.max.x)/(a.max.x-s.max.x)-(Math.min(s.min.x,o.x)-s.min.x)/(a.min.x-s.min.x),(Math.max(s.max.y,o.y)-s.max.y)/(a.max.y-s.max.y)-(Math.min(s.min.y,o.y)-s.min.y)/(a.min.y-s.min.y)).multiplyBy(r),n.panBy(i,{animate:!1}),this._draggable._newPos._add(i),this._draggable._startPos._add(i),k(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=w(this._adjustPan.bind(this,t)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(a(this._panRequest),this._panRequest=w(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,r=Ce(e._icon),i=e._map.layerPointToLatLng(r);n&&k(n,r),e._latlng=i,t.latlng=i,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){a(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),mn=i.extend({options:{icon:new fn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){h(this,e),this._latlng=b(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=b(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){var t;return this._icon&&this._map&&(t=this._map.latLngToLayerPoint(this._latlng).round(),this._setPos(t)),this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),r=!1,n=(n!==this._icon&&(this._icon&&this._removeIcon(),r=!0,t.title&&(n.title=t.title),"IMG"===n.tagName)&&(n.alt=t.alt||""),T(n,e),t.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&x(n,"focus",this._panOnFocus,this),t.icon.createShadow(this._shadow)),i=!1;n!==this._shadow&&(this._removeShadow(),i=!0),n&&(T(n,e),n.alt=""),this._shadow=n,t.opacity<1&&this._updateOpacity(),r&&this.getPane().appendChild(this._icon),this._initInteraction(),n&&i&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&N(this._icon,"focus",this._panOnFocus,this),S(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&S(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&k(this._icon,t),this._shadow&&k(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){t=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(t)},_initInteraction:function(){var t;this.options.interactive&&(T(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),gn)&&(t=this.options.draggable,this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new gn(this),t)&&this.dragging.enable()},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&I(this._icon,t),this._shadow&&I(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t,e,n=this._map;n&&(t=(e=this.options.icon.options).iconSize?g(e.iconSize):g(0,0),e=e.iconAnchor?g(e.iconAnchor):g(0,0),n.panInside(this._latlng,{paddingTopLeft:e,paddingBottomRight:t.subtract(e)}))},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),yn=i.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return h(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke)&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds(),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),vn=yn.extend({options:{fill:!0,radius:10},initialize:function(t,e){h(this,e),this._latlng=b(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=b(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return yn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),t=[t+n,e+n];this._pxBounds=new m(this._point.subtract(t),this._point.add(t))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),_n=vn.extend({initialize:function(t,e,n){if(h(this,e="number"==typeof e?u({},n,{radius:e}):e),this._latlng=b(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new o(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:yn.prototype.setStyle,_project:function(){var t,e,n,r,i,o=this._latlng.lng,a=this._latlng.lat,s=this._map,l=s.options.crs;l.distance===ot.distance?(r=Math.PI/180,i=this._mRadius/ot.R/r,t=s.project([a+i,o]),e=s.project([a-i,o]),e=t.add(e).divideBy(2),n=s.unproject(e).lat,r=Math.acos((Math.cos(i*r)-Math.sin(a*r)*Math.sin(n*r))/(Math.cos(a*r)*Math.cos(n*r)))/r,!isNaN(r)&&0!==r||(r=i/Math.cos(Math.PI/180*a)),this._point=e.subtract(s.getPixelOrigin()),this._radius=isNaN(r)?0:e.x-s.project([n,o-r]).x,this._radiusY=e.y-t.y):(i=l.unproject(l.project(this._latlng).subtract([this._mRadius,0])),this._point=s.latLngToLayerPoint(this._latlng),this._radius=this._point.x-s.latLngToLayerPoint(i).x),this._updateBounds()}}),wn=yn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){h(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e=1/0,n=null,r=an,i=0,o=this._parts.length;i<o;i++)for(var a=this._parts[i],s=1,l=a.length;s<l;s++){var u,c,h=r(t,u=a[s-1],c=a[s],!0);h<e&&(e=h,n=r(t,u,c))}return n&&(n.distance=Math.sqrt(e)),n},getCenter:function(){if(this._map)return ln(this._defaultShape(),this._map.options.crs);throw new Error("Must add layer to map before using getCenter()")},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=b(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new o,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return M(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=M(t),r=0,i=t.length;r<i;r++)n?(e[r]=b(t[r]),this._bounds.extend(e[r])):e[r]=this._convertLatLngs(t[r]);return e},_project:function(){var t=new m;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),t=new f(t,t);this._rawPxBounds&&(this._pxBounds=new m([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)]))},_projectLatlngs:function(t,e,n){var r,i,o=t[0]instanceof v,a=t.length;if(o){for(i=[],r=0;r<a;r++)i[r]=this._map.latLngToLayerPoint(t[r]),n.extend(i[r]);e.push(i)}else for(r=0;r<a;r++)this._projectLatlngs(t[r],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var e,n,r,i,o=this._parts,a=0,s=0,l=this._rings.length;a<l;a++)for(e=0,n=(i=this._rings[a]).length;e<n-1;e++)(r=nn(i[e],i[e+1],t,e,!0))&&(o[s]=o[s]||[],o[s].push(r[0]),r[1]===i[e+1]&&e!==n-2||(o[s].push(r[1]),s++))},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,r=t.length;n<r;n++)t[n]=tn(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,r,i,o,a,s,l=this._clickTolerance();if(this._pxBounds&&this._pxBounds.contains(t))for(n=0,o=this._parts.length;n<o;n++)for(r=0,i=(a=(s=this._parts[n]).length)-1;r<a;i=r++)if((e||0!==r)&&en(t,s[i],s[r])<=l)return!0;return!1}}),bn=(wn._flat=sn,wn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(this._map)return Ye(this._defaultShape(),this._map.options.crs);throw new Error("Must add layer to map before using getCenter()")},_convertLatLngs:function(t){var t=wn.prototype._convertLatLngs.call(this,t),e=t.length;return 2<=e&&t[0]instanceof v&&t[0].equals(t[e-1])&&t.pop(),t},_setLatLngs:function(t){wn.prototype._setLatLngs.call(this,t),M(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return(M(this._latlngs[0])?this._latlngs:this._latlngs[0])[0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,e=new f(e,e),t=new m(t.min.subtract(e),t.max.add(e));if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,r=0,i=this._rings.length;r<i;r++)(n=Ze(this._rings[r],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,r,i,o,a,s,l,u=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,s=this._parts.length;i<s;i++)for(o=0,a=(l=(e=this._parts[i]).length)-1;o<l;a=o++)n=e[o],r=e[a],n.y>t.y!=r.y>t.y&&t.x<(r.x-n.x)*(t.y-n.y)/(r.y-n.y)+n.x&&(u=!u);return u||wn.prototype._containsPoint.call(this,t,!0)}})),Cn=dn.extend({initialize:function(t,e){h(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,r,i=d(t)?t:t.features;if(i){for(e=0,n=i.length;e<n;e++)((r=i[e]).geometries||r.geometry||r.features||r.coordinates)&&this.addData(r);return this}var o,a=this.options;return(!a.filter||a.filter(t))&&(o=En(t,a))?(o.feature=xn(t),o.defaultOptions=o.options,this.resetStyle(o),a.onEachFeature&&a.onEachFeature(t,o),this.addLayer(o)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=u({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function En(t,e){var n,r,i,o,a="Feature"===t.type?t.geometry:t,s=a?a.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||Tn;if(!s&&!a)return null;switch(a.type){case"Point":return Sn(u,t,n=c(s),e);case"MultiPoint":for(i=0,o=s.length;i<o;i++)n=c(s[i]),l.push(Sn(u,t,n,e));return new dn(l);case"LineString":case"MultiLineString":return r=An(s,"LineString"===a.type?0:1,c),new wn(r,e);case"Polygon":case"MultiPolygon":return r=An(s,"Polygon"===a.type?1:2,c),new bn(r,e);case"GeometryCollection":for(i=0,o=a.geometries.length;i<o;i++){var h=En({geometry:a.geometries[i],type:"Feature",properties:t.properties},e);h&&l.push(h)}return new dn(l);case"FeatureCollection":for(i=0,o=a.features.length;i<o;i++){var d=En(a.features[i],e);d&&l.push(d)}return new dn(l);default:throw new Error("Invalid GeoJSON object.")}}function Sn(t,e,n,r){return t?t(e,n):new mn(n,r&&r.markersInheritOptions&&r)}function Tn(t){return new v(t[1],t[0],t[2])}function An(t,e,n){for(var r,i=[],o=0,a=t.length;o<a;o++)r=e?An(t[o],e-1,n):(n||Tn)(t[o]),i.push(r);return i}function In(t,e){return void 0!==(t=b(t)).alt?[n(t.lng,e),n(t.lat,e),n(t.alt,e)]:[n(t.lng,e),n(t.lat,e)]}function Ln(t,e,n,r){for(var i=[],o=0,a=t.length;o<a;o++)i.push(e?Ln(t[o],M(t[o])?0:e-1,n,r):In(t[o],r));return!e&&n&&0<i.length&&i.push(i[0].slice()),i}function kn(t,e){return t.feature?u({},t.feature,{geometry:e}):xn(e)}function xn(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}function Dn(t,e){return new Cn(t,e)}Et={toGeoJSON:function(t){return kn(this,{type:"Point",coordinates:In(this.getLatLng(),t)})}},mn.include(Et),_n.include(Et),vn.include(Et),wn.include({toGeoJSON:function(t){var e=!M(this._latlngs);return kn(this,{type:(e?"Multi":"")+"LineString",coordinates:Ln(this._latlngs,e?1:0,!1,t)})}}),bn.include({toGeoJSON:function(t){var e=!M(this._latlngs),n=e&&!M(this._latlngs[0]),t=Ln(this._latlngs,n?2:e?1:0,!0,t);return kn(this,{type:(n?"Multi":"")+"Polygon",coordinates:t=e?t:[t]})}}),hn.include({toMultiPoint:function(e){var n=[];return this.eachLayer(function(t){n.push(t.toGeoJSON(e).geometry.coordinates)}),kn(this,{type:"MultiPoint",coordinates:n})},toGeoJSON:function(e){var n,r,t=this.feature&&this.feature.geometry&&this.feature.geometry.type;return"MultiPoint"===t?this.toMultiPoint(e):(n="GeometryCollection"===t,r=[],this.eachLayer(function(t){t.toGeoJSON&&(t=t.toGeoJSON(e),n?r.push(t.geometry):"FeatureCollection"===(t=xn(t)).type?r.push.apply(r,t.features):r.push(t))}),n?kn(this,{geometries:r,type:"GeometryCollection"}):{type:"FeatureCollection",features:r})}});var St=Dn,Nn=i.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=y(e),h(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(T(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){S(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ge(this._image),this},bringToBack:function(){return this._map&&me(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=y(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:E("img");T(e,"leaflet-image-layer"),this._zoomAnimated&&T(e,"leaflet-zoom-animated"),this.options.className&&T(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onload=s(this.fire,this,"load"),e.onerror=s(this._overlayOnError,this,"error"),!this.options.crossOrigin&&""!==this.options.crossOrigin||(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),t=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;be(this._image,t,e)},_reset:function(){var t=this._image,e=new m(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();k(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){I(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Rn=Nn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:E("video");if(T(e,"leaflet-image-layer"),this._zoomAnimated&&T(e,"leaflet-zoom-animated"),this.options.className&&T(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onloadeddata=s(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),r=[],i=0;i<n.length;i++)r.push(n[i].src);this._url=0<n.length?r:[e.src]}else{d(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var o=0;o<this._url.length;o++){var a=E("source");a.src=this._url[o],e.appendChild(a)}}}}),Pn=Nn.extend({_initImage:function(){var t=this._image=this._url;T(t,"leaflet-image-layer"),this._zoomAnimated&&T(t,"leaflet-zoom-animated"),this.options.className&&T(t,this.options.className),t.onselectstart=c,t.onmousemove=c}}),On=i.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof v||d(t))?(this._latlng=b(t),h(this,e)):(h(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&I(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&I(this._container,1),this.bringToFront(),this.options.interactive&&(T(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(I(this._container,0),this._removeTimeout=setTimeout(s(S,void 0,this._container),200)):S(this._container),this.options.interactive&&(A(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=b(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ge(this._container),this},bringToBack:function(){return this._map&&me(this._container),this},_prepareOpen:function(t){if(!(n=this._source)._map)return!1;if(n instanceof dn){var e,n=null,r=this._source._layers;for(e in r)if(r[e]._map){n=r[e];break}if(!n)return!1;this._source=n}if(!t)if(n.getCenter)t=n.getCenter();else if(n.getLatLng)t=n.getLatLng();else{if(!n.getBounds)throw new Error("Unable to get source layer LatLng.");t=n.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){var t,e,n;this._map&&(e=this._map.latLngToLayerPoint(this._latlng),t=g(this.options.offset),n=this._getAnchor(),this._zoomAnimated?k(this._container,e.add(n)):t=t.add(e).add(n),e=this._containerBottom=-t.y,n=this._containerLeft=-Math.round(this._containerWidth/2)+t.x,this._container.style.bottom=e+"px",this._container.style.left=n+"px")},_getAnchor:function(){return[0,0]}}),Mn=(P.include({_initOverlay:function(t,e,n,r){var i=e;return i instanceof t||(i=new t(r).setContent(e)),n&&i.setLatLng(n),i}}),i.include({_initOverlay:function(t,e,n,r){var i=n;return i instanceof t?(h(i,r),i._source=this):(i=e&&!r?e:new t(r,this)).setContent(n),i}}),On.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,On.prototype.openOn.call(this,t)},onAdd:function(t){On.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof yn||this._source.on("preclick",Re))},onRemove:function(t){On.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof yn||this._source.off("preclick",Re))},getEvents:function(){var t=On.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=E("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=E("div",t+"-content-wrapper",e);this._contentNode=E("div",t+"-content",n),Oe(e),Pe(this._contentNode),x(e,"contextmenu",Re),this._tipContainer=E("div",t+"-tip-container",e),this._tip=E("div",t+"-tip",this._tipContainer),this.options.closeButton&&((n=this._closeButton=E("a",t+"-close-button",e)).setAttribute("role","button"),n.setAttribute("aria-label","Close popup"),n.href="#close",n.innerHTML='<span aria-hidden="true">&#215;</span>',x(n,"click",function(t){R(t),this.close()},this))},_updateLayout:function(){var t=this._contentNode,e=t.style,n=(e.width="",e.whiteSpace="nowrap",t.offsetWidth),n=Math.min(n,this.options.maxWidth),n=(n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="",t.offsetHeight),r=this.options.maxHeight,i="leaflet-popup-scrolled";(r&&r<n?(e.height=r+"px",T):A)(t,i),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var t=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),e=this._getAnchor();k(this._container,t.add(e))},_adjustPan:function(){var t,e,n,r,i,o,a,s;this.options.autoPan&&(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning?this._autopanning=!1:(t=this._map,e=parseInt(pe(this._container,"marginBottom"),10)||0,e=this._container.offsetHeight+e,s=this._containerWidth,(n=new f(this._containerLeft,-e-this._containerBottom))._add(Ce(this._container)),n=t.layerPointToContainerPoint(n),i=g(this.options.autoPanPadding),r=g(this.options.autoPanPaddingTopLeft||i),i=g(this.options.autoPanPaddingBottomRight||i),o=t.getSize(),a=0,n.x+s+i.x>o.x&&(a=n.x+s-o.x+i.x),n.x-a-r.x<(s=0)&&(a=n.x-r.x),n.y+e+i.y>o.y&&(s=n.y+e-o.y+i.y),n.y-s-r.y<0&&(s=n.y-r.y),(a||s)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([a,s]))))},_getAnchor:function(){return g(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}})),Bn=(P.mergeOptions({closePopupOnClick:!0}),P.include({openPopup:function(t,e,n){return this._initOverlay(Mn,t,e,n).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),i.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Mn,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof dn||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng))&&this._popup.openOn(this._map),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e;this._popup&&this._map&&(Me(t),e=t.layer||t.target,this._popup._source!==e||e instanceof yn?(this._popup._source=e,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}}),On.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){On.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){On.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=On.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=E("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,n=this._map,r=this._container,i=n.latLngToContainerPoint(n.getCenter()),n=n.layerPointToContainerPoint(t),o=this.options.direction,a=r.offsetWidth,s=r.offsetHeight,l=g(this.options.offset),u=this._getAnchor(),n="top"===o?(e=a/2,s):"bottom"===o?(e=a/2,0):(e="center"===o?a/2:"right"===o?0:"left"===o?a:n.x<i.x?(o="right",0):(o="left",a+2*(l.x+u.x)),s/2);t=t.subtract(g(e,n,!0)).add(l).add(u),A(r,"leaflet-tooltip-right"),A(r,"leaflet-tooltip-left"),A(r,"leaflet-tooltip-top"),A(r,"leaflet-tooltip-bottom"),T(r,"leaflet-tooltip-"+o),k(r,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&I(this._container,t)},_animateZoom:function(t){t=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(t)},_getAnchor:function(){return g(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}})),Un=(P.include({openTooltip:function(t,e,n){return this._initOverlay(Bn,t,e,n).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),i.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Bn,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){var e,n;!t&&this._tooltipHandlersAdded||(e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip},this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[e](n),this._tooltipHandlersAdded=!t)},openTooltip:function(t){return this._tooltip&&(this instanceof dn||(this._tooltip._source=this),this._tooltip._prepareOpen(t))&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this)),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&(x(e,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),x(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){t="function"==typeof t.getElement&&t.getElement();t&&t.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){var e;this._tooltip&&this._map&&(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag?(this._openOnceFlag=!0,(e=this)._map.once("moveend",function(){e._openOnceFlag=!1,e._openTooltip(t)})):(this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)))},_moveTooltip:function(t){var e=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(t=this._map.mouseEventToContainerPoint(t.originalEvent),t=this._map.containerPointToLayerPoint(t),e=this._map.layerPointToLatLng(t)),this._tooltip.setLatLng(e)}}),pn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var t=t&&"DIV"===t.tagName?t:document.createElement("div"),e=this.options;return e.html instanceof Element?(fe(t),t.appendChild(e.html)):t.innerHTML=!1!==e.html?e.html:"",e.bgPos&&(e=g(e.bgPos),t.style.backgroundPosition=-e.x+"px "+-e.y+"px"),this._setIconStyles(t,"icon"),t},createShadow:function(){return null}})),Fn=(pn.Default=fn,i.extend({options:{tileSize:256,opacity:1,updateWhenIdle:C.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){h(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),S(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ge(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(me(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){var t;return this._map&&(this._removeAllTiles(),(t=this._clampZoom(this._map.getZoom()))!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=V(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof f?t:new f(t,t)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,r=-t(-1/0,1/0),i=0,o=n.length;i<o;i++)e=n[i].style.zIndex,n[i]!==this._container&&e&&(r=t(r,+e));isFinite(r)&&(this.options.zIndex=r+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!C.ielt9){I(this._container,this.options.opacity);var t,e=+new Date,n=!1,r=!1;for(t in this._tiles){var i,o=this._tiles[t];o.current&&o.loaded&&(i=Math.min(1,(e-o.loaded)/200),I(o.el,i),i<1?n=!0:(o.active?r=!0:this._onOpaqueTile(o),o.active=!0))}r&&!this._noPrune&&this._pruneTiles(),n&&(a(this._fadeFrame),this._fadeFrame=w(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=E("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(S(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var r=this._levels[t],i=this._map;return r||((r=this._levels[t]={}).el=E("div","leaflet-tile-container leaflet-zoom-animated",this._container),r.el.style.zIndex=e,r.origin=i.project(i.unproject(i.getPixelOrigin()),t).round(),r.zoom=t,this._setZoomTransform(r,i.getCenter(),i.getZoom()),c(r.el.offsetWidth),this._onCreateLevel(r)),this._level=r}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var t,e,n,r=this._map.getZoom();if(r>this.options.maxZoom||r<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(n=this._tiles[t]).retain=n.current;for(t in this._tiles)(n=this._tiles[t]).current&&!n.active&&(e=n.coords,this._retainParent(e.x,e.y,e.z,e.z-5)||this._retainChildren(e.x,e.y,e.z,e.z+2));for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)S(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,r){var t=Math.floor(t/2),e=Math.floor(e/2),n=n-1,i=new f(+t,+e),i=(i.z=n,this._tileCoordsToKey(i)),i=this._tiles[i];return i&&i.active?i.retain=!0:(i&&i.loaded&&(i.retain=!0),r<n&&this._retainParent(t,e,n,r))},_retainChildren:function(t,e,n,r){for(var i=2*t;i<2*t+2;i++)for(var o=2*e;o<2*e+2;o++){var a=new f(i,o),a=(a.z=n+1,this._tileCoordsToKey(a)),a=this._tiles[a];a&&a.active?a.retain=!0:(a&&a.loaded&&(a.retain=!0),n+1<r&&this._retainChildren(i,o,n+1,r))}},_resetView:function(t){t=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,r){var i=Math.round(e),i=void 0!==this.options.maxZoom&&i>this.options.maxZoom||void 0!==this.options.minZoom&&i<this.options.minZoom?void 0:this._clampZoom(i),o=this.options.updateWhenZooming&&i!==this._tileZoom;r&&!o||(this._tileZoom=i,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==i&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var r=this._map.getZoomScale(n,t.zoom),e=t.origin.multiplyBy(r).subtract(this._map._getNewPixelOrigin(e,n)).round();C.any3d?be(t.el,e,r):k(t.el,e)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),r=this._tileZoom,i=this._map.getPixelWorldBounds(this._tileZoom);i&&(this._globalTileRange=this._pxBoundsToTileRange(i)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],r).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],r).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],r).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],r).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(n,this._tileZoom),t=e.project(t,this._tileZoom).floor(),e=e.getSize().divideBy(2*n);return new m(t.subtract(e),t.add(e))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var r,e=this._getTiledPixelBounds(t),i=this._pxBoundsToTileRange(e),o=i.getCenter(),a=[],e=this.options.keepBuffer,s=new m(i.getBottomLeft().subtract([e,-e]),i.getTopRight().add([e,-e]));if(!(isFinite(i.min.x)&&isFinite(i.min.y)&&isFinite(i.max.x)&&isFinite(i.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(r in this._tiles){var l=this._tiles[r].coords;l.z===this._tileZoom&&s.contains(new f(l.x,l.y))||(this._tiles[r].current=!1)}if(1<Math.abs(n-this._tileZoom))this._setView(t,n);else{for(var u=i.min.y;u<=i.max.y;u++)for(var c=i.min.x;c<=i.max.x;c++){var h,d=new f(c,u);d.z=this._tileZoom,this._isValidTile(d)&&((h=this._tiles[this._tileCoordsToKey(d)])?h.current=!0:a.push(d))}if(a.sort(function(t,e){return t.distanceTo(o)-e.distanceTo(o)}),0!==a.length){this._loading||(this._loading=!0,this.fire("loading"));for(var p=document.createDocumentFragment(),c=0;c<a.length;c++)this._addTile(a[c],p);this._level.el.appendChild(p)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}return!this.options.bounds||(e=this._tileCoordsToBounds(t),y(this.options.bounds).overlaps(e))},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),r=t.scaleBy(n),n=r.add(n);return[e.unproject(r,t.z),e.unproject(n,t.z)]},_tileCoordsToBounds:function(t){t=this._tileCoordsToNwSe(t),t=new o(t[0],t[1]);return t=this.options.noWrap?t:this._map.wrapLatLngBounds(t)},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var t=t.split(":"),e=new f(+t[0],+t[1]);return e.z=+t[2],e},_removeTile:function(t){var e=this._tiles[t];e&&(S(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){T(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=c,t.onmousemove=c,C.ielt9&&this.options.opacity<1&&I(t,this.options.opacity)},_addTile:function(t,e){var n=this._getTilePos(t),r=this._tileCoordsToKey(t),i=this.createTile(this._wrapCoords(t),s(this._tileReady,this,t));this._initTile(i),this.createTile.length<2&&w(s(this._tileReady,this,t,null,i)),k(i,n),this._tiles[r]={el:i,coords:t,current:!0},e.appendChild(i),this.fire("tileloadstart",{tile:i,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var r=this._tileCoordsToKey(t);(n=this._tiles[r])&&(n.loaded=+new Date,this._map._fadeAnimated?(I(n.el,0),a(this._fadeFrame),this._fadeFrame=w(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(T(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad())&&(this._loading=!1,this.fire("load"),C.ielt9||!this._map._fadeAnimated?w(this._pruneTiles,this):setTimeout(s(this._pruneTiles,this),250))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new f(this._wrapX?H(t.x,this._wrapX):t.x,this._wrapY?H(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new m(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}})),Vn=Fn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=h(this,e)).detectRetina&&C.retina&&0<e.maxZoom?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return x(n,"load",s(this._tileOnLoad,this,e,n)),x(n,"error",s(this._tileOnError,this,e,n)),!this.options.crossOrigin&&""!==this.options.crossOrigin||(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:C.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};return this._map&&!this._map.options.crs.infinite&&(t=this._globalTileRange.max.y-t.y,this.options.tms&&(e.y=t),e["-y"]=t),G(this._url,u(e,this.options))},_tileOnLoad:function(t,e){C.ielt9?setTimeout(s(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var r=this.options.errorTileUrl;r&&e.getAttribute("src")!==r&&(e.src=r),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return(t=this.options.zoomReverse?e-t:t)+this.options.zoomOffset},_getSubdomain:function(t){t=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var t,e,n;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((n=this._tiles[t].el).onload=c,n.onerror=c,n.complete||(n.src=K,e=this._tiles[t].coords,S(n),delete this._tiles[t],this.fire("tileabort",{tile:n,coords:e})))},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",K),Fn.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(this._map&&(!n||n.getAttribute("src")!==K))return Fn.prototype._tileReady.call(this,t,e,n)}});function Hn(t,e){return new Vn(t,e)}var zn=Vn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var n,r=u({},this.defaultWmsParams);for(n in e)n in this.options||(r[n]=e[n]);var t=(e=h(this,e)).detectRetina&&C.retina?2:1,i=this.getTileSize();r.width=i.x*t,r.height=i.y*t,this.wmsParams=r},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[e]=this._crs.code,Vn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,n=p(n.project(e[0]),n.project(e[1])),e=n.min,n=n.max,e=(1.3<=this._wmsVersion&&this._crs===cn?[e.y,e.x,n.y,n.x]:[e.x,e.y,n.x,n.y]).join(","),n=Vn.prototype.getTileUrl.call(this,t);return n+q(this.wmsParams,n,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+e},setParams:function(t,e){return u(this.wmsParams,t),e||this.redraw(),this}}),jn=(Vn.WMS=zn,Hn.wms=function(t,e){return new zn(t,e)},i.extend({options:{padding:.1},initialize:function(t){h(this,t),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),T(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),i=this._map.project(this._center,e),r=r.multiplyBy(-n).add(i).subtract(this._map._getNewPixelOrigin(t,e));C.any3d?be(this._container,r,n):k(this._container,r)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new m(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}})),qn=jn.extend({options:{tolerance:0},getEvents:function(){var t=jn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){jn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");x(t,"mousemove",this._onMouseMove,this),x(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),x(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){a(this._redrawRequest),delete this._ctx,S(this._container),N(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){var t,e,n,r;this._map._animatingZoom&&this._bounds||(jn.prototype._update.call(this),t=this._bounds,e=this._container,n=t.getSize(),r=C.retina?2:1,k(e,t.min),e.width=r*n.x,e.height=r*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",C.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update"))},_reset:function(){jn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t);t=(this._layers[l(t)]=t)._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,e=e.prev;n?n.prev=e:this._drawLast=e,e?e.next=n:this._drawFirst=n,delete t._order,delete this._layers[l(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){for(var e,n=t.options.dashArray.split(/[, ]+/),r=[],i=0;i<n.length;i++){if(e=Number(n[i]),isNaN(e))return;r.push(e)}t.options._dashArray=r}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||w(this._redraw,this))},_extendRedrawBounds:function(t){var e;t._pxBounds&&(e=(t.options.weight||0)+1,this._redrawBounds=this._redrawBounds||new m,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e])))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t,e=this._redrawBounds;e?(t=e.getSize(),this._ctx.clearRect(e.min.x,e.min.y,t.x,t.y)):(this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore())},_draw:function(){var t,e,n=this._redrawBounds;this._ctx.save(),n&&(e=n.getSize(),this._ctx.beginPath(),this._ctx.rect(n.min.x,n.min.y,e.x,e.y),this._ctx.clip()),this._drawing=!0;for(var r=this._drawFirst;r;r=r.next)t=r.layer,(!n||t._pxBounds&&t._pxBounds.intersects(n))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,r,i,o,a=t._parts,s=a.length,l=this._ctx;if(s){for(l.beginPath(),n=0;n<s;n++){for(r=0,i=a[n].length;r<i;r++)o=a[n][r],l[r?"lineTo":"moveTo"](o.x,o.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){var e,n,r,i;this._drawing&&!t._empty()&&(e=t._point,n=this._ctx,r=Math.max(Math.round(t._radius),1),1!=(i=(Math.max(Math.round(t._radiusY),1)||r)/r)&&(n.save(),n.scale(1,i)),n.beginPath(),n.arc(e.x,e.y/i,r,0,2*Math.PI,!1),1!=i&&n.restore(),this._fillStroke(n,t))},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,r=this._map.mouseEventToLayerPoint(t),i=this._drawFirst;i;i=i.next)(e=i.layer).options.interactive&&e._containsPoint(r)&&(("click"===t.type||"preclick"===t.type)&&this._map._draggableMoved(e)||(n=e));this._fireEvent(!!n&&[n],t)},_onMouseMove:function(t){var e;!this._map||this._map.dragging.moving()||this._map._animatingZoom||(e=this._map.mouseEventToLayerPoint(t),this._handleMouseHover(t,e))},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(A(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,r,i=this._drawFirst;i;i=i.next)(n=i.layer).options.interactive&&n._containsPoint(e)&&(r=n);r!==this._hoveredLayer&&(this._handleMouseOut(t),r)&&(T(this._container,"leaflet-interactive"),this._fireEvent([r],t,"mouseover"),this._hoveredLayer=r),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(s(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e,n,r=t._order;r&&(e=r.next,n=r.prev,e)&&((e.prev=n)?n.next=e:e&&(this._drawFirst=e),r.prev=this._drawLast,(this._drawLast.next=r).next=null,this._drawLast=r,this._requestRedraw(t))},_bringToBack:function(t){var e,n,r=t._order;r&&(e=r.next,n=r.prev)&&((n.next=e)?e.prev=n:n&&(this._drawLast=n),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(t))}});function Wn(t){return C.canvas?new qn(t):null}var Gn=(()=>{try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Tt={_initContainer:function(){this._container=E("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(jn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=Gn("shape");T(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=Gn("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[l(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;S(e),t.removeInteractiveTarget(e),delete this._layers[l(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,r=t.options,i=t._container;i.stroked=!!r.stroke,i.filled=!!r.fill,r.stroke?(e=e||(t._stroke=Gn("stroke")),i.appendChild(e),e.weight=r.weight+"px",e.color=r.color,e.opacity=r.opacity,r.dashArray?e.dashStyle=d(r.dashArray)?r.dashArray.join(" "):r.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=r.lineCap.replace("butt","flat"),e.joinstyle=r.lineJoin):e&&(i.removeChild(e),t._stroke=null),r.fill?(n=n||(t._fill=Gn("fill")),i.appendChild(n),n.color=r.fillColor||r.color,n.opacity=r.fillOpacity):n&&(i.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),r=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+r+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ge(t._container)},_bringToBack:function(t){me(t._container)}},$n=C.vml?Gn:ht,Kn=jn.extend({_initContainer:function(){this._container=$n("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=$n("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){S(this._container),N(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){var t,e,n;this._map._animatingZoom&&this._bounds||(jn.prototype._update.call(this),e=(t=this._bounds).getSize(),n=this._container,this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),k(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update"))},_initPath:function(t){var e=t._path=$n("path");t.options.className&&T(e,t.options.className),t.options.interactive&&T(e,"leaflet-interactive"),this._updateStyle(t),this._layers[l(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){S(t._path),t.removeInteractiveTarget(t._path),delete this._layers[l(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,t=t.options;e&&(t.stroke?(e.setAttribute("stroke",t.color),e.setAttribute("stroke-opacity",t.opacity),e.setAttribute("stroke-width",t.weight),e.setAttribute("stroke-linecap",t.lineCap),e.setAttribute("stroke-linejoin",t.lineJoin),t.dashArray?e.setAttribute("stroke-dasharray",t.dashArray):e.removeAttribute("stroke-dasharray"),t.dashOffset?e.setAttribute("stroke-dashoffset",t.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),t.fill?(e.setAttribute("fill",t.fillColor||t.color),e.setAttribute("fill-opacity",t.fillOpacity),e.setAttribute("fill-rule",t.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,dt(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),r="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",e=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+r+2*n+",0 "+r+2*-n+",0 ";this._setPath(t,e)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ge(t._path)},_bringToBack:function(t){me(t._path)}});function Xn(t){return C.svg||C.vml?new Kn(t):null}C.vml&&Kn.include(Tt),P.include({getRenderer:function(t){t=(t=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer)||(this._renderer=this._createRenderer());return this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(t){var e;return"overlayPane"!==t&&void 0!==t&&(void 0===(e=this._paneRenderers[t])&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e)},_createRenderer:function(t){return this.options.preferCanvas&&Wn(t)||Xn(t)}});var Zn=bn.extend({initialize:function(t,e){bn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=y(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),At=(Kn.create=$n,Kn.pointsToPath=dt,Cn.geometryToLayer=En,Cn.coordsToLatLng=Tn,Cn.coordsToLatLngs=An,Cn.latLngToCoords=In,Cn.latLngsToCoords=Ln,Cn.getFeature=kn,Cn.asFeature=xn,P.mergeOptions({boxZoom:!0}),r.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){x(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){N(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){S(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),re(),Ee(),this._startPoint=this._map.mouseEventToContainerPoint(t),x(document,{contextmenu:Me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=E("div","leaflet-zoom-box",this._container),T(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var t=new m(this._point,this._startPoint),e=t.getSize();k(this._box,t.min),this._box.style.width=e.x+"px",this._box.style.height=e.y+"px"},_finish:function(){this._moved&&(S(this._box),A(this._container,"leaflet-crosshair")),ie(),Se(),N(document,{contextmenu:Me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){1!==t.which&&1!==t.button||(this._finish(),this._moved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(s(this._resetState,this),0),t=new o(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})))},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}})),It=(P.addInitHook("addHandler","boxZoom",At),P.mergeOptions({doubleClickZoom:!0}),r.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),r=e.options.zoomDelta,n=t.originalEvent.shiftKey?n-r:n+r;"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}})),pt=(P.addInitHook("addHandler","doubleClickZoom",It),P.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),r.extend({addHooks:function(){var t;this._draggable||(t=this._map,this._draggable=new Xe(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))),T(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){A(this._map._container,"leaflet-grab"),A(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t,e=this._map;e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity?(t=y(this._map.options.maxBounds),this._offsetLimit=p(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))):this._offsetLimit=null,e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){var e,n;this._map.options.inertia&&(e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos,this._positions.push(n),this._times.push(e),this._prunePositions(e)),this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;1<this._positions.length&&50<t-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){var t,e;this._viscosity&&this._offsetLimit&&(t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit,t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t))},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,r=this._draggable._newPos.x,i=(r-e+n)%t+e-n,r=(r+e+n)%t-e-n,t=Math.abs(i+n)<Math.abs(r+n)?i:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=t},_onDragEnd:function(t){var e,n,r,i,o=this._map,a=o.options,s=!a.inertia||t.noInertia||this._times.length<2;o.fire("dragend",t),!s&&(this._prunePositions(+new Date),t=this._lastPos.subtract(this._positions[0]),s=(this._lastTime-this._times[0])/1e3,e=a.easeLinearity,s=(t=t.multiplyBy(e/s)).distanceTo([0,0]),n=Math.min(a.inertiaMaxSpeed,s),t=t.multiplyBy(n/s),r=n/(a.inertiaDeceleration*e),(i=t.multiplyBy(-r/2).round()).x||i.y)?(i=o._limitOffset(i,o.options.maxBounds),w(function(){o.panBy(i,{duration:r,easeLinearity:e,noMoveStart:!0,animate:!0})})):o.fire("moveend")}})),Lt=(P.addInitHook("addHandler","dragging",pt),P.mergeOptions({keyboard:!0,keyboardPanDelta:80}),r.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),x(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),N(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){var t,e,n;this._focused||(n=document.body,t=document.documentElement,e=n.scrollTop||t.scrollTop,n=n.scrollLeft||t.scrollLeft,this._map._container.focus(),window.scrollTo(n,e))},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){for(var e=this._panKeys={},n=this.keyCodes,r=0,i=n.left.length;r<i;r++)e[n.left[r]]=[-1*t,0];for(r=0,i=n.right.length;r<i;r++)e[n.right[r]]=[t,0];for(r=0,i=n.down.length;r<i;r++)e[n.down[r]]=[0,t];for(r=0,i=n.up.length;r<i;r++)e[n.up[r]]=[0,-1*t]},_setZoomDelta:function(t){for(var e=this._zoomKeys={},n=this.keyCodes,r=0,i=n.zoomIn.length;r<i;r++)e[n.zoomIn[r]]=t;for(r=0,i=n.zoomOut.length;r<i;r++)e[n.zoomOut[r]]=-t},_addHooks:function(){x(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){N(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n,r=t.keyCode,i=this._map;if(r in this._panKeys)i._panAnim&&i._panAnim._inProgress||(n=this._panKeys[r],t.shiftKey&&(n=g(n).multiplyBy(3)),i.options.maxBounds&&(n=i._limitOffset(g(n),i.options.maxBounds)),i.options.worldCopyJump?(e=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(n))),i.panTo(e)):i.panBy(n));else if(r in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[r]);else{if(27!==r||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Me(t)}}})),Yn=(P.addInitHook("addHandler","keyboard",Lt),P.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),r.extend({addHooks:function(){x(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){N(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=Ve(t),n=this._map.options.wheelDebounceTime,e=(this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date),Math.max(n-(+new Date-this._startTime),0));clearTimeout(this._timer),this._timer=setTimeout(s(this._performZoom,this),e),Me(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0,r=(t._stop(),this._delta/(4*this._map.options.wheelPxPerZoomLevel)),r=4*Math.log(2/(1+Math.exp(-Math.abs(r))))/Math.LN2,n=n?Math.ceil(r/n)*n:r,r=t._limitZoom(e+(0<this._delta?n:-n))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}})),kt=(P.addInitHook("addHandler","scrollWheelZoom",Yn),P.mergeOptions({tapHold:C.touchNative&&C.safari&&C.mobile,tapTolerance:15}),r.extend({addHooks:function(){x(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){N(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){var e;clearTimeout(this._holdTimeout),1===t.touches.length&&(e=t.touches[0],this._startPos=this._newPos=new f(e.clientX,e.clientY),this._holdTimeout=setTimeout(s(function(){this._cancel(),this._isTapValid()&&(x(document,"touchend",R),x(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))},this),600),x(document,"touchend touchcancel contextmenu",this._cancel,this),x(document,"touchmove",this._onMove,this))},_cancelClickPrevent:function t(){N(document,"touchend",R),N(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),N(document,"touchend touchcancel contextmenu",this._cancel,this),N(document,"touchmove",this._onMove,this)},_onMove:function(t){t=t.touches[0];this._newPos=new f(t.clientX,t.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){t=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});t._simulated=!0,e.target.dispatchEvent(t)}})),xt=(P.addInitHook("addHandler","tapHold",kt),P.mergeOptions({touchZoom:C.touch,bounceAtZoomLimits:!0}),r.extend({addHooks:function(){T(this._map._container,"leaflet-touch-zoom"),x(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){A(this._map._container,"leaflet-touch-zoom"),N(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e,n,r=this._map;!t.touches||2!==t.touches.length||r._animatingZoom||this._zooming||(e=r.mouseEventToContainerPoint(t.touches[0]),n=r.mouseEventToContainerPoint(t.touches[1]),this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),"center"!==r.options.touchZoom&&(this._pinchStartLatLng=r.containerPointToLatLng(e.add(n)._divideBy(2))),this._startDist=e.distanceTo(n),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),x(document,"touchmove",this._onTouchMove,this),x(document,"touchend touchcancel",this._onTouchEnd,this),R(t))},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]),i=n.distanceTo(r)/this._startDist;if(this._zoom=e.getScaleZoom(i,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&i<1||this._zoom>e.getMaxZoom()&&1<i)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1==i)return}else{n=n._add(r)._divideBy(2)._subtract(this._centerPoint);if(1==i&&0===n.x&&0===n.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(n),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),a(this._animRequest);r=s(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=w(r,this,!0),R(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,a(this._animRequest),N(document,"touchmove",this._onTouchMove,this),N(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}})),Qn=(P.addInitHook("addHandler","touchZoom",xt),P.BoxZoom=At,P.DoubleClickZoom=It,P.Drag=pt,P.Keyboard=Lt,P.ScrollWheelZoom=Yn,P.TapHold=kt,P.TouchZoom=xt,t.Bounds=m,t.Browser=C,t.CRS=it,t.Canvas=qn,t.Circle=_n,t.CircleMarker=vn,t.Class=et,t.Control=O,t.DivIcon=Un,t.DivOverlay=On,t.DomEvent=gt,t.DomUtil=ft,t.Draggable=Xe,t.Evented=nt,t.FeatureGroup=dn,t.GeoJSON=Cn,t.GridLayer=Fn,t.Handler=r,t.Icon=pn,t.ImageOverlay=Nn,t.LatLng=v,t.LatLngBounds=o,t.Layer=i,t.LayerGroup=hn,t.LineUtil=vt,t.Map=P,t.Marker=mn,t.Mixin=mt,t.Path=yn,t.Point=f,t.PolyUtil=yt,t.Polygon=bn,t.Polyline=wn,t.Popup=Mn,t.PosAnimation=ze,t.Projection=wt,t.Rectangle=Zn,t.Renderer=jn,t.SVG=Kn,t.SVGOverlay=Pn,t.TileLayer=Vn,t.Tooltip=Bn,t.Transformation=st,t.Util=tt,t.VideoOverlay=Rn,t.bind=s,t.bounds=p,t.canvas=Wn,t.circle=function(t,e,n){return new _n(t,e,n)},t.circleMarker=function(t,e){return new vn(t,e)},t.control=je,t.divIcon=function(t){return new Un(t)},t.extend=u,t.featureGroup=function(t,e){return new dn(t,e)},t.geoJSON=Dn,t.geoJson=St,t.gridLayer=function(t){return new Fn(t)},t.icon=function(t){return new pn(t)},t.imageOverlay=function(t,e,n){return new Nn(t,e,n)},t.latLng=b,t.latLngBounds=y,t.layerGroup=function(t,e){return new hn(t,e)},t.map=function(t,e){return new P(t,e)},t.marker=function(t,e){return new mn(t,e)},t.point=g,t.polygon=function(t,e){return new bn(t,e)},t.polyline=function(t,e){return new wn(t,e)},t.popup=function(t,e){return new Mn(t,e)},t.rectangle=function(t,e){return new Zn(t,e)},t.setOptions=h,t.stamp=l,t.svg=Xn,t.svgOverlay=function(t,e,n){return new Pn(t,e,n)},t.tileLayer=Hn,t.tooltip=function(t,e){return new Bn(t,e)},t.transformation=lt,t.version="1.9.4",t.videoOverlay=function(t,e,n){return new Rn(t,e,n)},window.L);t.noConflict=function(){return window.L=Qn,this},window.L=t});function Us(t,e){"number"!=typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1)&&(this.limit=this.size)}function Fs(t,e){this.key=t,this.value=e,this[Rs]=void 0,this[Ps]=void 0}function Vs(t){this.entry=t}function Hs(t){this.entry=t}function zs(t){this.entry=t}xs=window,Ds=document,L.drawVersion="1.0.4+838a63b",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e);t=L.version.split(".");1===parseInt(t[0],10)&&2<=parseInt(t[1],10)?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire(L.Draw.Event.CREATED,{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){var t,e,n,r;this._markers.length<=1||(t=this._markers.pop(),r=(n=(e=this._poly).getLatLngs()).splice(-1,1)[0],this._poly.setLatLngs(n),this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(r,!1))},addVertex:function(t){2<=this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(t,!0))},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),t=this._poly.newLatLngIntersects(t[t.length-1]);!this.options.allowIntersection&&t||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),n=this._map.layerPointToLatLng(e);this._currentLatLng=n,this._updateTooltip(n),this._updateGuide(e),this._mouseMarker.setLatLng(n),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){var e;this._clickHandled||this._touchHandled||this._disableMarkers||(this._onMouseMove(t),this._clickHandled=!0,this._disableNewMarkers(),e=(t=t.originalEvent).clientX,this._startPoint.call(this,e,t.clientY))},_startPoint:function(t,e){this._mouseDownOrigin=L.point(t,e)},_onMouseUp:function(t){var e=t.originalEvent,n=e.clientX;this._endPoint.call(this,n,e.clientY,t),this._clickHandled=null},_endPoint:function(t,e,n){this._mouseDownOrigin&&(t=L.point(t,e).distanceTo(this._mouseDownOrigin),e=this._calculateFinishDistance(n.latlng),1<this.options.maxPoints&&this.options.maxPoints==this._markers.length+1?(this.addVertex(n.latlng),this._finishShape()):e<10&&L.Browser.touch?this._finishShape():Math.abs(t)<9*(xs.devicePixelRatio||1)&&this.addVertex(n.latlng),this._enableNewMarkers()),this._mouseDownOrigin=null},_onTouch:function(t){var e,n=t.originalEvent;!n.touches||!n.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=n.touches[0].clientX,n=n.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,n),this._endPoint.call(this,e,n,t),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(t){if(0<this._markers.length){if(this.type===L.Draw.Polyline.TYPE)e=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;e=this._markers[0]}var e=this._map.latLngToContainerPoint(e.getLatLng()),t=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),t=this._map.latLngToContainerPoint(t.getLatLng()),e=e.distanceTo(t)}else e=1/0;return e},_updateFinishHandler:function(){var t=this._markers.length;1<t&&this._markers[t-1].on("click",this._finishShape,this),2<t&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){t=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(t),t},_updateGuide:function(t){var e=this._markers?this._markers.length:0;0<e&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var n,r,i=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),o=this.options.guidelineDistance,a=this.options.maxGuideLineLength,s=a<i?i-a:o;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));s<i;s+=this.options.guidelineDistance)n=s/i,n={x:Math.floor(t.x*(1-n)+n*e.x),y:Math.floor(t.y*(1-n)+n*e.y)},(r=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=(this._errorShown?this.options.drawError:this.options.shapeOptions).color,L.DomUtil.setPosition(r,n)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,n=this._guidesContainer.childNodes.length;e<n;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t=this.options.showLength,t=0===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(t=t?this._getMeasurementString():"",1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:t}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:t});return t},_updateRunningMeasure:function(t,e){var n=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(n=n-(e?2:1),t=L.GeometryUtil.isVersion07x()?t.distanceTo(this._markers[n].getLatLng())*(this.options.factor||1):this._map.distance(t,this._markers[n].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=t*(e?1:-1))},_getMeasurementString:function(){var t=this._currentLatLng,e=this._markers[this._markers.length-1].getLatLng(),t=L.GeometryUtil.isVersion07x()?e&&t&&t.distanceTo?this._measurementRunningTotal+t.distanceTo(e)*(this.options.factor||1):this._measurementRunningTotal||0:e&&t?this._measurementRunningTotal+this._map.distance(t,e)*(this.options.factor||1):this._measurementRunningTotal||0;return L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),2<t&&(this._markers[t-1].on("dblclick",this._finishShape,this),3<t)&&this._markers[t-2].off("dblclick",this._finishShape,this)},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:e=(t=this._markers.length<3?L.drawLocal.draw.handlers.polygon.tooltip.cont:L.drawLocal.draw.handlers.polygon.tooltip.end,this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area,e="";return t||this.options.showLength?(this.options.showLength&&(e=L.Draw.Polyline.prototype._getMeasurementString.call(this)),t&&(e+="<br>"+L.GeometryUtil.readableArea(t,this.options.metric,this.options.precision)),e):null},_shapeIsValid:function(){return 3<=this._markers.length},_vertexChanged:function(t,e){var n;!this.options.allowIntersection&&this.options.showArea&&(n=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(n)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;0<t&&(this._markers[0].off("click",this._finishShape,this),2<t)&&this._markers[t-1].off("dblclick",this._finishShape,this)}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),Ds.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(Ds,"mouseup",this._onMouseUp,this),L.DomEvent.off(Ds,"touchend",this._onMouseUp,this),Ds.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape)&&(this._map.removeLayer(this._shape),delete this._shape),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(Ds,"mouseup",this._onMouseUp,this).on(Ds,"touchend",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){t=t.latlng;this._tooltip.updatePosition(t),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(t))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(t){this._shape||this._isCurrentlyTwoClickDrawing?this._isCurrentlyTwoClickDrawing&&!((t,e)=>{for(;(t=t.parentElement)&&!t.classList.contains(e););return t})(t.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this):this._isCurrentlyTwoClickDrawing=!0},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e=L.Draw.SimpleShape.prototype._getTooltipText.call(this),n=this._shape,r=this.options.showArea;return n&&(n=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),n=L.GeometryUtil.geodesicArea(n),t=r?L.GeometryUtil.readableArea(n,this.options.metric):""),{text:e.text,subtext:t}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){t=t.latlng;this._tooltip.updatePosition(t),this._mouseMarker.setLatLng(t),this._marker?(t=this._mouseMarker.getLatLng(),this._marker.setLatLng(t)):(this._marker=this._createMarker(t),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(t){return new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},_fireCreatedEvent:function(){var t=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)},_createMarker:function(t){return new L.CircleMarker(t,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){t=L.GeometryUtil.isVersion07x()?this._startLatLng.distanceTo(t):this._map.distance(this._startLatLng,t),this._shape?this._shape.setRadius(t):(this._shape=new L.Circle(this._startLatLng,t,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,t=t.latlng,n=this.options.showRadius,r=this.options.metric;this._tooltip.updatePosition(t),this._isDrawing&&(this._drawShape(t),t=this._shape.getRadius().toFixed(1),e="",n&&(e=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(t,r,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:e}))}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){t=t.target;t.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:t})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display="none",L.DomUtil.hasClass(t,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,4)),t.style.display="")},_offsetMarker:function(t,e){var n=parseInt(t.style.marginTop,10)-e,e=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=n+"px",t.style.marginLeft=e+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable)&&this.editing.enable()}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(t){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return!L.Polyline._flat||L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this._poly.options.poly))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(t,e,n){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,n&&n.drawError&&(n.drawError=L.Util.extend({},this.options.drawError,n.drawError)),this._latlngs=e,L.setOptions(this,n)},_defaultShape:function(){return!L.Polyline._flat||L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},addHooks:function(){var t=this._poly,e=t._path;t instanceof L.Polygon||(t.options.fill=!1,t.options.editing&&(t.options.editing.fill=!1)),e&&t.options.editing&&t.options.editing.className&&(t.options.original.className&&t.options.original.className.split(" ").forEach(function(t){L.DomUtil.removeClass(e,t)}),t.options.editing.className.split(" ").forEach(function(t){L.DomUtil.addClass(e,t)})),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly,e=t._path;e&&t.options.editing&&t.options.editing.className&&(t.options.editing.className.split(" ").forEach(function(t){L.DomUtil.removeClass(e,t)}),t.options.original.className)&&t.options.original.className.split(" ").forEach(function(t){L.DomUtil.addClass(e,t)}),t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];for(var t,e,n,r,i=this._defaultShape(),o=0,a=i.length;o<a;o++)(e=this._createMarker(i[o],o)).on("click",this._onMarkerClick,this),e.on("contextmenu",this._onContextMenu,this),this._markers.push(e);for(o=0,t=a-1;o<a;t=o++)(0!==o||L.Polygon&&this._poly instanceof L.Polygon)&&(n=this._markers[t],r=this._markers[o],this._createMiddleMarker(n,r),this._updatePrevNext(n,r))},_createMarker:function(t,e){var n=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return n._origLatLng=t,n._index=e,n.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(n),n},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var t=this._defaultShape(),e=[].splice.apply(t,arguments);return this._poly._convertLatLngs(t,!0),this._poly.redraw(),e},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(t){var e,n,t=t.target,r=this._poly,i=L.LatLngUtil.cloneLatLng(t._origLatLng),i=(L.extend(t._origLatLng,t._latlng),r.options.poly&&(e=r._map._editTooltip,!r.options.poly.allowIntersection)&&r.intersects()&&(L.extend(t._origLatLng,i),t.setLatLng(i),n=r.options.color,r.setStyle({color:this.options.drawError.color}),e&&e.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){r.setStyle({color:n}),e&&e.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)),t._middleLeft&&t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev,t)),t._middleRight&&t._middleRight.setLatLng(this._getMiddleLatLng(t,t._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0),this._poly.getLatLngs());this._poly._convertLatLngs(i,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,t=t.target;this._defaultShape().length<e||(this._removeMarker(t),this._updatePrevNext(t._prev,t._next),t._middleLeft&&this._markerGroup.removeLayer(t._middleLeft),t._middleRight&&this._markerGroup.removeLayer(t._middleRight),t._prev&&t._next?this._createMiddleMarker(t._prev,t._next):t._prev?t._next||(t._prev._middleRight=null):t._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(t){t=t.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:t,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),e=this._map.layerPointToLatLng(e),t=t.target;L.extend(t._origLatLng,e),t._middleLeft&&t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev,t)),t._middleRight&&t._middleRight.setLatLng(this._getMiddleLatLng(t,t._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(e,n){this._markerGroup.eachLayer(function(t){t._index>e&&(t._index+=n)})},_createMiddleMarker:function(e,n){var r,i,t,o=this._getMiddleLatLng(e,n),a=this._createMarker(o);a.setOpacity(.6),e._middleRight=n._middleLeft=a,i=function(){a.off("touchmove",i,this);var t=n._index;a._index=t,a.off("click",r,this).on("click",this._onMarkerClick,this),o.lat=a.getLatLng().lat,o.lng=a.getLatLng().lng,this._spliceLatLngs(t,0,o),this._markers.splice(t,0,a),a.setOpacity(1),this._updateIndexes(t,1),n._index++,this._updatePrevNext(e,a),this._updatePrevNext(a,n),this._poly.fire("editstart")},t=function(){a.off("dragstart",i,this),a.off("dragend",t,this),a.off("touchmove",i,this),this._createMiddleMarker(e,a),this._createMiddleMarker(a,n)},r=function(){i.call(this),t.call(this),this._fireEdit()},a.on("click",r,this).on("dragstart",i,this).on("dragend",t,this).on("touchmove",i,this),this._markerGroup.addLayer(a)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var n=this._poly._map,t=n.project(t.getLatLng()),e=n.project(e.getLatLng());return n.unproject(t._add(e)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable)&&this.editing.enable(),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map)&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,n=this._resizeMarkers.length;e<n;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){t=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(t),this._markerGroup.addLayer(t),t},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var t=t.target,e=t.getLatLng();t===this._moveMarker?this._move(e):this._resize(e),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){var e,n;L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),"function"==typeof this._getCorners&&(e=this._getCorners(),n=(t=t.target)._cornerIndex,t.setOpacity(0),this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)),this._shape.fire("editstart")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),e=this._map.layerPointToLatLng(e);return t.target===this._moveMarker?this._move(e):this._resize(e),this._shape.redraw(),!1},_onTouchEnd:function(t){t.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,n=t.length;e<n;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),t=t.target._cornerIndex;this._oppositeCorner=e[(t+2)%4],this._toggleCornerMarkers(0,t)},_onMarkerDragEnd:function(t){var e,n=t.target;n===this._moveMarker&&(e=this._shape.getBounds().getCenter(),n.setLatLng(e)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,n=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),r=this._shape.getBounds().getCenter(),i=[],o=0,a=n.length;o<a;o++)e=[n[o].lat-r.lat,n[o].lng-r.lng],i.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(i),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(t){this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),t=this._shape.getBounds(),this._moveMarker.setLatLng(t.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,n=this._resizeMarkers.length;e<n;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,n=this._resizeMarkers.length;e<n;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable)&&this.editing.enable()}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(t){var e;this._resizeMarkers.length&&(e=this._getResizeMarkerPoint(t),this._resizeMarkers[0].setLatLng(e)),this._shape.setLatLng(t),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable)&&this.editing.enable(),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var t=this._shape.getLatLng(),t=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(t,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),t=this._map.project(t);return this._map.unproject([t.x+e,t.y-e])},_resize:function(t){var e=this._moveMarker.getLatLng();radius=L.GeometryUtil.isVersion07x()?e.distanceTo(t):this._map.distance(e,t),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable)&&this.editing.enable()}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(t,e){var n={};if(void 0!==t.touches){if(!t.touches.length)return;n=t.touches[0]}else{if("touch"!==t.pointerType)return;if(!this._filterClick(n=t))return}var r=this._map.mouseEventToContainerPoint(n),i=this._map.mouseEventToLayerPoint(n),o=this._map.layerPointToLatLng(i);this._map.fire(e,{latlng:o,layerPoint:i,containerPoint:r,pageX:n.pageX,pageY:n.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,n=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return n&&100<n&&n<500||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){this._map._loaded&&this._touchEvent(t,"touchstart")},_onTouchEnd:function(t){this._map._loaded&&this._touchEvent(t,"touchend")},_onTouchCancel:function(t){var e;this._map._loaded&&(e="touchcancel",this._detectIE()&&(e="pointercancel"),this._touchEvent(t,e))},_onTouchLeave:function(t){this._map._loaded&&this._touchEvent(t,"touchleave")},_onTouchMove:function(t){this._map._loaded&&this._touchEvent(t,"touchmove")},_detectIE:function(){var t=xs.navigator.userAgent,e=t.indexOf("MSIE ");return 0<e?parseInt(t.substring(e+5,t.indexOf(".",e)),10):0<t.indexOf("Trident/")?(e=t.indexOf("rv:"),parseInt(t.substring(e+3,t.indexOf(".",e)),10)):0<(e=t.indexOf("Edge/"))&&parseInt(t.substring(e+5,t.indexOf(".",e)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?e.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):e.concat(["touchcancel"]),L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this),L.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)L.DomEvent.on(t,e[n],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable)&&this.dragging.enable()}},_detectIE:function(){var t=xs.navigator.userAgent,e=t.indexOf("MSIE ");return 0<e?parseInt(t.substring(e+5,t.indexOf(".",e)),10):0<t.indexOf("Trident/")?(e=t.indexOf("rv:"),parseInt(t.substring(e+3,t.indexOf(".",e)),10)):0<(e=t.indexOf("Edge/"))&&parseInt(t.substring(e+5,t.indexOf(".",e)),10)}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],n=0,r=t.length;n<r;n++)Array.isArray(t[n])?e.push(L.LatLngUtil.cloneLatLngs(t[n])):e.push(this.cloneLatLng(t[n]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},Ns={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2},L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,n,r=t.length,i=0,o=Math.PI/180;if(2<r){for(var a=0;a<r;a++)e=t[a],i+=((n=t[(a+1)%r]).lng-e.lng)*o*(2+Math.sin(e.lat*o)+Math.sin(n.lat*o));i=6378137*i*6378137/2}return Math.abs(i)},formattedNumber:function(t,e){var n,t=parseFloat(t).toFixed(e),e=L.drawLocal.format&&L.drawLocal.format.numeric,e=e&&e.delimiters,r=e&&e.thousands,e=e&&e.decimal;return t=(r||e)&&(n=t.split("."),t=r?n[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+r):n[0],e=e||".",1<n.length)?t+e+n[1]:t},readableArea:function(t,e,n){var r,n=L.Util.extend({},Ns,n),i=e?(r=["ha","m"],"string"==(i=typeof e)?r=[e]:"boolean"!=i&&(r=e),1e6<=t&&-1!==r.indexOf("km")?L.GeometryUtil.formattedNumber(1e-6*t,n.km)+" kmÂ²":1e4<=t&&-1!==r.indexOf("ha")?L.GeometryUtil.formattedNumber(1e-4*t,n.ha)+" ha":L.GeometryUtil.formattedNumber(t,n.m)+" mÂ²"):3097600<=(t/=.836127)?L.GeometryUtil.formattedNumber(t/3097600,n.mi)+" miÂ²":4840<=t?L.GeometryUtil.formattedNumber(t/4840,n.ac)+" acres":L.GeometryUtil.formattedNumber(t,n.yd)+" ydÂ²";return i},readableDistance:function(t,e,n,r,i){var o,i=L.Util.extend({},Ns,i);switch(e?"string"==typeof e?e:"metric":n?"feet":r?"nauticalMile":"yards"){case"metric":o=1e3<t?L.GeometryUtil.formattedNumber(t/1e3,i.km)+" km":L.GeometryUtil.formattedNumber(t,i.m)+" m";break;case"feet":t*=3.28083,o=L.GeometryUtil.formattedNumber(t,i.ft)+" ft";break;case"nauticalMile":t*=.53996,o=L.GeometryUtil.formattedNumber(t/1e3,i.nm)+" nm";break;default:o=1760<(t*=1.09361)?L.GeometryUtil.formattedNumber(t/1760,i.mi)+" miles":L.GeometryUtil.formattedNumber(t,i.yd)+" yd"}return o},isVersion07x:function(){var t=L.version.split(".");return 0===parseInt(t[0],10)&&7===parseInt(t[1],10)}}),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,n,r){return this._checkCounterclockwise(t,n,r)!==this._checkCounterclockwise(e,n,r)&&this._checkCounterclockwise(t,e,n)!==this._checkCounterclockwise(t,e,r)},_checkCounterclockwise:function(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,n,r=this._getProjectedPoints(),i=r?r.length:0;if(!this._tooFewPointsForIntersection())for(t=i-1;3<=t;t--)if(e=r[t-1],n=r[t],this._lineSegmentsIntersectsRange(e,n,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var n=this._getProjectedPoints(),r=n?n.length:0,n=n?n[r-1]:null,r=r-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(n,t,r,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._getProjectedPoints(),n=e?e.length:0;return n+=t||0,!e||n<=3},_lineSegmentsIntersectsRange:function(t,e,n,r){var i,o,a=this._getProjectedPoints();r=r||0;for(var s=n;r<s;s--)if(i=a[s-1],o=a[s],L.LineUtil.segmentsIntersect(t,e,i,o))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var t=[],e=this._defaultShape(),n=0;n<e.length;n++)t.push(this._map.latLngToLayerPoint(e[n]));return t}}),L.Polygon.include({intersects:function(){var t,e,n=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(t=n.length,e=n[0],n=n[t-1],this._lineSegmentsIntersectsRange(n,e,t-2,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");var e;L.Control.prototype.initialize.call(this,t),this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,n,r=L.DomUtil.create("div","leaflet-draw"),i=!1;for(n in this._toolbars)this._toolbars.hasOwnProperty(n)&&(e=this._toolbars[n].addToolbar(t))&&(i||(L.DomUtil.hasClass(e,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(e.childNodes[0],"leaflet-draw-toolbar-top"),i=!0),r.appendChild(e));return r},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e,n=t.target;for(e in this._toolbars)this._toolbars[e]!==n&&this._toolbars[e].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null;t=L.version.split(".");1===parseInt(t[0],10)&&2<=parseInt(t[1],10)?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,n=L.DomUtil.create("div","leaflet-draw-section"),r=0,i=this._toolbarClass||"",o=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<o.length;e++)o[e].enabled&&this._initModeHandler(o[e].handler,this._toolbarContainer,r++,i,o[e].title);if(r)return this._lastButtonIndex=--r,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),n.appendChild(this._toolbarContainer),n.appendChild(this._actionsContainer),n},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,n=this._actionButtons.length;e<n;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,n,r,i){var o=t.type;this._modes[o]={},this._modes[o].handler=t,this._modes[o].button=this._createButton({type:o,title:i,className:r+"-"+o,container:e,callback:this._modes[o].handler.enable,context:this._modes[o].handler}),this._modes[o].buttonIndex=n,this._modes[o].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!xs.MSStream},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container),n=L.DomUtil.create("span","sr-only",t.container),n=(e.href="#",e.appendChild(n),t.title&&(e.title=t.title,n.innerHTML=t.title),t.text&&(e.innerHTML=t.text,n.innerHTML=t.text),this._detectIOS()?"touchstart":"click");return L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"touchstart",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,n,t.callback,t.context),e},_disposeButton:function(t,e){var n=this._detectIOS()?"touchstart":"click";L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"touchstart",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,n,e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){for(var e,n=this._actionsContainer,r=this.getActions(t),i=r.length,o=0,a=this._actionButtons.length;o<a;o++)this._disposeButton(this._actionButtons[o].button,this._actionButtons[o].callback);for(this._actionButtons=[];n.firstChild;)n.removeChild(n.firstChild);for(var s=0;s<i;s++)"enabled"in r[s]&&!r[s].enabled||(e=L.DomUtil.create("li","",n),e=this._createButton({title:r[s].title,text:r[s].text,container:e,callback:r[s].callback,context:r[s].context}),this._actionButtons.push({button:e,callback:r[s].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,n=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=n+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._visible=!1,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container&&(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?0<t.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(0<t.subtext.length?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",t.text||t.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden")),this},updatePosition:function(t){var t=this._map.latLngToLayerPoint(t),e=this._container;return this._container&&(this._visible&&(e.style.visibility="inherit"),L.DomUtil.setPosition(e,t)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(t,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){for(var e in L.setOptions(this,t),this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&(void 0===t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(t){var e=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return t.removeAllLayers&&e.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),e},addToolbar:function(t){t=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),t},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;t=L.version.split(".");1===parseInt(t[0],10)&&2<=parseInt(t[1],10)?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var e=new L.LayerGroup;this._featureGroup.eachLayer(function(t){t.edited&&(e.addLayer(t),t.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:e})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:(t instanceof L.Marker||t instanceof L.CircleMarker)&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):(t instanceof L.Marker||t instanceof L.CircleMarker)&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire("revert-edited",{layer:t}))},_enableLayerEdit:function(t){var e,t=t.layer||t.target||t;this._backupLayer(t),this.options.poly&&(e=L.Util.extend({},this.options.poly),t.options.poly=e),this.options.selectedPathOptions&&((e=L.Util.extend({},this.options.selectedPathOptions)).maintainColor&&(e.color=t.options.color,e.fillColor=t.options.fillColor),t.options.original=L.extend({},t.options),t.options.editing=e),t instanceof L.Marker?(t.editing&&t.editing.enable(),t.dragging.enable(),t.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):t.editing.enable()},_disableLayerEdit:function(t){t=t.layer||t.target||t;t.edited=!1,t.editing&&t.editing.disable(),delete t.options.editing,delete t.options.original,this._selectedPathOptions&&(t instanceof L.Marker?this._toggleMarkerHighlight(t):(t.setStyle(t.options.previousOptions),delete t.options.previousOptions)),t instanceof L.Marker?(t.dragging.disable(),t.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):t.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onMarkerDragEnd:function(t){t=t.target;t.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:t})},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],e=this._map.mouseEventToLayerPoint(e),e=this._map.layerPointToLatLng(e);t.target.setLatLng(e)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;t=L.version.split(".");1===parseInt(t[0],10)&&2<=parseInt(t[1],10)?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t),t.fire("revert-deleted",{layer:t})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(t){this._removeLayer({layer:t})},this),this.save()},_enableLayerDelete:function(t){(t.layer||t.target||t).on("click",this._removeLayer,this)},_disableLayerDelete:function(t){t=t.layer||t.target||t;t.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(t)},_removeLayer:function(t){t=t.layer||t.target||t;this._deletableLayers.removeLayer(t),this._deletedLayers.addLayer(t),t.fire("deleted")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}}),Rs=Symbol("newer"),Ps=Symbol("older"),Us.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[Rs]&&(t===this.oldest&&(this.oldest=t[Rs]),t[Rs][Ps]=t[Ps]),t[Ps]&&(t[Ps][Rs]=t[Rs]),t[Rs]=void 0,t[Ps]=this.newest,this.newest&&(this.newest[Rs]=t),this.newest=t)},Us.prototype.assign=function(t){for(var e,n=this.limit||Number.MAX_VALUE,r=(this._keymap.clear(),t[Symbol.iterator]()),i=r.next();!i.done;i=r.next()){var o=new Fs(i.value[0],i.value[1]);if(this._keymap.set(o.key,o),e?(e[Rs]=o)[Ps]=e:this.oldest=o,e=o,0==n--)throw new Error("overflow")}this.newest=e,this.size=this._keymap.size},Us.prototype.get=function(t){t=this._keymap.get(t);if(t)return this._markEntryAsUsed(t),t.value},Us.prototype.set=function(t,e){var n=this._keymap.get(t);return n?(n.value=e,this._markEntryAsUsed(n)):(this._keymap.set(t,n=new Fs(t,e)),this.newest?(this.newest[Rs]=n)[Ps]=this.newest:this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift()),this},Us.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[Rs]?(this.oldest=this.oldest[Rs],this.oldest[Ps]=void 0):(this.oldest=void 0,this.newest=void 0),t[Rs]=t[Ps]=void 0,this._keymap.delete(t.key),--this.size,[t.key,t.value]},Us.prototype.find=function(t){t=this._keymap.get(t);return t?t.value:void 0},Us.prototype.has=function(t){return this._keymap.has(t)},Us.prototype.delete=function(t){t=this._keymap.get(t);if(t)return this._keymap.delete(t.key),t[Rs]&&t[Ps]?(t[Ps][Rs]=t[Rs],t[Rs][Ps]=t[Ps]):t[Rs]?(t[Rs][Ps]=void 0,this.oldest=t[Rs]):t[Ps]?(t[Ps][Rs]=void 0,this.newest=t[Ps]):this.oldest=this.newest=void 0,this.size--,t.value},Us.prototype.clear=function(){this.oldest=this.newest=void 0,this.size=0,this._keymap.clear()},Us.prototype.keys=function(){return new Hs(this.oldest)},Us.prototype.values=function(){return new zs(this.oldest)},Us.prototype.entries=function(){return this},Us.prototype[Symbol.iterator]=function(){return new Vs(this.oldest)},Us.prototype.forEach=function(t,e){"object"!=typeof e&&(e=this);for(var n=this.oldest;n;)t.call(e,n.value,n.key,this),n=n[Rs]},Us.prototype.toJSON=function(){for(var t=new Array(this.size),e=0,n=this.oldest;n;)t[e++]={key:n.key,value:n.value},n=n[Rs];return t},Us.prototype.toString=function(){for(var t="",e=this.oldest;e;)t+=String(e.key)+":"+e.value,(e=e[Rs])&&(t+=" < ");return t},Vs.prototype[Symbol.iterator]=function(){return this},Vs.prototype.next=function(){var t=this.entry;return t?(this.entry=t[Rs],{done:!1,value:[t.key,t.value]}):{done:!0,value:void 0}},Hs.prototype[Symbol.iterator]=function(){return this},Hs.prototype.next=function(){var t=this.entry;return t?(this.entry=t[Rs],{done:!1,value:t.key}):{done:!0,value:void 0}},zs.prototype[Symbol.iterator]=function(){return this},zs.prototype.next=function(){var t=this.entry;return t?(this.entry=t[Rs],{done:!1,value:t.value}):{done:!0,value:void 0}},Ms=function(){return Os=Os||new Promise(function(t,e){var n=0,r=null,r=setInterval(function(){return 20<=n?(clearInterval(r),e(new Error("window.google not found after 10 seconds"))):window.google&&window.google.maps&&window.google.maps.Map?(clearInterval(r),t(window.google)):void++n},500)})},L.GridLayer.GoogleMutant=L.GridLayer.extend({options:{minZoom:0,maxZoom:21,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,type:"roadmap",maxNativeZoom:21},initialize:function(t){L.GridLayer.prototype.initialize.call(this,t),this._isMounted=!0,this.once("spawned",function(){if(this._subLayers)for(var t in this._subLayers)this._subLayers[t].setMap(this._mutant)}),this._tileCallbacks={},this._lru=new Us(100),this._imagesPerTile="hybrid"===this.options.type?2:1,this._boundOnMutatedImage=this._onMutatedImage.bind(this)},onAdd:function(e){var n=this;L.GridLayer.prototype.onAdd.call(this,e),this._initMutantContainer(),this._logoContainer&&e._controlCorners.bottomleft.appendChild(this._logoContainer),this._attributionContainer&&e._controlCorners.bottomright.appendChild(this._attributionContainer),Ms().then(function(){var t;n._isMounted&&(n._ready=!0,n._initMutant(),e=n._map)&&(t=n.options.updateWhenIdle?"moveend":"move",e.on(t,n._update,n),n.once("remove",function(){this._map.off(t,this._update,this)}),google.maps.event.addListenerOnce(n._mutant,"idle",function(){n._map&&(n._checkZoomLevels(),n._mutantIsReady=!0)}),n._update())})},onRemove:function(t){L.GridLayer.prototype.onRemove.call(this,t),this._observer.disconnect(),t._container.removeChild(this._mutantContainer),this._logoContainer&&L.DomUtil.remove(this._logoContainer),this._attributionContainer&&L.DomUtil.remove(this._attributionContainer),google.maps.event.clearListeners(t,"idle"),this._mutant&&google.maps.event.clearListeners(this._mutant,"idle"),t.off("move moveend",this._update,this),this._isMounted=!1},addGoogleLayer:function(e,n){var r=this;return this._subLayers||(this._subLayers={}),Ms().then(function(){var t=new google.maps[e](n);r._mutant&&t.setMap(r._mutant),r._subLayers[e]=t}),this},removeGoogleLayer:function(e){var n=this;return Ms().then(function(){var t=n._subLayers&&n._subLayers[e];t&&(t.setMap(null),delete n._subLayers[e])}),this},_initMutantContainer:function(){this._mutantContainer||(this._mutantContainer=L.DomUtil.create("div","leaflet-google-mutant leaflet-top leaflet-left"),this._mutantContainer.id="_MutantContainer_"+L.Util.stamp(this._mutantContainer),this._mutantContainer.style.zIndex=800,this._mutantContainer.style.pointerEvents="none",L.DomEvent.off(this._mutantContainer)),this._map.getContainer().appendChild(this._mutantContainer),this.setOpacity(this.options.opacity);var t=this._mutantContainer.style;this.options.zoomSnap<1?(t.width="180%",t.height="180%"):(t.width="100%",t.height="100%"),t.zIndex=-1,this._attachObserver(this._mutantContainer)},_initMutant:function(){var t,n=this;this._mutant||(t=new google.maps.Map(this._mutantContainer,{center:{lat:0,lng:0},zoom:0,tilt:0,mapTypeId:this.options.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,styles:this.options.styles||{},backgroundColor:"transparent"}),this._mutant=t,google.maps.event.addListenerOnce(t,"idle",function(){for(var t=n._mutantContainer.querySelectorAll("a"),e=0;e<t.length;++e)t[e].style.pointerEvents="auto"}),this.fire("spawned",{mapObject:t}))},_attachObserver:function(t){this._observer||(this._observer=new MutationObserver(this._onMutations.bind(this))),this._observer.observe(t,{childList:!0,subtree:!0}),Array.prototype.forEach.call(t.querySelectorAll("img"),this._boundOnMutatedImage)},_onMutations:function(t){for(var e=0;e<t.length;++e)for(var n=t[e],r=0;r<n.addedNodes.length;++r){var i,o=n.addedNodes[r];o instanceof HTMLImageElement?this._onMutatedImage(o):o instanceof HTMLElement&&(Array.prototype.forEach.call(o.querySelectorAll("img"),this._boundOnMutatedImage),"white"===o.style.backgroundColor&&L.DomUtil.remove(o),0===o.textContent.indexOf("For development purposes only")&&L.DomUtil.remove(o),Array.prototype.forEach.call(o.querySelectorAll('div[draggable=false][style*="text-align: center"]'),L.DomUtil.remove),(0<o.querySelectorAll(".gmnoprint").length||0<o.querySelectorAll('a[title="Click to see this area on Google Maps"]').length)&&(i=this._attributionContainer=L.DomUtil.create("div","leaflet-control leaflet-control-attribution"),L.DomEvent.disableClickPropagation(i),i.style.height="14px",i.style.background="none",this._map._controlCorners.bottomright.appendChild(i),i.appendChild(o)),1e6==o.style.zIndex)&&(this._map._controlCorners.bottomleft.appendChild(o),this._logoContainer=o)}},_roadRegexp:/!1i(\d+)!2i(\d+)!3i(\d+)!/,_satRegexp:/x=(\d+)&y=(\d+)&z=(\d+)/,_staticRegExp:/StaticMapService\.GetMapImage/,_onMutatedImage:function(e){var t,n=e.src.match(this._roadRegexp),r=0;n?(t={z:n[1],x:n[2],y:n[3]},1<this._imagesPerTile&&(r=e.style.zIndex=1)):((n=e.src.match(this._satRegexp))&&(t={x:n[1],y:n[2],z:n[3]}),r=0),t?(n=this._tileCoordsToKey(t),e.style.position="absolute",e.style.visibility="hidden",this._lru.set(t=n+"/"+r,e),t in this._tileCallbacks&&this._tileCallbacks[t]&&(this._tileCallbacks[t].forEach(function(t){return t(e)}),delete this._tileCallbacks[t])):e.src.match(this._staticRegExp)&&(e.style.visibility="hidden")},createTile:function(t,n){var e=this._tileCoordsToKey(t),r=L.DomUtil.create("div");r.style.textAlign="left",r.dataset.pending=this._imagesPerTile,n=n.bind(this,null,r);for(var i=0;i<this._imagesPerTile;++i){var o=e+"/"+i,a=this._lru.get(o);a?(r.appendChild(this._clone(a)),--r.dataset.pending):(this._tileCallbacks[o]=this._tileCallbacks[o]||[],this._tileCallbacks[o].push(function(e){return function(t){e.appendChild(this._clone(t)),--e.dataset.pending,parseInt(e.dataset.pending)||n()}.bind(this)}.bind(this)(r)))}return parseInt(r.dataset.pending)||L.Util.requestAnimFrame(n),r},_clone:function(t){t=t.cloneNode(!0);return t.style.visibility="visible",t},_checkZoomLevels:function(){var t=this._map.getZoom(),e=this._mutant.getZoom();t&&e&&(e!==t||e>this.options.maxNativeZoom)&&this._setMaxNativeZoom(e)},_setMaxNativeZoom:function(t){t!==this.options.maxNativeZoom&&(this.options.maxNativeZoom=t,this._resetView())},_update:function(){var t,e,n;this._mutant&&(t=this._map.getCenter(),t=new google.maps.LatLng(t.lat,t.lng),e=Math.round(this._map.getZoom()),n=this._mutant.getZoom(),this._mutant.setCenter(t),e!==n)&&(this._mutant.setZoom(e),this._mutantIsReady)&&this._checkZoomLevels(),L.GridLayer.prototype._update.call(this)},_resize:function(){var t=this.options.zoomSnap<1?1.8:1,t=this._map.getSize().multiplyBy(t);this._mutantContainer.style.width===t.x&&this._mutantContainer.style.height===t.y||(this.setElementSize(this._mutantContainer,t),this._mutant&&google.maps.event.trigger(this._mutant,"resize"))},_handleZoomAnim:function(){var t;this._mutant&&(t=this._map.getCenter(),t=new google.maps.LatLng(t.lat,t.lng),this._mutant.setCenter(t),this._mutant.setZoom(Math.round(this._map.getZoom())))}}),L.gridLayer.googleMutant=function(t){return new L.GridLayer.GoogleMutant(t)};let js=e=>new Promise((o,t)=>{navigator.geolocation.getCurrentPosition(t=>{var{latitude:e,longitude:n,altitude:r,accuracy:i}=t.coords,e=Math.round(1e6*e)/1e6,n=Math.round(1e6*n)/1e6;o({geopoint:e+` ${n} ${r||"0.0"} `+(i||"0.0"),lat:e,lng:n,position:t})},t,e)}),qs,Ws=rt&&rt.maps&&0<rt.maps.length?rt.maps:[{name:"streets",maxzoom:19,tiles:["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"],attribution:'Â© <a href="http://openstreetmap.org">OpenStreetMap</a> | <a href="www.openstreetmap.org/copyright">Terms</a>'}],Gs="https://maps.googleapis.com/maps/api/geocode/json?address={address}&sensor=true&key={api_key}",$s="https://maps.googleapis.com/maps/api/geocode/json?latlng={lat},{lng}&key={api_key}";var Ks,Xs,Zs,Ys=rt.google_api_key;let Qs=Bs.divIcon({iconSize:24,className:"enketo-geopoint-marker"}),Js=Bs.divIcon({iconSize:16,className:"enketo-geopoint-circle-marker"}),tl=Bs.divIcon({iconSize:16,className:"enketo-geopoint-circle-marker-active"}),el=Bs.divIcon({iconSize:16,className:"smap-geopoint-blue-circle-marker"}),nl=Bs.divIcon({iconSize:16,className:"smap-geopoint-blue-circle-marker-active"}),rl=Bs.divIcon({iconSize:16,className:"smap-geopoint-red-circle-marker"}),il=Bs.divIcon({iconSize:16,className:"smap-geopoint-red-circle-marker-active"});class ol extends cs{static get selector(){return'.question input[data-type-xml="geopoint"]:not([data-setgeopoint]), .question input[data-type-xml="geotrace"], .question input[data-type-xml="geoshape"], .question input[data-type-xml="geocompound"]'}static condition(t){return!qe.has(t,"ArcGisGeopicker")}_init(){var t=this.originalInputValue;let a=this;"undefined"!=typeof smapConfig&&(Ys=smapConfig.googleApiKey),this.$form=m(this.element).closest("form.or"),this.$question=m(this.element).closest(".question"),this.mapId=Math.round(1e7*Math.random()),this._addDomElements(),this.currentIndex=0,this.points=[],this.markerTypes=[],this.addressCache={},this.markerAddress={},"geocompound"===this.props.type&&(this.markers=this._getMarkers(this.props.appearances)),t&&(this.value=t),this.$widget.find('[name="lat"], [name="long"], [name="alt"], [name="acc"]').on("change change.bymap change.bysearch",t=>{var e=a.$lat.val()?Number(a.$lat.val()):"",n=a.$lng.val()?Number(a.$lng.val()):"",r=a.$alt.val()?Number(a.$alt.val()):"",i=a.$acc.val()?Number(a.$acc.val()):"",o={lat:e,lng:n};t.stopImmediatePropagation(),"bymap"!==t.namespace&&"bysearch"!==t.namespace&&a.polyline&&"geoshape"===a.props.type&&!a.containsEmptyPoints(a.points,a.currentIndex)&&a.updatedPolylineWouldIntersect(o,a.currentIndex)?(a._showIntersectError(),a._updateInputs(a.points[a.currentIndex],"nochange",a.currentIndex)):(a._editPoint([e,n,r,i]),"bysearch"!==t.namespace&&a.$search&&a.$search.val(""))}),this.$kmlInput.on("change",function(t){let n=a.$points.find(".addpoint"),e=m(this).prev(".paste-progress").removeClass("hide");var r=t.target.value;let i=a._convertKmlCoordinatesToLeafletCoordinates(r);t.target.value="",setTimeout(()=>{i.forEach((t,e)=>{a._updateInputs(t,void 0,e),e<i.length-1&&n.click()}),e.remove(),a._switchInputType("points")},10)}),this.$widget.find(".toggle-input-type-btn").on("click",()=>{var t=a.$inputGroup.hasClass("kml-input-mode")?"points":"kml";return a._switchInputType(t),!1}),m(this.element).on("change",function(){a.$kmlInput.prop("disabled",!!this.value)}).on("applyfocus",()=>{a.$widget[0].querySelector("input").focus()}),this.$points.on("click",".point",function(){return a._setCurrent(a.$points.find(".point").index(m(this))),a._switchInputType("points"),!1}),this.$points.find(".addpoint").on("click",()=>(a._addPoint(),!1)),this.$widget.find(".close-chain-btn").on("click",()=>(a._closePolygon(),!1)),this.$widget.find(".btn-remove").on("click",()=>{a.points.length<2?a._updateInputs([],void 0,-1):ts.confirm(C("geopicker.removePoint")).then(t=>{t&&a._removePoint()}).catch(()=>{})}),this.$map.find(".show-map-btn").on("click",()=>(a.$widget.find(".search-bar").removeClass("hide-search"),a.$widget.addClass("full-screen"),this._showMap(),!1)),this.$form.on("pageflip.map"+this.mapId,t=>{a.map&&m.contains(t.target,a.element)&&(a.map.invalidateSize(),a.$form.off("pageflip.map"+a.mapId))}),this.props.wide&&this.$widget.addClass("wide"),this.$widget.toggleClass("hide-input",this.$question.hasClass("or-appearance-hide-input")).find(".toggle-input-visibility-btn").on("click",function(){a.$widget.toggleClass("hide-input"),m(this).toggleClass("open",a.$widget.hasClass("hide-input")),a.map&&a.map.invalidateSize(!1)}).toggleClass("open",a.$widget.hasClass("hide-input")),this.$widget.find(".hide-map-btn").on("click",()=>(a.$widget.find(".search-bar").addClass("hide-search"),a.$widget.removeClass("full-screen").find(".map-canvas").removeClass("leaflet-container").find(".leaflet-google-layer").remove(),a.map&&(a.map.remove(),a.map=void 0,this.loadMap=void 0,a.polygon=void 0,a.polyline=void 0),!1)),this.props.search&&this._enableSearch(),this.props.detect&&this._enableDetection(),this.props.readonly&&this.disable(),t&&this.points.forEach(()=>{a._addPointBtn()}),this._showMap()}_getMarkers(e){var n,r={};let i=!1;if(0<e.length)for(let t=0;t<e.length;t++)0===e[t].indexOf("marker")&&(i=!0,1<(n=e[t].split(":")).length&&(r[n[1]]={}),2<n.length&&(r[n[1]].name=n[2]),3<n.length)&&(r[n[1]].label=n[3]);return i||(r.pit={name:"Chamber",label:"J"},r.fault={name:"Blockage",label:"Blockage"}),r}_getMarkerSelect(t){var e=[];let n=-1;var r,i=this.markerTypes[this.currentIndex];for(r in e[++n]='<select id="markerType" className="ignore" name="markerType">',e[++n]='<option value="none">None</option>',t){var o=t[r];e[++n]='<option value="',e[++n]=r,e[++n]='"',i===r&&(e[++n]=" selected"),e[++n]=">",e[++n]=this.htmlEncode(o.name),e[++n]="</option>"}return e[++n]="</select>",e.join("")}htmlEncode(t){if(t)return m("<div>").text(t).html()}_showMap(){this.originalInputValue?("geopoint"===this.props.type?this._updateMap(Bs.latLng(this.points[0][0],this.points[0][1]),void 0,!1):this._updateMap(void 0,void 0,!0),this._setCurrent(this.currentIndex)):(this._updateMap([0,0],1),this.props.detect&&navigator.geolocation.getCurrentPosition(t=>{this._updateMap([t.coords.latitude,t.coords.longitude],15)}))}_markerTypePopupChanged(t,e){this.markerTypes[this.currentIndex]=t,this._updateAddress(e.lat,e.lng,this.currentIndex),this._updateValue(),this._updateMap()}_switchInputType(t){"kml"===t?this.$inputGroup.addClass("kml-input-mode"):"points"===t&&this.$inputGroup.removeClass("kml-input-mode")}_addPointBtn(){this.$points.find(".addpoint").before('<a href="#" class="point-list point" aria-label="point"> </a>')}_addDomElements(){var t=`<div class="map-canvas-wrapper"><div class=map-canvas id="map${this.mapId}"></div></div>`,e=`
            <a href="#" class="toggle-input-type-btn">
                <span class="kml-input">KML</span>
                <span class="points-input" data-i18n="geopicker.points">${C("geopicker.points")}</span>
            </a>
            <label class="geo kml">
                <span data-i18n="geopicker.kmlcoords">${C("geopicker.kmlcoords")}</span>
                <progress class="paste-progress hide"></progress>
                <textarea class="ignore" name="kml" placeholder="${C("geopicker.kmlpaste")}" data-i18n="geopicker.kmlpaste"></textarea>
                <span class="disabled-msg">remove all points to enable</span>
            </label>`,n=`<button type="button" class="close-chain-btn btn btn-default btn-xs" data-i18n="geopicker.closepolygon">${C("geopicker.closepolygon")}</button>`;this.$widget=m(`<div class="geopicker widget">
                <div class="search-bar hide-search no-map no-detect">
                    <button type="button" class="hide-map-btn btn btn-default"><span class="icon icon-arrow-left"> </span></button>
                    <button name="geodetect" type="button" class="btn btn-default" title="detect current location" data-placement="top"><span class="icon icon-crosshairs"> </span></button>
                    <div class="input-group">
                        <input class="geo ignore" name="search" type="text" placeholder="${C("geopicker.searchPlaceholder")}" data-i18n="geopicker.searchPlaceholder" disabled="disabled"/>
                        <button type="button" class="btn btn-default search-btn"><i class="icon icon-search"> </i></button>
                    </div>
                </div>
                <div class="geo-inputs">
                    <label class="geo lat">
                        <span data-i18n="geopicker.latitude">${C("geopicker.latitude")}</span>
                        <input class="ignore" name="lat" type="number" step="0.000001" min="-90" max="90"/>
                    </label>
                    <label class="geo long">
                        <span data-i18n="geopicker.longitude">${C("geopicker.longitude")}</span>
                        <input class="ignore" name="long" type="number" step="0.000001" min="-180" max="180"/>
                    </label>
                    <label class="geo alt">
                        <span data-i18n="geopicker.altitude">${C("geopicker.altitude")}</span>
                        <input class="ignore" name="alt" type="number" step="0.1" />
                    </label>
                    <label class="geo acc">
                        <span data-i18n="geopicker.accuracy">${C("geopicker.accuracy")}</span>
                        <input class="ignore" name="acc" type="number" step="0.1" />
                    </label>
                    <button type="button" class="btn-icon-only btn-remove" aria-label="remove"><span class="icon icon-trash"> </span></button>
                </div>
            </div>`),this.props.detect&&(this.$widget.find(".search-bar").removeClass("no-detect"),this.$detect=this.$widget.find('button[name="geodetect"]')),this.$search=this.$widget.find('[name="search"]'),this.$inputGroup=this.$widget.find(".geo-inputs"),this.props.map?(this.$widget.find(".search-bar").removeClass("no-map").after(t),this.$map=this.$widget.find(".map-canvas"),this.$map.parent().append('<button type="button" class="toggle-input-visibility-btn" aria-label="toggle input"> </button>')):this.$map=m(),this.props.touch&&this.props.map&&this.$map.append('<button type="button" class="show-map-btn btn btn-default">Map</button>'),this.props.touch||this.$widget.find(".search-bar").removeClass("hide-search"),"geopoint"!==this.props.type?(this.$points=m('<div class="points"><button type="button" class="addpoint">+</button></div>'),this.$widget.prepend(this.$points),"geoshape"===this.props.type&&this.$inputGroup.append(n),t=m(e),this.$kmlInput=t.find('[name="kml"]'),this.$inputGroup.prepend(t)):(this.$points=m(),this.$kmlInput=m()),this.$lat=this.$widget.find('[name="lat"]'),this.$lng=this.$widget.find('[name="long"]'),this.$alt=this.$widget.find('[name="alt"]'),this.$acc=this.$widget.find('[name="acc"]'),m(this.element).hide().after(this.$widget).parent().addClass("clearfix")}_updateValue(){this._markAsValid();var t=this.originalInputValue,e=this.value;return t!==e&&(this.originalInputValue=e,!0)}_isValidGeopoint(t){return!!t&&Qe.geopoint.validate(t)}_isValidLatLngList(t){let r=this;return t.every((t,e,n)=>r._isValidLatLng(t)||""===t.join()&&e===n.length-1)}_cleanLatLng(t){return Array.isArray(t)?[t[0],t[1]]:t}_isValidLatLng(t){var e="number"==typeof t[0]?t[0]:"number"==typeof t.lat?t.lat:null,t="number"==typeof t[1]?t[1]:"number"==typeof t.lng?t.lng:null;return Qe.geopoint.validate([e,t].join(" "))}_markAsInvalid(t){this.$points.find(".point-list").eq(t).addClass("has-error")}_markAsValid(){this.$points.find(".point-list").removeClass("has-error")}_setCurrent(t){this.currentIndex=t,this.$points.find(".point-list").removeClass("active").eq(t).addClass("active"),this._updateInputs(this.points[t],void 0,t),!this.map||this.props.touch&&!this._inFullScreenMode()||this._updateMarkers()}_enableDetection(){let r=this,e={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};this.$detect.click(t=>(t.preventDefault(),js(e).then(t=>{var e,n;r.polyline&&"geoshape"===r.props.type&&r.updatedPolylineWouldIntersect(t,r.currentIndex)?r._showIntersectError():({lat:t,lng:e,position:n}=t,"geopoint"!==r.props.type&&r._addPoint(),r._updateInputs([t,e,n.coords.altitude,n.coords.accuracy],"change.bymap",-1))}).catch(t=>{console.error("error occurred trying to obtain position: "+t.message)}),!1))}_enableSearch(){let r=this;$s=Ys?(Gs=Gs.replace("{api_key}",Ys),$s.replace("{api_key}",Ys)):(Gs=Gs.replace("&key={api_key}",""),$s.replace("&key={api_key}","")),this.$search.prop("disabled",!1).on("change",function(t){let n=m(this).val();t.stopImmediatePropagation(),n&&(n=n.split(/\s+/).join("+"),m.get(Gs.replace("{address}",n),t=>{var e;t.results&&0<t.results.length&&t.results[0].geometry&&t.results[0].geometry.location?(e=t.results[0].geometry.location,r._updateMap([e.lat,e.lng],15),r.$search.closest(".input-group").removeClass("has-error")):(r.$search.closest("input").val(t.error_message),r.$search.closest(".input-group").addClass("has-error"),console.warn(`Location "${n}" not found`))},"json").fail(()=>{r.$search.closest(".input-group").addClass("has-error"),console.error("Error. Geocoding service may not be available or app is offline")}).always(()=>{}))})}_updateAddress(t,e,n){let r=this,i=$s.replace("{lat}",t).replace("{lng}",e);t=this.addressCache[i];t?this._setAddress(t,n):m.get(i,t=>{t.results&&0<t.results.length&&t.results[0].formatted_address&&(this.addressCache[i]=t.results[0].formatted_address,this._setAddress(t.results[0].formatted_address,n))},"json").fail(()=>{r.$search.closest(".input-group").addClass("has-error"),console.error("Error. Geocoding service may not be available or app is offline")}).always(()=>{})}_setAddress(t,e){this.$search.val(t),this.markerAddress[e]=t;for(let t=0;t<this.markerTypes.length;t++)""!==this._getMarkerLabel(t)&&m('input[name="/main/'+this._getMarkerLabel(t)+'"]').val(this.markerAddress[t]).trigger("change")}_dynamicMapAvailable(){return!!this.map}_inFullScreenMode(){return this.$widget.hasClass("full-screen")}_updateMap(t,e,n){let r=this;this.props.map&&(e=e||this.map&&this.map.getZoom()||15,t&&(this.lastLatLng=t),this.lastZoom=e,this.props.touch&&!this._inFullScreenMode()||(this.loadMap=this.loadMap||this._addDynamicMap(),this.loadMap.then(()=>{r._updateDynamicMapView(t,e,n)}).catch(()=>{})))}_addDynamicMap(){let i=this;return this._getLayers().then(t=>{var e={layers:i._getDefaultLayer(t)};i.map=Bs.map("map"+i.mapId,e).on("click",t=>{var n;let r=[];if(i.props.readonly)return!1;if(n=t.latlng,1<i.points.length&&(r=i.points.map(t=>i._convertLatLng(t))),t=i.$lat.val()&&i.$lng.val()?i.points.length:i.currentIndex,n.lat=Math.round(1e6*n.lat)/1e6,n.lng=Math.round(1e6*n.lng)/1e6,"geoshape"===i.props.type&&!i.containsEmptyPoints(i.points,t)&&i.updatedPolylineWouldIntersect(n,t))i._showIntersectError();else if(i.$lat.val()&&i.$lng.val()&&"geopoint"!==i.props.type){if(i.$lat.val()&&i.$lng.val()){let e=!1;if(1<r.length)for(let t=0;t<r.length-1;t++)if(i.belongsSegment(n,r[t],r[t+1],.05)){i._insertPoint(t+1),i._updateInputs(n,"change.bymap",t+1),e=!0;break}e||(i._addPoint(),i._updateInputs(n,"change.bymap",-1))}}else i._updateInputs(n,"change.bymap",-1)}),i.map.attributionControl.setPrefix(""),1<t.length&&Bs.control.layers(i._getBaseLayers(t),null).addTo(i.map),i.$widget.find(".leaflet-control-layers-toggle").append('<span class="icon icon-globe"></span>'),i.map.on("baselayerchange",()=>{i.$widget.find(".leaflet-control-container input").addClass("ignore no-unselect").next("span").addClass("option-label")})})}_convertLatLng(t){return new Bs.latLng(t[0],t[1])}_updateDynamicMapView(t,e,n){t?(this._updateMarkers(),this.map.setView(t,e||15)):(this._updatePolyline(n),this._updateMarkers(),1===this.points.length&&""===this.points[0].toString()&&(this.lastLatLng?this.map.setView(this.lastLatLng,this.lastZoom||15):this.map.setView(Bs.latLng(0,0),e||15)))}_showIntersectError(){ts.alert(C("geopicker.bordersintersectwarning"))}_getLayers(){let n=this,r=[];return Ws.forEach((t,e)=>{"string"==typeof t.tiles&&/^GOOGLE_(SATELLITE|ROADMAP|HYBRID|TERRAIN)/.test(t.tiles)?r.push(n._getGoogleTileLayer(t,e)):t.tiles?r.push(n._getLeafletTileLayer(t,e)):console.error("Configuration error for map tiles. Not a valid tile layer: ",t)}),Promise.all(r)}_getLeafletTileLayer(t,e){e=this._getTileOptions(t,e);return t.tileIndex=void 0===t.tileIndex?Math.round(100*Math.random())%t.tiles.length:t.tileIndex,t=t.tiles[t.tileIndex],Promise.resolve(Bs.tileLayer(t,e))}_getGoogleTileLayer(t,e){let n=this._getTileOptions(t,e);return n.type=t.tiles.substring(7).toLowerCase(),this._loadGoogleMapsScript().then(()=>Bs.gridLayer.googleMutant(n))}_getTileOptions(t,e){e=t.name||"map-"+(e+1);return{id:t.id||e,maxZoom:t.maxzoom||19,minZoom:t.minzoom||0,name:e,attribution:t.attribution||""}}_loadGoogleMapsScript(){return qs=qs||new Promise(t=>{var e,n,r;window.gmapsLoaded=()=>{t()},e=`https://maps.google.com/maps/api/js?v=weekly${Ys?"&key="+Ys:""}&libraries=places&callback=gmapsLoaded`,n=document.createElement("script"),r=document.getElementsByTagName("script")[0],n.src=e,r.parentNode.insertBefore(n,r)})}_getDefaultLayer(t){let n,r=this;return t.reverse().some(e=>(n=e,r.props.appearances.some(t=>t===e.options.name))),n}_getBaseLayers(t){let e={};return t.forEach(t=>{e[t.options.name]=t}),e}_updateMarkers(){let r=[],i=[],o=this;this.markerLayer&&this.markerLayer.clearLayers(),0==this.points.length||1==this.points.length&&""===this.points[0].join()||(this.points.forEach((t,e)=>{let n;n="geocompound"===o.props.type?"pit"===o.markerTypes[e]?e===o.currentIndex?nl:el:"fault"===o.markerTypes[e]?e===o.currentIndex?il:rl:e===o.currentIndex?tl:Js:"geopoint"===o.props.type?Qs:e===o.currentIndex?tl:Js,o._isValidLatLng(t)?(r.push(o._cleanLatLng(t)),i.push(Bs.marker(o._cleanLatLng(t),{icon:n,clickable:!o.props.readonly,draggable:!o.props.readonly,alt:e,opacity:.9}).on("click",t=>{0===t.target.options.alt&&"geoshape"===o.props.type?o._closePolygon():o._setCurrent(t.target.options.alt),"geocompound"===o.props.type&&(Bs.popup({minWidth:200}).setLatLng(t.target.getLatLng()).setContent(this._getMarkerPopup()).openOn(this.map),m("#markerType").change(function(){o._markerTypePopupChanged(m(this).val(),t.target.getLatLng()),o.map.closePopup()}))}).on("dragend",t=>{var e=t.target.getLatLng(),t=t.target.options.alt;e.lat=Math.round(1e6*e.lat)/1e6,e.lng=Math.round(1e6*e.lng)/1e6,o.polyline&&"geoshape"===o.props.type&&o.updatedPolylineWouldIntersect(e,t)?(o._showIntersectError(),o._updateMarkers()):(o._setCurrent(t),o._updateInputs(e,"change.bymap",t),o._updateMap())}))):console.warn("this latLng was not considered valid",t)}),0<i.length&&(this.markerLayer=Bs.layerGroup(i).addTo(this.map),1!==this.points.length&&this._isValidLatLngList(this.points)||this.map.setView(r[0],this.lastZoom||15)))}_getMarkerPopup(){var t=[],e=-1;return t[e++]="<h1>",t[++e]=this.htmlEncode(this._getMarkerLabel(this.currentIndex)),t[++e]="</h1>",t[3]=this._getMarkerSelect(this.markers),t.join("")}_getMarkerLabel(n){let t="";var r=this.markerTypes[n];if(r&&0<r.length){let e=1;if(0<n)for(let t=0;t<n;t++)this.markerTypes[t]===r&&e++;t=this.markers[r].label+e}return t}_updatePolyline(t){let e,r=this;"geopoint"!==this.props.type&&(this.points.length<2||!this._isValidLatLngList(this.points)?(this.map&&(this.polyline&&this.map.removeLayer(this.polyline),this.polygon)&&this.map.removeLayer(this.polygon),this.polyline=null,this.polygon=null):("geoshape"===this.props.type&&this._updatePolygon(),e=(e=""!==this.points[this.points.length-1].join("")?this.points:this.points.slice(0,this.points.length-1)).map(t=>r._cleanLatLng(t)),this.polyline?this.polyline.setLatLngs(e):(this.polyline=Bs.polyline(e,{color:"red"}).on("click",function(e){Bs.DomEvent.stopPropagation(e);var n=e.sourceTarget.getLatLngs();if(1<n.length)for(let t=0;t<n.length-1;t++)if(r.belongsSegment(e.latlng,n[t],n[t+1])){r._insertPoint(t+1),r._updateInputs(e.latlng,"change.bymap",t+1);break}}),this.map.addLayer(this.polyline)),t&&setTimeout(()=>{r.map.fitBounds(r.polyline.getBounds())},0)))}belongsSegment(t,e,n,r){r=void 0===r?.2:r;var i=e.distanceTo(n);return(e.distanceTo(t)+t.distanceTo(n)-i)/i<r}_updatePolygon(){let t,e=this;"geopoint"!==this.props.type&&"geotrace"!==this.props.type&&(t=(t=""!==this.points[this.points.length-1].join("")?this.points:this.points.slice(0,this.points.length-1)).map(t=>e._cleanLatLng(t)),this.polygon?this.polygon.setLatLngs(t):(this.polygon=Bs.polygon(t,{color:"red",stroke:!1}),this.map.addLayer(this.polygon)),this._updateArea(t))}_updateArea(t){2<t.length?(t=t.map(t=>({lat:t[0],lng:t[1]})),t=Bs.GeometryUtil.geodesicArea(t),t=Bs.GeometryUtil.readableArea(t,!0),Bs.popup({className:"enketo-area-popup"}).setLatLng(this.polygon.getBounds().getCenter()).setContent(t).openOn(this.map)):this.map.closePopup()}_addPoint(){this._addPointBtn(),this.points.push([]),"geocompound"===this.props.type&&this.markerTypes.push(""),this._setCurrent(this.points.length-1),this._updateValue()}_insertPoint(t){this._addPointBtn(),this.points.splice(t,0,[]),"geocompound"===this.props.type&&this.markerTypes.splice(t,0,""),this._setCurrent(t),this._updateValue()}_editPoint(t){return this.points[this.currentIndex]=t,(t=this._updateValue())&&this._updateMap(),t}_removePoint(){let t=this.currentIndex;this.points.splice(this.currentIndex,1),"geocompound"===this.props.type&&this.markerTypes.splice(this.currentIndex,1),this._updateValue(),this.$points.find(".point-list").eq(this.currentIndex).remove(),void 0===this.points[this.currentIndex]&&(t=this.currentIndex-1),this._setCurrent(t),this._updateMap()}_closePolygon(){var t=this.points[this.points.length-1];if(!(this.points.length<3||3===this.points.length&&!this._isValidLatLng(this.points[2])||JSON.stringify(this.points[0])===JSON.stringify(t))){if(this._isValidLatLng(t)?this._addPoint():this.currentIndex=this.points.length-1,this.polyline&&!this.containsEmptyPoints(this.points,this.points.length)&&this.updatedPolylineWouldIntersect(this.points[0],this.currentIndex))return this._showIntersectError();this._updateInputs(this.points[0],void 0,-1)}}_updateInputs(t,e,n){var r=t[0]||t.lat||"",i=t[1]||t.lng||"",o=t[2]||t.alt||"",t=t[3]||t.acc||"";e=void 0!==e?e:"change","geocompound"===this.props.type&&0<=n&&(this.markerTypes[n]&&0<this.markerTypes[n].length?this._updateAddress(r,i,n):this.$search.val("")),this.$lat.val(r||""),this.$lng.val(i||""),this.$alt.val(o||""),this.$acc.val(t||"").trigger(e)}_convertKmlCoordinatesToLeafletCoordinates(t){let e=[];var n=/<\s?coordinates>(([^<]|\n)*)<\/\s?coordinates\s?>/;return(t=n.test(t)?t.match(n)[1]:t).trim().split(/\s+/).forEach(t=>{let n=[];t.split(",").forEach((t,e)=>{t=Number(t);0===e?n[1]=t:1===e?n[0]=t:2===e&&(n[2]=t)}),e.push(n)}),e}_getGeopoint(t){var e="number"==typeof t[0]?t[0]:"number"==typeof t.lat?t.lat:null,n="number"==typeof t[1]?t[1]:"number"==typeof t.lng?t.lng:null,r="number"==typeof t[2]?t[2]:0,t="number"==typeof t[3]?t[3]:0;return e&&n?e+` ${n} ${r} `+t:"0.0 0.0 0.0 0.0"}updatedPolylineWouldIntersect(t,e){var n=[];let r,i=this;return!(this.points<3)&&(m.extend(!0,n,this.points),n[e]=[t[0]||t.lat,t[1]||t.lng],r=(r=(r=""!==n[n.length-1].join("")?n:n.slice(0,n.length-1))[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]?r.slice(0,r.length-1):r).map(t=>i._cleanLatLng(t)),e=Bs.polyline(r,{color:"white"}),this.map.addLayer(e),t=e.intersects(),this.map.removeLayer(e),t)}containsEmptyPoints(t,n){return t.some((t,e)=>!(e===n||t[0]&&t[1]))}get props(){var t=this._props;return t.detect=!!navigator.geolocation,t.map=!ys.touch||t.appearances.includes("maps")||t.appearances.includes("placement-map"),t.search=t.map,t.touch=ys.touch,t.wide=.8<this.question.clientWidth/this.element.closest("form.or").clientWidth,t}get value(){if(0===this.points.length)return"";let r="";return"geocompound"===this.props.type&&(r="line:"),this.points.forEach((t,e,n)=>{t=this._getGeopoint(t);this._isValidGeopoint(t)||""===t&&e===n.length-1||this._markAsInvalid(e),""!==t||e!==n.length-1?(r+=t,e!==n.length-1&&(r+=";")):r=r.substring(0,r.lastIndexOf(";"))}),"geocompound"===this.props.type&&(this.markerTypes.forEach((t,e,n)=>{""!==t&&(r=(r=(r+="#marker:")+this._getGeopoint(this.points[e]))+":index="+e+";type="+t)}),console.debug("Value ",r)),r}set value(t){"geocompound"===this.props.type?(console.log("Set value: "+t),t.trim().split("#").forEach((t,e)=>{0===t.indexOf("line:")&&(t=t.substring(t.indexOf(":")+1)).trim().split(";").forEach((t,e)=>{this.points[e]=t.trim().split(" "),this.markerTypes[e]="",this.points[e].forEach((t,e,n)=>{n[e]=Number(t)})}),0===t.indexOf("marker:")&&t.trim().split(":").forEach((t,e)=>{if(1==e||2==e){e=t.trim().split(";");let r=-1,i;e.forEach((t,e,n)=>{t=t.trim().split("=");1<t.length&&("index"===t[0]?r=Number(t[1]):"type"===t[0]&&(i=t[1]))}),0<=r&&i&&(this.markerTypes[r]=i)}})})):t.trim().split(";").forEach((t,e)=>{this.points[e]=t.trim().split(" "),this.points[e].forEach((t,e,n)=>{n[e]=Number(t)})})}enable(){m(this.element).next(".widget").removeClass("readonly").find("input, select, textarea").prop("disabled",!1).end().find(".btn:not(.show-map-btn):not(.hide-map-btn), .btn-icon-only, .addpoint").prop("disabled",!1),this.map&&this.map.invalidateSize()}disable(){m(this.element).next(".widget").addClass("readonly").find("input, select, textarea").prop("disabled",!0).end().find(".btn:not(.show-map-btn):not(.hide-map-btn), .btn-icon-only, .addpoint").prop("disabled",!0)}update(){var t=this.element.parentElement.querySelector(".widget");t&&(t.remove(),this.loadMap=void 0,this.map=void 0,this.polyline=void 0,this.polygon=void 0,this._init())}}class al extends cs{static get selector(){return"form"}_init(){var t=this.element.querySelectorAll("textarea");this.defaultHeight=t[0]?t[0].clientHeight:20,this.element.addEventListener("input",t=>{t=t.target;"textarea"===t.nodeName.toLowerCase()&&this._resize(t)}),t.forEach(this._resize.bind(this)),this.element.addEventListener(E.PageFlip().type,t=>{t.target.querySelectorAll("textarea").forEach(this._resize.bind(this))})}_resize(t){t.scrollHeight>t.clientHeight&&t.scrollHeight>this.defaultHeight&&(t.style.height=t.scrollHeight+"px",t.style.flex="auto")}}class sl extends cs{static get selector(){return"form"}_init(){var t=m(this.element);let e=this;t.on("click",'input[type="radio"]:not([readonly]):checked',function(){m(this).parent("label").siblings().removeAttr("data-checked").end().attr("data-checked","true")}).on("click",'input[type="checkbox"]:not([readonly])',function(){e._updateDataChecked(this)}).on(E.InputUpdate().type,'input[type="radio"], input[type="checkbox"]',function(){this.closest(".option-wrapper").querySelectorAll('input[type="radio"],input[type="checkbox"]').forEach(t=>e._updateDataChecked(t))}).on("click",'input[type="checkbox"][readonly],input[type="radio"][readonly]',t=>(t.stopImmediatePropagation(),!1)).on(E.Change().type,'input[type="checkbox"][readonly],input[type="radio"][readonly]',function(t){var e=void 0===t.originalEvent;return e||(t.stopImmediatePropagation(),this.checked&&"true"!==this.parentNode.dataset.checked&&(this.checked=!1)),e}).on("click",'[data-checked]>input[type="radio"]:not(.no-unselect)',function(){m(this).prop("checked",!1).trigger("change").parent().removeAttr("data-checked")}),this.element.querySelectorAll('input[type="radio"]:checked, input[type="checkbox"]:checked').forEach(t=>this._updateDataChecked(t))}_updateDataChecked(t){t.checked?t.parentNode.dataset.checked=!0:delete t.parentNode.dataset.checked}}F(function(t,e){function b(){return new Date(Date.UTC.apply(Date,arguments))}function C(){var t=new Date;return b(t.getFullYear(),t.getMonth(),t.getDate())}function o(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}function n(t,e){return function(){return e!==S&&E.fn.datepicker.deprecated(e),this[t].apply(this,arguments)}}var E,S,r,T,l,i,a,u,c,A,I;E=m,r=(()=>{var e={get:function(t){return this.slice(t)[0]},contains:function(t){for(var e=t&&t.valueOf(),n=0,r=this.length;n<r;n++)if(0<=this[n].valueOf()-e&&this[n].valueOf()-e<864e5)return n;return-1},remove:function(t){this.splice(t,1)},replace:function(t){t&&(E.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.length=0},copy:function(){var t=new r;return t.replace(this),t}};return function(){var t=[];return t.push.apply(t,arguments),E.extend(t,e),t}})(),(T=function(t,e){E.data(t,"datepicker",this),this._events=[],this._secondaryEvents=[],this._process_options(e),this.dates=new r,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=E(t),this.isInput=this.element.is("input"),this.inputField=this.isInput?this.element:this.element.find("input"),this.component=!!this.element.hasClass("date")&&this.element.find(".add-on, .input-group-addon, .input-group-append, .input-group-prepend, .btn"),this.component&&0===this.component.length&&(this.component=!1),this.isInline=!this.component&&this.element.is("div"),this.picker=E(I.template),this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow),this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(t,e){return Number(e)+1}),this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled}),this._allow_update=!1,this.setViewMode(this.o.startView),this._allow_update=!0,this.fillDow(),this.fillMonths(),this.update(),this.isInline&&this.show()}).prototype={constructor:T,_resolveViewName:function(n){return E.each(I.viewModes,function(t,e){if(n===t||-1!==E.inArray(n,e.names))return n=t,!1}),n},_resolveDaysOfWeek:function(t){return E.isArray(t)||(t=t.split(/[,\s]*/)),E.map(t,Number)},_check_template:function(t){try{return t===S||""===t?!1:(t.match(/[<>]/g)||[]).length<=0||0<E(t).length}catch(t){return!1}},_process_options:function(t){this._o=E.extend({},this._o,t);var e,n,r=this.o=E.extend({},this._o),t=r.language,i=(A[t]||(t=t.split("-")[0],A[t])||(t=u.language),r.language=t,r.startView=this._resolveViewName(r.startView),r.minViewMode=this._resolveViewName(r.minViewMode),r.maxViewMode=this._resolveViewName(r.maxViewMode),r.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,r.startView)),!0!==r.multidate&&(r.multidate=Number(r.multidate)||!1,!1!==r.multidate)&&(r.multidate=Math.max(0,r.multidate)),r.multidateSeparator=String(r.multidateSeparator),r.weekStart%=7,r.weekEnd=(r.weekStart+6)%7,I.parseFormat(r.format)),o=(r.startDate!==-1/0&&(r.startDate?r.startDate instanceof Date?r.startDate=this._local_to_utc(this._zero_time(r.startDate)):r.startDate=I.parseDate(r.startDate,i,r.language,r.assumeNearbyYear):r.startDate=-1/0),r.endDate!==1/0&&(r.endDate?r.endDate instanceof Date?r.endDate=this._local_to_utc(this._zero_time(r.endDate)):r.endDate=I.parseDate(r.endDate,i,r.language,r.assumeNearbyYear):r.endDate=1/0),r.daysOfWeekDisabled=this._resolveDaysOfWeek(r.daysOfWeekDisabled||[]),r.daysOfWeekHighlighted=this._resolveDaysOfWeek(r.daysOfWeekHighlighted||[]),r.datesDisabled=r.datesDisabled||[],E.isArray(r.datesDisabled)||(r.datesDisabled=r.datesDisabled.split(",")),r.datesDisabled=E.map(r.datesDisabled,function(t){return I.parseDate(t,i,r.language,r.assumeNearbyYear)}),String(r.orientation).toLowerCase().split(/\s+/g)),t=r.orientation.toLowerCase(),o=E.grep(o,function(t){return/^auto|left|right|top|bottom$/.test(t)});if(r.orientation={x:"auto",y:"auto"},t&&"auto"!==t)if(1===o.length)switch(o[0]){case"top":case"bottom":r.orientation.y=o[0];break;case"left":case"right":r.orientation.x=o[0]}else t=E.grep(o,function(t){return/^left|right$/.test(t)}),r.orientation.x=t[0]||"auto",t=E.grep(o,function(t){return/^top|bottom$/.test(t)}),r.orientation.y=t[0]||"auto";r.defaultViewDate instanceof Date||"string"==typeof r.defaultViewDate?r.defaultViewDate=I.parseDate(r.defaultViewDate,i,r.language,r.assumeNearbyYear):r.defaultViewDate?(t=r.defaultViewDate.year||(new Date).getFullYear(),e=r.defaultViewDate.month||0,n=r.defaultViewDate.day||1,r.defaultViewDate=b(t,e,n)):r.defaultViewDate=C()},_applyEvents:function(t){for(var e,n,r,i=0;i<t.length;i++)e=t[i][0],2===t[i].length?(n=S,r=t[i][1]):3===t[i].length&&(n=t[i][1],r=t[i][2]),e.on(r,n)},_unapplyEvents:function(t){for(var e,n,r,i=0;i<t.length;i++)e=t[i][0],2===t[i].length?(r=S,n=t[i][1]):3===t[i].length&&(r=t[i][1],n=t[i][2]),e.off(n,r)},_buildEvents:function(){var t={keyup:E.proxy(function(t){-1===E.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:E.proxy(this.keydown,this),paste:E.proxy(this.paste,this)};!0===this.o.showOnFocus&&(t.focus=E.proxy(this.show,this)),this.isInput?this._events=[[this.element,t]]:this.component&&this.inputField.length?this._events=[[this.inputField,t],[this.component,{click:E.proxy(this.show,this)}]]:this._events=[[this.element,{click:E.proxy(this.show,this),keydown:E.proxy(this.keydown,this)}]],this._events.push([this.element,"*",{blur:E.proxy(function(t){this._focused_from=t.target},this)}],[this.element,{blur:E.proxy(function(t){this._focused_from=t.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":E.proxy(function(t){this.update(t.date)},this)}]),this._secondaryEvents=[[this.picker,{click:E.proxy(this.click,this)}],[this.picker,".prev, .next",{click:E.proxy(this.navArrowsClick,this)}],[this.picker,".day:not(.disabled)",{click:E.proxy(this.dayCellClick,this)}],[E(window),{resize:E.proxy(this.place,this)}],[E(document),{"mousedown touchstart":E.proxy(function(t){this.element.is(t.target)||this.element.find(t.target).length||this.picker.is(t.target)||this.picker.find(t.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,e){e=e||this.dates.get(-1),e=this._utc_to_local(e);this.element.trigger({type:t,date:e,viewMode:this.viewMode,dates:E.map(this.dates,this._utc_to_local),format:E.proxy(function(t,e){0===arguments.length?(t=this.dates.length-1,e=this.o.format):"string"==typeof t&&(e=t,t=this.dates.length-1),e=e||this.o.format;t=this.dates.get(t);return I.formatDate(t,e,this.o.language)},this)})},show:function(){if(!(this.inputField.is(":disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&E(this.element).blur(),this},hide:function(){return!this.isInline&&this.picker.is(":visible")&&(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.setViewMode(this.o.startView),this.o.forceParse&&this.inputField.val()&&this.setValue(),this._trigger("hide")),this},destroy:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(t){var e;if(t.originalEvent.clipboardData&&t.originalEvent.clipboardData.types&&-1!==E.inArray("text/plain",t.originalEvent.clipboardData.types))e=t.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;e=window.clipboardData.getData("Text")}this.setDate(e),this.update(),t.preventDefault()},_utc_to_local:function(t){var e;return t&&((e=new Date(t.getTime()+6e4*t.getTimezoneOffset())).getTimezoneOffset()!==t.getTimezoneOffset()?new Date(t.getTime()+6e4*e.getTimezoneOffset()):e)},_local_to_utc:function(t){return t&&new Date(t.getTime()-6e4*t.getTimezoneOffset())},_zero_time:function(t){return t&&new Date(t.getFullYear(),t.getMonth(),t.getDate())},_zero_utc_time:function(t){return t&&b(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())},getDates:function(){return E.map(this.dates,this._utc_to_local)},getUTCDates:function(){return E.map(this.dates,function(t){return new Date(t)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var t=this.dates.get(-1);return t!==S?new Date(t):null},clearDates:function(){this.inputField.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var t=E.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,t),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var t=E.isArray(arguments[0])?arguments[0]:arguments;return this.setDates.apply(this,E.map(t,this._utc_to_local)),this},setDate:n("setDates"),setUTCDate:n("setUTCDates"),remove:n("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),setValue:function(){var t=this.getFormattedDate();return this.inputField.val(t),this},getFormattedDate:function(e){e===S&&(e=this.o.format);var n=this.o.language;return E.map(this.dates,function(t){return I.formatDate(t,e,n)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(t){return this._process_options({startDate:t}),this.update(),this.updateNavArrows(),this},getEndDate:function(){return this.o.endDate},setEndDate:function(t){return this._process_options({endDate:t}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(t){return this._process_options({daysOfWeekDisabled:t}),this.update(),this},setDaysOfWeekHighlighted:function(t){return this._process_options({daysOfWeekHighlighted:t}),this.update(),this},setDatesDisabled:function(t){return this._process_options({datesDisabled:t}),this.update(),this},place:function(){var t,e,n,r,i,o,a,s,l,u,c;return this.isInline||(t=this.picker.outerWidth(),e=this.picker.outerHeight(),n=(u=E(this.o.container)).width(),r=("body"===this.o.container?E(document):u).scrollTop(),u=u.offset(),i=[0],this.element.parents().each(function(){var t=E(this).css("z-index");"auto"!==t&&0!==Number(t)&&i.push(Number(t))}),o=Math.max.apply(Math,i)+this.o.zIndexOffset,c=(this.component?this.component.parent():this.element).offset(),a=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),s=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),l=c.left-u.left,u=c.top-u.top,"body"!==this.o.container&&(u+=r),this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(l-=t-s)):c.left<0?(this.picker.addClass("datepicker-orient-left"),l-=c.left-10):n<l+t?(this.picker.addClass("datepicker-orient-right"),l+=s-t):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left"),"auto"===(c=this.o.orientation.y)&&(c=-r+u-e<0?"bottom":"top"),this.picker.addClass("datepicker-orient-"+c),"top"===c?u-=e+parseInt(this.picker.css("padding-top")):u+=a,this.o.rtl?this.picker.css({top:u,right:n-(l+s),zIndex:o}):this.picker.css({top:u,left:l,zIndex:o})),this},_allow_update:!0,update:function(){var t,n,e;return this._allow_update&&(t=this.dates.copy(),e=!(n=[]),arguments.length?(E.each(arguments,E.proxy(function(t,e){e instanceof Date&&(e=this._local_to_utc(e)),n.push(e)},this)),e=!0):(n=(n=this.isInput?this.element.val():this.element.data("date")||this.inputField.val())&&this.o.multidate?n.split(this.o.multidateSeparator):[n],delete this.element.data().date),n=E.map(n,E.proxy(function(t){return I.parseDate(t,this.o.format,this.o.language,this.o.assumeNearbyYear)},this)),n=E.grep(n,E.proxy(function(t){return!this.dateWithinRange(t)||!t},this),!0),this.dates.replace(n),this.o.updateViewDate&&(this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate),e?(this.setValue(),this.element.change()):this.dates.length&&String(t)!==String(this.dates)&&e&&(this._trigger("changeDate"),this.element.change()),!this.dates.length&&t.length&&(this._trigger("clearDate"),this.element.change()),this.fill()),this},fillDow:function(){if(this.o.showWeekDays){var t=this.o.weekStart,e="<tr>";for(this.o.calendarWeeks&&(e+='<th class="cw">&#160;</th>');t<this.o.weekStart+7;)e+='<th class="dow',-1!==E.inArray(t,this.o.daysOfWeekDisabled)&&(e+=" disabled"),e+='">'+A[this.o.language].daysMin[t++%7]+"</th>";e+="</tr>",this.picker.find(".datepicker-days thead").append(e)}},fillMonths:function(){for(var t=this._utc_to_local(this.viewDate),e="",n=0;n<12;n++)e+='<span class="month'+(t&&t.getMonth()===n?" focused":"")+'">'+A[this.o.language].monthsShort[n]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=E.map(t,function(t){return t.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var e=[],n=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),i=C();return t.getUTCFullYear()<n||t.getUTCFullYear()===n&&t.getUTCMonth()<r?e.push("old"):(t.getUTCFullYear()>n||t.getUTCFullYear()===n&&t.getUTCMonth()>r)&&e.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&e.push("focused"),this.o.todayHighlight&&o(t,i)&&e.push("today"),-1!==this.dates.contains(t)&&e.push("active"),this.dateWithinRange(t)||e.push("disabled"),this.dateIsDisabled(t)&&e.push("disabled","disabled-date"),-1!==E.inArray(t.getUTCDay(),this.o.daysOfWeekHighlighted)&&e.push("highlighted"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&e.push("range"),-1!==E.inArray(t.valueOf(),this.range)&&e.push("selected"),t.valueOf()===this.range[0]&&e.push("range-start"),t.valueOf()===this.range[this.range.length-1])&&e.push("range-end"),e},_fill_yearsView:function(t,e,n,r,i,o,a){for(var s,l,u,c="",h=n/10,t=this.picker.find(t),d=Math.floor(r/n)*n,p=d+9*h,f=Math.floor(this.viewDate.getFullYear()/h)*h,g=E.map(this.dates,function(t){return Math.floor(t.getUTCFullYear()/h)*h}),m=d-h;m<=p+h;m+=h)s=[e],l=null,m===d-h?s.push("old"):m===p+h&&s.push("new"),-1!==E.inArray(m,g)&&s.push("active"),(m<i||o<m)&&s.push("disabled"),m===f&&s.push("focused"),a!==E.noop&&((u=a(new Date(m,0,1)))===S?u={}:"boolean"==typeof u?u={enabled:u}:"string"==typeof u&&(u={classes:u}),!1===u.enabled&&s.push("disabled"),u.classes&&(s=s.concat(u.classes.split(/\s+/))),u.tooltip)&&(l=u.tooltip),c+='<span class="'+s.join(" ")+'"'+(l?' title="'+l+'"':"")+">"+m+"</span>";t.find(".datepicker-switch").text(d+"-"+p),t.find("td").html(c)},fill:function(){var t,e,n=new Date(this.viewDate),r=n.getUTCFullYear(),i=n.getUTCMonth(),o=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,a=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,s=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,l=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,u=A[this.o.language].today||A.en.today||"",c=A[this.o.language].clear||A.en.clear||"",h=A[this.o.language].titleFormat||A.en.titleFormat,d=C(),d=(!0===this.o.todayBtn||"linked"===this.o.todayBtn)&&d>=this.o.startDate&&d<=this.o.endDate&&!this.weekOfDateIsDisabled(d);if(!isNaN(r)&&!isNaN(i)){this.picker.find(".datepicker-days .datepicker-switch").text(I.formatDate(n,h,this.o.language)),this.picker.find("tfoot .today").text(u).css("display",d?"table-cell":"none"),this.picker.find("tfoot .clear").text(c).css("display",!0===this.o.clearBtn?"table-cell":"none"),this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"==typeof this.o.title&&""!==this.o.title?"table-cell":"none"),this.updateNavArrows(),this.fillMonths();for(var p=b(r,i,0),n=p.getUTCDate(),f=(p.setUTCDate(n-(p.getUTCDay()-this.o.weekStart+7)%7),new Date(p)),g=(p.getUTCFullYear()<100&&f.setUTCFullYear(p.getUTCFullYear()),f.setUTCDate(f.getUTCDate()+42),f=f.valueOf(),[]);p.valueOf()<f;){(y=p.getUTCDay())===this.o.weekStart&&(g.push("<tr>"),this.o.calendarWeeks)&&(m=new Date(+p+(this.o.weekStart-y-7)%7*864e5),m=new Date(Number(m)+(11-m.getUTCDay())%7*864e5),v=new Date(Number(v=b(m.getUTCFullYear(),0,1))+(11-v.getUTCDay())%7*864e5),g.push('<td class="cw">'+((m-v)/864e5/7+1)+"</td>")),(m=this.getClassNames(p)).push("day");var m,y,v=p.getUTCDate();this.o.beforeShowDay!==E.noop&&((e=this.o.beforeShowDay(this._utc_to_local(p)))===S?e={}:"boolean"==typeof e?e={enabled:e}:"string"==typeof e&&(e={classes:e}),!1===e.enabled&&m.push("disabled"),e.classes&&(m=m.concat(e.classes.split(/\s+/))),e.tooltip&&(t=e.tooltip),e.content)&&(v=e.content),m=E.isFunction(E.uniqueSort)?E.uniqueSort(m):E.unique(m),g.push('<td class="'+m.join(" ")+'"'+(t?' title="'+t+'"':"")+' data-date="'+p.getTime().toString()+'">'+v+"</td>"),t=null,y===this.o.weekEnd&&g.push("</tr>"),p.setUTCDate(p.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(g.join(""));var _,h=A[this.o.language].monthsTitle||A.en.monthsTitle||"Months",w=this.picker.find(".datepicker-months").find(".datepicker-switch").text(this.o.maxViewMode<2?h:r).end().find("tbody span").removeClass("active");E.each(this.dates,function(t,e){e.getUTCFullYear()===r&&w.eq(e.getUTCMonth()).addClass("active")}),(r<o||s<r)&&w.addClass("disabled"),r===o&&w.slice(0,a).addClass("disabled"),r===s&&w.slice(l+1).addClass("disabled"),this.o.beforeShowMonth!==E.noop&&(_=this,E.each(w,function(t,e){t=new Date(r,t,1),t=_.o.beforeShowMonth(t);t===S?t={}:"boolean"==typeof t?t={enabled:t}:"string"==typeof t&&(t={classes:t}),!1!==t.enabled||E(e).hasClass("disabled")||E(e).addClass("disabled"),t.classes&&E(e).addClass(t.classes),t.tooltip&&E(e).prop("title",t.tooltip)})),this._fill_yearsView(".datepicker-years","year",10,r,o,s,this.o.beforeShowYear),this._fill_yearsView(".datepicker-decades","decade",100,r,o,s,this.o.beforeShowDecade),this._fill_yearsView(".datepicker-centuries","century",1e3,r,o,s,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var t,e,n=new Date(this.viewDate),r=n.getUTCFullYear(),i=n.getUTCMonth(),o=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,a=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,s=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,l=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,u=1;switch(this.viewMode){case 4:u*=10;case 3:u*=10;case 2:u*=10;case 1:t=Math.floor(r/u)*u<=o,e=Math.floor(r/u)*u+u>s;break;case 0:t=r<=o&&i<=a,e=s<=r&&l<=i}this.picker.find(".prev").toggleClass("disabled",t),this.picker.find(".next").toggleClass("disabled",e)}},click:function(t){var e,n;t.preventDefault(),t.stopPropagation(),(t=E(t.target)).hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode&&this.setViewMode(this.viewMode+1),t.hasClass("today")&&!t.hasClass("day")&&(this.setViewMode(0),this._setDate(C(),"linked"===this.o.todayBtn?null:"view")),t.hasClass("clear")&&this.clearDates(),t.hasClass("disabled")||(t.hasClass("month")||t.hasClass("year")||t.hasClass("decade")||t.hasClass("century"))&&(this.viewDate.setUTCDate(1),1===this.viewMode?(n=t.parent().find("span").index(t),e=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(n)):(n=0,e=Number(t.text()),this.viewDate.setUTCFullYear(e)),this._trigger(I.viewModes[this.viewMode-1].e,this.viewDate),this.viewMode===this.o.minViewMode?this._setDate(b(e,n,1)):(this.setViewMode(this.viewMode-1),this.fill())),this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus(),delete this._focused_from},dayCellClick:function(t){t=E(t.currentTarget).data("date"),t=new Date(t);this.o.updateViewDate&&(t.getUTCFullYear()!==this.viewDate.getUTCFullYear()&&this._trigger("changeYear",this.viewDate),t.getUTCMonth()!==this.viewDate.getUTCMonth())&&this._trigger("changeMonth",this.viewDate),this._setDate(t)},navArrowsClick:function(t){t=E(t.currentTarget).hasClass("prev")?-1:1;0!==this.viewMode&&(t*=12*I.viewModes[this.viewMode].navStep),this.viewDate=this.moveMonth(this.viewDate,t),this._trigger(I.viewModes[this.viewMode].e,this.viewDate),this.fill()},_toggle_multidate:function(t){var e=this.dates.contains(t);if(t||this.dates.clear(),-1!==e?(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(e):(!1===this.o.multidate&&this.dates.clear(),this.dates.push(t)),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(t,e){e&&"date"!==e||this._toggle_multidate(t&&new Date(t)),(!e&&this.o.updateViewDate||"view"===e)&&(this.viewDate=t&&new Date(t)),this.fill(),this.setValue(),e&&"view"===e||this._trigger("changeDate"),this.inputField.trigger("change"),!this.o.autoclose||e&&"date"!==e||this.hide()},moveDay:function(t,e){var n=new Date(t);return n.setUTCDate(t.getUTCDate()+e),n},moveWeek:function(t,e){return this.moveDay(t,7*e)},moveMonth:function(t,e){if(!(n=t)||isNaN(n.getTime()))return this.o.defaultViewDate;var n;if(!e)return t;var r,i,o=new Date(t.valueOf()),a=o.getUTCDate(),s=o.getUTCMonth(),l=Math.abs(e);if(e=0<e?1:-1,1===l)i=-1===e?function(){return o.getUTCMonth()===s}:function(){return o.getUTCMonth()!==r},r=s+e,o.setUTCMonth(r),r=(r+12)%12;else{for(var u=0;u<l;u++)o=this.moveMonth(o,e);r=o.getUTCMonth(),o.setUTCDate(a),i=function(){return r!==o.getUTCMonth()}}for(;i();)o.setUTCDate(--a),o.setUTCMonth(r);return o},moveYear:function(t,e){return this.moveMonth(t,12*e)},moveAvailableDate:function(t,e,n){do{if(t=this[n](t,e),!this.dateWithinRange(t))return!1}while(n="moveDay",this.dateIsDisabled(t));return t},weekOfDateIsDisabled:function(t){return-1!==E.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(e){return this.weekOfDateIsDisabled(e)||0<E.grep(this.o.datesDisabled,function(t){return o(e,t)}).length},dateWithinRange:function(t){return t>=this.o.startDate&&t<=this.o.endDate},keydown:function(t){if(this.picker.is(":visible")){var e,n,r=!1,i=this.focusDate||this.viewDate;switch(t.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),t.preventDefault(),t.stopPropagation();break;case 37:case 38:case 39:case 40:this.o.keyboardNavigation&&7!==this.o.daysOfWeekDisabled.length&&(e=37===t.keyCode||38===t.keyCode?-1:1,0===this.viewMode?t.ctrlKey?(n=this.moveAvailableDate(i,e,"moveYear"))&&this._trigger("changeYear",this.viewDate):t.shiftKey?(n=this.moveAvailableDate(i,e,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===t.keyCode||39===t.keyCode?n=this.moveAvailableDate(i,e,"moveDay"):this.weekOfDateIsDisabled(i)||(n=this.moveAvailableDate(i,e,"moveWeek")):1===this.viewMode?(38!==t.keyCode&&40!==t.keyCode||(e*=4),n=this.moveAvailableDate(i,e,"moveMonth")):2===this.viewMode&&(38!==t.keyCode&&40!==t.keyCode||(e*=4),n=this.moveAvailableDate(i,e,"moveYear")),n)&&(this.focusDate=this.viewDate=n,this.setValue(),this.fill(),t.preventDefault());break;case 13:this.o.forceParse&&(i=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(i),r=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible"))&&(t.preventDefault(),t.stopPropagation(),this.o.autoclose)&&this.hide();break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}r&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))}else 40!==t.keyCode&&27!==t.keyCode||(this.show(),t.stopPropagation())},setViewMode:function(t){this.viewMode=t,this.picker.children("div").hide().filter(".datepicker-"+I.viewModes[this.viewMode].clsName).show(),this.updateNavArrows(),this._trigger("changeViewMode",new Date(this.viewDate))}},(l=function(t,e){E.data(t,"datepicker",this),this.element=E(t),this.inputs=E.map(e.inputs,function(t){return t.jquery?t[0]:t}),delete e.inputs,this.keepEmptyValues=e.keepEmptyValues,delete e.keepEmptyValues,a.call(E(this.inputs),e).on("changeDate",E.proxy(this.dateUpdated,this)),this.pickers=E.map(this.inputs,function(t){return E.data(t,"datepicker")}),this.updateDates()}).prototype={updateDates:function(){this.dates=E.map(this.pickers,function(t){return t.getUTCDate()}),this.updateRanges()},updateRanges:function(){var n=E.map(this.dates,function(t){return t.valueOf()});E.each(this.pickers,function(t,e){e.setRange(n)})},clearDates:function(){E.each(this.pickers,function(t,e){e.clearDates()})},dateUpdated:function(t){if(!this.updating){this.updating=!0;var n=E.data(t.target,"datepicker");if(n!==S){var r=n.getUTCDate(),i=this.keepEmptyValues,t=E.inArray(t.target,this.inputs),e=t-1,o=t+1,a=this.inputs.length;if(-1!==t){if(E.each(this.pickers,function(t,e){e.getUTCDate()||e!==n&&i||e.setUTCDate(r)}),r<this.dates[e])for(;0<=e&&r<this.dates[e];)this.pickers[e--].setUTCDate(r);else if(r>this.dates[o])for(;o<a&&r>this.dates[o];)this.pickers[o++].setUTCDate(r);this.updateDates(),delete this.updating}}}},destroy:function(){E.map(this.pickers,function(t){t.destroy()}),E(this.inputs).off("changeDate",this.dateUpdated),delete this.element.data().datepicker},remove:n("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")},i=E.fn.datepicker,a=function(o){var a,s=Array.apply(null,arguments);if(s.shift(),this.each(function(){var t,e,n=E(this),r=n.data("datepicker"),i="object"==typeof o&&o;r||(t=((t,e)=>{var n,r,i=E(t).data(),o={},a=new RegExp("^"+e.toLowerCase()+"([A-Z])");function s(t,e){return e.toLowerCase()}for(r in e=new RegExp("^"+e.toLowerCase()),i)e.test(r)&&(n=r.replace(a,s),o[n]=i[r]);return o})(this,"date"),e=(t=>{var n,r={};if(A[t]||(t=t.split("-")[0],A[t]))return n=A[t],E.each(c,function(t,e){e in n&&(r[e]=n[e])}),r})(E.extend({},u,t,i).language),e=E.extend({},u,e,t,i),r=new(n.hasClass("input-daterange")||e.inputs?(E.extend(e,{inputs:e.inputs||n.find("input").toArray()}),l):T)(this,e),n.data("datepicker",r)),"string"==typeof o&&"function"==typeof r[o]&&(a=r[o].apply(r,s))}),a===S||a instanceof T||a instanceof l)return this;if(1<this.length)throw new Error("Using only allowed for the collection of a single element ("+o+" function)");return a},E.fn.datepicker=a,u=E.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:E.noop,beforeShowMonth:E.noop,beforeShowYear:E.noop,beforeShowDecade:E.noop,beforeShowCentury:E.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0},c=E.fn.datepicker.locale_opts=["format","rtl","weekStart"],E.fn.datepicker.Constructor=T,A=E.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},(I={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1e3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(t){if("function"==typeof t.toValue&&"function"==typeof t.toDisplay)return t;var e=t.replace(this.validParts,"\0").split("\0"),t=t.match(this.validParts);if(e&&e.length&&t&&0!==t.length)return{separators:e,parts:t};throw new Error("Invalid date format.")},parseDate:function(t,e,n,r){if(!t)return S;if(!(t instanceof Date)){if((e="string"==typeof e?I.parseFormat(e):e).toValue)return e.toValue(t,e,n);var i,o,a,s={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},l={yesterday:"-1d",today:"+0d",tomorrow:"+1d"};if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(t=t in l?l[t]:t)){for(h=t.match(/([\-+]\d+)([dmwy])/gi),t=new Date,v=0;v<h.length;v++)i=h[v].match(/([\-+]\d+)([dmwy])/i),o=Number(i[1]),a=s[i[2].toLowerCase()],t=T.prototype[a](t,o);return T.prototype._zero_utc_time(t)}var u,c,h=t&&t.match(this.nonpunctuation)||[],d={},p=["yyyy","yy","M","MM","m","mm","d","dd"],f={yyyy:function(t,e){return t.setUTCFullYear(r?(!0===(t=r)&&(t=10),(n=e)<100&&(n+=2e3)>(new Date).getFullYear()+t&&(n-=100),n):e);var n},m:function(t,e){if(!isNaN(t)){for(--e;e<0;)e+=12;for(t.setUTCMonth(e%=12);t.getUTCMonth()!==e;)t.setUTCDate(t.getUTCDate()-1)}return t},d:function(t,e){return t.setUTCDate(e)}},g=(f.yy=f.yyyy,f.M=f.MM=f.mm=f.m,f.dd=f.d,t=C(),e.parts.slice());if(h.length!==g.length&&(g=E(g).filter(function(t,e){return-1!==E.inArray(e,p)}).toArray()),h.length===g.length){for(var m,y,v=0,_=g.length;v<_;v++){if(u=parseInt(h[v],10),i=g[v],isNaN(u))switch(i){case"MM":c=E(A[n].months).filter(w),u=E.inArray(c[0],A[n].months)+1;break;case"M":c=E(A[n].monthsShort).filter(w),u=E.inArray(c[0],A[n].monthsShort)+1}d[i]=u}for(v=0;v<p.length;v++)(y=p[v])in d&&!isNaN(d[y])&&(m=new Date(t),f[y](m,d[y]),isNaN(m)||(t=m))}}return t;function w(){var t=this.slice(0,h[v].length),e=h[v].slice(0,t.length);return t.toLowerCase()===e.toLowerCase()}},formatDate:function(t,e,n){if(!t)return"";if((e="string"==typeof e?I.parseFormat(e):e).toDisplay)return e.toDisplay(t,e,n);for(var r={d:t.getUTCDate(),D:A[n].daysShort[t.getUTCDay()],DD:A[n].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:A[n].monthsShort[t.getUTCMonth()],MM:A[n].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()},i=(r.dd=(r.d<10?"0":"")+r.d,r.mm=(r.m<10?"0":"")+r.m,t=[],E.extend([],e.separators)),o=0,a=e.parts.length;o<=a;o++)i.length&&t.push(i.shift()),t.push(r[e.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">'+u.templates.leftArrow+'</th><th colspan="5" class="datepicker-switch"></th><th class="next">'+u.templates.rightArrow+"</th></tr></thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'}).template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+I.headTemplate+"<tbody></tbody>"+I.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+I.headTemplate+I.contTemplate+I.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+I.headTemplate+I.contTemplate+I.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+I.headTemplate+I.contTemplate+I.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+I.headTemplate+I.contTemplate+I.footTemplate+"</table></div></div>",E.fn.datepicker.DPGlobal=I,E.fn.datepicker.noConflict=function(){return E.fn.datepicker=i,this},E.fn.datepicker.version="1.9.0",E.fn.datepicker.deprecated=function(t){var e=window.console;e&&e.warn&&e.warn("DEPRECATED: "+t)},E(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var e=E(this);e.data("datepicker")||(t.preventDefault(),a.call(e,"show"))}),E(function(){a.call(E('[data-provide="datepicker-inline"]'))})});class ll extends cs{static get selector(){return'.question input[type="date"]'}static condition(){return!ys.touch||!ys.inputTypes.date}_init(){this.settings=this.props.appearances.includes("year")?{format:"yyyy",startView:"decade",minViewMode:"years"}:this.props.appearances.includes("month-year")?{format:"yyyy-mm",startView:"year",minViewMode:"months"}:{format:"yyyy-mm-dd",startView:"month",minViewMode:"days"},this.$fakeDateI=this._createFakeDateInput(this.settings.format),this._setChangeHandler(this.$fakeDateI),this._setFocusHandler(this.$fakeDateI),this._setResetHandler(this.$fakeDateI),this.enable(),this.value=this.element.value,this.props.readonly&&this.disable()}_createFakeDateInput(t){var e=m(this.element),t=m(`<div class="widget date"><input class="ignore input-small" type="text" placeholder="${t}" /></div>`).append(this.resetButtonHtml),n=t.find("input");return e.hide().before(t),n}_setChangeHandler(r){let i=this.settings;r.on("change paste",t=>{let e="";var n="paste"===t.type?Ne(t):this.value;return 0<n.length&&(e=xe(n)&&"yyyy"!==i.format?"":(n=this._toActualDate(n),Qe.date.convert(n))),r.val(this._toDisplayDate(e)).datepicker("update"),""===e&&"paste"===t.type&&t.stopImmediatePropagation(),this.originalInputValue!==e&&(this.originalInputValue=e),!1})}_setResetHandler(t){t.next(".btn-reset").on("click",()=>{this.originalInputValue&&(this.value="")})}_setFocusHandler(t){m(this.element).on("applyfocus",()=>{t[0].focus()})}_toActualDate(t=""){return(t=t.trim())&&"yyyy"===this.settings.format&&t.length<5?t+"-01-01":t&&"yyyy-mm"===this.settings.format&&t.length<8?t+"-01":t}_toDisplayDate(t=""){return(t=t.trim())&&"yyyy"===this.settings.format?t.substring(0,4):"yyyy-mm"===this.settings.format?t.substring(0,7):t}disable(){this.$fakeDateI.datepicker("destroy"),this.$fakeDateI.prop("disabled",!0),this.$fakeDateI.next(".btn-reset").prop("disabled",!0)}enable(){this.$fakeDateI.datepicker({format:this.settings.format,autoclose:!0,todayHighlight:!0,startView:this.settings.startView,minViewMode:this.settings.minViewMode,forceParse:!1}),this.$fakeDateI.prop("disabled",!1),this.$fakeDateI.next(".btn-reset").prop("disabled",!1)}update(){this.value=this.element.value}get displayedValue(){return this.question.querySelector(".widget input").value}get value(){return this._toActualDate(this.displayedValue)}set value(t){this.$fakeDateI[0].disabled?this.$fakeDateI[0].value=this._toDisplayDate(t):this.$fakeDateI.datepicker("setDate",this._toDisplayDate(t))}}class ul extends cs{static get selector(){return'.or-appearance-month-year input[type="date"]'}static condition(t){return!qe.has(t,"DatepickerExtended")&&ys.touch&&ys.inputTypes.month}_init(){this.element.classList.add("hide");var t=document.createRange().createContextualFragment('<input class="ignore widget datepicker-mobile" type="month"/>');this.element.after(t),this.widgetInput=this.question.querySelector("input.widget"),this.value=this.originalInputValue,this.widgetInput.addEventListener("change",()=>{this.originalInputValue=this.value})}get value(){return this.widgetInput.value?this.widgetInput.value+"-01":""}set value(t){t=t?t.substring(0,t.lastIndexOf("-")):"";this.widgetInput.value=t}update(){this.value=this.originalInputValue}}function cl(t,e){this.widget="",this.$element=Ks(t),this.defaultTime=e.defaultTime,this.disableFocus=e.disableFocus,this.disableMousewheel=e.disableMousewheel,this.isOpen=e.isOpen,this.minuteStep=e.minuteStep,this.orientation=e.orientation,this.secondStep=e.secondStep,this.snapToStep=e.snapToStep,this.showInputs=e.showInputs,this.showMeridian=e.showMeridian,this.meridianNotation=e.meridianNotation,this.showSeconds=e.showSeconds,this.template=e.template,this.appendWidgetTo=e.appendWidgetTo,this.showWidgetOnAddonClick=e.showWidgetOnAddonClick,this.icons=e.icons,this.maxHours=e.maxHours,this.explicitMode=e.explicitMode,this.handleDocumentClick=t=>{var e=t.data.scope;e.$element.parent().find(t.target).length||e.$widget.is(t.target)||e.$widget.find(t.target).length||e.hideWidget()},this._init()}Ks=m,Xs=window,Zs=document,cl.prototype={constructor:cl,_init(){let t=this;this.showWidgetOnAddonClick&&this.$element.parent().hasClass("input-group")&&this.$element.parent().hasClass("timepicker")?(this.$element.parent(".input-group.timepicker").find(".input-group-addon").on({"click.timepicker":Ks.proxy(this.showWidget,this)}),this.$element.on({"focus.timepicker":Ks.proxy(this.highlightUnit,this),"click.timepicker":Ks.proxy(this.highlightUnit,this),"keydown.timepicker":Ks.proxy(this.elementKeydown,this),"blur.timepicker":Ks.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":Ks.proxy(this.mousewheel,this)})):this.template?this.$element.on({"focus.timepicker":Ks.proxy(this.showWidget,this),"click.timepicker":Ks.proxy(this.showWidget,this),"blur.timepicker":Ks.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":Ks.proxy(this.mousewheel,this)}):this.$element.on({"focus.timepicker":Ks.proxy(this.highlightUnit,this),"click.timepicker":Ks.proxy(this.highlightUnit,this),"keydown.timepicker":Ks.proxy(this.elementKeydown,this),"blur.timepicker":Ks.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":Ks.proxy(this.mousewheel,this)}),!1!==this.template?this.$widget=Ks(this.getTemplate()).on("click",Ks.proxy(this.widgetClick,this)):this.$widget=!1,this.showInputs&&!1!==this.$widget&&this.$widget.find("input").each(function(){Ks(this).on({"click.timepicker":function(){Ks(this).select()},"keydown.timepicker":Ks.proxy(t.widgetKeydown,t),"keyup.timepicker":Ks.proxy(t.widgetKeyup,t)})}),this.setDefaultTime(this.defaultTime)},blurElement(){this.highlightedUnit=null,this.updateFromElementVal()},clear(){this.hour="",this.minute="",this.second="",this.meridian="",this.$element.val("")},decrementHour(){if(""===this.hour&&(this.hour=this.getCurrentHour(),this.incrementHour()),this.showMeridian)if(1===this.hour)this.hour=12;else{if(12===this.hour)return this.hour--,this.toggleMeridian();{if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}}else this.hour<=0?this.hour=this.maxHours-1:this.hour--},decrementMinute(t){let e;""===this.minute&&(this.minute=this.getCurrentMinute(),this.incrementMinute()),(e=t?this.minute-t:this.minute-this.minuteStep)<0?(this.decrementHour(),this.minute=e+60):this.minute=e},decrementSecond(){var t=this.second-this.secondStep;t<0?(this.decrementMinute(!0),this.second=60+t):this.second=t},elementKeydown(t){switch(t.which){case 9:if(t.shiftKey){if("hour"===this.highlightedUnit){this.hideWidget();break}this.highlightPrevUnit()}else{if(this.showMeridian&&"meridian"===this.highlightedUnit||this.showSeconds&&"second"===this.highlightedUnit||!this.showMeridian&&!this.showSeconds&&"minute"===this.highlightedUnit){this.hideWidget();break}this.highlightNextUnit()}t.preventDefault(),this.updateFromElementVal();break;case 27:this.updateFromElementVal();break;case 37:t.preventDefault(),this.highlightPrevUnit(),this.updateFromElementVal();break;case 38:switch(t.preventDefault(),this.highlightedUnit){case"hour":this.incrementHour(),this.highlightHour();break;case"minute":this.incrementMinute(),this.highlightMinute();break;case"second":this.incrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 39:t.preventDefault(),this.highlightNextUnit(),this.updateFromElementVal();break;case 40:switch(t.preventDefault(),this.highlightedUnit){case"hour":this.decrementHour(),this.highlightHour();break;case"minute":this.decrementMinute(),this.highlightMinute();break;case"second":this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update()}},getCursorPosition(){var t,e,n=this.$element.get(0);return"selectionStart"in n?n.selectionStart:Zs.selection?(n.focus(),t=Zs.selection.createRange(),e=Zs.selection.createRange().text.length,t.moveStart("character",-n.value.length),t.text.length-e):void 0},getMeridianLength(){var t=Zs.createElement("span"),e=(t.textContent=this.meridianNotation.am,t.style.position="absolute",Zs.querySelector("body").appendChild(t),t.scrollWidth),n=(t.textContent=this.meridianNotation.pm,t.scrollWidth);return t.remove(),n<e?e:n},getTemplate(){let t,e,n,r,i,o;var a;return i=this.showInputs?(a=26<this.getMeridianLength()?`style="width: ${this.getMeridianLength()+24}px"`:"",e=`<input type="text" class="timepicker-hour" ${a}/>`,n=`<input type="text" class="timepicker-minute" ${a}/>`,r=`<input type="text" class="timepicker-second" ${a}/>`,`<input type="text" class="timepicker-meridian"${a}/>`):(e='<span class="timepicker-hour"></span>',n='<span class="timepicker-minute"></span>',r='<span class="timepicker-second"></span>','<span class="timepicker-meridian"></span>'),o=`<table><tr><td><a href="#" data-action="incrementHour"><span class="${this.icons.up}"></span></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><span class="${this.icons.up}"></span></a></td>${this.showSeconds?`<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><span class="${this.icons.up}"></span></a></td>`:""}${this.showMeridian?`<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><span class="${this.icons.up}"></span></a></td>`:""}</tr><tr><td>${e}</td> <td class="separator">:</td><td>${n}</td> ${this.showSeconds?`<td class="separator">:</td><td>${r}</td>`:""}${this.showMeridian?`<td class="separator">&nbsp;</td><td>${i}</td>`:""}</tr><tr><td><a href="#" data-action="decrementHour"><span class="${this.icons.down}"></span></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><span class="${this.icons.down}"></span></a></td>${this.showSeconds?`<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><span class="${this.icons.down}"></span></a></td>`:""}${this.showMeridian?`<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><span class="${this.icons.down}"></span></a></td>`:""}</tr></table>`,t="dropdown"===this.template?`<div class="timepicker-widget dropdown-menu">${o}</div>`:t},getTime(){return""===this.hour?"":`${1===this.hour.toString().length?"0"+this.hour:this.hour}:`+(1===this.minute.toString().length?"0"+this.minute:this.minute)+(this.showSeconds?":"+(1===this.second.toString().length?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget(){!1!==this.isOpen&&(this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.$widget.removeClass("open"),Ks(Zs).off("mousedown.timepicker, touchend.timepicker",this.handleDocumentClick),this.isOpen=!1,this.$widget.detach())},highlightUnit(){this.position=this.getCursorPosition(),0<=this.position&&this.position<=2?this.highlightHour():3<=this.position&&this.position<=5?this.highlightMinute():6<=this.position&&this.position<=8?this.showSeconds?this.highlightSecond():this.highlightMeridian():9<=this.position&&this.position<=11&&this.highlightMeridian()},highlightNextUnit(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"second":this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"meridian":this.highlightHour()}},highlightPrevUnit(){switch(this.highlightedUnit){case"hour":this.showMeridian?this.highlightMeridian():this.showSeconds?this.highlightSecond():this.highlightMinute();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour(){let t=this.$element.get(0),e=this;this.highlightedUnit="hour",t.setSelectionRange&&setTimeout(()=>{e.hour<10?t.setSelectionRange(0,1):t.setSelectionRange(0,2)},0)},highlightMinute(){let t=this.$element.get(0),e=this;this.highlightedUnit="minute",t.setSelectionRange&&setTimeout(()=>{e.hour<10?t.setSelectionRange(2,4):t.setSelectionRange(3,5)},0)},highlightSecond(){let t=this.$element.get(0),e=this;this.highlightedUnit="second",t.setSelectionRange&&setTimeout(()=>{e.hour<10?t.setSelectionRange(5,7):t.setSelectionRange(6,8)},0)},highlightMeridian(){let t=this.$element.get(0),e=this;this.highlightedUnit="meridian",t.setSelectionRange&&(this.showSeconds?setTimeout(()=>{e.hour<10?t.setSelectionRange(8,10):t.setSelectionRange(9,11)},0):setTimeout(()=>{e.hour<10?t.setSelectionRange(5,7):t.setSelectionRange(6,8)},0))},getCurrentHour(){var t=(new Date).getHours();return this.showMeridian?t%12:t},getCurrentMinute(){return(new Date).getMinutes()},incrementHour(){if(""===this.hour&&(this.hour=this.getCurrentHour(),this.decrementHour()),this.showMeridian){if(11===this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}this.hour===this.maxHours-1?this.hour=0:this.hour++},incrementMinute(t){let e;""===this.minute&&(this.minute=this.getCurrentMinute(),this.decrementMinute()),59<(e=t?this.minute+t:this.minute+this.minuteStep-this.minute%this.minuteStep)?(this.incrementHour(),this.minute=e-60):this.minute=e},incrementSecond(){var t=this.second+this.secondStep-this.second%this.secondStep;59<t?(this.incrementMinute(!0),this.second=t-60):this.second=t},mousewheel(e){if(!this.disableMousewheel){e.preventDefault(),e.stopPropagation();var n=e.originalEvent.wheelDelta||-e.originalEvent.detail;let t=null;switch("mousewheel"===e.type?t=-1*e.originalEvent.wheelDelta:"DOMMouseScroll"===e.type&&(t=40*e.originalEvent.detail),t&&(e.preventDefault(),Ks(this).scrollTop(t+Ks(this).scrollTop())),this.highlightedUnit){case"minute":0<n?this.incrementMinute():this.decrementMinute(),this.highlightMinute();break;case"second":0<n?this.incrementSecond():this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian();break;default:0<n?this.incrementHour():this.decrementHour(),this.highlightHour()}return!1}},changeToNearestStep(t,e){return t%e==0?t:Math.round(t%e/e)?(t+(e-t%e))%60:t-t%e},place(){if(!this.isInline){var o=this.$widget.outerWidth(),a=this.$widget.outerHeight(),s=Ks(Xs).width(),l=Ks(Xs).height(),u=Ks(Xs).scrollTop(),c=parseInt(this.$element.parents().filter(function(){return"auto"!==Ks(this).css("z-index")}).first().css("z-index"),10)+10,h=(this.component?this.component.parent():this.$element).offset(),d=this.component?this.component.outerHeight(!0):this.$element.outerHeight(!1),p=this.component?this.component.outerWidth(!0):this.$element.outerWidth(!1);let t=h.left,e=h.top,n=(this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left"),"auto"!==this.orientation.x?(this.$widget.addClass("timepicker-orient-"+this.orientation.x),"right"===this.orientation.x&&(t-=o-p)):(this.$widget.addClass("timepicker-orient-left"),h.left<0?t-=h.left-10:h.left+o>s&&(t=s-o-10)),this.orientation.y),r,i;"auto"===n&&(r=-u+h.top-a,i=u+l-(h.top+d+a),n=Math.max(r,i)===i?"top":"bottom"),this.$widget.addClass("timepicker-orient-"+n),"top"===n?e+=d:e-=a+parseInt(this.$widget.css("padding-top"),10),this.$widget.css({top:e,left:t,zIndex:c})}},remove(){Ks("document").off(".timepicker"),this.$widget&&this.$widget.remove(),delete this.$element.data().timepicker},setDefaultTime(t){if(this.$element.val())this.updateFromElementVal();else if("current"===t){var i=new Date;let t=i.getHours(),e=i.getMinutes(),n=i.getSeconds(),r=this.meridianNotation.am;0!==n&&60===(n=Math.ceil(i.getSeconds()/this.secondStep)*this.secondStep)&&(e+=1,n=0),0!==e&&60===(e=Math.ceil(i.getMinutes()/this.minuteStep)*this.minuteStep)&&(t+=1,e=0),this.showMeridian&&(0===t?t=12:r=12<=t?(12<t&&(t-=12),this.meridianNotation.pm):this.meridianNotation.am),this.hour=t,this.minute=e,this.second=n,this.meridian=r,this.update()}else!1===t?(this.hour=0,this.minute=0,this.second=0,this.meridian=this.meridianNotation.am):this.setTime(t)},setTime(a,s){if(a){let t,e,n,r,i,o;if("object"==typeof a&&a.getMonth)n=a.getHours(),r=a.getMinutes(),i=a.getSeconds(),this.showMeridian&&(o=this.meridianNotation.am,12<n&&(o=this.meridianNotation.pm,n%=12),12===n)&&(o=this.meridianNotation.pm);else{var l=this.showMeridian?this.meridianNotation.am:"am",u=this.showMeridian?this.meridianNotation.pm:"pm";if(2<(t=(new RegExp(l,"i").test(a)?1:0)+(new RegExp(u,"i").test(a)?2:0)))return void this.clear();if(e=a.replace(/[^0-9:]/g,"").split(":"),n=(e[0]||e).toString(),this.explicitMode&&2<n.length&&n.length%2!=0)return void this.clear();r=e[1]?e[1].toString():"",i=e[2]?e[2].toString():"",4<n.length&&(i=n.slice(-2),n=n.slice(0,-2)),2<n.length&&(r=n.slice(-2),n=n.slice(0,-2)),2<r.length&&(i=r.slice(-2),r=r.slice(0,-2)),n=parseInt(n,10),r=parseInt(r,10),i=parseInt(i,10),isNaN(n)&&(n=0),isNaN(r)&&(r=0),59<(i=isNaN(i)?0:i)&&(i=59),59<r&&(r=59),n>=this.maxHours&&(n=this.maxHours-1),this.showMeridian?(12<=n&&(t=t||2,n-=12),t=t||1,0===n&&(n=12),o=1===t?this.meridianNotation.am:this.meridianNotation.pm):n<12&&2===t?n+=12:n>=this.maxHours?n=this.maxHours-1:(n<0||12===n&&1===t)&&(n=0)}this.hour=n,this.snapToStep?(this.minute=this.changeToNearestStep(r,this.minuteStep),this.second=this.changeToNearestStep(i,this.secondStep)):(this.minute=r,this.second=i),this.meridian=o,this.update(s)}else this.clear()},showWidget(){this.isOpen||this.$element.is(":disabled")||(this.setTime(this.$element.val()),this.updateWidget(),this.$widget.appendTo(this.appendWidgetTo),Ks(Zs).on("mousedown.timepicker, touchend.timepicker",{scope:this},this.handleDocumentClick),this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.place(),this.disableFocus&&this.$element.blur(),""===this.hour&&this.defaultTime&&this.setDefaultTime(this.defaultTime),!1===this.isOpen&&this.$widget.addClass("open"),this.isOpen=!0)},toggleMeridian(){this.meridian=this.meridian===this.meridianNotation.am?this.meridianNotation.pm:this.meridianNotation.am},update(t){this.updateElement(),t||this.updateWidget(),this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement(){this.$element.val(this.getTime()),this.$element[0].dispatchEvent(E.Change())},updateFromElementVal(){this.setTime(this.$element.val())},updateWidget(){var t,e,n;!1!==this.$widget&&(t=this.hour,e=1===this.minute.toString().length?"0"+this.minute:this.minute,n=1===this.second.toString().length?"0"+this.second:this.second,this.showInputs?(this.$widget.find("input.timepicker-hour").val(t),this.$widget.find("input.timepicker-minute").val(e),this.showSeconds&&this.$widget.find("input.timepicker-second").val(n),this.showMeridian&&this.$widget.find("input.timepicker-meridian").val(this.meridian)):(this.$widget.find("span.timepicker-hour").text(t),this.$widget.find("span.timepicker-minute").text(e),this.showSeconds&&this.$widget.find("span.timepicker-second").text(n),this.showMeridian&&this.$widget.find("span.timepicker-meridian").text(this.meridian)))},updateFromWidgetInputs(){var t;!1!==this.$widget&&(t=this.$widget.find("input.timepicker-hour").val()+":"+this.$widget.find("input.timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.timepicker-meridian").val():""),this.setTime(t,!0))},widgetClick(t){t.stopPropagation(),t.preventDefault();var t=Ks(t.target),e=t.closest("a").data("action");e&&this[e](),this.update(),t.is("input")&&t.get(0).setSelectionRange(0,2)},widgetKeydown(t){var e=Ks(t.target),n=e.attr("class").replace("timepicker-","");switch(t.which){case 9:if(t.shiftKey){if("hour"===n)return this.hideWidget()}else if(this.showMeridian&&"meridian"===n||this.showSeconds&&"second"===n||!this.showMeridian&&!this.showSeconds&&"minute"===n)return this.hideWidget();break;case 27:this.hideWidget();break;case 38:switch(t.preventDefault(),n){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),e.get(0).setSelectionRange(0,2);break;case 40:switch(t.preventDefault(),n){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),e.get(0).setSelectionRange(0,2)}},widgetKeyup(t){(65===t.which||77===t.which||80===t.which||46===t.which||8===t.which||48<=t.which&&t.which<=57||96<=t.which&&t.which<=105)&&this.updateFromWidgetInputs()}},Ks.fn.timepicker=function(r){let i=Array(...arguments);return i.shift(),this.each(function(){var t=Ks(this);let e=t.data("timepicker");var n="object"==typeof r&&r;e||t.data("timepicker",e=new cl(this,Ks.extend({},Ks.fn.timepicker.defaults,n,Ks(this).data()))),"string"==typeof r&&e[r](...i)})},Ks.fn.timepicker.defaults={defaultTime:"current",disableFocus:!1,disableMousewheel:!1,isOpen:!1,minuteStep:15,orientation:{x:"auto",y:"auto"},secondStep:15,snapToStep:!1,showSeconds:!1,showInputs:!0,showMeridian:!0,meridianNotation:{am:"AM",pm:"PM"},template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:!0,icons:{up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},maxHours:24,explicitMode:!1},Ks.fn.timepicker.Constructor=cl,Ks(Zs).on("focus.timepicker.data-api click.timepicker.data-api",'[data-provide="timepicker"]',function(t){var e=Ks(this);e.data("timepicker")||(t.preventDefault(),e.timepicker())});class hl extends cs{static get selector(){return'.question input[type="time"]:not([readonly])'}static condition(){return!ys.touch||!ys.inputTypes.time}_init(){var t=document.createRange().createContextualFragment(`<div class="widget timepicker">
                <input class="ignore timepicker-default" type="text" placeholder="hh:mm" />
            </div>`),t=(t.querySelector(".widget").append(this.resetButtonHtml),this.element.classList.add("hide"),this.element.before(t),this.question.querySelector(".widget > .btn-reset"));this.fakeTimeI=this.question.querySelector(".widget > input"),m(this.fakeTimeI).timepicker({showMeridian:Ye.hour12,meridianNotation:{am:Ye.amNotation,pm:Ye.pmNotation}}),this.value=this.originalInputValue,this.fakeTimeI.addEventListener("change",()=>{var t=Ye.hour12?Qe.time.convertMeridian(this.value):this.value;this.originalInputValue=t}),t.addEventListener("click",this._reset.bind(this)),this.element.addEventListener(E.ApplyFocus().type,()=>{this.fakeTimeI.focus()})}_reset(){var t=this.originalInputValue?E.Change():null;(t||this.value)&&(this.value="",this.fakeTimeI.dispatchEvent(t))}update(){this.element.value!==this.value&&this.fakeTimeI&&m(this.fakeTimeI).timepicker("setTime",this.element.value)}get value(){return this.fakeTimeI.value}set value(t){m(this.fakeTimeI).timepicker("setTime",t)}}class dl extends cs{static get selector(){return'.question input[type="datetime-local"]:not([readonly])'}static condition(){return!ys.touch||!ys.inputTypes["datetime-local"]}_init(){this.$fakeDateI=this._createFakeDateInput(),this.$fakeTimeI=this._createFakeTimeInput(),this.element.classList.add("hide"),this.element.before(document.createRange().createContextualFragment('<div class="datetimepicker widget" />'));var t=this.question.querySelector(".widget");t.append(this.$fakeDateI[0].closest(".date")),t.append(this.$fakeTimeI[0].closest(".timepicker")),this.$fakeDateI.datepicker({format:"yyyy-mm-dd",autoclose:!0,todayHighlight:!0,forceParse:!1}),this.$fakeTimeI.timepicker({showMeridian:Ye.hour12,meridianNotation:{am:Ye.amNotation,pm:Ye.pmNotation}}),this.value=this.originalInputValue,this._setFocusHandler(this.$fakeDateI.add(this.$fakeTimeI)),this.$fakeDateI.on("change changeDate",()=>(Qe.date.validate(this.$fakeDateI[0].value)||this.$fakeDateI.val("").datepicker("update"),this.originalInputValue=this.value,!1)),this.$fakeTimeI.on("change",()=>(this.originalInputValue=this.value,!1)),this.question.querySelector(".btn-reset").addEventListener("click",()=>{var t=this.originalInputValue?"change":"";(t||this.$fakeDateI.val()||this.$fakeTimeI.val())&&(this.$fakeDateI.val("").trigger(t).datepicker("update"),this.$fakeTimeI.val("").trigger(t))})}_createFakeDateInput(){return m('<div class="date"><input class="ignore" type="text" placeholder="yyyy-mm-dd"/></div>').find("input")}_createFakeTimeInput(){return m(`<div class="timepicker">
                    <input class="ignore timepicker-default" type="text" placeholder="hh:mm"/>
                </div>`).append(this.resetButtonHtml).find("input")}_setFocusHandler(t){this.element.addEventListener(E.ApplyFocus().type,()=>{t.eq(0).focus()})}update(){var t,e=m(this.element);let n=0<e.val().length?new Date(e.val()).toISOLocalString():"";(n=ps.macos&&fs.safari?0<e.val().length?new Date(e.val()+(new Date).timezoneOffsetAsTime()).toISOLocalString():"":n)!==this.value&&(t=(e=n.split("T"))[0],e=e[1]&&4<e[1].length?e[1].substring(0,5):"",this.$fakeDateI.datepicker("setDate",t),this.$fakeTimeI.timepicker("setTime",e))}get value(){var t,e;return 0<this.$fakeDateI.val().length&&3<this.$fakeTimeI.val().length?(t=this.$fakeDateI.val().split("-"),e=(Ye.hour12?Qe.time.convertMeridian(this.$fakeTimeI.val()):this.$fakeTimeI.val()).split(":"),new Date(t[0],t[1]-1,t[2],e[0],e[1]).toISOLocalString()):""}set value(t){var t=(t?new Date(t).toISOLocalString():"").split("T"),e=t[0],t=t[1]&&4<t[1].length?t[1].substring(0,5):e&&!t[1]?"00:00":"";this.$fakeDateI.datepicker("setDate",e),this.$fakeTimeI.timepicker("setTime",t)}}class pl extends cs{static get selector(){return'.question input[type="date"],.question input[type="datetime-local"]'}static condition(t){return!qe.has(t,"DatepickerExtended")&&!qe.has(t,"DatetimepickerExtended")&&!ys.touch}_init(){this.element.type="text",this.element.classList.add("mask-date")}}class fl extends cs{static get selector(){return".or-appearance-no-buttons"}_init(){this.element.querySelectorAll(".option-label").forEach(function(t){Me(t,"img, video, audio")&&(t.style.display="none")}),m(this.element).find(".itemset-template").each(function(){m(this).css("display","none")})}}let gl=/[a-zA-Z0-9+-.]+?:\/\//,ml={init:()=>Promise.resolve(!0),isWaitingForPermissions:()=>!1,getFileUrl:n=>new Promise((e,t)=>{n?"string"==typeof n?n.startsWith("http")?e(n):V.isSupported().then(t=>{t&&(t=window.gLoadedInstanceID,V.getFile(n,t).then(function(t){e(t||location.origin+"/"+n)}))}):"object"==typeof n?n.type.startsWith("image")||n.type.startsWith("audio")||n.type.startsWith("video")?ml.isTooLarge(n)?t(new Error(C("filepicker.toolargeerror",{maxSize:ml.getMaxSizeReadable()}))):e(URL.createObjectURL(n)):e(null):t(new Error("Unknown error occurred")):e(null)}),getObjectUrl:t=>ml.getFileUrl(t).then(t=>/https?:\/\//.test(t)?ml.urlToBlob(t).then(URL.createObjectURL):t),urlToBlob:e=>{let n=new XMLHttpRequest;return new Promise(t=>{n.open("GET",e),n.responseType="blob",n.onload=()=>{t(n.response)},n.send()})},getCurrentFiles:()=>{let n=[];return m("form.or").find('input[type="file"]:not(.ignore), input[type="text"][data-drawing="true"]').each(function(){let t=null;var e=null;"file"===this.type?t=this.files[0]:this.value&&(e=m(this).closest(".question")[0].querySelector(".draw-widget canvas"))&&!gl.test(this.value)&&((t=De(e.toDataURL())).name=this.value),t&&t.name&&(e=ke(t,this.dataset.filenamePostfix),this.dataset.resized&&this.dataset.resizedDataURI&&(t=De(this.dataset.resizedDataURI)),(t=new Blob([t],{type:t.type})).name=e,n.push(t))}),n},isTooLarge:()=>!1,getMaxSizeReadable:()=>"5MB",getDataUrl:function(t){var n;return new Promise(e=>{t?"object"==typeof t?((n=new FileReader).onload=function(t){e(t.target.result)},n.onerror=function(t){reject(void 0)},n.readAsDataURL(t)):reject(new Error("Unknown error occurred")):e(null)})}};var yl={updateDownloadLink:function(t,e,n){if(window.updateDownloadLinkIe11)return window.updateDownloadLinkIe11(...arguments);t.setAttribute("href",e||""),t.setAttribute("download",n||"")}};function vl(t,e,n){this.message=t,this.translationKey=e,this.translationOptions=n}(vl.prototype=Object.create(Error.prototype)).name="TranslatedError";class _l extends cs{static get selector(){return'.question:not(.or-appearance-draw):not(.or-appearance-signature):not(.or-appearance-annotate) input[type="file"]'}_init(){let e=this.element.getAttribute("data-loaded-file-name"),n=this;this.element.classList.add("hide"),this.question.classList.add("with-media","clearfix");var t=document.createRange().createContextualFragment(`<div class="widget file-picker">
                    <input class="ignore fake-file-input"/>
                    <div class="file-feedback"></div>
                    <div class="file-preview"></div>
                </div>`),t=(t.querySelector("input").after(this.downloadButtonHtml),t.querySelector("input").after(this.resetButtonHtml),this.element.after(t),this.disable(),this.question.querySelector(".widget"));this.feedback=t.querySelector(".file-feedback"),this.preview=t.querySelector(".file-preview"),this.fakeInput=t.querySelector(".fake-file-input"),this.downloadLink=t.querySelector(".btn-download"),this.props.readonly||n._setResetButtonListener(t.querySelector(".btn-reset")),n._setFocusListener(),this._showFileName(e),ml.isWaitingForPermissions()&&this._showFeedback(C("filepicker.waitingForPermissions"),"warning"),this._updatePlaceholder(),this.element.closest("form.or").addEventListener(E.UpdateMaxSize().type,this._updatePlaceholder.bind(this)),ml.init().then(()=>{n._showFeedback(),n._setChangeListener(),n.props.readonly||n.enable(),e&&ml.getFileUrl(e).then(t=>{n._showPreview(t,n.props.mediaType),n._updateDownloadLink(t,e)}).catch(()=>{n._showFeedback(C("filepicker.notFound",{existing:e}),"error")})}).catch(t=>{n._showFeedback(t,"error")})}_updatePlaceholder(){this.fakeInput.setAttribute("placeholder",C("filepicker.placeholder",{maxSize:ml.getMaxSizeReadable()||"?MB"}))}_setResetButtonListener(t){t&&t.addEventListener("click",()=>{(this.originalInputValue||this.value)&&ts.confirm(C("filepicker.resetWarning",{item:C("filepicker.file")})).then(t=>{t&&(this.originalInputValue="")}).catch(()=>{})})}_setChangeListener(){let o=this;m(this.element).on("click",t=>{if(o.props.readonly||"propagate"!==t.namespace)return o.fakeInput.focus(),t.stopImmediatePropagation(),!1}).on("change.propagate",e=>{let n,r;let i=this.element.getAttribute("data-loaded-file-name");var t=new Date;if("propagate"===e.namespace)return m(this.element).trigger("change.file"),!1;e.stopImmediatePropagation(),n=e.target.files[0],t=`-${t.getHours()}_${t.getMinutes()}_${t.getSeconds()}_`+t.getMilliseconds(),e.target.dataset.filenamePostfix=t,r=ke(n,t),this._resizeFile(n,o.props.mediaType).then(t=>{e.target.dataset.resized=!0,e.target.dataset.resizedDataURI=t.dataURI,n=t.blob}).catch(()=>{}).finally(()=>{ml.getFileUrl(n,r).then(t=>{o._showPreview(t,o.props.mediaType),o._showFeedback(),o._showFileName(r),i&&i!==r&&o.element.removeAttribute("data-loaded-file-name"),o._updateDownloadLink(t,r),m(o.element).trigger("change.propagate")}).catch(t=>{m(o.element).val("").trigger("change.propagate"),o._showFileName(""),o._showPreview(null),o._showFeedback(t,"error"),o._updateDownloadLink("","")})})}),this.fakeInput.addEventListener("click",t=>{t.preventDefault(),this.props.readonly||this.originalInputValue||this.value?(this.fakeInput.focus(),t.stopImmediatePropagation()):m(o.element).trigger("click.propagate")}),this.fakeInput.addEventListener("change",t=>{t.preventDefault(),t.stopPropagation()})}_setFocusListener(){this.element.addEventListener(E.ApplyFocus().type,()=>{this.fakeInput.focus()})}_showFileName(t){this.value=t,this.fakeInput.readOnly=!!t}_showFeedback(t,e){t=t instanceof vl?C(t.translationKey,t.translationOptions):t instanceof Error?t.message:t||"";e=e||"",this.feedback.textContent=t,this.feedback.setAttribute("class","file-feedback "+e)}_showPreview(t,e){let n;switch([...this.preview.children].forEach(t=>t.remove()),e){case"image/*":n="<img />";break;case"audio/*":n='<audio controls="controls"/>';break;case"video/*":n='<video controls="controls"/>';break;default:return}t&&n&&((e=document.createRange().createContextualFragment(n)).querySelector("*").src=t,this.preview.append(e))}_resizeFile(e,r){return new Promise((n,t)=>{var a,s;"image/*"!==r&&t(e),this.props&&this.props.maxPixels?(a=e,s=this.props.maxPixels,new Promise((i,t)=>{let o=new Image;o.src=URL.createObjectURL(a),o.onload=()=>{var t=o.width,e=o.height;t<=s&&e<=s&&i(a);let n,r;e<t?(r=e*(s/t),n=s):(n=t*(s/e),r=s);t=document.createElement("canvas");t.width=n,t.height=r,t.getContext("2d").drawImage(o,0,0,n,r),t.toBlob(i,a.type)},o.onerror=t}).then(t=>{let e=new FileReader;e.addEventListener("load",function(){n({blob:t,dataURI:e.result})},!1),e.readAsDataURL(t)}).catch(()=>{t(e)})):t(e)})}_updateDownloadLink(t,e){yl.updateDownloadLink(this.downloadLink,t,e)}disable(){this.element.disabled=!0,this.question.querySelector(".btn-reset").disabled=!0}enable(){this.element.disabled=!1,this.question.querySelector(".btn-reset").disabled=!1}get props(){var t=this._props;return t.mediaType=this.element.getAttribute("accept"),this.element.dataset.maxPixels&&xe(this.element.dataset.maxPixels)&&(t.maxPixels=parseInt(this.element.dataset.maxPixels,10)),t}get value(){return this.fakeInput.value}set value(t){this.fakeInput.value=t}}function wl(t,e,n){this.x=t,this.y=e,this.time=n||(new Date).getTime()}function bl(t,e,n,r){this.startPoint=t,this.control1=e,this.control2=n,this.endPoint=r}function Cl(t,e){var n,r,i,o,a,s,l,u,c=this,e=e||{};function h(){u=!1===i.leading?0:Date.now(),l=null,s=n.apply(o,a),l||(o=a=null)}this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.throttle?this._strokeMoveUpdate=(n=Cl.prototype._strokeUpdate,r=this.throttle,l=null,u=0,i=i||{},function(){var t=Date.now(),e=(u||!1!==i.leading||(u=t),r-(t-u));return o=this,a=arguments,e<=0||r<e?(l&&(clearTimeout(l),l=null),u=t,s=n.apply(o,a),l||(o=a=null)):l||!1===i.trailing||(l=setTimeout(h,e)),s}):this._strokeMoveUpdate=Cl.prototype._strokeUpdate,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(t){1===t.which&&(c._mouseButtonDown=!0,c._strokeBegin(t))},this._handleMouseMove=function(t){c._mouseButtonDown&&c._strokeMoveUpdate(t)},this._handleMouseUp=function(t){1===t.which&&c._mouseButtonDown&&(c._mouseButtonDown=!1,c._strokeEnd(t))},this._handleTouchStart=function(t){1===t.targetTouches.length&&(t=t.changedTouches[0],c._strokeBegin(t))},this._handleTouchMove=function(t){t.preventDefault();t=t.targetTouches[0];c._strokeMoveUpdate(t)},this._handleTouchEnd=function(t){t.target===c._canvas&&(t.preventDefault(),c._strokeEnd(t))},this.on()}wl.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1},wl.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},wl.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time},bl.prototype.length=function(){for(var t=0,e=void 0,n=void 0,r=0;r<=10;r+=1){var i,o,a=r/10,s=this._point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),a=this._point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);0<r&&(i=s-e,o=a-n,t+=Math.sqrt(i*i+o*o)),e=s,n=a}return t},bl.prototype._point=function(t,e,n,r,i){return e*(1-t)*(1-t)*(1-t)+3*n*(1-t)*(1-t)*t+3*r*(1-t)*t*t+i*t*t*t},Cl.prototype.clear=function(){var t=this._ctx,e=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(),this._isEmpty=!0},Cl.prototype.fromDataURL=function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=new Image,i=n.ratio||window.devicePixelRatio||1,o=n.width||this._canvas.width/i,a=n.height||this._canvas.height/i;this._reset(),r.src=t,r.onload=function(){e._ctx.drawImage(r,0,0,o,a)},this._isEmpty=!1},Cl.prototype.toDataURL=function(t){var e;if("image/svg+xml"===t)return this._toSVG();for(var n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(e=this._canvas).toDataURL.apply(e,[t].concat(r))},Cl.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()},Cl.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)},Cl.prototype.isEmpty=function(){return this._isEmpty},Cl.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),"function"==typeof this.onBegin&&this.onBegin(t)},Cl.prototype._strokeUpdate=function(t){var e=t.clientX,e=this._createPoint(e,t.clientY),t=this._data[this._data.length-1],t=t&&t[t.length-1],n=t&&e.distanceTo(t)<this.minDistance;t&&n||(n=(t=this._addPoint(e)).curve,t=t.widths,n&&t&&this._drawCurve(n,t.start,t.end),this._data[this._data.length-1].push({x:e.x,y:e.y,time:e.time,color:this.penColor}))},Cl.prototype._strokeEnd=function(t){var e,n=2<this.points.length,r=this.points[0];!n&&r&&this._drawDot(r),r&&(e=(n=this._data[this._data.length-1])[n.length-1],r.equals(e)||n.push({x:r.x,y:r.y,time:r.time,color:this.penColor})),"function"==typeof this.onEnd&&this.onEnd(t)},Cl.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},Cl.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)},Cl.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},Cl.prototype._createPoint=function(t,e,n){var r=this._canvas.getBoundingClientRect();return new wl(t-r.left,e-r.top,n||(new Date).getTime())},Cl.prototype._addPoint=function(t){var e,n=this.points;return n.push(t),2<n.length?(3===n.length&&n.unshift(n[0]),t=this._calculateCurveControlPoints(n[0],n[1],n[2]).c2,e=this._calculateCurveControlPoints(n[1],n[2],n[3]).c1,t=new bl(n[1],t,e,n[2]),e=this._calculateCurveWidths(t),n.shift(),{curve:t,widths:e}):{}},Cl.prototype._calculateCurveControlPoints=function(t,e,n){var r=t.x-e.x,i=t.y-e.y,o=e.x-n.x,a=e.y-n.y,s=(t.x+e.x)/2,t=(t.y+e.y)/2,l=(e.x+n.x)/2,n=(e.y+n.y)/2,r=Math.sqrt(r*r+i*i),i=Math.sqrt(o*o+a*a),o=i/(r+i),a=l+(s-l)*o,r=n+(t-n)*o,i=e.x-a,o=e.y-r;return{c1:new wl(s+i,t+o),c2:new wl(l+i,n+o)}},Cl.prototype._calculateCurveWidths=function(t){var e=t.startPoint,t=t.endPoint,n={start:null,end:null},t=this.velocityFilterWeight*t.velocityFrom(e)+(1-this.velocityFilterWeight)*this._lastVelocity,e=this._strokeWidth(t);return n.start=this._lastWidth,n.end=e,this._lastVelocity=t,this._lastWidth=e,n},Cl.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)},Cl.prototype._drawPoint=function(t,e,n){var r=this._ctx;r.moveTo(t,e),r.arc(t,e,n,0,2*Math.PI,!1),this._isEmpty=!1},Cl.prototype._drawCurve=function(t,e,n){var r=this._ctx,i=n-e,o=Math.floor(t.length());r.beginPath();for(var a=0;a<o;a+=1){var s=a/o,l=s*s,u=l*s,c=1-s,h=c*c,d=h*c,p=d*t.startPoint.x,d=(p=(p=(p+=3*h*s*t.control1.x)+3*c*l*t.control2.x)+u*t.endPoint.x,d*t.startPoint.y),h=(d=(d=(d+=3*h*s*t.control1.y)+3*c*l*t.control2.y)+u*t.endPoint.y,e+u*i);this._drawPoint(p,d,h)}r.closePath(),r.fill()},Cl.prototype._drawDot=function(t){var e=this._ctx,n="function"==typeof this.dotSize?this.dotSize():this.dotSize;e.beginPath(),this._drawPoint(t.x,t.y,n),e.closePath(),e.fill()},Cl.prototype._fromData=function(t,e,n){for(var r=0;r<t.length;r+=1){var i=t[r];if(1<i.length)for(var o=0;o<i.length;o+=1){var a,s=i[o],l=new wl(s.x,s.y,s.time),s=s.color;0===o?(this.penColor=s,this._reset(),this._addPoint(l)):o!==i.length-1&&(a=(l=this._addPoint(l)).curve,l=l.widths,a)&&l&&e(a,l,s)}else this._reset(),n(i[0])}},Cl.prototype._toSVG=function(){var r=this,t=this._data,e=this._canvas,n=Math.max(window.devicePixelRatio||1,1),i=e.width/n,n=e.height/n,o=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=(o.setAttributeNS(null,"width",e.width),o.setAttributeNS(null,"height",e.height),this._fromData(t,function(t,e,n){var r=document.createElement("path");isNaN(t.control1.x)||isNaN(t.control1.y)||isNaN(t.control2.x)||isNaN(t.control2.y)||(t="M "+t.startPoint.x.toFixed(3)+","+t.startPoint.y.toFixed(3)+" C "+t.control1.x.toFixed(3)+","+t.control1.y.toFixed(3)+" "+t.control2.x.toFixed(3)+","+t.control2.y.toFixed(3)+" "+t.endPoint.x.toFixed(3)+","+t.endPoint.y.toFixed(3),r.setAttribute("d",t),r.setAttribute("stroke-width",(2.25*e.end).toFixed(3)),r.setAttribute("stroke",n),r.setAttribute("fill","none"),r.setAttribute("stroke-linecap","round"),o.appendChild(r))},function(t){var e=document.createElement("circle"),n="function"==typeof r.dotSize?r.dotSize():r.dotSize;e.setAttribute("r",n),e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),e.setAttribute("fill",t.color),o.appendChild(e)}),'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 '+i+" "+n+'" width="'+i+'" height="'+n+'">'),t=o.innerHTML;if(void 0===t){var a=document.createElement("dummy"),s=o.childNodes;a.innerHTML="";for(var l=0;l<s.length;l+=1)a.appendChild(s[l].cloneNode(!0));t=a.innerHTML}return"data:image/svg+xml;base64,"+btoa(e+t+"</svg>")},Cl.prototype.fromData=function(t){var n=this;this.clear(),this._fromData(t,function(t,e){return n._drawCurve(t,e.start,e.end)},function(t){return n._drawDot(t)}),this._data=t},Cl.prototype.toData=function(){return this._data},Cl.prototype.fromObjectURL=function(s,t){let l=new Image;var e=(t=t||{}).ratio||window.devicePixelRatio||1;let u=t.width||this._canvas.width/e,c=t.height||this._canvas.height/e,h=this;return this._reset(),new Promise(a=>{l.src=s,l.onload=()=>{var t=l.width,e=l.height,n=u/t,r=c/e;let i,o;n<1||r<1?(n=Math.min(n,r),i=(u-t*n)/2,o=(c-e*n)/2,h._ctx.drawImage(l,0,0,t,e,i,o,t*n,e*n)):(i=(u-t)/2,o=(c-e)/2,h._ctx.drawImage(l,i,o,t,e)),a(s)},l.onerror=function(t){console.log("Error",t.target.error.message),reject(t)},h._isEmpty=!1})},Cl.prototype.updateData=function(t){let n=this;this._fromData(t,(t,e)=>{n._drawCurve(t,e.start,e.end)},t=>{n._drawDot(t)}),this._data=t};class El extends cs{static get selector(){return'.or-appearance-draw input[data-type-xml="binary"][accept^="image"], .or-appearance-signature input[data-type-xml="binary"][accept^="image"], .or-appearance-annotate input[data-type-xml="binary"][accept^="image"]'}_init(){let t,n=this,e=this.element.dataset.loadedFileName;this.element.type="text",this.element.dataset.drawing=!0,this.element.after(this._getMarkup());var r=this.question;r.classList.add(`or-${this.props.type}-initialized`),this.$widget=m(r.querySelector(".widget")),t=this.$widget[0].querySelector(".draw-widget__body__canvas"),this._handleResize(t),this._resizeCanvas(t),this.props.load&&this._handleFiles(e),t.addEventListener("blur",this._forceUpdate.bind(this)),this.initialize=ml.init().then(()=>(n.pad=new Cl(t,{onEnd:()=>{clearTimeout(n._updateWithDelay),n._updateWithDelay=setTimeout(n._updateValue.bind(n),1500)},penColor:n.props.colors[0]||"black"}),n.pad.off(),!e||(n.element.value=e,n._loadFileIntoPad(e).then(n._updateDownloadLink.bind(n))))),this.disable(),this.initialize.then(()=>{n.$widget.find(".btn-reset").on("click",n._reset.bind(n)).end().find(".draw-widget__colorpicker").on("click",".current",function(){m(this).parent().toggleClass("reveal")}).on("click","[data-color]:not(.current)",function(){m(this).siblings().removeClass("current").end().addClass("current").parent().removeClass("reveal"),n.pad.penColor=this.dataset.color}).end().find(".draw-widget__undo").on("click",()=>{let t=n.pad.toData();n.pad.clear();var e=n.$widget[0].querySelector("input[type=file]"),e=e&&e.files[0]?e.files[0]:n.element.dataset.loadedFileName;n._loadFileIntoPad(e).then(()=>{n.pad.updateData(t.slice(0,-1)),n._updateValue(),n.pad.penColor=n.$widget.find(".draw-widget__colorpicker .current")[0].dataset.color})}).end().find(".show-canvas-btn").on("click",()=>(n.$widget.addClass("full-screen"),n._resizeCanvas(t),n.enable(),!1)).end().find(".hide-canvas-btn").on("click",()=>(n.$widget.removeClass("full-screen"),n.pad.off(),n._forceUpdate(),n._resizeCanvas(t),!1)).click(),m(t).on("canvasreload",()=>{n.cache&&n.pad.fromObjectURL(n.cache).then(n._updateValue.bind(n,!1))}),n.enable()}).catch(t=>{n._showFeedback(t.message)}),m(this.element).on("applyfocus",()=>{t.focus()}).closest('[role="page"]').on(E.PageFlip().type,()=>{n._resizeCanvas(t)})}_forceUpdate(){this._updateWithDelay&&(clearTimeout(this._updateWithDelay),this._updateValue())}_handleFiles(t){this._updatePlaceholder(),this.element.closest("form.or").addEventListener(E.UpdateMaxSize().type,this._updatePlaceholder.bind(this));let e=this,n=this.$widget.find("input[type=file]"),r=this.$widget.find(".fake-file-input");var i=this.$widget.parent().find(".dynamic-input");this._showFileName(t),n.on("click",t=>{if(e.props.readonly||"propagate"!==t.namespace)return e.$fakeInput.focus(),t.stopImmediatePropagation(),!1}).on("change",function(){let t=this.files[0];t?ml.isTooLarge(t)?e._showFeedback(C("filepicker.toolargeerror",{maxSize:ml.getMaxSizeReadable()})):(e.pad.clear(),e._loadFileIntoPad(this.files[0]).then(()=>{e._updateValue.call(e),e._showFileName(t.name),e.enable()})):e._showFileName(null)}),r.on("click",function(t){if(e.props.readonly||n[0].value||r[0].value)return m(this).focus(),t.stopImmediatePropagation(),!1;t.preventDefault(),n.trigger("click.propagate")}).on("change",()=>!1),i.on("change."+this.namespace,function(){let t=this.value;t?e.pad?(e.pad.clear(),e._loadFileIntoPad(t).then(()=>{e._updateValue.call(e),e._showFileName(t),e.enable()})):(console.log("pad not initialised yet"),setTimeout(function(){e.pad.clear(),e._loadFileIntoPad(t).then(()=>{e._updateValue.call(e),e._showFileName(t),e.enable()},200)})):e._showFileName(null)})}_showFileName(t){this.$widget.find(".fake-file-input").val(t).prop("readonly",!!t)}_updatePlaceholder(){this.$widget.find(".fake-file-input").attr("placeholder",C("filepicker.placeholder",{maxSize:ml.getMaxSizeReadable()||"?MB"}))}_getMarkup(){var t=this.props.load?`<input type="file" class="ignore draw-widget__load"${null!==this.props.capture?` capture="${this.props.capture}"`:""} accept="${this.props.accept}"/><div class="widget file-picker"><input class="ignore fake-file-input"/><div class="file-feedback"></div></div>`:"",e=this.props.touch?'<button type="button" class="show-canvas-btn btn btn-default">Draw/Sign</button><button type="button" class="hide-canvas-btn btn btn-default"><span class="icon icon-arrow-left"> </span></button>':"",e=document.createRange().createContextualFragment(`<div class="widget draw-widget">
                <div class="draw-widget__body">
                    ${e}
                    ${t}
                    <canvas class="draw-widget__body__canvas noSwipe disabled" tabindex="0"></canvas>
                    <div class="draw-widget__colorpicker"></div>
                    ${"signature"===this.props.type?"":'<button class="btn-icon-only draw-widget__undo" aria-label="undo" type=button><i class="icon icon-undo"> </i></button>'}
                </div>
                <div class="draw-widget__footer">
                    <div class="draw-widget__feedback"></div>
                </div>
            </div>`);e.querySelector(".draw-widget__footer").prepend(this.downloadButtonHtml),e.querySelector(".draw-widget__footer").prepend(this.resetButtonHtml);let n=e.querySelector(".draw-widget__colorpicker");return this.props.colors.forEach((t,e)=>{e=0===e?" current":"",e=document.createRange().createContextualFragment(`<div class="${e}"data-color="${t}" style="background: ${t};" />`);n.append(e)}),e}_updateValue(t=!0){var e,n=this.pad.toDataURL();this.value!==n&&(e=`-${(e=new Date).getHours()}_${e.getMinutes()}_${e.getSeconds()}_`+e.getMilliseconds(),this.element.dataset.filenamePostfix||(this.element.dataset.filenamePostfix=e),t&&(this.originalInputValue=this.props.filename),this.value=n,this._updateDownloadLink(this.value))}_reset(){let e=this;var t;this.element.value&&(t="signature"===this.props.type?C("drawwidget.signature"):"drawing"===this.props.type?C("drawwidget.drawing"):C("drawwidget.annotation"),ts.confirm(C("filepicker.resetWarning",{item:t})).then(t=>{t&&(e.pad.clear(),e.cache=null,delete e.element.dataset.loadedFileName,delete e.element.dataset.loadedUrl,e.element.dataset.filenamePostfix="",m(e.element).val("").trigger("change"),e.$widget.find("input[type=file]").val("").trigger("change"),e._updateDownloadLink(""),e.disable(),e.enable())}))}_loadFileIntoPad(t){let e=this;return t?("string"==typeof t&&t.startsWith("jr://")&&this.element.dataset.loadedUrl&&(t=this.element.dataset.loadedUrl),ml.getObjectUrl(t).then(e.pad.fromObjectURL.bind(e.pad)).then(t=>e.cache=t).catch(()=>{e._showFeedback(C("filepicker.notFound",{item:C("filepicker.file")}))})):Promise.resolve("")}_showFeedback(t){t=t||"",this.$widget.find(".draw-widget__feedback").text(t)}_updateDownloadLink(t){var e=(t=t&&0===t.indexOf("data:")?URL.createObjectURL(De(t)):t)?ke({name:this.element.value},this.element.dataset.filenamePostfix):"";yl.updateDownloadLink(this.$widget.find(".btn-download")[0],t,e)}_handleResize(t){let e=this;m(window).on("resize",()=>{e._resizeCanvas(t)})}_resizeCanvas(t){var e;0<t.offsetWidth&&(e=Math.max(window.devicePixelRatio||1,1),t.width=t.offsetWidth*e,t.height=t.offsetHeight*e,t.getContext("2d").scale(e,e),m(t).trigger("canvasreload"))}disable(){let t=this,e=this.$widget.find(".draw-widget__body__canvas")[0];this.initialize.then(()=>{t.pad.off(),e.classList.add("disabled"),t.$widget.find(".btn-reset").prop("disabled",!0)})}enable(){let t=this,e=this.$widget.find(".draw-widget__body__canvas")[0],n=this.props.touch&&!this.$widget.is(".full-screen"),r=this.props.load&&!this.element.value;this.initialize.then(()=>{t.props.readonly||r||n||(t.pad.on(),e.classList.remove("disabled"),t.$widget.find(".btn-reset").prop("disabled",!1)),t._resizeCanvas(e)})}update(){""===this.originalInputValue&&this._reset()}get props(){var t=this._props;return t.type=t.appearances.includes("draw")?"drawing":t.appearances.includes("signature")?"signature":"annotation",t.filename=t.type+".png",t.load="annotation"===t.type,t.colors="signature"===t.type?[]:["black","lightblue","blue","red","orange","cyan","yellow","lightgreen","green","pink","purple","lightgray","darkgray"],t.touch=ys.touch,t.accept=this.element.getAttribute("accept"),t.capture=this.element.getAttribute("capture"),t}get value(){return this.cache||""}set value(t){this.cache=t}}class Sl extends cs{static get selector(){return".question.or-appearance-columns"}_init(){this.element.querySelectorAll(".option-wrapper").forEach(t=>{let e=3-t.querySelectorAll("label").length%3;for(;e<3&&0<e;)t.append(document.createRange().createContextualFragment('<label class="filler"></label>')),e--;this.question.classList.add("or-columns-initialized")})}}class Tl extends cs{static get selector(){return'.or-appearance-distress input[type="number"], .question:not(.or-appearance-analog-scale):not(.or-appearance-rating) > input[type="number"][min][max][step]'}_init(){let t=this;var e=document.createRange().createContextualFragment(this._getHtmlStr());e.querySelector(".range-widget__scale__end").before(this.resetButtonHtml),e.querySelector(".range-widget__scale__start").textContent=this.props.min,e.querySelector(".range-widget__scale__end").textContent=this.props.max,this.element.after(e),this.element.classList.add("hide"),this.element.addEventListener("applyfocus",()=>{this.range.focus()}),this.widget=this.question.querySelector(".widget"),this.range=this.widget.querySelector("input"),this.current=this.widget.querySelector(".range-widget__current"),this.props.readonly&&this.disable(),this.range.addEventListener("change",()=>{this.current.textContent=this.value,this._updateMercury((this.value-this.props.min)/(t.props.max-t.props.min)),this.originalInputValue!==this.value&&(this.originalInputValue=this.value)}),this.widget.querySelector("input.empty").addEventListener("click",()=>{this.range.classList.remove("empty"),this.range.dispatchEvent(E.Change())}),this.widget.querySelector("input.empty").addEventListener("touchstart",()=>{this.range.classList.remove("empty"),this.range.dispatchEvent(E.Change())}),this.widget.querySelector(".btn-reset").addEventListener("click",this._reset.bind(this)),this.update();let n=this.props.ticks?Math.ceil(Math.abs((this.props.max-this.props.min)/this.props.step)):1,r=Math.ceil(n/this.props.maxTicks);for(;n%r&&r<n;)r++;n/=r,this.widget.querySelector(".range-widget__ticks").append(document.createRange().createContextualFragment(new Array(n).fill("<span></span>").join("")))}_getHtmlStr(){return`<div class="widget range-widget">
                <div class="range-widget__wrap">
                    <div class="range-widget__current"></div>
                    <div class="range-widget__bg"></div>
                    <div class="range-widget__ticks"></div>
                    <div class="range-widget__scale">
                        <span class="range-widget__scale__start"></span>
                        ${this._stepsBetweenHtmlStr(this.props)}
                        <span class="range-widget__scale__end"></span>
                    </div>
                    <div class="range-widget__bulb">
                        <div class="range-widget__bulb__inner"></div>
                        <div class="range-widget__bulb__mercury"></div>
                    </div>
                </div>
                <input type="range" class="ignore empty" min="${this.props.min}" max="${this.props.max}" step="${this.props.step}"/>
            </div>`}_updateMercury(t){var e=this.widget.querySelector(".range-widget__ticks").clientHeight,n=this.widget.querySelector(".range-widget__bulb").clientHeight;this.widget.querySelector(".range-widget__bulb__mercury").style.height=t*e+.5*n+"px"}_stepsBetweenHtmlStr(e){let n="";if(e.showScale&&((e.max-e.min)/e.step<=10&&(e.max-e.min)%e.step==0))for(let t=e.min+e.step;t<e.max;t+=e.step)n+=`<span class="range-widget__scale__between">${t}</span>`;return n}_reset(){this.current.textContent="",this._updateMercury(0),this.value="",this.originalInputValue=""}disable(){this.widget.querySelectorAll("input, button").forEach(t=>t.disabled=!0)}enable(){this.widget.querySelectorAll("input, button").forEach(t=>t.disabled=!1)}update(){var t=this.element.value;xe(t)?(this.value=t,this.range.dispatchEvent(E.Change())):this._reset()}get props(){var t=this._props,e=xe(this.element.getAttribute("min"))?this.element.getAttribute("min"):0,n=xe(this.element.getAttribute("max"))?this.element.getAttribute("max"):10,r=xe(this.element.getAttribute("step"))?this.element.getAttribute("step"):1,i=t.appearances.includes("distress");return t.min=Number(e),t.max=Number(n),t.step=Number(r),t.vertical=t.appearances.includes("vertical")||i,t.ticks=!t.appearances.includes("no-ticks"),t.showScale=i,t.maxTicks=50,t}get value(){return this.range.classList.contains("empty")?"":this.range.value}set value(t){this.range.value=t,this.range.classList.toggle("empty",""===t)}}class Al extends Tl{static get selector(){return'.or-appearance-analog-scale input[type="number"]'}_init(){super._init(),this.props.vertical&&this.question.classList.add("or-appearance-vertical"),this.question.classList.add("or-analog-scale-initialized"),this._renderLabels(),this._setResizeListener()}_getHtmlStr(){return`<div class="widget analog-scale-widget">
                ${super._getHtmlStr()}
            </div>`}_updateMercury(){}_renderLabels(){var t=document.createRange().createContextualFragment('<div class="label-content widget"></div>');let e=t.querySelector(".label-content");this.question.querySelectorAll('.question-label, .or-hint, .or-required-msg, [class*="or-constraint"]').forEach(t=>e.append(t)),this.question.prepend(t),this.labelContent=this.question.querySelector(".label-content"),this._updateLabels()}_updateLabels(){var t,e,n;this.question.classList.contains("or-analog-scale-initialized")&&(t=(e=this.labelContent.querySelector(".question-label.active:not(.widget)")).innerHTML.split(/\|/).map(t=>t.trim()),(n=this.labelContent.querySelector(".question-label.widget"))&&n.remove(),n=document.createRange().createContextualFragment(`<span class="question-label widget active">${t[0]}</span>`),e.after(n),(e=this.widget.querySelector(".max-label"))&&e.remove(),n=document.createRange().createContextualFragment(`<div class="max-label">${t[1]}</div>`),this.widget.prepend(n),(e=this.widget.querySelector(".min-label"))&&e.remove(),n=document.createRange().createContextualFragment(`<div class="min-label">${t[2]}</div>`),this.widget.append(n),(e=this.labelContent.querySelector(".show-value"))&&e.remove(),t[3])&&(n=document.createRange().createContextualFragment(`<div class="widget show-value">
                    <div class="show-value__box">${t[3]}<span class="show-value__value">${this.value}</span></div>
                <div>`),this.labelContent.append(n),this.current=this.labelContent.querySelector(".show-value__value"))}_setResizeListener(){this.props.vertical&&this.question.addEventListener(E.PageFlip().type,this._stretchHeight.bind(this))}_stretchHeight(){this.question.style["min-height"]="auto"}update(){super.update(),this._updateLabels()}get props(){var t=this._props,e=(t.touch=ys.touch,t.vertical=!t.appearances.includes("horizontal"),t.ticks=!t.appearances.includes("no-ticks"),t.showScale=t.appearances.includes("show-scale")&&t.vertical&&t.ticks,xe(this.element.getAttribute("min"))?this.element.getAttribute("min"):0),n=xe(this.element.getAttribute("max"))?this.element.getAttribute("max"):100,r=xe(this.element.getAttribute("step"))?this.element.getAttribute("step"):t.showScale?10:1;return t.min=Number(e),t.max=Number(n),t.step=Number(r),t.maxTicks=10,t}get value(){return super.value}set value(t){super.value=t}}class Il extends cs{static get selector(){return"a.or-big-image"}_init(){this.element.addEventListener("click",t=>{var e=this.element.getAttribute("href"),n=this.element.querySelector("img"),r=n.getAttribute("src");this.element.setAttribute("href",r),n.setAttribute("src",e),this.element.classList.toggle("open"),t.preventDefault(),t.stopPropagation()})}}class Ll extends cs{static get selector(){return'.or-appearance-comment input[type="text"][data-for], .or-appearance-comment textarea[data-for]'}static get helpersRequired(){return["input","pathToAbsolute"]}_init(){var t,e;this.linkedQuestion=this._getLinkedQuestion(this.element),this.commentQuestion=this.question,this.linkedQuestion&&(this.commentQuestion.classList.add("hide"),this.commentQuestion.setAttribute("role","comment"),t=document.createRange().createContextualFragment('<a class="btn-icon-only btn-comment aria-label="comment" type="button" href="#"><i class="icon"> </i></a>'),(e=this.linkedQuestion.querySelectorAll(".question-label"))[e.length-1].after(t),this.commentButton=this.linkedQuestion.querySelector(".btn-comment"),this._setCommentButtonState(this.originalInputValue),this._setCommentButtonHandler(),this._setValidationHandler(),this._setFocusHandler())}_getLinkedQuestion(t){var e=this.options.helpers.input.getName(t),n=this.element.dataset.for.trim(),n=this.options.helpers.pathToAbsolute(n,e),e=t.closest("form.or, .or-repeat");return this.options.helpers.input.getWrapNode(e.querySelector(`[name="${n}"], [data-name="${n}"]`))}_commentHasError(){return this.commentQuestion.classList.contains("invalid-required")||this.commentQuestion.classList.contains("invalid-constraint")}_setCommentButtonState(t,e){t="string"==typeof t?t.trim():t,this.commentButton.classList.toggle("empty",!t),this.commentButton.classList.toggle("invalid",!!e)}_setCommentButtonHandler(){this.commentButton.addEventListener("click",t=>{this._isCommentModalShown(this.linkedQuestion)?this._hideCommentModal(this.linkedQuestion):this._showCommentModal(),t.preventDefault(),t.stopPropagation()})}_setValidationHandler(){this.element.closest("form.or").addEventListener(E.ValidationComplete().type,()=>{var t=this._commentHasError(),e=this.originalInputValue;this._setCommentButtonState(e,t)})}_setFocusHandler(){m(this.element).on("applyfocus",()=>{this.commentButton.matches(":visible")?this.commentButton.click():console.warn("The linked question is not visible. Cannot apply focus to "+this.element.getAttribute("name"))})}_isCommentModalShown(t){return!!t.querySelector(".or-comment-widget")}_showCommentModal(){var t=this.question.cloneNode(!0),e=C("widget.comment.update")||"Update";let r=t.querySelector("input:not(.ignore), textarea:not(.ignore)");t.classList.remove("hide"),r.classList.add("ignore"),r.removeAttribute("name data-for data-type-xml");var e=document.createRange().createContextualFragment(`<section class="widget or-comment-widget">
                <div class="or-comment-widget__content">
                    <button class="btn btn-primary or-comment-widget__content__btn-update" type="button">${e}</button>
                    <button class="btn-icon-only or-comment-widget__content__btn-close-x" type="button">&times;</button>
                </div>
            </section>
            `),t=(e.querySelector(".or-comment-widget__content").prepend(t),document.createRange().createContextualFragment('<div class="or-comment-widget__overlay"></div>')),e=(this.linkedQuestion.prepend(e),this.linkedQuestion.before(t),this.linkedQuestion.previousElementSibling),t=this.linkedQuestion.querySelector(".or-comment-widget"),n=t.querySelector(".or-comment-widget__content__btn-update"),i=t.querySelector(".or-comment-widget__content__btn-close-x");r.focus(),t.scrollIntoView(!1),n.addEventListener("click",t=>{var e=r.value,n=(this.originalInputValue=e,this.element.dispatchEvent(E.Change()),this._commentHasError());this._setCommentButtonState(e,n),this._hideCommentModal(this.linkedQuestion),this.options.helpers.input.validate(m(this.linkedQuestion.querySelector("input:not(.ignore), select:not(.ignore), textarea:not(.ignore)"))),t.preventDefault(),t.stopPropagation()}),i.addEventListener("click",t=>{this._hideCommentModal(this.linkedQuestion),t.stopPropagation(),t.preventDefault()}),e.addEventListener("click",t=>{this._hideCommentModal(this.linkedQuestion),t.stopPropagation(),t.preventDefault()})}_hideCommentModal(t){t.querySelector(".or-comment-widget").remove();t=t.previousElementSibling;t&&t.matches(".or-comment-widget__overlay")&&t.remove()}}let kl="path[id], g[id], circle[id]";class xl extends cs{static get selector(){return".simple-select.or-appearance-image-map label:first-child > input"}_init(){let e=this.question.querySelector("img");if(this.question.classList.add("or-image-map-initialized"),e)return e.getAttribute("src")?this._addMarkup(e).then(this._addFunctionality.bind(this)).then(()=>this):new Promise(t=>{e.addEventListener("load",()=>{this._addMarkup(e).then(this._addFunctionality.bind(this)),t(this)})});this._showSvgNotFoundError()}_addFunctionality(t){t&&(this.svg=t.querySelector("svg"),this.tooltip=t.querySelector(".image-map__ui__tooltip"),this.props.readonly&&this.disable(),this._setSvgClickHandler(),this._setChangeHandler(),this._setHoverHandler(),this._updateImage(),this._setPageHandler())}_addMarkup(t){let n=this;t=t.getAttribute("src");return fetch(t).then(t=>t.text()).then(t=>(new DOMParser).parseFromString(t,"text/xml")).then(t=>{var e;if(n._isSvgDoc(t))return t=n._removeUnmatchedIds(t.querySelector("svg")),(e=document.createRange().createContextualFragment(`<div class="widget image-map">
                            <div class="image-map__ui">
                                <span class="image-map__ui__tooltip"></span>
                            </div>
                        </div>`)).querySelector(".widget").append(t),n.question.querySelectorAll("img").forEach(t=>t.remove()),n.question.querySelector("fieldset > .option-wrapper").before(e),(e=(t=n.question.querySelector(".image-map")).querySelector("svg")).getAttribute("viewBox")||this._setViewBox(e),t;throw"Image is not an SVG doc"}).catch(this._showSvgNotFoundError.bind(n))}_setViewBox(e){let n;try{var r=e.getBBox();n=r.x+` ${r.y} ${r.width} `+r.height}catch(t){console.error("Could not obtain Boundary Box of SVG element",t);var r=e.getAttribute("width"),i=e.getAttribute("height");r&&i&&(n=`0 0 ${parseInt(r,10)} `+parseInt(i,10))}e.setAttribute("viewBox",n)}_showSvgNotFoundError(t){console.error(t);t=document.createRange().createContextualFragment(`<div class="widget image-map">
                <div class="image-map__error" data-i18n="imagemap.svgNotFound">${C("imagemap.svgNotFound")}</div>
            </div>`);this.question.querySelector(".option-wrapper").before(t)}_removeUnmatchedIds(t){return t.querySelectorAll(kl).forEach(t=>{this._getInput(t.id)||t.removeAttribute("id")}),t}_getInput(t){return this.question.querySelector(`input[value="${CSS.escape(t)}"]`)}_setSvgClickHandler(){this.svg.addEventListener("click",t=>{!t.target.closest("svg").matches("[or-readonly]")&&(t.target.matches(kl)||t.target.closest(kl))&&(t=t.target.id||t.target.closest("g[id]").id,t=this._getInput(t))&&(t.checked=!t.checked,t.dispatchEvent(E.Change()),t.dispatchEvent(E.FakeFocus()))})}_setChangeHandler(){this.question.addEventListener("change",this._updateImage.bind(this))}_setHoverHandler(){this.svg.querySelectorAll(kl).forEach(t=>{t.addEventListener("mouseenter",t=>{t=t.target.id||t.target.closest("g[id]").id,t=Me(this._getInput(t),".option-label.active"),t=t?t.textContent:"";this.tooltip.textContent=t}),t.addEventListener("mouseleave",t=>{t.target.matches(kl)&&(this.tooltip.textContent="")})})}_setPageHandler(){var t=this.element.closest('[role="page"]');t&&t.addEventListener(E.PageFlip().type,()=>this._setViewBox(this.svg))}_isSvgDoc(t){return"object"==typeof t&&t.querySelector("svg")}_updateImage(){let t=this.originalInputValue;this.svg.querySelectorAll("path[or-selected], g[or-selected], circle[or-selected]").forEach(t=>t.removeAttribute("or-selected")),(t="string"==typeof t?[t]:t).forEach(t=>{t&&this.svg.querySelectorAll(`path#${CSS.escape(t)},g#${CSS.escape(t)},circle#`+CSS.escape(t)).forEach(t=>t.setAttribute("or-selected",""))})}disable(){this.svg.setAttribute("or-readonly","")}enable(){this.svg.removeAttribute("or-readonly")}update(){this._updateImage()}get value(){return this.originalInputValue}set value(t){this.originalInputValue=t}}function Dl(t,e,n){if(void 0===n)return t&&t.h5s&&t.h5s.data&&t.h5s.data[e];t.h5s=t.h5s||{},t.h5s.data=t.h5s.data||{},t.h5s.data[e]=n}var Nl=function(t,e){if(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)return"string"!=typeof e?Array.from(t):Array.from(t).filter(function(t){return 1===t.nodeType&&t.matches(e)});throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.")},Rl=new Map,Pl=(Object.defineProperty(Ol.prototype,"config",{get:function(){var n={};return this._config.forEach(function(t,e){n[e]=t}),n},set:function(t){if("object"!=typeof t)throw new Error("You must provide a valid configuration object to the config setter.");t=Object.assign({},t);this._config=new Map(Object.entries(t))},enumerable:!1,configurable:!0}),Ol.prototype.setConfig=function(t,e){if(!this._config.has(t))throw new Error("Trying to set invalid configuration item: "+t);this._config.set(t,e)},Ol.prototype.getConfig=function(t){if(this._config.has(t))return this._config.get(t);throw new Error("Invalid configuration item requested: "+t)},Object.defineProperty(Ol.prototype,"placeholder",{get:function(){return this._placeholder},set:function(t){if(!(t instanceof HTMLElement)&&null!==t)throw new Error("A placeholder must be an html element or null.");this._placeholder=t},enumerable:!1,configurable:!0}),Ol.prototype.setData=function(t,e){if("string"!=typeof t)throw new Error("The key must be a string.");this._data.set(t,e)},Ol.prototype.getData=function(t){if("string"!=typeof t)throw new Error("The key must be a string.");return this._data.get(t)},Ol.prototype.deleteData=function(t){if("string"!=typeof t)throw new Error("The key must be a string.");return this._data.delete(t)},Ol);function Ol(){this._config=new Map,this._placeholder=void 0,this._data=new Map}var Ml=function(t){if(t instanceof HTMLElement)return Rl.has(t)||Rl.set(t,new Pl),Rl.get(t);throw new Error("Please provide a sortable to the store function.")};function Bl(t,e,n){if(t instanceof Array)for(var r=0;r<t.length;++r)Bl(t[r],e,n);else t.addEventListener(e,n),Ml(t).setData("event"+e,n)}function Ul(t,e){if(t instanceof Array)for(var n=0;n<t.length;++n)Ul(t[n],e);else t.removeEventListener(e,Ml(t).getData("event"+e)),Ml(t).deleteData("event"+e)}function Fl(t,e,n){if(t instanceof Array)for(var r=0;r<t.length;++r)Fl(t[r],e,n);else t.setAttribute(e,n)}function Vl(t,e){if(t instanceof Array)for(var n=0;n<t.length;++n)Vl(t[n],e);else t.removeAttribute(e)}function Hl(t){if(t instanceof HTMLElement)return null!==t.parentNode;throw new Error("Element is not a node element.")}function zl(t,e){Kl(t,e,"after")}function jl(t){var e;if(t instanceof HTMLElement)return"border-box"===(e=window.getComputedStyle(t)).getPropertyValue("box-sizing")?parseInt(e.getPropertyValue("height"),10):["height","padding-top","padding-bottom"].map(function(t){t=parseInt(e.getPropertyValue(t),10);return isNaN(t)?0:t}).reduce(function(t,e){return t+e});throw new Error("You must provide a valid dom element")}function ql(t){var e;if(t instanceof HTMLElement)return e=window.getComputedStyle(t),["width","padding-left","padding-right"].map(function(t){t=parseInt(e.getPropertyValue(t),10);return isNaN(t)?0:t}).reduce(function(t,e){return t+e});throw new Error("You must provide a valid dom element")}function Wl(t,e){if(!0===t.isSortable){var n=Ml(t).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&0<n.split(",").filter(function(t){return 0<t.length&&e.matches(t)}).length;if(t===e)return 1;if(void 0!==Ml(t).getConfig("connectWith")&&null!==Ml(t).getConfig("connectWith"))return Ml(t).getConfig("connectWith")===Ml(e).getConfig("connectWith")}}var Gl=function(t){if(t.parentElement&&0!==t.getClientRects().length)return{left:(t=t.getClientRects()[0]).left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset};throw new Error("target element must be part of the dom")},$l=function(t,e){if(t instanceof HTMLElement&&(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))return Array.from(e).indexOf(t);throw new Error("You must provide an element and a list of elements.")},Kl=function(t,e,n){if(!(t instanceof HTMLElement&&t.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");t.parentElement.insertBefore(e,"before"===n?t:t.nextElementSibling)},Xl=function(t,e){if(t instanceof Array)return"string"!=typeof e?t:t.filter(function(t){return t.querySelector(e)instanceof HTMLElement||t.shadowRoot&&t.shadowRoot.querySelector(e)instanceof HTMLElement}).map(function(t){return t.querySelector(e)||t.shadowRoot&&t.shadowRoot.querySelector(e)});throw new Error("You must provide a Array of HTMLElements to be filtered.")},Zl=function(t){return t.composedPath&&t.composedPath()[0]||t.target},Yl=function(t,e,n){return{element:t,posX:n.pageX-e.left,posY:n.pageY-e.top}},Ql={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,dropTargetContainerClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};function Jl(t){var e;(e=t).h5s&&delete e.h5s.data,Vl(t,"aria-dropeffect")}function tu(t){Vl(t,"aria-grabbed"),Vl(t,"aria-copied"),Vl(t,"draggable"),Vl(t,"role")}var eu,nu,ru,iu,ou,au,su,lu,uu,cu=function(t,e){var r;"string"==typeof Ml(t).getConfig("hoverClass")&&(r=Ml(t).getConfig("hoverClass").split(" "),!0===e?(Bl(t,"mousemove",function(r,i){var o=this;if(void 0===i&&(i=250),"function"!=typeof r)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof i)throw new Error("You must provide a number as the second argument for throttle.");var a=null;return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Date.now();(null===a||i<=n-a)&&(a=n,r.apply(o,t))}}(function(n){0===n.buttons&&Nl(t.children,Ml(t).getConfig("items")).forEach(function(t){var e;t===n.target||t.contains(n.target)?(e=t.classList).add.apply(e,r):(e=t.classList).remove.apply(e,r)})},Ml(t).getConfig("throttleTime"))),Bl(t,"mouseleave",function(){Nl(t.children,Ml(t).getConfig("items")).forEach(function(t){(t=t.classList).remove.apply(t,r)})})):(Ul(t,"mousemove"),Ul(t,"mouseleave")))},hu=function(t){Ul(t,"dragstart"),Ul(t,"dragend"),Ul(t,"dragover"),Ul(t,"dragenter"),Ul(t,"drop"),Ul(t,"mouseenter"),Ul(t,"mouseleave")},du=function(t,e){t&&Ul(t,"dragleave"),e&&e!==t&&Ul(e,"dragleave")};function pu(t,e){if(e.composedPath)return e.composedPath().find(function(t){return t.isSortable});for(;!0!==t.isSortable;)t=t.parentElement;return t}function fu(t,e){var n=Dl(t,"opts"),t=Nl(t.children,n.items).filter(function(t){return t.contains(e)||t.shadowRoot&&t.shadowRoot.contains(e)});return 0<t.length?t[0]:e}function gu(t){var e=Dl(t,"opts"),n=Nl(t.children,e.items),r=Xl(n,e.handle);Fl(t,"aria-dropeffect","move"),Dl(t,"_disabled","false"),Fl(r,"draggable","true"),cu(t,!0),!1===e.disableIEFix&&"function"==typeof(document||window.document).createElement("span").dragDrop&&Bl(r,"mousedown",function(){if(-1!==n.indexOf(this))this.dragDrop();else{for(var t=this.parentElement;-1===n.indexOf(t);)t=t.parentElement;t.dragDrop()}})}function mu(t,f){var c=String(f);return f=f||{},(t="string"==typeof t?document.querySelectorAll(t):t)instanceof HTMLElement&&(t=[t]),t=Array.prototype.slice.call(t),/serialize/.test(c)?t.map(function(t){var e=Dl(t,"opts"),n=t,r=e.itemSerializer,t=e.containerSerializer;if(void 0===r&&(r=function(t,e){return t}),void 0===t&&(t=function(t){return t}),!(n instanceof HTMLElement)||!0==!n.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof r||"function"!=typeof t)throw new Error("You need to provide a valid serializer for items and the container.");var e=Dl(n,"opts").items,i=Nl(n.children,e),e=i.map(function(t){return{parent:n,node:t,html:t.outerHTML,index:$l(t,i)}});return{container:t({node:n,itemCount:e.length}),items:e.map(function(t){return r(t,n)})}}):(t.forEach(function(a){if(/enable|disable|destroy/.test(c))return mu[c](a);function t(t){var e,n=!0===(r=t.target).isSortable?r:pu(r,t),r=fu(n,r);eu&&Wl(n,eu.parentElement)&&"true"!==Dl(n,"_disabled")&&(e=Dl(n,"opts"),parseInt(e.maxItems)&&Nl(n.children,Dl(n,"items")).length>=parseInt(e.maxItems)&&eu.parentElement!==n||(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=!0===Ml(n).getConfig("copy")?"copy":"move",u(n,r,t.pageX,t.pageY)))}["connectWith","disableIEFix"].forEach(function(t){Object.prototype.hasOwnProperty.call(f,t)&&null!==f[t]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+t+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')}),f=Object.assign({},Ql,Ml(a).config,f),Ml(a).config=f,Dl(a,"opts",f),a.isSortable=!0,r=Dl(e=a,"opts"),l=Nl(e.children,r.items),r=Xl(l,r.handle),Dl(e,"_disabled","false"),hu(l),du(iu,lu),Ul(r,"mousedown"),Ul(e,"dragover"),Ul(e,"dragenter"),Ul(e,"drop");var e,n,r,i,o,s,l=Nl(a.children,f.items),u=(null!=f.placeholder&&(r=document.createElement(a.tagName),f.placeholder instanceof HTMLElement?r.appendChild(f.placeholder):r.innerHTML=f.placeholder,n=r.children[0]),Ml(a).placeholder=((t,e,n)=>{if(void 0===n&&(n="sortable-placeholder"),!(t instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(e instanceof HTMLElement||void 0===e)return void 0===e&&(["UL","OL"].includes(t.tagName)?e=document.createElement("li"):["TABLE","TBODY"].includes(t.tagName)?(e=document.createElement("tr")).innerHTML='<td colspan="100"></td>':e=document.createElement("div")),"string"==typeof n&&(t=e.classList).add.apply(t,n.split(" ")),e;throw new Error("You must provide a valid element as a placeholder or set ot to undefined.")})(a,n,f.placeholderClass),Dl(a,"items",f.items),f.acceptFrom?Dl(a,"acceptFrom",f.acceptFrom):f.connectWith&&Dl(a,"connectWith",f.connectWith),gu(a),Fl(l,"role","option"),Fl(l,"aria-grabbed","false"),Bl(a,"dragstart",function(t){var e=Zl(t);if(!0!==e.isSortable&&(t.stopImmediatePropagation(),!f.handle||e.matches(f.handle))&&"false"!==e.getAttribute("draggable")){var n=pu(e,t),r=fu(n,e),i=(su=Nl(n.children,f.items),ou=su.indexOf(r),au=$l(r,n.children),iu=n,r),o=f.customDragImage;if(!(t instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(i instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(o=o||Yl,t.dataTransfer&&t.dataTransfer.setDragImage){o=o(i,Gl(i),t);if(!(o.element instanceof HTMLElement)||"number"!=typeof o.posX||"number"!=typeof o.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setData("text/plain",Zl(t).id),t.dataTransfer.setDragImage(o.element,o.posX,o.posY)}nu=jl(r),ru=ql(r),r.classList.add(f.draggingClass),t=i=r,!0===Ml(n).getConfig("copy")&&(Fl(t=i.cloneNode(!0),"aria-copied","true"),i.parentElement.appendChild(t),t.style.display="none",t.oldDisplay=i.style.display),Fl(eu=t,"aria-grabbed","true"),n.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:au,index:ou,container:iu},item:eu,originalTarget:e}}))}}),Bl(a,"dragenter",function(t){var n=Zl(t),r=pu(n,t);r&&r!==lu&&(uu=Nl(r.children,Dl(r,"items")).filter(function(t){return t!==Ml(a).placeholder}),f.dropTargetContainerClass&&r.classList.add(f.dropTargetContainerClass),r.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:au,index:ou,container:iu},destination:{container:r,itemsBeforeUpdate:uu},item:eu,originalTarget:n}})),Bl(r,"dragleave",function(t){var e=t.relatedTarget||t.fromElement;t.currentTarget.contains(e)||(f.dropTargetContainerClass&&r.classList.remove(f.dropTargetContainerClass),r.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:au,index:ou,container:r},item:eu,originalTarget:n}})))})),lu=r}),Bl(a,"dragend",function(t){var e;eu&&(eu.classList.remove(f.draggingClass),Fl(eu,"aria-grabbed","false"),"true"===eu.getAttribute("aria-copied")&&"true"!==Dl(eu,"dropped")&&eu.remove(),eu.style.display=eu.oldDisplay,delete eu.oldDisplay,(e=Array.from(Rl.values()).map(function(t){return t.placeholder}).filter(function(t){return t instanceof HTMLElement}).filter(Hl)[0])&&e.remove(),a.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:au,index:ou,container:iu},item:eu}})),ru=nu=eu=lu=null)}),Bl(a,"drop",function(t){var e,n,r,i,o;Wl(a,eu.parentElement)&&(t.preventDefault(),t.stopPropagation(),Dl(eu,"dropped","true"),(t=Array.from(Rl.values()).map(function(t){return t.placeholder}).filter(function(t){return t instanceof HTMLElement}).filter(Hl)[0])?(zl(t,eu),t.remove(),a.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:au,index:ou,container:iu},item:eu}})),e=Ml(a).placeholder,t=Nl(iu.children,f.items).filter(function(t){return t!==e}),n=!0===this.isSortable?this:this.parentElement,r=Nl(n.children,Dl(n,"items")).filter(function(t){return t!==e}),i=$l(eu,Array.from(eu.parentElement.children).filter(function(t){return t!==e})),o=$l(eu,r),f.dropTargetContainerClass&&n.classList.remove(f.dropTargetContainerClass),au===i&&iu===n||a.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:au,index:ou,container:iu,itemsBeforeUpdate:su,items:t},destination:{index:o,elementIndex:i,container:n,itemsBeforeUpdate:uu,items:r},item:eu}}))):Dl(eu,"dropped","false"))}),i=function(e,t,n,r){if(eu)if(f.forcePlaceholderSize&&(Ml(e).placeholder.style.height=nu+"px",Ml(e).placeholder.style.width=ru+"px"),-1<Array.from(e.children).indexOf(t)){var i=jl(t),o=ql(t),a=$l(Ml(e).placeholder,t.parentElement.children),s=$l(t,t.parentElement.children);if(nu<i||ru<o){var l=i-nu,u=o-ru,c=Gl(t).top,h=Gl(t).left;if(a<s&&("vertical"===f.orientation&&r<c||"horizontal"===f.orientation&&n<h))return;if(s<a&&("vertical"===f.orientation&&c+i-l<r||"horizontal"===f.orientation&&h+o-u<n))return}void 0===eu.oldDisplay&&(eu.oldDisplay=eu.style.display),"none"!==eu.style.display&&(eu.style.display="none");c=!1;try{var d=Gl(t).top+t.offsetHeight/2,p=Gl(t).left+t.offsetWidth/2,c="vertical"===f.orientation&&d<=r||"horizontal"===f.orientation&&p<=n}catch(t){c=a<s}c?zl(t,Ml(e).placeholder):(i=t,l=Ml(e).placeholder,Kl(i,l,"before")),Array.from(Rl.values()).filter(function(t){return void 0!==t.placeholder}).forEach(function(t){t.placeholder!==Ml(e).placeholder&&t.placeholder.remove()})}else{h=Array.from(Rl.values()).filter(function(t){return void 0!==t.placeholder}).map(function(t){return t.placeholder});-1!==h.indexOf(t)||e!==t||Nl(t.children,f.items).length||(h.forEach(function(t){return t.remove()}),t.appendChild(Ml(e).placeholder))}},void 0===(o=f.debounce)&&(o=0),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];clearTimeout(s),s=setTimeout(function(){i.apply(void 0,t)},o)});Bl(l.concat(a),"dragover",t),Bl(l.concat(a),"dragenter",t)}),t)}mu.destroy=function(t){var e,n;e=Dl(t=t,"opts")||{},n=Nl(t.children,e.items),e=Xl(n,e.handle),cu(t,!1),Ul(t,"dragover"),Ul(t,"dragenter"),Ul(t,"dragstart"),Ul(t,"dragend"),Ul(t,"drop"),Jl(t),Ul(e,"mousedown"),hu(n),tu(n),du(iu,lu),t.isSortable=!1},mu.enable=function(t){gu(t)},mu.disable=function(t){var e,n;e=Dl(t=t,"opts"),n=Nl(t.children,e.items),n=Xl(n,e.handle),Fl(t,"aria-dropeffect","none"),Dl(t,"_disabled","true"),Fl(n,"draggable","false"),Ul(n,"mousedown"),cu(t,!1)},mu.__testing={data:Dl,removeItemEvents:hu,removeItemData:tu,removeSortableData:Jl,removeContainerEvents:du};var yu=mu;class vu extends cs{static get selector(){return".question input.rank"}static get list(){return!0}_init(){let e=this;var t=this.originalInputValue,n=ys.touch?"rankwidget.tapstart":"rankwidget.clickstart";this.itemSelector="label:not(.itemset-template)",this.list=m(this.element).next(".option-wrapper").addClass("widget rank-widget")[0],m(this.list).toggleClass("rank-widget--empty",!t).append(this.resetButtonHtml).append(`<div class="rank-widget__overlay"><span class="rank-widget__overlay__content" data-i18n="${n}">${ys.touch?C("rankwidget.tapstart"):C("rankwidget.clickstart")}</span></div>`).on("click",function(){e.element.disabled||(this.classList.remove("rank-widget--empty"),e.originalInputValue=e.value,e.element.dispatchEvent(E.FakeFocus()))}),this.list.querySelector(".btn-reset").addEventListener("click",t=>{this._reset(),t.stopPropagation()}),this.element.classList.add("hide"),this.value=t,yu(this.list,{items:this.itemSelector,containerSerializer(t){return{value:[].slice.call(t.node.querySelectorAll(e.itemSelector+" input")).map(t=>t.value).join(" ")}}})[0].addEventListener("sortupdate",()=>{this.originalInputValue=this.value,this.element.dispatchEvent(E.FakeFocus())}),this.props.readonly&&this.disable()}_reset(){}get value(){return yu(this.list,"serialize")[0].container.value}set value(t){if(t){let e=this,n=t.split(" ");t=[...this.list.querySelectorAll(this.itemSelector+" input")];if(n.length!==t.length)throw new Error("Could not load rank widget value. Number of items mismatch.");t.sort((t,e)=>{t=n.indexOf(t.value),e=n.indexOf(e.value);if(-1===t||-1===e)throw new Error("Could not load rank widget value. Mismatch in item values.");return t-e}),t.forEach(t=>{m(e.list).find(".btn-reset").before(m(t.parentNode).detach())})}else this._reset()}disable(){m(this.element).prop("disabled",!0).next(".widget").find("input, button").prop("disabled",!0),yu(this.list,"disable")}enable(){m(this.element).prop("disabled",!1).next(".widget").find("input, button").prop("disabled",!1),yu(this.list,"enable")}update(){var t=this.element.value;yu(this.list),t?(this.value=t,this.originalInputValue=t):this._reset()}get originalInputValue(){return super.originalInputValue}set originalInputValue(t){super.originalInputValue=t,this.list.classList.toggle("rank-widget--empty",!t)}}class _u extends cs{static get selector(){return'.or-appearance-url input[type="text"]'}_init(){var t=document.createRange().createContextualFragment('<a class="widget url-widget" target="_blank" rel="noopener"/>');this.element.classList.add("hide"),this.element.after(t),this.value=this.originalInputValue}update(){this.value=this.originalInputValue}get value(){return this.question.querySelector(".url-widget").href}set value(t){t=t||"";var e=this.question.querySelector(".url-widget");e.href=t,e.title=t,e.textContent=t}}class wu extends cs{static get selector(){return'[data-type-xml="string"]'}_init(){var t=Number(rt.textMaxChars);!isNaN(t)&&0<t&&this.element.setAttribute("maxlength",rt.textMaxChars)}}class bu extends cs{static get selector(){return' .question input[type="date"], .question input[type="datetime-local"], .question input[type="time"]'}static condition(t){return!qe.has(t,"DatepickerExtended")&&!qe.has(t,"DatetimepickerExtended")&&!qe.has(t,"TimepickerExtended")&&ps.ios}_init(){this.element.addEventListener("focus",()=>{this.element.readOnly&&this.element.blur()})}}class Cu extends cs{static get selector(){return'.or-appearance-rating input[type="number"]'}_init(){var t=document.createRange().createContextualFragment(this._getHtmlStr());this.element.after(t),this.element.classList.add("hide"),this.widget=this.question.querySelector(".widget");let e="",n=Math.random().toString(36).substring(2,15);for(let t=this.props.min;t<=this.props.max;t+=this.props.step)e+=`<input type=radio name="rating-stars__${n}" class="rating-widget__rating__star ignore" value="${t}"/>`;this.widget.querySelector(".rating-widget__rating").append(document.createRange().createContextualFragment(e)),this.rating=this.widget.querySelector(".rating-widget__rating"),this.stars=this.rating.querySelectorAll(".rating-widget__rating__star"),this.stars.forEach(t=>{t.addEventListener("change",()=>{var t=this.rating.querySelector("input:checked");this.value==t.value&&!this.rating.classList.contains("empty")||(this.value=t.value)})}),this.update(),this.props.readonly&&this.disable()}_getHtmlStr(){return`<div class="widget rating-widget">
                	<div class="rating-widget__rating empty"></div>
            	</div>`}disable(){this.stars.forEach(t=>t.disabled=!0)}enable(){this.stars.forEach(t=>t.disabled=!1)}update(){let e=this.element.value;xe(e)?this.stars.forEach(t=>{t.value===e&&(t.checked=!0,t.dispatchEvent(E.Change()))}):this._reset()}_reset(){var t=this.rating.querySelector("input:checked");t&&(this.value="",t.checked=!1)}get props(){var t=this._props,e=xe(this.element.getAttribute("min"))?this.element.getAttribute("min"):0,n=xe(this.element.getAttribute("max"))?this.element.getAttribute("max"):10,r=xe(this.element.getAttribute("step"))?this.element.getAttribute("step"):1;return t.min=Number(e),t.max=Number(n),t.step=Number(r),t}get value(){return this.originalInputValue}set value(t){this.originalInputValue=t,this.rating.classList.toggle("empty",""===t)}}class Eu extends cs{static get selector(){return".question:not(.or-appearance-autocomplete):not(.or-appearance-url) > input[type=text]:not(.ignore):not([data-for]), .question:not(.or-appearance-autocomplete):not(.or-appearance-url) > textarea:not(.ignore):not([data-for])"}_init(){this.question.addEventListener(E.Printify().type,this._addWidget.bind(this)),this.question.addEventListener(E.DePrintify().type,this._removeWidget.bind(this))}_addWidget(){var t,e;this.widget||(t="print-input-text",(e=document.createElement("div")).classList.add(t,"widget"),this.element.after(e),this.element.classList.add("print-hide"),this.widget=this.element.parentElement.querySelector("."+t),this.widget.innerHTML=this.element.value.replace(/\n/g,"<br>"))}_removeWidget(){this.widget&&(this.element.classList.remove("print-hide"),this.element.parentElement.removeChild(this.widget),this.widget=null)}}class Su extends cs{static get selector(){return'.or-appearance-thousands-sep input[type="number"]'}_init(){var t=document.createRange().createContextualFragment('<div class="widget "></div>');this.element.after(t),this.widget=this.element.parentElement.querySelector(".widget"),this.update(),this.element.addEventListener("change",this.update.bind(this))}update(){this.value=this.originalInputValue}get value(){return this.widget.textContent}set value(t){let e="";xe(t)&&(e=Number(t).toLocaleString(void 0,{maximumFractionDigits:20})),this.widget.textContent=e}}let Tu="flash",Au="stop",Iu="start",Lu="finish";class ku extends cs{static get selector(){return".or-appearance-literacy.simple-select"}static get helpersRequired(){return["evaluate"]}_init(){var t,e,n,r=document.createRange();!this.element.querySelector('input[type="checkbox"]')||this.element.querySelector('input[type="checkbox"][readonly]')?console.error("literacy widget cannot be instantiated on this question type"):(e=this.props.name,t=this._getCurrentModelValue(),this.checkboxes=[...this.element.querySelectorAll('input[type="checkbox"]')],this.checkboxes.forEach(t=>{t.classList.add("ignore"),t.removeAttribute("name"),t.removeAttribute("data-type-xml"),t.removeAttribute("data-relevant"),t.disabled=!0}),(n=this.element.querySelector(".option-wrapper")).classList.add("widget","literacy-widget"),n.after(r.createContextualFragment(`<input type="text" name="${e}" ${this.props.readonly?"readonly":""}${["required","constraint","relevant"].map(t=>this.props[t]?`data-${t}="${this.props[t]}" `:"").join("")}/>`)),this.input=this.element.querySelector(`input[name="${e}"]`),n.prepend(r.createContextualFragment(`<button class="btn btn-default literacy-widget__start" type="button" data-i18n="literacywidget.start">Start</button>
                <div class="literacy-widget__timer"/>`)),e=n.querySelector(".literacy-widget__start"),n.append(r.createContextualFragment('<button class="btn btn-primary literacy-widget__stop" disabled type="button" data-i18n="literacywidget.finish">Finish</button>')),n.append(this.resetButtonHtml),r=n.querySelector(".literacy-widget__stop"),n=n.querySelector(".btn-reset"),this._addResetHandler(n),n.click(),this._addTimerHandlers(e,r),this._addWordHandlers(),t&&(this.input.value=t,this.value=t,this._setState(Lu)))}_getCurrentModelValue(){var t=3<this.props.name.split("/").length?this.props.name.substring(0,this.props.name.lastIndexOf("/")):null,e=this.element.closest(".or-repeat[name]"),e=e?[...this.element.closest("form.or").querySelectorAll(`.or-repeat[name="${e.getAttribute("name")}"]`)].indexOf(e):0;return this.options.helpers.evaluate(this.props.name,"string",t,e)}_addResetHandler(t){t.addEventListener("click",()=>{this.timer&&this.timer.interval&&clearInterval(this.timer.interval),this.timer={elapsed:0,element:this.element.querySelector(".literacy-widget__timer"),interval:null,state:null},this.result={flashWordIndex:null,lastWordIndex:null},this.input.value="",this.input.dispatchEvent(E.Change()),this._resetCheckboxes(),this._resetWords(),this._updateTimer(),this._setState(null)})}_addTimerHandlers(t,e){this._updateTimer(),t.addEventListener("click",()=>{this.timer.interval=setInterval(this._tick.bind(this),1e3),this._setState(Iu),e.disabled=!1}),e.addEventListener("click",()=>{clearInterval(this.timer.interval),this._setState(Au),e.disabled=!0})}_addWordHandlers(){this.element.addEventListener("click",t=>"input"===t.target.nodeName.toLowerCase()),this.element.querySelectorAll(".option-label").forEach(t=>t.addEventListener("click",t=>{-1!==[Iu,Au,Tu].indexOf(this.timer.state)&&t.target.closest("label").classList.toggle("incorrect-word")})),this.element.addEventListener("change",t=>{t.target.matches('input[type="checkbox"]')&&(t.target.checked&&this.timer.state===Tu?(this.result.flashWordIndex=this._getCheckboxIndex(t.target),this._setState(Iu)):t.target.checked&&this.timer.state===Au&&(this.result.lastWordIndex=this._getCheckboxIndex(t.target),this.input.value=this.value,this.input.dispatchEvent(E.Change()),this._setState(Lu)))})}_resetWords(){this.element.querySelectorAll(".incorrect-word, .at-flash, .at-end, .unread").forEach(t=>t.classList.remove("incorrect-word","at-flash","at-end","unread"))}_hideCheckboxes(){this.checkboxes.forEach(t=>t.disabled=!0)}_getCheckboxIndex(t){return this.checkboxes.indexOf(t)}_showCheckboxes(t){this.checkboxes.slice(t=0<t?t:0).forEach(t=>t.disabled=!1)}_resetCheckboxes(){this.checkboxes.forEach(t=>t.checked=!1)}_setState(t){let e;switch(this.element.classList.remove(Iu,Au,Tu,Lu),(this.timer.state=t)&&this.element.classList.add(t),t){case Iu:this._updateWordCounts(),this._hideCheckboxes();break;case Au:e=this._getCheckboxIndex([...this.element.querySelectorAll('.incorrect-word input[type="checkbox"]')].pop()),this._showCheckboxes(this.result.flashWordIndex>=e?this.result.flashWordIndex:e);break;case Tu:e=this._getCheckboxIndex([...this.element.querySelectorAll('.incorrect-word input[type="checkbox"]')].pop()),this._showCheckboxes(e||0);break;case Lu:this._updateWordCounts(),this._hideCheckboxes();break;default:this._hideCheckboxes()}}_updateTimer(){this.timer.element.textContent=this._formatTime(this.timer.elapsed)}_updateWordCounts(){if(null!==this.result.flashWordIndex&&this.checkboxes[this.result.flashWordIndex].parentElement.classList.add("at-flash"),null!==this.result.lastWordIndex){this.checkboxes[this.result.lastWordIndex].parentElement.classList.add("at-end");let t=this.result.lastWordIndex+1;for(;this.checkboxes[t];)this.checkboxes[t].parentElement.classList.add("unread"),t++}}_formatTime(t){var e=~~(t/3600),n=~~(t%3600/60),t=t%60;let r="";return 0<e&&(r+=e+":"+(n<10?"0":"")),r=r+(n+":"+(t<10?"0":""))+(""+t)}_tick(){this.timer.elapsed++,this._updateTimer(),this.timer.elapsed===this.props.flashTime&&this._setState(Tu)}_convertSpaceList(t){t=t.split(" ").map(t=>"null"===t?null:Number(t));return{flashCount:t[0],finishCount:t[2],finishTime:t[1],incorrectWords:t.splice(10)}}get props(){var t=this._props,e=this.element.querySelector('input[type="text"], input[type="checkbox"]'),n=this.element.querySelectorAll(".option-wrapper label");return t.flashTime=isNaN(this.element.dataset.flash)?60:Number(this.element.dataset.flash),t.name=e.name,t.numberWords=n.length,t.relevant=e.dataset.relevant||"",t.constraint=e.dataset.constraint||"",t.required=e.dataset.required||"",t}get value(){var t=null!==this.result.lastWordIndex?this.result.lastWordIndex:null,e=null!==this.result.flashWordIndex?this.result.flashWordIndex:null,n=[...this.element.querySelectorAll(".incorrect-word input")].map(t=>t.value);return[e,this.timer.elapsed,t,null,null,null,null,null,null,null].map(t=>null==t?"null":t).concat(n).join(" ")}set value(t){t=this._convertSpaceList(t);let e=this.checkboxes.map(t=>t.parentElement);this.timer.elapsed=t.finishTime,this.result.lastWordIndex=null!==t.finishCount?t.finishCount-1:null,this.result.flashWordIndex=null!==t.flashCount?t.flashCount-1:null,this._updateTimer(),this._updateWordCounts(),t.incorrectWords.forEach(t=>{e[t-1].classList.add("incorrect-word")})}}class xu extends cs{static get selector(){return'.or-appearance-form input[type="text"]'}_init(){var t=document.createRange().createContextualFragment('<a class="widget form-widget btn btn-primary" role="button" rel="noopener"/>');this.element.classList.add("hide"),this.element.after(t),this.value=this.originalInputValue}update(){this.value=this.originalInputValue}get value(){return this.question.querySelector(".form-widget").href}set value(t){t=t||"";var e=this.question.querySelector(".form-widget");e.href=t,e.title=this.question.title,e.textContent=this.question.title}}Du=function(t,e){return(Du=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};var Du,Nu,Ru=Mu,Pu=Nu=Error;if("function"!=typeof Pu&&null!==Pu)throw new TypeError("Class extends value "+String(Pu)+" is not a constructor or null");function Ou(){this.constructor=Ru}function Mu(t,e){var n,r,i=this.constructor,t=Nu.call(this,t,e)||this;return Object.defineProperty(t,"name",{value:i.name,enumerable:!1,configurable:!0}),e=t,i=i.prototype,(n=Object.setPrototypeOf)?n(e,i):e.__proto__=i,n=t,void 0===r&&(r=n.constructor),(e=Error.captureStackTrace)&&e(n,r),t}Du(Ru,Pu),Ru.prototype=null===Pu?Object.create(Pu):(Ou.prototype=Pu.prototype,new Ou);var Bu,Uu=Hu,Fu=Bu=i=Mu;function Vu(){this.constructor=Uu}function Hu(t){var e=Bu.call(this,t=void 0===t?void 0:t)||this;return e.message=t,e}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Uu,Fu),Uu.prototype=null===Fu?Object.create(Fu):(Vu.prototype=Fu.prototype,new Vu),Hu.prototype.getKind=function(){return this.constructor.kind},Hu.kind="Exception";var zu=$u,ju=Wu=n=Hu;function qu(){this.constructor=zu}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(zu,ju),zu.prototype=null===ju?Object.create(ju):(qu.prototype=ju.prototype,new qu),$u.kind="ArgumentException";var Wu,Gu=$u;function $u(){return null!==Wu&&Wu.apply(this,arguments)||this}var Ku=Ju,Xu=Yu=n;function Zu(){this.constructor=Ku}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Ku,Xu),Ku.prototype=null===Xu?Object.create(Xu):(Zu.prototype=Xu.prototype,new Zu),Ju.kind="IllegalArgumentException";var Yu,Qu=Ju;function Ju(){return null!==Yu&&Yu.apply(this,arguments)||this}ec.prototype.getWidth=function(){return this.binarizer.getWidth()},ec.prototype.getHeight=function(){return this.binarizer.getHeight()},ec.prototype.getBlackRow=function(t,e){return this.binarizer.getBlackRow(t,e)},ec.prototype.getBlackMatrix=function(){return null==this.matrix&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},ec.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},ec.prototype.crop=function(t,e,n,r){t=this.binarizer.getLuminanceSource().crop(t,e,n,r);return new ec(this.binarizer.createBinarizer(t))},ec.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},ec.prototype.rotateCounterClockwise=function(){var t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new ec(this.binarizer.createBinarizer(t))},ec.prototype.rotateCounterClockwise45=function(){var t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new ec(this.binarizer.createBinarizer(t))},ec.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch(t){return""}};var tc=ec;function ec(t){if(null===(this.binarizer=t))throw new Qu("Binarizer must be non-null.")}var nc=sc,rc=oc=n;function ic(){this.constructor=nc}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(nc,rc),nc.prototype=null===rc?Object.create(rc):(ic.prototype=rc.prototype,new ic),sc.getChecksumInstance=function(){return new sc},sc.kind="ChecksumException";var oc,ac=sc;function sc(){return null!==oc&&oc.apply(this,arguments)||this}function lc(t){this.source=t}lc.prototype.getLuminanceSource=function(){return this.source},lc.prototype.getWidth=function(){return this.source.getWidth()},lc.prototype.getHeight=function(){return this.source.getHeight()},t=lc,cc.arraycopy=function(t,e,n,r,i){for(;i--;)n[r++]=t[e++]},cc.currentTimeMillis=function(){return Date.now()};var uc=cc;function cc(){}var hc=mc,dc=fc=n;function pc(){this.constructor=hc}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(hc,dc),hc.prototype=null===dc?Object.create(dc):(pc.prototype=dc.prototype,new pc),mc.kind="IndexOutOfBoundsException";var fc,gc=mc;function mc(){return null!==fc&&fc.apply(this,arguments)||this}var yc=Cc,vc=wc=gc;function _c(){this.constructor=yc}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(yc,vc),yc.prototype=null===vc?Object.create(vc):(_c.prototype=vc.prototype,new _c),Cc.kind="ArrayIndexOutOfBoundsException";var wc,bc=Cc;function Cc(t,e){void 0===t&&(t=void 0);var n=wc.call(this,e=void 0===e?void 0:e)||this;return n.index=t,n.message=e,n}var Ec=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Sc=(Tc.fill=function(t,e){for(var n=0,r=t.length;n<r;n++)t[n]=e},Tc.fillWithin=function(t,e,n,r){Tc.rangeCheck(t.length,e,n);for(var i=e;i<n;i++)t[i]=r},Tc.rangeCheck=function(t,e,n){if(n<e)throw new Qu("fromIndex("+e+") > toIndex("+n+")");if(e<0)throw new bc(e);if(t<n)throw new bc(n)},Tc.asList=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t},Tc.create=function(t,e,n){return Array.from({length:t}).map(function(t){return Array.from({length:e}).fill(n)})},Tc.createInt32Array=function(t,e,n){return Array.from({length:t}).map(function(t){return Int32Array.from({length:e}).fill(n)})},Tc.equals=function(t,e){if(!t)return!1;if(!e)return!1;if(!t.length)return!1;if(!e.length)return!1;if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0},Tc.hashCode=function(t){var e,n;if(null===t)return 0;var r=1;try{for(var i=Ec(t),o=i.next();!o.done;o=i.next())r=31*r+o.value}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},Tc.fillUint8Array=function(t,e){for(var n=0;n!==t.length;n++)t[n]=e},Tc.copyOf=function(t,e){return t.slice(0,e)},Tc.copyOfUint8Array=function(t,e){var n;return t.length<=e?((n=new Uint8Array(e)).set(t),n):t.slice(0,e)},Tc.copyOfRange=function(t,e,n){var n=n-e,r=new Int32Array(n);return uc.arraycopy(t,e,r,0,n),r},Tc.binarySearch=function(t,e,n){void 0===n&&(n=Tc.numberComparator);for(var r=0,i=t.length-1;r<=i;){var o=i+r>>1,a=n(e,t[o]);if(0<a)r=1+o;else{if(!(a<0))return o;i=o-1}}return-r-1},Tc.numberComparator=function(t,e){return t-e},Tc);function Tc(){}Ic.numberOfTrailingZeros=function(t){var e,n;return 0===t?32:(e=31,0!=(n=t<<16)&&(e-=16,t=n),0!=(n=t<<8)&&(e-=8,t=n),0!=(n=t<<4)&&(e-=4,t=n),0!=(n=t<<2)&&(e-=2,t=n),e-(t<<1>>>31))},Ic.numberOfLeadingZeros=function(t){var e;return 0===t?32:(e=1,t>>>16==0&&(e+=16,t<<=16),t>>>24==0&&(e+=8,t<<=8),t>>>28==0&&(e+=4,t<<=4),t>>>30==0&&(e+=2,t<<=2),e-(t>>>31))},Ic.toHexString=function(t){return t.toString(16)},Ic.toBinaryString=function(t){return String(parseInt(String(t),2))},Ic.bitCount=function(t){return t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135,63&(t=(t+=t>>>8)+(t>>>16))},Ic.truncDivision=function(t,e){return Math.trunc(t/e)},Ic.parseInt=function(t,e){return void 0===e&&(e=void 0),parseInt(t,e)},Ic.MIN_VALUE_32_BITS=-2147483648,Ic.MAX_VALUE=Number.MAX_SAFE_INTEGER;var Ac=Ic;function Ic(){}kc.prototype.getSize=function(){return this.size},kc.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},kc.prototype.ensureCapacity=function(t){t>32*this.bits.length&&(t=kc.makeArray(t),uc.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t)},kc.prototype.get=function(t){return 0!=(this.bits[Math.floor(t/32)]&1<<(31&t))},kc.prototype.set=function(t){this.bits[Math.floor(t/32)]|=1<<(31&t)},kc.prototype.flip=function(t){this.bits[Math.floor(t/32)]^=1<<(31&t)},kc.prototype.getNextSet=function(t){var e=this.size;if(e<=t)return e;for(var n=this.bits,r=Math.floor(t/32),i=n[r],o=(i&=~((1<<(31&t))-1),n.length);0===i;){if(++r===o)return e;i=n[r]}t=32*r+Ac.numberOfTrailingZeros(i);return e<t?e:t},kc.prototype.getNextUnset=function(t){var e=this.size;if(e<=t)return e;for(var n=this.bits,r=Math.floor(t/32),i=~n[r],o=(i&=~((1<<(31&t))-1),n.length);0===i;){if(++r===o)return e;i=~n[r]}t=32*r+Ac.numberOfTrailingZeros(i);return e<t?e:t},kc.prototype.setBulk=function(t,e){this.bits[Math.floor(t/32)]=e},kc.prototype.setRange=function(t,e){if(e<t||t<0||e>this.size)throw new Qu;if(e!==t){e--;for(var n=Math.floor(t/32),r=Math.floor(e/32),i=this.bits,o=n;o<=r;o++)i[o]|=(2<<(o<r?31:31&e))-(1<<(n<o?0:31&t))}},kc.prototype.clear=function(){for(var t=this.bits.length,e=this.bits,n=0;n<t;n++)e[n]=0},kc.prototype.isRange=function(t,e,n){if(e<t||t<0||e>this.size)throw new Qu;if(e!==t){e--;for(var r=Math.floor(t/32),i=Math.floor(e/32),o=this.bits,a=r;a<=i;a++){var s=(2<<(a<i?31:31&e))-(1<<(r<a?0:31&t))&4294967295;if((o[a]&s)!=(n?s:0))return!1}}return!0},kc.prototype.appendBit=function(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++},kc.prototype.appendBits=function(t,e){if(e<0||32<e)throw new Qu("Num bits must be between 0 and 32");this.ensureCapacity(this.size+e);for(var n=e;0<n;n--)this.appendBit(1==(t>>n-1&1))},kc.prototype.appendBitArray=function(t){var e=t.size;this.ensureCapacity(this.size+e);for(var n=0;n<e;n++)this.appendBit(t.get(n))},kc.prototype.xor=function(t){if(this.size!==t.size)throw new Qu("Sizes don't match");for(var e=this.bits,n=0,r=e.length;n<r;n++)e[n]^=t.bits[n]},kc.prototype.toBytes=function(t,e,n,r){for(var i=0;i<r;i++){for(var o=0,a=0;a<8;a++)this.get(t)&&(o|=1<<7-a),t++;e[n+i]=o}},kc.prototype.getBitArray=function(){return this.bits},kc.prototype.reverse=function(){for(var t=new Int32Array(this.bits.length),e=Math.floor((this.size-1)/32),n=e+1,r=this.bits,i=0;i<n;i++){var o=r[i];t[e-i]=(o=(o=(o=(o=o>>1&1431655765|(1431655765&o)<<1)>>2&858993459|(858993459&o)<<2)>>4&252645135|(252645135&o)<<4)>>8&16711935|(16711935&o)<<8)>>16&65535|(65535&o)<<16}if(this.size!==32*n){for(var a=32*n-this.size,s=t[0]>>>a,i=1;i<n;i++){var l=t[i];s|=l<<32-a,t[i-1]=s,s=l>>>a}t[n-1]=s}this.bits=t},kc.makeArray=function(t){return new Int32Array(Math.floor((t+31)/32))},kc.prototype.equals=function(t){return t instanceof kc&&this.size===t.size&&Sc.equals(this.bits,t.bits)},kc.prototype.hashCode=function(){return 31*this.size+Sc.hashCode(this.bits)},kc.prototype.toString=function(){for(var t="",e=0,n=this.size;e<n;e++)0==(7&e)&&(t+=" "),t+=this.get(e)?"X":".";return t},kc.prototype.clone=function(){return new kc(this.size,this.bits.slice())},kc.prototype.toArray=function(){for(var t=[],e=0,n=this.size;e<n;e++)t.push(this.get(e));return t};var Lc=kc;function kc(t,e){void 0===t?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,this.bits=null==e?kc.makeArray(t):e)}(me=l=l||{})[me.OTHER=0]="OTHER",me[me.PURE_BARCODE=1]="PURE_BARCODE",me[me.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",me[me.TRY_HARDER=3]="TRY_HARDER",me[me.CHARACTER_SET=4]="CHARACTER_SET",me[me.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",me[me.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",me[me.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",me[me.ASSUME_GS1=8]="ASSUME_GS1",me[me.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",me[me.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",me[me.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS";var xc=l,Dc=Oc,Nc=Pc=n;function Rc(){this.constructor=Dc}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Dc,Nc),Dc.prototype=null===Nc?Object.create(Nc):(Rc.prototype=Nc.prototype,new Rc),Oc.getFormatInstance=function(){return new Oc},Oc.kind="FormatException";var Pc,A=Oc;function Oc(){return null!==Pc&&Pc.apply(this,arguments)||this}var Mc=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Bc=((u=M=M||{})[u.Cp437=0]="Cp437",u[u.ISO8859_1=1]="ISO8859_1",u[u.ISO8859_2=2]="ISO8859_2",u[u.ISO8859_3=3]="ISO8859_3",u[u.ISO8859_4=4]="ISO8859_4",u[u.ISO8859_5=5]="ISO8859_5",u[u.ISO8859_6=6]="ISO8859_6",u[u.ISO8859_7=7]="ISO8859_7",u[u.ISO8859_8=8]="ISO8859_8",u[u.ISO8859_9=9]="ISO8859_9",u[u.ISO8859_10=10]="ISO8859_10",u[u.ISO8859_11=11]="ISO8859_11",u[u.ISO8859_13=12]="ISO8859_13",u[u.ISO8859_14=13]="ISO8859_14",u[u.ISO8859_15=14]="ISO8859_15",u[u.ISO8859_16=15]="ISO8859_16",u[u.SJIS=16]="SJIS",u[u.Cp1250=17]="Cp1250",u[u.Cp1251=18]="Cp1251",u[u.Cp1252=19]="Cp1252",u[u.Cp1256=20]="Cp1256",u[u.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",u[u.UTF8=22]="UTF8",u[u.ASCII=23]="ASCII",u[u.Big5=24]="Big5",u[u.GB18030=25]="GB18030",u[u.EUC_KR=26]="EUC_KR",f.prototype.getValueIdentifier=function(){return this.valueIdentifier},f.prototype.getName=function(){return this.name},f.prototype.getValue=function(){return this.values[0]},f.getCharacterSetECIByValue=function(t){if(t<0||900<=t)throw new A("incorect value");t=f.VALUES_TO_ECI.get(t);if(void 0===t)throw new A("incorect value");return t},f.getCharacterSetECIByName=function(t){t=f.NAME_TO_ECI.get(t);if(void 0===t)throw new A("incorect value");return t},f.prototype.equals=function(t){return t instanceof f&&(t=t,this.getName()===t.getName())},f.VALUE_IDENTIFIER_TO_ECI=new Map,f.VALUES_TO_ECI=new Map,f.NAME_TO_ECI=new Map,f.Cp437=new f(M.Cp437,Int32Array.from([0,2]),"Cp437"),f.ISO8859_1=new f(M.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),f.ISO8859_2=new f(M.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),f.ISO8859_3=new f(M.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),f.ISO8859_4=new f(M.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),f.ISO8859_5=new f(M.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),f.ISO8859_6=new f(M.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),f.ISO8859_7=new f(M.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),f.ISO8859_8=new f(M.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),f.ISO8859_9=new f(M.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),f.ISO8859_10=new f(M.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),f.ISO8859_11=new f(M.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),f.ISO8859_13=new f(M.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),f.ISO8859_14=new f(M.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),f.ISO8859_15=new f(M.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),f.ISO8859_16=new f(M.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),f.SJIS=new f(M.SJIS,20,"SJIS","Shift_JIS"),f.Cp1250=new f(M.Cp1250,21,"Cp1250","windows-1250"),f.Cp1251=new f(M.Cp1251,22,"Cp1251","windows-1251"),f.Cp1252=new f(M.Cp1252,23,"Cp1252","windows-1252"),f.Cp1256=new f(M.Cp1256,24,"Cp1256","windows-1256"),f.UnicodeBigUnmarked=new f(M.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),f.UTF8=new f(M.UTF8,26,"UTF8","UTF-8"),f.ASCII=new f(M.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),f.Big5=new f(M.Big5,28,"Big5"),f.GB18030=new f(M.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),f.EUC_KR=new f(M.EUC_KR,30,"EUC_KR","EUC-KR"),f);function f(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];this.valueIdentifier=t,this.name=n,this.values="number"==typeof e?Int32Array.from([e]):e,this.otherEncodingNames=o,f.VALUE_IDENTIFIER_TO_ECI.set(t,this),f.NAME_TO_ECI.set(n,this);for(var s=this.values,l=0,u=s.length;l!==u;l++){var c=s[l];f.VALUES_TO_ECI.set(c,this)}try{for(var h=Mc(o),d=h.next();!d.done;d=h.next()){var p=d.value;f.NAME_TO_ECI.set(p,this)}}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}var Uc=jc,Fc=Hc=n;function Vc(){this.constructor=Uc}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Uc,Fc),Uc.prototype=null===Fc?Object.create(Fc):(Vc.prototype=Fc.prototype,new Vc),jc.kind="UnsupportedOperationException";var Hc,zc=jc;function jc(){return null!==Hc&&Hc.apply(this,arguments)||this}Wc.decode=function(t,e){e=this.encodingName(e);return this.customDecoder?this.customDecoder(t,e):"undefined"==typeof TextDecoder||this.shouldDecodeOnFallback(e)?this.decodeFallback(t,e):new TextDecoder(e).decode(t)},Wc.shouldDecodeOnFallback=function(t){return!Wc.isBrowser()&&"ISO-8859-1"===t},Wc.encode=function(t,e){e=this.encodingName(e);return this.customEncoder?this.customEncoder(t,e):"undefined"==typeof TextEncoder?this.encodeFallback(t):(new TextEncoder).encode(t)},Wc.isBrowser=function(){return"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)},Wc.encodingName=function(t){return"string"==typeof t?t:t.getName()},Wc.encodingCharacterSet=function(t){return t instanceof Bc?t:Bc.getCharacterSetECIByName(t)},Wc.decodeFallback=function(t,e){var n=this.encodingCharacterSet(e);if(Wc.isDecodeFallbackSupported(n)){for(var r="",i=0,o=t.length;i<o;i++){var a=t[i].toString(16);r+="%"+(a=a.length<2?"0"+a:a)}return decodeURIComponent(r)}if(n.equals(Bc.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new zc("Encoding "+this.encodingName(e)+" not supported by fallback.")},Wc.isDecodeFallbackSupported=function(t){return t.equals(Bc.UTF8)||t.equals(Bc.ISO8859_1)||t.equals(Bc.ASCII)},Wc.encodeFallback=function(t){for(var e=btoa(unescape(encodeURIComponent(t))).split(""),n=[],r=0;r<e.length;r++)n.push(e[r].charCodeAt(0));return new Uint8Array(n)};var qc=Wc;function Wc(){}$c.castAsNonUtf8Char=function(t,e){e=(e=void 0===e?null:e)?e.getName():this.ISO88591;return qc.decode(new Uint8Array([t]),e)},$c.guessEncoding=function(t,e){if(null!=e&&void 0!==e.get(xc.CHARACTER_SET))return e.get(xc.CHARACTER_SET).toString();for(var n=t.length,r=!0,i=!0,o=!0,a=0,s=0,l=0,u=0,c=0,h=0,d=0,p=0,f=0,g=0,m=0,e=3<t.length&&239===t[0]&&187===t[1]&&191===t[2],y=0;y<n&&(r||i||o);y++){var v=255&t[y];o&&(0<a?0==(128&v)?o=!1:a--:0!=(128&v)&&(0==(64&v)?o=!1:(a++,0==(32&v)?s++:(a++,0==(16&v)?l++:(a++,0==(8&v)?u++:o=!1))))),r&&(127<v&&v<160?r=!1:159<v&&(v<192||215==v||247==v)&&m++),i&&(0<c?v<64||127==v||252<v?i=!1:c--:128==v||160==v||239<v?i=!1:160<v&&v<224?(h++,p=0,f<++d&&(f=d)):127<v?(c++,d=0,g<++p&&(g=p)):p=d=0)}return i&&0<c&&(i=!1),(o=o&&0<a?!1:o)&&(e||0<s+l+u)?$c.UTF8:i&&($c.ASSUME_SHIFT_JIS||3<=f||3<=g)?$c.SHIFT_JIS:r&&i?2===f&&2===h||n<=10*m?$c.SHIFT_JIS:$c.ISO88591:r?$c.ISO88591:i?$c.SHIFT_JIS:o?$c.UTF8:$c.PLATFORM_DEFAULT_ENCODING},$c.format=function(t){for(var c=[],e=1;e<arguments.length;e++)c[e-1]=arguments[e];var h=-1;return t.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(t,e,n,r,i,o){if("%%"===t)return"%";if(void 0!==c[++h]){t=r?parseInt(r.substr(1)):void 0;var a=i?parseInt(i.substr(1)):void 0;switch(o){case"s":s=c[h];break;case"c":s=c[h][0];break;case"f":s=parseFloat(c[h]).toFixed(t);break;case"p":s=parseFloat(c[h]).toPrecision(t);break;case"e":s=parseFloat(c[h]).toExponential(t);break;case"x":s=parseInt(c[h]).toString(a||16);break;case"d":s=parseFloat(parseInt(c[h],a||10).toPrecision(t)).toFixed(0)}for(var s="object"==typeof s?JSON.stringify(s):(+s).toString(a),l=parseInt(n),u=n&&n[0]+""=="0"?"0":" ";s.length<l;)s=void 0!==e?s+u:u+s;return s}})},$c.getBytes=function(t,e){return qc.encode(t,e)},$c.getCharCode=function(t,e){return t.charCodeAt(e=void 0===e?0:e)},$c.getCharAt=function(t){return String.fromCharCode(t)},$c.SHIFT_JIS=Bc.SJIS.getName(),$c.GB2312="GB2312",$c.ISO88591=Bc.ISO8859_1.getName(),$c.EUC_JP="EUC_JP",$c.UTF8=Bc.UTF8.getName(),$c.PLATFORM_DEFAULT_ENCODING=$c.UTF8,$c.ASSUME_SHIFT_JIS=!1;var Gc=$c;function $c(){}Xc.prototype.enableDecoding=function(t){return this.encoding=t,this},Xc.prototype.append=function(t){return"string"==typeof t?this.value+=t.toString():this.encoding?this.value+=Gc.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this},Xc.prototype.appendChars=function(t,e,n){for(var r=e;e<e+n;r++)this.append(t[r]);return this},Xc.prototype.length=function(){return this.value.length},Xc.prototype.charAt=function(t){return this.value.charAt(t)},Xc.prototype.deleteCharAt=function(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)},Xc.prototype.setCharAt=function(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+1)},Xc.prototype.substring=function(t,e){return this.value.substring(t,e)},Xc.prototype.setLengthToZero=function(){this.value=""},Xc.prototype.toString=function(){return this.value},Xc.prototype.insert=function(t,e){this.value=this.value.substring(0,t)+e+this.value.substring(t)};var Kc=Xc;function Xc(t){this.value=t=void 0===t?"":t}Yc.parseFromBooleanArray=function(t){for(var e=t.length,n=t[0].length,r=new Yc(n,e),i=0;i<e;i++)for(var o=t[i],a=0;a<n;a++)o[a]&&r.set(a,i);return r},Yc.parseFromString=function(t,e,n){if(null===t)throw new Qu("stringRepresentation cannot be null");for(var r=new Array(t.length),i=0,o=0,a=-1,s=0,l=0;l<t.length;)if("\n"===t.charAt(l)||"\r"===t.charAt(l)){if(o<i){if(-1===a)a=i-o;else if(i-o!==a)throw new Qu("row lengths do not match");o=i,s++}l++}else{if(t.substring(l,l+e.length)===e)l+=e.length,r[i]=!0;else{if(t.substring(l,l+n.length)!==n)throw new Qu("illegal character encountered: "+t.substring(l));l+=n.length,r[i]=!1}i++}if(o<i){if(-1===a)a=i-o;else if(i-o!==a)throw new Qu("row lengths do not match");s++}for(var u=new Yc(a,s),c=0;c<i;c++)r[c]&&u.set(Math.floor(c%a),Math.floor(c/a));return u},Yc.prototype.get=function(t,e){e=e*this.rowSize+Math.floor(t/32);return 0!=(this.bits[e]>>>(31&t)&1)},Yc.prototype.set=function(t,e){e=e*this.rowSize+Math.floor(t/32);this.bits[e]|=1<<(31&t)&4294967295},Yc.prototype.unset=function(t,e){e=e*this.rowSize+Math.floor(t/32);this.bits[e]&=~(1<<(31&t)&4294967295)},Yc.prototype.flip=function(t,e){e=e*this.rowSize+Math.floor(t/32);this.bits[e]^=1<<(31&t)&4294967295},Yc.prototype.xor=function(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new Qu("input matrix dimensions do not match");for(var e=new Lc(Math.floor(this.width/32)+1),n=this.rowSize,r=this.bits,i=0,o=this.height;i<o;i++)for(var a=i*n,s=t.getRow(i,e).getBitArray(),l=0;l<n;l++)r[a+l]^=s[l]},Yc.prototype.clear=function(){for(var t=this.bits,e=t.length,n=0;n<e;n++)t[n]=0},Yc.prototype.setRegion=function(t,e,n,r){if(e<0||t<0)throw new Qu("Left and top must be nonnegative");if(r<1||n<1)throw new Qu("Height and width must be at least 1");var i=t+n,o=e+r;if(o>this.height||i>this.width)throw new Qu("The region must fit inside the matrix");for(var a=this.rowSize,s=this.bits,l=e;l<o;l++)for(var u=l*a,c=t;c<i;c++)s[u+Math.floor(c/32)]|=1<<(31&c)&4294967295},Yc.prototype.getRow=function(t,e){null==e||e.getSize()<this.width?e=new Lc(this.width):e.clear();for(var n=this.rowSize,r=this.bits,i=t*n,o=0;o<n;o++)e.setBulk(32*o,r[i+o]);return e},Yc.prototype.setRow=function(t,e){uc.arraycopy(e.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)},Yc.prototype.rotate180=function(){for(var t=this.getWidth(),e=this.getHeight(),n=new Lc(t),r=new Lc(t),i=0,o=Math.floor((e+1)/2);i<o;i++)n=this.getRow(i,n),r=this.getRow(e-1-i,r),n.reverse(),r.reverse(),this.setRow(i,r),this.setRow(e-1-i,n)},Yc.prototype.getEnclosingRectangle=function(){for(var t=this.width,e=this.height,n=this.rowSize,r=this.bits,i=t,o=e,a=-1,s=-1,l=0;l<e;l++)for(var u=0;u<n;u++){var c=r[l*n+u];if(0!==c){if(l<o&&(o=l),s<l&&(s=l),32*u<i){for(var h=0;0==(c<<31-h&4294967295);)h++;32*u+h<i&&(i=32*u+h)}if(a<32*u+31){for(h=31;c>>>h==0;)h--;a<32*u+h&&(a=32*u+h)}}}return a<i||s<o?null:Int32Array.from([i,o,a-i+1,s-o+1])},Yc.prototype.getTopLeftOnBit=function(){for(var t=this.rowSize,e=this.bits,n=0;n<e.length&&0===e[n];)n++;if(n===e.length)return null;for(var r=n/t,t=n%t*32,i=e[n],o=0;0==(i<<31-o&4294967295);)o++;return t+=o,Int32Array.from([t,r])},Yc.prototype.getBottomRightOnBit=function(){for(var t=this.rowSize,e=this.bits,n=e.length-1;0<=n&&0===e[n];)n--;if(n<0)return null;for(var r=Math.floor(n/t),t=32*Math.floor(n%t),i=e[n],o=31;i>>>o==0;)o--;return t+=o,Int32Array.from([t,r])},Yc.prototype.getWidth=function(){return this.width},Yc.prototype.getHeight=function(){return this.height},Yc.prototype.getRowSize=function(){return this.rowSize},Yc.prototype.equals=function(t){return t instanceof Yc&&this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&Sc.equals(this.bits,t.bits)},Yc.prototype.hashCode=function(){return 31*(31*(31*(31*this.width+this.width)+this.height)+this.rowSize)+Sc.hashCode(this.bits)},Yc.prototype.toString=function(t,e,n){return this.buildToString(t=void 0===t?"X ":t,e=void 0===e?"  ":e,n=void 0===n?"\n":n)},Yc.prototype.buildToString=function(t,e,n){for(var r=new Kc,i=0,o=this.height;i<o;i++){for(var a=0,s=this.width;a<s;a++)r.append(this.get(a,i)?t:e);r.append(n)}return r.toString()},Yc.prototype.clone=function(){return new Yc(this.width,this.height,this.rowSize,this.bits.slice())};var Zc=Yc;function Yc(t,e,n,r){if(this.width=t,this.height=e,this.rowSize=n,this.bits=r,this.height=e=null==e?t:e,t<1||e<1)throw new Qu("Both dimensions must be greater than 0");null==n&&(n=Math.floor((t+31)/32)),this.rowSize=n,null==r&&(this.bits=new Int32Array(this.rowSize*this.height))}var Qc=nh,Jc=eh=n;function th(){this.constructor=Qc}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Qc,Jc),Qc.prototype=null===Jc?Object.create(Jc):(th.prototype=Jc.prototype,new th),nh.getNotFoundInstance=function(){return new nh},nh.kind="NotFoundException";var eh,I=nh;function nh(){return null!==eh&&eh.apply(this,arguments)||this}var rh,ih=sh,oh=rh=t;function ah(){this.constructor=ih}function sh(t){t=rh.call(this,t)||this;return t.luminances=sh.EMPTY,t.buckets=new Int32Array(sh.LUMINANCE_BUCKETS),t}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(ih,oh),ih.prototype=null===oh?Object.create(oh):(ah.prototype=oh.prototype,new ah),sh.prototype.getBlackRow=function(t,e){for(var n=this.getLuminanceSource(),r=n.getWidth(),i=(null==e||e.getSize()<r?e=new Lc(r):e.clear(),this.initArrays(r),n.getRow(t,this.luminances)),o=this.buckets,a=0;a<r;a++)o[(255&i[a])>>sh.LUMINANCE_SHIFT]++;var s=sh.estimateBlackPoint(o);if(r<3)for(a=0;a<r;a++)(255&i[a])<s&&e.set(a);else for(var l=255&i[0],u=255&i[1],a=1;a<r-1;a++){var c=255&i[a+1];(4*u-l-c)/2<s&&e.set(a),l=u,u=c}return e},sh.prototype.getBlackMatrix=function(){for(var t=this.getLuminanceSource(),e=t.getWidth(),n=t.getHeight(),r=new Zc(e,n),i=(this.initArrays(e),this.buckets),o=1;o<5;o++)for(var a=Math.floor(n*o/5),s=t.getRow(a,this.luminances),l=Math.floor(4*e/5),u=Math.floor(e/5);u<l;u++)i[(255&s[u])>>sh.LUMINANCE_SHIFT]++;for(var c=sh.estimateBlackPoint(i),h=t.getMatrix(),o=0;o<n;o++)for(var d=o*e,u=0;u<e;u++)(255&h[d+u])<c&&r.set(u,o);return r},sh.prototype.createBinarizer=function(t){return new sh(t)},sh.prototype.initArrays=function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var e=this.buckets,n=0;n<sh.LUMINANCE_BUCKETS;n++)e[n]=0},sh.estimateBlackPoint=function(t){for(var e=t.length,n=0,r=0,i=0,o=0;o<e;o++)t[o]>i&&(i=t[r=o]),n<t[o]&&(n=t[o]);for(var a,s=0,l=0,o=0;o<e;o++){var u=o-r;l<(d=t[o]*u*u)&&(s=o,l=d)}if(s<r&&(a=r,r=s,s=a),s-r<=e/16)throw new I;for(var c=s-1,h=-1,o=s-1;r<o;o--){var d,p=o-r;h<(d=p*p*(s-o)*(n-t[o]))&&(c=o,h=d)}return c<<sh.LUMINANCE_SHIFT},sh.LUMINANCE_SHIFT=8-(sh.LUMINANCE_BITS=5),sh.LUMINANCE_BUCKETS=1<<sh.LUMINANCE_BITS,sh.EMPTY=Uint8ClampedArray.from([0]);var lh=ph,uh=hh=oo=sh;function ch(){this.constructor=lh}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(lh,uh),lh.prototype=null===uh?Object.create(uh):(ch.prototype=uh.prototype,new ch),ph.prototype.getBlackMatrix=function(){var t,e,n,r,i,o,a;return null===this.matrix&&(t=(n=this.getLuminanceSource()).getWidth(),e=n.getHeight(),ph.MINIMUM_DIMENSION<=t&&ph.MINIMUM_DIMENSION<=e?(n=n.getMatrix(),r=t>>ph.BLOCK_SIZE_POWER,0!=(t&ph.BLOCK_SIZE_MASK)&&r++,i=e>>ph.BLOCK_SIZE_POWER,0!=(e&ph.BLOCK_SIZE_MASK)&&i++,o=ph.calculateBlackPoints(n,r,i,t,e),a=new Zc(t,e),ph.calculateThresholdForBlock(n,r,i,t,e,o,a),this.matrix=a):this.matrix=hh.prototype.getBlackMatrix.call(this)),this.matrix},ph.prototype.createBinarizer=function(t){return new ph(t)},ph.calculateThresholdForBlock=function(t,e,n,r,i,o,a){for(var s=i-ph.BLOCK_SIZE,l=r-ph.BLOCK_SIZE,u=0;u<n;u++)for(var c=u<<ph.BLOCK_SIZE_POWER,h=(s<c&&(c=s),ph.cap(u,2,n-3)),d=0;d<e;d++){for(var p=d<<ph.BLOCK_SIZE_POWER,f=(l<p&&(p=l),ph.cap(d,2,e-3)),g=0,m=-2;m<=2;m++){var y=o[h+m];g+=y[f-2]+y[f-1]+y[f]+y[f+1]+y[f+2]}ph.thresholdBlock(t,p,c,g/25,r,a)}},ph.cap=function(t,e,n){return t<e?e:n<t?n:t},ph.thresholdBlock=function(t,e,n,r,i,o){for(var a=0,s=n*i+e;a<ph.BLOCK_SIZE;a++,s+=i)for(var l=0;l<ph.BLOCK_SIZE;l++)(255&t[s+l])<=r&&o.set(e+l,n+a)},ph.calculateBlackPoints=function(t,e,n,r,i){for(var o=i-ph.BLOCK_SIZE,a=r-ph.BLOCK_SIZE,s=new Array(n),l=0;l<n;l++){s[l]=new Int32Array(e);var u=l<<ph.BLOCK_SIZE_POWER;o<u&&(u=o);for(var c=0;c<e;c++){for(var h=c<<ph.BLOCK_SIZE_POWER,d=0,p=255,f=0,g=0,m=u*r+(h=a<h?a:h);g<ph.BLOCK_SIZE;g++,m+=r){for(var y=0;y<ph.BLOCK_SIZE;y++){var v=255&t[m+y];d+=v,v<p&&(p=v),f<v&&(f=v)}if(ph.MIN_DYNAMIC_RANGE<f-p)for(g++,m+=r;g<ph.BLOCK_SIZE;g++,m+=r)for(y=0;y<ph.BLOCK_SIZE;y++)d+=255&t[m+y]}var _,h=d>>2*ph.BLOCK_SIZE_POWER;f-p<=ph.MIN_DYNAMIC_RANGE&&(h=p/2,0<l)&&0<c&&p<(_=(s[l-1][c]+2*s[l][c-1]+s[l-1][c-1])/4)&&(h=_),s[l][c]=h}}return s},ph.BLOCK_SIZE_MASK=(ph.BLOCK_SIZE=1<<(ph.BLOCK_SIZE_POWER=3))-1,ph.MINIMUM_DIMENSION=5*ph.BLOCK_SIZE,ph.MIN_DYNAMIC_RANGE=24;var hh,dh=ph;function ph(t){t=hh.call(this,t)||this;return t.matrix=null,t}function fh(t,e){this.width=t,this.height=e}fh.prototype.getWidth=function(){return this.width},fh.prototype.getHeight=function(){return this.height},fh.prototype.isCropSupported=function(){return!1},fh.prototype.crop=function(t,e,n,r){throw new zc("This luminance source does not support cropping.")},fh.prototype.isRotateSupported=function(){return!1},fh.prototype.rotateCounterClockwise=function(){throw new zc("This luminance source does not support rotation by 90 degrees.")},fh.prototype.rotateCounterClockwise45=function(){throw new zc("This luminance source does not support rotation by 45 degrees.")},fh.prototype.toString=function(){for(var t=new Uint8ClampedArray(this.width),e=new Kc,n=0;n<this.height;n++){for(var r=this.getRow(n,t),i=0;i<this.width;i++){var o=255&r[i],a=void 0,a=o<64?"#":o<128?"+":o<192?".":" ";e.append(a)}e.append("\n")}return e.toString()};var gh=wh,mh=vh=pe=fh;function yh(){this.constructor=gh}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(gh,mh),gh.prototype=null===mh?Object.create(mh):(yh.prototype=mh.prototype,new yh),wh.prototype.getRow=function(t,e){for(var n=this.delegate.getRow(t,e),r=this.getWidth(),i=0;i<r;i++)n[i]=255-(255&n[i]);return n},wh.prototype.getMatrix=function(){for(var t=this.delegate.getMatrix(),e=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(e),r=0;r<e;r++)n[r]=255-(255&t[r]);return n},wh.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},wh.prototype.crop=function(t,e,n,r){return new wh(this.delegate.crop(t,e,n,r))},wh.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},wh.prototype.invert=function(){return this.delegate},wh.prototype.rotateCounterClockwise=function(){return new wh(this.delegate.rotateCounterClockwise())},wh.prototype.rotateCounterClockwise45=function(){return new wh(this.delegate.rotateCounterClockwise45())};var vh,_h=wh;function wh(t){var e=vh.call(this,t.getWidth(),t.getHeight())||this;return e.delegate=t,e}var bh=Ah,Ch=Sh=pe;function Eh(){this.constructor=bh}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(bh,Ch),bh.prototype=null===Ch?Object.create(Ch):(Eh.prototype=Ch.prototype,new Eh),Ah.makeBufferFromCanvasImageData=function(t,e){void 0===e&&(e=!1);var n=t.getContext("2d").getImageData(0,0,t.width,t.height);return Ah.toGrayscaleBuffer(n.data,t.width,t.height,e)},Ah.toGrayscaleBuffer=function(t,e,n,r){void 0===r&&(r=!1);var i=new Uint8ClampedArray(e*n);if((Ah.FRAME_INDEX=!Ah.FRAME_INDEX)||!r)for(var o=0,a=0,s=t.length;o<s;o+=4,a++){var l=void 0;l=0===t[o+3]?255:306*t[o]+601*t[o+1]+117*t[o+2]+512>>10,i[a]=l}else for(var o=0,a=0,u=t.length;o<u;o+=4,a++){l=void 0;l=0===t[o+3]?255:306*t[o]+601*t[o+1]+117*t[o+2]+512>>10,i[a]=255-l}return i},Ah.prototype.getRow=function(t,e){if(t<0||t>=this.getHeight())throw new Qu("Requested row is outside the image: "+t);var n=this.getWidth(),t=t*n;return null===e?e=this.buffer.slice(t,t+n):(e=e.length<n?new Uint8ClampedArray(n):e).set(this.buffer.slice(t,t+n)),e},Ah.prototype.getMatrix=function(){return this.buffer},Ah.prototype.isCropSupported=function(){return!0},Ah.prototype.crop=function(t,e,n,r){return Sh.prototype.crop.call(this,t,e,n,r),this},Ah.prototype.isRotateSupported=function(){return!0},Ah.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},Ah.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},Ah.prototype.getTempCanvasElement=function(){var t;return null===this.tempCanvasElement&&((t=this.canvas.ownerDocument.createElement("canvas")).width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t),this.tempCanvasElement},Ah.prototype.rotate=function(t){var e=this.getTempCanvasElement(),n=e.getContext("2d"),t=t*Ah.DEGREE_TO_RADIANS,r=this.canvas.width,i=this.canvas.height,o=Math.ceil(Math.abs(Math.cos(t))*r+Math.abs(Math.sin(t))*i),a=Math.ceil(Math.abs(Math.sin(t))*r+Math.abs(Math.cos(t))*i);return e.width=o,e.height=a,n.translate(o/2,a/2),n.rotate(t),n.drawImage(this.canvas,r/-2,i/-2),this.buffer=Ah.makeBufferFromCanvasImageData(e),this},Ah.prototype.invert=function(){return new _h(this)},Ah.DEGREE_TO_RADIANS=Math.PI/180,Ah.FRAME_INDEX=!0;var Sh,Th=Ah;function Ah(t,e){void 0===e&&(e=!1);var n=Sh.call(this,t.width,t.height)||this;return n.canvas=t,n.tempCanvasElement=null,n.buffer=Ah.makeBufferFromCanvasImageData(t,e),n}Lh.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}};var Ih=Lh;function Lh(t,e,n){this.deviceId=t,this.label=e,this.kind="videoinput",this.groupId=n||void 0}var kh=function(t,a,s,l){return new(s=s||Promise)(function(n,e){function r(t){try{o(l.next(t))}catch(t){e(t)}}function i(t){try{o(l.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(r,i)}o((l=l.apply(t,a||[])).next())})},xh=function(r,i){var o,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(n){return function(t){var e=[n,t];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(s=2&e[0]?a.return:e[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,e[1])).done)return s;switch(a=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,a=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3]))l.label=e[1];else if(6===e[0]&&l.label<s[1])l.label=s[1],s=e;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(e)}}e=i.call(r,l)}catch(t){e=[6,t],a=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}},Dh=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=(Object.defineProperty(s.prototype,"hasNavigator",{get:function(){return"undefined"!=typeof navigator},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"canEnumerateDevices",{get:function(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(t){this._timeBetweenDecodingAttempts=t<0?0:t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"hints",{get:function(){return this._hints},set:function(t){this._hints=t||null},enumerable:!1,configurable:!0}),s.prototype.listVideoInputDevices=function(){return kh(this,void 0,void 0,function(){var e,n,r,i,o,a,s,l,u,c;return xh(this,function(t){switch(t.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(this.canEnumerateDevices)return[4,navigator.mediaDevices.enumerateDevices()];throw new Error("Can't enumerate devices, method not supported.");case 1:e=t.sent(),n=[];try{for(r=Dh(e),i=r.next();!i.done;i=r.next())o=i.value,"videoinput"===(a="video"===o.kind?"videoinput":o.kind)&&(s=o.deviceId||o.id,l=o.label||"Video device "+(n.length+1),n.push({deviceId:s,label:l,kind:a,groupId:o.groupId}))}catch(t){u={error:t}}finally{try{i&&!i.done&&(c=r.return)&&c.call(r)}finally{if(u)throw u.error}}return[2,n]}})})},s.prototype.getVideoInputDevices=function(){return kh(this,void 0,void 0,function(){return xh(this,function(t){switch(t.label){case 0:return[4,this.listVideoInputDevices()];case 1:return[2,t.sent().map(function(t){return new Ih(t.deviceId,t.label)})]}})})},s.prototype.findDeviceById=function(n){return kh(this,void 0,void 0,function(){var e;return xh(this,function(t){switch(t.label){case 0:return[4,this.listVideoInputDevices()];case 1:return(e=t.sent())?[2,e.find(function(t){return t.deviceId===n})]:[2,null]}})})},s.prototype.decodeFromInputVideoDevice=function(e,n){return kh(this,void 0,void 0,function(){return xh(this,function(t){switch(t.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,n)];case 1:return[2,t.sent()]}})})},s.prototype.decodeOnceFromVideoDevice=function(n,r){return kh(this,void 0,void 0,function(){var e;return xh(this,function(t){switch(t.label){case 0:return this.reset(),e={video:n?{deviceId:{exact:n}}:{facingMode:"environment"}},[4,this.decodeOnceFromConstraints(e,r)];case 1:return[2,t.sent()]}})})},s.prototype.decodeOnceFromConstraints=function(n,r){return kh(this,void 0,void 0,function(){var e;return xh(this,function(t){switch(t.label){case 0:return[4,navigator.mediaDevices.getUserMedia(n)];case 1:return e=t.sent(),[4,this.decodeOnceFromStream(e,r)];case 2:return[2,t.sent()]}})})},s.prototype.decodeOnceFromStream=function(n,r){return kh(this,void 0,void 0,function(){var e;return xh(this,function(t){switch(t.label){case 0:return this.reset(),[4,this.attachStreamToVideo(n,r)];case 1:return e=t.sent(),[4,this.decodeOnce(e)];case 2:return[2,t.sent()]}})})},s.prototype.decodeFromInputVideoDeviceContinuously=function(e,n,r){return kh(this,void 0,void 0,function(){return xh(this,function(t){switch(t.label){case 0:return[4,this.decodeFromVideoDevice(e,n,r)];case 1:return[2,t.sent()]}})})},s.prototype.decodeFromVideoDevice=function(n,r,i){return kh(this,void 0,void 0,function(){var e;return xh(this,function(t){switch(t.label){case 0:return e={video:n?{deviceId:{exact:n}}:{facingMode:"environment"}},[4,this.decodeFromConstraints(e,r,i)];case 1:return[2,t.sent()]}})})},s.prototype.decodeFromConstraints=function(n,r,i){return kh(this,void 0,void 0,function(){var e;return xh(this,function(t){switch(t.label){case 0:return[4,navigator.mediaDevices.getUserMedia(n)];case 1:return e=t.sent(),[4,this.decodeFromStream(e,r,i)];case 2:return[2,t.sent()]}})})},s.prototype.decodeFromStream=function(n,r,i){return kh(this,void 0,void 0,function(){var e;return xh(this,function(t){switch(t.label){case 0:return this.reset(),[4,this.attachStreamToVideo(n,r)];case 1:return e=t.sent(),[4,this.decodeContinuously(e,i)];case 2:return[2,t.sent()]}})})},s.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},s.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},s.prototype.attachStreamToVideo=function(n,r){return kh(this,void 0,void 0,function(){var e;return xh(this,function(t){switch(t.label){case 0:return e=this.prepareVideoElement(r),this.addVideoSource(e,n),this.videoElement=e,this.stream=n,[4,this.playVideoOnLoadAsync(e)];case 1:return t.sent(),[2,e]}})})},s.prototype.playVideoOnLoadAsync=function(n){var r=this;return new Promise(function(t,e){return r.playVideoOnLoad(n,function(){return t()})})},s.prototype.playVideoOnLoad=function(t,e){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(t)},t.addEventListener("ended",this.videoEndedListener),t.addEventListener("canplay",this.videoCanPlayListener),t.addEventListener("playing",e),this.tryPlayVideo(t)},s.prototype.isVideoPlaying=function(t){return 0<t.currentTime&&!t.paused&&!t.ended&&2<t.readyState},s.prototype.tryPlayVideo=function(e){return kh(this,void 0,void 0,function(){return xh(this,function(t){switch(t.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.play()];case 2:return t.sent(),[3,4];case 3:return t.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},s.prototype.getMediaElement=function(t,e){var n=document.getElementById(t);if(!n)throw new Gu("element with id '"+t+"' not found");if(n.nodeName.toLowerCase()!==e.toLowerCase())throw new Gu("element with id '"+t+"' must be an "+e+" element");return n},s.prototype.decodeFromImage=function(t,e){if(t||e)return e&&!t?this.decodeFromImageUrl(e):this.decodeFromImageElement(t);throw new Gu("either imageElement with a src set or an url must be provided")},s.prototype.decodeFromVideo=function(t,e){if(t||e)return e&&!t?this.decodeFromVideoUrl(e):this.decodeFromVideoElement(t);throw new Gu("Either an element with a src set or an URL must be provided")},s.prototype.decodeFromVideoContinuously=function(t,e,n){if(void 0===t&&void 0===e)throw new Gu("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrlContinuously(e,n):this.decodeFromVideoElementContinuously(t,n)},s.prototype.decodeFromImageElement=function(t){if(!t)throw new Gu("An image element must be provided.");this.reset();t=this.prepareImageElement(t);return this.imageElement=t,this.isImageLoaded(t)?this.decodeOnce(t,!1,!0):this._decodeOnLoadImage(t)},s.prototype.decodeFromVideoElement=function(t){t=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideo(t)},s.prototype.decodeFromVideoElementContinuously=function(t,e){t=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideoContinuously(t,e)},s.prototype._decodeFromVideoElementSetup=function(t){if(!t)throw new Gu("A video element must be provided.");this.reset();t=this.prepareVideoElement(t);return this.videoElement=t},s.prototype.decodeFromImageUrl=function(t){if(!t)throw new Gu("An URL must be provided.");this.reset();var e=this.prepareImageElement(),n=(this.imageElement=e,this._decodeOnLoadImage(e));return e.src=t,n},s.prototype.decodeFromVideoUrl=function(t){if(!t)throw new Gu("An URL must be provided.");this.reset();var e=this.prepareVideoElement(),n=this.decodeFromVideoElement(e);return e.src=t,n},s.prototype.decodeFromVideoUrlContinuously=function(t,e){if(!t)throw new Gu("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),e=this.decodeFromVideoElementContinuously(n,e);return n.src=t,e},s.prototype._decodeOnLoadImage=function(n){var r=this;return new Promise(function(t,e){r.imageLoadedListener=function(){return r.decodeOnce(n,!1,!0).then(t,e)},n.addEventListener("load",r.imageLoadedListener)})},s.prototype._decodeOnLoadVideo=function(e){return kh(this,void 0,void 0,function(){return xh(this,function(t){switch(t.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return t.sent(),[4,this.decodeOnce(e)];case 2:return[2,t.sent()]}})})},s.prototype._decodeOnLoadVideoContinuously=function(e,n){return kh(this,void 0,void 0,function(){return xh(this,function(t){switch(t.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return t.sent(),this.decodeContinuously(e,n),[2]}})})},s.prototype.isImageLoaded=function(t){return!!t.complete&&0!==t.naturalWidth},s.prototype.prepareImageElement=function(t){var e;return void 0===t&&((e=document.createElement("img")).width=200,e.height=200),"string"==typeof t&&(e=this.getMediaElement(t,"img")),e=t instanceof HTMLImageElement?t:e},s.prototype.prepareVideoElement=function(t){var e;return t||"undefined"==typeof document||((e=document.createElement("video")).width=200,e.height=200),"string"==typeof t&&(e=this.getMediaElement(t,"video")),(e=t instanceof HTMLVideoElement?t:e).setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e},s.prototype.decodeOnce=function(t,o,a){function s(e,n){if(l._stopAsyncDecode)n(new I("Video stream has ended before any code could be detected.")),l._stopAsyncDecode=void 0;else try{e(l.decode(t))}catch(t){var r=o&&t instanceof I,i=t instanceof ac||t instanceof A;if(r||i&&a)return setTimeout(s,l._timeBetweenDecodingAttempts,e,n);n(t)}}var l=this;void 0===o&&(o=!0),void 0===a&&(a=!0),this._stopAsyncDecode=!1;return new Promise(s)},s.prototype.decodeContinuously=function(t,r){function i(){if(o._stopContinuousDecode)o._stopContinuousDecode=void 0;else try{var e=o.decode(t);r(e,null),setTimeout(i,o.timeBetweenScansMillis)}catch(t){r(null,t);var e=t instanceof ac||t instanceof A,n=t instanceof I;(e||n)&&setTimeout(i,o._timeBetweenDecodingAttempts)}}var o=this;this._stopContinuousDecode=!1;i()},s.prototype.decode=function(t){t=this.createBinaryBitmap(t);return this.decodeBitmap(t)},s.prototype.createBinaryBitmap=function(t){this.getCaptureCanvasContext(t);var e=!1,t=(t instanceof HTMLVideoElement?(this.drawFrameOnCanvas(t),e=!0):this.drawImageOnCanvas(t),this.getCaptureCanvas(t)),t=new Th(t,e),e=new dh(t);return new tc(e)},s.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var e=this.getCaptureCanvas(e),n=void 0;try{n=e.getContext("2d",{willReadFrequently:!0})}catch(t){n=e.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},s.prototype.getCaptureCanvas=function(t){return this.captureCanvas||(t=this.createCaptureCanvas(t),this.captureCanvas=t),this.captureCanvas},s.prototype.drawFrameOnCanvas=function(t,e,n){void 0===e&&(e={sx:0,sy:0,sWidth:t.videoWidth,sHeight:t.videoHeight,dx:0,dy:0,dWidth:t.videoWidth,dHeight:t.videoHeight}),(n=void 0===n?this.captureCanvasContext:n).drawImage(t,e.sx,e.sy,e.sWidth,e.sHeight,e.dx,e.dy,e.dWidth,e.dHeight)},s.prototype.drawImageOnCanvas=function(t,e,n){void 0===e&&(e={sx:0,sy:0,sWidth:t.naturalWidth,sHeight:t.naturalHeight,dx:0,dy:0,dWidth:t.naturalWidth,dHeight:t.naturalHeight}),(n=void 0===n?this.captureCanvasContext:n).drawImage(t,e.sx,e.sy,e.sWidth,e.sHeight,e.dx,e.dy,e.dWidth,e.dHeight)},s.prototype.decodeBitmap=function(t){return this.reader.decode(t,this._hints)},s.prototype.createCaptureCanvas=function(t){var e,n,r;return"undefined"==typeof document?(this._destroyCaptureCanvas(),null):(e=document.createElement("canvas"),void 0!==t&&(t instanceof HTMLVideoElement?(n=t.videoWidth,r=t.videoHeight):t instanceof HTMLImageElement&&(n=t.naturalWidth||t.width,r=t.naturalHeight||t.height)),e.style.width=n+"px",e.style.height=r+"px",e.width=n,e.height=r,e)},s.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(t){return t.stop()}),this.stream=void 0),!1===this._stopAsyncDecode&&this.stopAsyncDecode(),!1===this._stopContinuousDecode&&this.stopContinuousDecode()},s.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},s.prototype._destroyVideoElement=function(){this.videoElement&&(void 0!==this.videoEndedListener&&this.videoElement.removeEventListener("ended",this.videoEndedListener),void 0!==this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),void 0!==this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},s.prototype._destroyImageElement=function(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},s.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},s.prototype.addVideoSource=function(e,n){try{e.srcObject=n}catch(t){e.src=URL.createObjectURL(n)}},s.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch(t){e.src=""}this.videoElement.removeAttribute("src")},s);function s(t,e,n){void 0===e&&(e=500),this.reader=t,this.timeBetweenScansMillis=e,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}Rh.prototype.getText=function(){return this.text},Rh.prototype.getRawBytes=function(){return this.rawBytes},Rh.prototype.getNumBits=function(){return this.numBits},Rh.prototype.getResultPoints=function(){return this.resultPoints},Rh.prototype.getBarcodeFormat=function(){return this.format},Rh.prototype.getResultMetadata=function(){return this.resultMetadata},Rh.prototype.putMetadata=function(t,e){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(t,e)},Rh.prototype.putAllMetadata=function(t){null!==t&&(null===this.resultMetadata?this.resultMetadata=t:this.resultMetadata=new Map(t))},Rh.prototype.addResultPoints=function(t){var e,n=this.resultPoints;null===n?this.resultPoints=t:null!==t&&0<t.length&&(e=new Array(n.length+t.length),uc.arraycopy(n,0,e,0,n.length),uc.arraycopy(t,0,e,n.length,t.length),this.resultPoints=e)},Rh.prototype.getTimestamp=function(){return this.timestamp},Rh.prototype.toString=function(){return this.text};var Nh=Rh;function Rh(t,e,n,r,i,o){void 0===n&&(n=null==e?0:8*e.length),void 0===o&&(o=uc.currentTimeMillis()),this.text=t,this.rawBytes=e,this.numBits=n,this.resultPoints=r,this.format=i,this.timestamp=o,this.text=t,this.rawBytes=e,this.numBits=null==n?null==e?0:8*e.length:n,this.resultPoints=r,this.format=i,this.resultMetadata=null,this.timestamp=null==o?uc.currentTimeMillis():o}(e=iv=iv||{})[e.AZTEC=0]="AZTEC",e[e.CODABAR=1]="CODABAR",e[e.CODE_39=2]="CODE_39",e[e.CODE_93=3]="CODE_93",e[e.CODE_128=4]="CODE_128",e[e.DATA_MATRIX=5]="DATA_MATRIX",e[e.EAN_8=6]="EAN_8",e[e.EAN_13=7]="EAN_13",e[e.ITF=8]="ITF",e[e.MAXICODE=9]="MAXICODE",e[e.PDF_417=10]="PDF_417",e[e.QR_CODE=11]="QR_CODE",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION";var k=iv,Ph=((o=p=p||{})[o.OTHER=0]="OTHER",o[o.ORIENTATION=1]="ORIENTATION",o[o.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",o[o.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",o[o.ISSUE_NUMBER=4]="ISSUE_NUMBER",o[o.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",o[o.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",o[o.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",o[o.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",o[o.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",o[o.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY",p),Oh=(Mh.prototype.getRawBytes=function(){return this.rawBytes},Mh.prototype.getNumBits=function(){return this.numBits},Mh.prototype.setNumBits=function(t){this.numBits=t},Mh.prototype.getText=function(){return this.text},Mh.prototype.getByteSegments=function(){return this.byteSegments},Mh.prototype.getECLevel=function(){return this.ecLevel},Mh.prototype.getErrorsCorrected=function(){return this.errorsCorrected},Mh.prototype.setErrorsCorrected=function(t){this.errorsCorrected=t},Mh.prototype.getErasures=function(){return this.erasures},Mh.prototype.setErasures=function(t){this.erasures=t},Mh.prototype.getOther=function(){return this.other},Mh.prototype.setOther=function(t){this.other=t},Mh.prototype.hasStructuredAppend=function(){return 0<=this.structuredAppendParity&&0<=this.structuredAppendSequenceNumber},Mh.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},Mh.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},Mh);function Mh(t,e,n,r,i,o){void 0===i&&(i=-1),void 0===o&&(o=-1),this.rawBytes=t,this.text=e,this.byteSegments=n,this.ecLevel=r,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=o,this.numBits=null==t?0:8*t.length}Uh.prototype.exp=function(t){return this.expTable[t]},Uh.prototype.log=function(t){if(0===t)throw new Qu;return this.logTable[t]},Uh.addOrSubtract=function(t,e){return t^e};var Bh=Uh;function Uh(){}Vh.prototype.getCoefficients=function(){return this.coefficients},Vh.prototype.getDegree=function(){return this.coefficients.length-1},Vh.prototype.isZero=function(){return 0===this.coefficients[0]},Vh.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},Vh.prototype.evaluateAt=function(t){if(0===t)return this.getCoefficient(0);var e=this.coefficients;if(1===t)for(var n=o=0,r=e.length;n!==r;n++)var i=e[n],o=Bh.addOrSubtract(o,i);else{o=e[0];for(var a=e.length,s=this.field,n=1;n<a;n++)o=Bh.addOrSubtract(s.multiply(t,o),e[n])}return o},Vh.prototype.addOrSubtract=function(t){if(!this.field.equals(t.field))throw new Qu("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;var e=this.coefficients,n=t.coefficients,r=(e.length>n.length&&(t=e,e=n,n=t),new Int32Array(n.length)),i=n.length-e.length;uc.arraycopy(n,0,r,0,i);for(var o=i;o<n.length;o++)r[o]=Bh.addOrSubtract(e[o-i],n[o]);return new Vh(this.field,r)},Vh.prototype.multiply=function(t){if(!this.field.equals(t.field))throw new Qu("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();for(var e=this.coefficients,n=e.length,r=t.coefficients,i=r.length,o=new Int32Array(n+i-1),a=this.field,s=0;s<n;s++)for(var l=e[s],u=0;u<i;u++)o[s+u]=Bh.addOrSubtract(o[s+u],a.multiply(l,r[u]));return new Vh(a,o)},Vh.prototype.multiplyScalar=function(t){if(0===t)return this.field.getZero();if(1===t)return this;for(var e=this.coefficients.length,n=this.field,r=new Int32Array(e),i=this.coefficients,o=0;o<e;o++)r[o]=n.multiply(i[o],t);return new Vh(n,r)},Vh.prototype.multiplyByMonomial=function(t,e){if(t<0)throw new Qu;if(0===e)return this.field.getZero();for(var n=this.coefficients,r=n.length,i=new Int32Array(r+t),o=this.field,a=0;a<r;a++)i[a]=o.multiply(n[a],e);return new Vh(o,i)},Vh.prototype.divide=function(t){if(!this.field.equals(t.field))throw new Qu("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new Qu("Divide by 0");for(var e=this.field,n=e.getZero(),r=this,i=t.getCoefficient(t.getDegree()),o=e.inverse(i);r.getDegree()>=t.getDegree()&&!r.isZero();)var a=r.getDegree()-t.getDegree(),s=e.multiply(r.getCoefficient(r.getDegree()),o),l=t.multiplyByMonomial(a,s),a=e.buildMonomial(a,s),n=n.addOrSubtract(a),r=r.addOrSubtract(l);return[n,r]},Vh.prototype.toString=function(){for(var t="",e=this.getDegree();0<=e;e--){var n=this.getCoefficient(e);0!==n&&(n<0?(t+=" - ",n=-n):0<t.length&&(t+=" + "),0!==e&&1===n||(0===(n=this.field.log(n))?t+="1":1===n?t+="a":t=t+"a^"+n),0!==e)&&(1===e?t+="x":t=t+"x^"+e)}return t};var Fh=Vh;function Vh(t,e){if(0===e.length)throw new Qu;this.field=t;var n=e.length;if(1<n&&0===e[0]){for(var r=1;r<n&&0===e[r];)r++;r===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-r),uc.arraycopy(e,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}var Hh=Gh,zh=qh=n;function jh(){this.constructor=Hh}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Hh,zh),Hh.prototype=null===zh?Object.create(zh):(jh.prototype=zh.prototype,new jh),Gh.kind="ArithmeticException";var qh,Wh=Gh;function Gh(){return null!==qh&&qh.apply(this,arguments)||this}var $h=Qh,Kh=Zh=Bh;function Xh(){this.constructor=$h}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})($h,Kh),$h.prototype=null===Kh?Object.create(Kh):(Xh.prototype=Kh.prototype,new Xh),Qh.prototype.getZero=function(){return this.zero},Qh.prototype.getOne=function(){return this.one},Qh.prototype.buildMonomial=function(t,e){if(t<0)throw new Qu;return 0===e?this.zero:((t=new Int32Array(t+1))[0]=e,new Fh(this,t))},Qh.prototype.inverse=function(t){if(0===t)throw new Wh;return this.expTable[this.size-this.logTable[t]-1]},Qh.prototype.multiply=function(t,e){return 0===t||0===e?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.size-1)]},Qh.prototype.getSize=function(){return this.size},Qh.prototype.getGeneratorBase=function(){return this.generatorBase},Qh.prototype.toString=function(){return"GF(0x"+Ac.toHexString(this.primitive)+","+this.size+")"},Qh.prototype.equals=function(t){return t===this},Qh.AZTEC_DATA_12=new Qh(4201,4096,1),Qh.AZTEC_DATA_10=new Qh(1033,1024,1),Qh.AZTEC_DATA_6=new Qh(67,64,1),Qh.AZTEC_PARAM=new Qh(19,16,1),Qh.QR_CODE_FIELD_256=new Qh(285,256,0),Qh.DATA_MATRIX_FIELD_256=new Qh(301,256,1),Qh.AZTEC_DATA_8=Qh.DATA_MATRIX_FIELD_256,Qh.MAXICODE_FIELD_64=Qh.AZTEC_DATA_6;var Zh,Yh=Qh;function Qh(t,e,n){for(var r=Zh.call(this)||this,i=(r.primitive=t,r.size=e,r.generatorBase=n,new Int32Array(e)),o=1,a=0;a<e;a++)i[a]=o,e<=(o*=2)&&(o=(o^t)&e-1);r.expTable=i;for(var s=new Int32Array(e),a=0;a<e-1;a++)s[i[a]]=a;return r.logTable=s,r.zero=new Fh(r,Int32Array.from([0])),r.one=new Fh(r,Int32Array.from([1])),r}var Jh=id,td=nd=n;function ed(){this.constructor=Jh}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Jh,td),Jh.prototype=null===td?Object.create(td):(ed.prototype=td.prototype,new ed),id.kind="ReedSolomonException";var nd,rd=id;function id(){return null!==nd&&nd.apply(this,arguments)||this}var od=cd,ad=ld=n;function sd(){this.constructor=od}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(od,ad),od.prototype=null===ad?Object.create(ad):(sd.prototype=ad.prototype,new sd),cd.kind="IllegalStateException";var ld,ud=cd;function cd(){return null!==ld&&ld.apply(this,arguments)||this}pd.prototype.decode=function(t,e){for(var n=this.field,r=new Fh(n,t),i=new Int32Array(e),o=!0,a=0;a<e;a++){var s=r.evaluateAt(n.exp(a+n.getGeneratorBase()));0!==(i[i.length-1-a]=s)&&(o=!1)}if(!o)for(var l=new Fh(n,i),l=this.runEuclideanAlgorithm(n.buildMonomial(e,1),l,e),u=l[0],l=l[1],c=this.findErrorLocations(u),h=this.findErrorMagnitudes(l,c),a=0;a<c.length;a++){var d=t.length-1-n.log(c[a]);if(d<0)throw new rd("Bad error location");t[d]=Yh.addOrSubtract(t[d],h[a])}},pd.prototype.runEuclideanAlgorithm=function(t,e,n){t.getDegree()<e.getDegree()&&(f=t,t=e,e=f);for(var r=this.field,i=t,o=e,a=r.getZero(),s=r.getOne();o.getDegree()>=(n/2|0);){var l=i,u=a,a=s;if((i=o).isZero())throw new rd("r_{i-1} was zero");o=l;for(var c=r.getZero(),l=i.getCoefficient(i.getDegree()),h=r.inverse(l);o.getDegree()>=i.getDegree()&&!o.isZero();)var d=o.getDegree()-i.getDegree(),p=r.multiply(o.getCoefficient(o.getDegree()),h),c=c.addOrSubtract(r.buildMonomial(d,p)),o=o.addOrSubtract(i.multiplyByMonomial(d,p));if(s=c.multiply(a).addOrSubtract(u),o.getDegree()>=i.getDegree())throw new ud("Division algorithm failed to reduce polynomial?")}var f=s.getCoefficient(0);if(0===f)throw new rd("sigmaTilde(0) was zero");t=r.inverse(f);return[s.multiplyScalar(t),o.multiplyScalar(t)]},pd.prototype.findErrorLocations=function(t){var e=t.getDegree();if(1===e)return Int32Array.from([t.getCoefficient(1)]);for(var n=new Int32Array(e),r=0,i=this.field,o=1;o<i.getSize()&&r<e;o++)0===t.evaluateAt(o)&&(n[r]=i.inverse(o),r++);if(r!==e)throw new rd("Error locator degree does not match number of roots");return n},pd.prototype.findErrorMagnitudes=function(t,e){for(var n=e.length,r=new Int32Array(n),i=this.field,o=0;o<n;o++){for(var a,s=i.inverse(e[o]),l=1,u=0;u<n;u++)o!==u&&(a=i.multiply(e[u],s),l=i.multiply(l,0==(1&a)?1|a:-2&a));r[o]=i.multiply(t.evaluateAt(s),i.inverse(l)),0!==i.getGeneratorBase()&&(r[o]=i.multiply(r[o],s))}return r};var hd,dd=pd;function pd(t){this.field=t}(i=hd=hd||{})[i.UPPER=0]="UPPER",i[i.LOWER=1]="LOWER",i[i.MIXED=2]="MIXED",i[i.DIGIT=3]="DIGIT",i[i.PUNCT=4]="PUNCT",i[i.BINARY=5]="BINARY",gd.prototype.decode=function(t){var t=(this.ddata=t).getBits(),t=this.extractBits(t),t=this.correctBits(t),e=gd.convertBoolArrayToByteArray(t),n=gd.getEncodedData(t),e=new Oh(e,n,null,null);return e.setNumBits(t.length),e},gd.highLevelDecode=function(t){return this.getEncodedData(t)},gd.getEncodedData=function(t){for(var e=t.length,n=hd.UPPER,r=hd.UPPER,i="",o=0;o<e;)if(r===hd.BINARY){if(e-o<5)break;var a=gd.readCode(t,o,5);if(o+=5,0===a){if(e-o<11)break;a=gd.readCode(t,o,11)+31,o+=11}for(var s=0;s<a;s++){if(e-o<8){o=e;break}var l=gd.readCode(t,o,8);i+=Gc.castAsNonUtf8Char(l),o+=8}r=n}else{var u=r===hd.DIGIT?4:5;if(e-o<u)break;l=gd.readCode(t,o,u),u=(o+=u,gd.getCharacter(r,l));u.startsWith("CTRL_")?(n=r,r=gd.getTable(u.charAt(5)),"L"===u.charAt(6)&&(n=r)):(i+=u,r=n)}return i},gd.getTable=function(t){switch(t){case"L":return hd.LOWER;case"P":return hd.PUNCT;case"M":return hd.MIXED;case"D":return hd.DIGIT;case"B":return hd.BINARY;default:return hd.UPPER}},gd.getCharacter=function(t,e){switch(t){case hd.UPPER:return gd.UPPER_TABLE[e];case hd.LOWER:return gd.LOWER_TABLE[e];case hd.MIXED:return gd.MIXED_TABLE[e];case hd.PUNCT:return gd.PUNCT_TABLE[e];case hd.DIGIT:return gd.DIGIT_TABLE[e];default:throw new ud("Bad table")}},gd.prototype.correctBits=function(t){var e,n=this.ddata.getNbLayers()<=2?(e=6,Yh.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(e=8,Yh.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(e=10,Yh.AZTEC_DATA_10):(e=12,Yh.AZTEC_DATA_12),r=this.ddata.getNbDatablocks(),i=t.length/e;if(i<r)throw new A;for(var o=t.length%e,a=new Int32Array(i),s=0;s<i;s++,o+=e)a[s]=gd.readCode(t,o,e);try{new dd(n).decode(a,i-r)}catch(t){throw new A(t)}for(var l=(1<<e)-1,u=0,s=0;s<r;s++){if(0===(c=a[s])||c===l)throw new A;1!==c&&c!==l-1||u++}for(var c,h=new Array(r*e-u),d=0,s=0;s<r;s++)if(1===(c=a[s])||c===l-1)h.fill(1<c,d,d+e-1),d+=e-1;else for(var p=e-1;0<=p;--p)h[d++]=0!=(c&1<<p);return h},gd.prototype.extractBits=function(t){var e=this.ddata.isCompact(),n=this.ddata.getNbLayers(),r=(e?11:14)+4*n,i=new Int32Array(r),o=new Array(this.totalBitsInLayer(n,e));if(e)for(var a=0;a<i.length;a++)i[a]=a;else for(var s=1+r+2*Ac.truncDivision(Ac.truncDivision(r,2)-1,15),l=r/2,u=Ac.truncDivision(s,2),a=0;a<l;a++){var c=a+Ac.truncDivision(a,15);i[l-a-1]=u-c-1,i[l+a]=u+c+1}for(var a=0,h=0;a<n;a++){for(var d=4*(n-a)+(e?9:12),p=2*a,f=r-1-p,g=0;g<d;g++)for(var m=2*g,y=0;y<2;y++)o[h+m+y]=t.get(i[p+y],i[p+g]),o[h+2*d+m+y]=t.get(i[p+g],i[f-y]),o[h+4*d+m+y]=t.get(i[f-y],i[f-g]),o[h+6*d+m+y]=t.get(i[f-g],i[p+y]);h+=8*d}return o},gd.readCode=function(t,e,n){for(var r=0,i=e;i<e+n;i++)r<<=1,t[i]&&(r|=1);return r},gd.readByte=function(t,e){var n=t.length-e;return 8<=n?gd.readCode(t,e,8):gd.readCode(t,e,n)<<8-n},gd.convertBoolArrayToByteArray=function(t){for(var e=new Uint8Array((t.length+7)/8),n=0;n<e.length;n++)e[n]=gd.readByte(t,8*n);return e},gd.prototype.totalBitsInLayer=function(t,e){return((e?88:112)+16*t)*t},gd.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],gd.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],gd.MIXED_TABLE=["CTRL_PS"," ","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],gd.PUNCT_TABLE=["","\r","\r\n",". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],gd.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];var fd=gd;function gd(){}yd.round=function(t){return isNaN(t)?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER<=t?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0},yd.distance=function(t,e,n,r){t-=n,n=e-r;return Math.sqrt(t*t+n*n)},yd.sum=function(t){for(var e=0,n=0,r=t.length;n!==r;n++)e+=t[n];return e};var md=yd;function yd(){}_d.floatToIntBits=function(t){return t},_d.MAX_VALUE=Number.MAX_SAFE_INTEGER;var vd=_d;function _d(){}wd.prototype.getX=function(){return this.x},wd.prototype.getY=function(){return this.y},wd.prototype.equals=function(t){return t instanceof wd&&this.x===t.x&&this.y===t.y},wd.prototype.hashCode=function(){return 31*vd.floatToIntBits(this.x)+vd.floatToIntBits(this.y)},wd.prototype.toString=function(){return"("+this.x+","+this.y+")"},wd.orderBestPatterns=function(t){var e,n,r=this.distance(t[0],t[1]),i=this.distance(t[1],t[2]),o=this.distance(t[0],t[2]);i=r<=i&&o<=i?(e=t[0],n=t[1],t[2]):i<=o&&r<=o?(e=t[1],n=t[0],t[2]):(e=t[2],n=t[0],t[1]),this.crossProductZ(n,e,i)<0&&(r=n,n=i,i=r),t[0]=n,t[1]=e,t[2]=i},wd.distance=function(t,e){return md.distance(t.x,t.y,e.x,e.y)},wd.crossProductZ=function(t,e,n){var r=e.x,e=e.y;return(n.x-r)*(t.y-e)-(n.y-e)*(t.x-r)};var x=wd;function wd(t,e){this.x=t,this.y=e}Cd.prototype.getBits=function(){return this.bits},Cd.prototype.getPoints=function(){return this.points};var bd=Cd;function Cd(t,e){this.bits=t,this.points=e}var Ed=Ld,Sd=Ad=bd;function Td(){this.constructor=Ed}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Ed,Sd),Ed.prototype=null===Sd?Object.create(Sd):(Td.prototype=Sd.prototype,new Td),Ld.prototype.getNbLayers=function(){return this.nbLayers},Ld.prototype.getNbDatablocks=function(){return this.nbDatablocks},Ld.prototype.isCompact=function(){return this.compact};var Ad,Id=Ld;function Ld(t,e,n,r,i){t=Ad.call(this,t,e)||this;return t.compact=n,t.nbDatablocks=r,t.nbLayers=i,t}xd.prototype.detect=function(){for(var t=this.leftInit,e=this.rightInit,n=this.upInit,r=this.downInit,i=!1,o=!0,a=!1,s=!1,l=!1,u=!1,c=!1,h=this.width,d=this.height;o;){for(var o=!1,p=!0;(p||!s)&&e<h;)(p=this.containsBlackPoint(n,r,e,!1))?(e++,s=o=!0):s||e++;if(h<=e){i=!0;break}for(var f=!0;(f||!l)&&r<d;)(f=this.containsBlackPoint(t,e,r,!0))?(r++,l=o=!0):l||r++;if(d<=r){i=!0;break}for(var g=!0;(g||!u)&&0<=t;)(g=this.containsBlackPoint(n,r,t,!1))?(t--,u=o=!0):u||t--;if(t<0){i=!0;break}for(var m=!0;(m||!c)&&0<=n;)(m=this.containsBlackPoint(t,e,n,!0))?(n--,c=o=!0):c||n--;if(n<0){i=!0;break}o&&(a=!0)}if(i||!a)throw new I;for(var y=e-t,v=null,_=1;null===v&&_<y;_++)v=this.getBlackPointOnSegment(t,r-_,t+_,r);if(null==v)throw new I;for(var w=null,_=1;null===w&&_<y;_++)w=this.getBlackPointOnSegment(t,n+_,t+_,n);if(null==w)throw new I;for(var b=null,_=1;null===b&&_<y;_++)b=this.getBlackPointOnSegment(e,n+_,e-_,n);if(null==b)throw new I;for(var C=null,_=1;null===C&&_<y;_++)C=this.getBlackPointOnSegment(e,r-_,e-_,r);if(null==C)throw new I;return this.centerEdges(C,v,b,w)},xd.prototype.getBlackPointOnSegment=function(t,e,n,r){for(var i=md.round(md.distance(t,e,n,r)),o=(n-t)/i,a=(r-e)/i,s=this.image,l=0;l<i;l++){var u=md.round(t+l*o),c=md.round(e+l*a);if(s.get(u,c))return new x(u,c)}return null},xd.prototype.centerEdges=function(t,e,n,r){var i=t.getX(),t=t.getY(),o=e.getX(),e=e.getY(),a=n.getX(),n=n.getY(),s=r.getX(),r=r.getY(),l=xd.CORR;return i<this.width/2?[new x(s-l,r+l),new x(o+l,e+l),new x(a-l,n-l),new x(i+l,t-l)]:[new x(s+l,r+l),new x(o+l,e-l),new x(a-l,n+l),new x(i-l,t-l)]},xd.prototype.containsBlackPoint=function(t,e,n,r){var i=this.image;if(r){for(var o=t;o<=e;o++)if(i.get(o,n))return!0}else for(var a=t;a<=e;a++)if(i.get(n,a))return!0;return!1},xd.INIT_SIZE=10,xd.CORR=1;var kd=xd;function xd(t,e,n,r){this.image=t,this.height=t.getHeight(),this.width=t.getWidth(),null==e&&(e=xd.INIT_SIZE),null==n&&(n=t.getWidth()/2|0),null==r&&(r=t.getHeight()/2|0);t=e/2|0;if(this.leftInit=n-t,this.rightInit=n+t,this.upInit=r-t,this.downInit=r+t,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new I}Nd.checkAndNudgePoints=function(t,e){for(var n=t.getWidth(),r=t.getHeight(),i=!0,o=0;o<e.length&&i;o+=2){var a=Math.floor(e[o]),s=Math.floor(e[o+1]);if(a<-1||n<a||s<-1||r<s)throw new I;i=!1,-1===a?i=!(e[o]=0):a===n&&(e[o]=n-1,i=!0),-1===s?i=!(e[o+1]=0):s===r&&(e[o+1]=r-1,i=!0)}for(i=!0,o=e.length-2;0<=o&&i;o-=2){a=Math.floor(e[o]),s=Math.floor(e[o+1]);if(a<-1||n<a||s<-1||r<s)throw new I;i=!1,-1===a?i=!(e[o]=0):a===n&&(e[o]=n-1,i=!0),-1===s?i=!(e[o+1]=0):s===r&&(e[o+1]=r-1,i=!0)}};var Dd=Nd;function Nd(){}Pd.quadrilateralToQuadrilateral=function(t,e,n,r,i,o,a,s,l,u,c,h,d,p,f,g){t=Pd.quadrilateralToSquare(t,e,n,r,i,o,a,s);return Pd.squareToQuadrilateral(l,u,c,h,d,p,f,g).times(t)},Pd.prototype.transformPoints=function(t){for(var e=t.length,n=this.a11,r=this.a12,i=this.a13,o=this.a21,a=this.a22,s=this.a23,l=this.a31,u=this.a32,c=this.a33,h=0;h<e;h+=2){var d=t[h],p=t[h+1],f=i*d+s*p+c;t[h]=(n*d+o*p+l)/f,t[h+1]=(r*d+a*p+u)/f}},Pd.prototype.transformPointsWithValues=function(t,e){for(var n=this.a11,r=this.a12,i=this.a13,o=this.a21,a=this.a22,s=this.a23,l=this.a31,u=this.a32,c=this.a33,h=t.length,d=0;d<h;d++){var p=t[d],f=e[d],g=i*p+s*f+c;t[d]=(n*p+o*f+l)/g,e[d]=(r*p+a*f+u)/g}},Pd.squareToQuadrilateral=function(t,e,n,r,i,o,a,s){var l,u,c=t-n+i-a,h=e-r+o-s;return 0==c&&0==h?new Pd(n-t,i-n,t,r-e,o-r,e,0,0,1):new Pd(n-t+(o=(c*(l=s-o)-(u=a-i)*h)/(u=(i=n-i)*l-u*(l=r-o)))*n,a-t+(n=(i*h-c*l)/u)*a,t,r-e+o*r,s-e+n*s,e,o,n,1)},Pd.quadrilateralToSquare=function(t,e,n,r,i,o,a,s){return Pd.squareToQuadrilateral(t,e,n,r,i,o,a,s).buildAdjoint()},Pd.prototype.buildAdjoint=function(){return new Pd(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},Pd.prototype.times=function(t){return new Pd(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)};var Rd=Pd;function Pd(t,e,n,r,i,o,a,s,l){this.a11=t,this.a21=e,this.a31=n,this.a12=r,this.a22=i,this.a32=o,this.a13=a,this.a23=s,this.a33=l}var Od=Fd,Md=Ud=Dd;function Bd(){this.constructor=Od}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Od,Md),Od.prototype=null===Md?Object.create(Md):(Bd.prototype=Md.prototype,new Bd),Fd.prototype.sampleGrid=function(t,e,n,r,i,o,a,s,l,u,c,h,d,p,f,g,m,y,v){r=Rd.quadrilateralToQuadrilateral(r,i,o,a,s,l,u,c,h,d,p,f,g,m,y,v);return this.sampleGridWithTransform(t,e,n,r)},Fd.prototype.sampleGridWithTransform=function(t,e,n,r){if(e<=0||n<=0)throw new I;for(var i=new Zc(e,n),o=new Float32Array(2*e),a=0;a<n;a++){for(var s=o.length,l=a+.5,u=0;u<s;u+=2)o[u]=u/2+.5,o[u+1]=l;r.transformPoints(o),Dd.checkAndNudgePoints(t,o);try{for(u=0;u<s;u+=2)t.get(Math.floor(o[u]),Math.floor(o[u+1]))&&i.set(u/2,a)}catch(t){throw new I}}return i};var Ud,l=Fd;function Fd(){return null!==Ud&&Ud.apply(this,arguments)||this}Hd.setGridSampler=function(t){Hd.gridSampler=t},Hd.getInstance=function(){return Hd.gridSampler},Hd.gridSampler=new l;var Vd=Hd;function Hd(){}jd.prototype.toResultPoint=function(){return new x(this.getX(),this.getY())},jd.prototype.getX=function(){return this.x},jd.prototype.getY=function(){return this.y};var zd=jd;function jd(t,e){this.x=t,this.y=e}Wd.prototype.detect=function(){return this.detectMirror(!1)},Wd.prototype.detectMirror=function(t){var e=this.getMatrixCenter(),e=this.getBullsEyeCorners(e),t=(t&&(t=e[0],e[0]=e[2],e[2]=t),this.extractParameters(e),this.sampleGrid(this.image,e[this.shift%4],e[(this.shift+1)%4],e[(this.shift+2)%4],e[(this.shift+3)%4])),e=this.getMatrixCornerPoints(e);return new Id(t,e,this.compact,this.nbDataBlocks,this.nbLayers)},Wd.prototype.extractParameters=function(t){if(!(this.isValidPoint(t[0])&&this.isValidPoint(t[1])&&this.isValidPoint(t[2])&&this.isValidPoint(t[3])))throw new I;for(var e=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(t[0],t[1],e),this.sampleLine(t[1],t[2],e),this.sampleLine(t[2],t[3],e),this.sampleLine(t[3],t[0],e)]),r=(this.shift=this.getRotation(n,e),0),i=0;i<4;i++)var o=n[(this.shift+i)%4],r=this.compact?(r<<7)+(o>>1&127):(o>>2&992)+(o>>1&31)+(r<<10);t=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=1+(t>>6),this.nbDataBlocks=1+(63&t)):(this.nbLayers=1+(t>>11),this.nbDataBlocks=1+(2047&t))},Wd.prototype.getRotation=function(t,r){var i=0;t.forEach(function(t,e,n){i=(i<<3)+((t>>r-2<<1)+(1&t))});for(var i=((1&i)<<11)+(i>>1),e=0;e<4;e++)if(Ac.bitCount(i^this.EXPECTED_CORNER_BITS[e])<=2)return e;throw new I},Wd.prototype.getCorrectedParameterData=function(t,e){for(var n,r=e?(n=7,2):(n=10,4),e=n-r,i=new Int32Array(n),o=n-1;0<=o;--o)i[o]=15&t,t>>=4;try{new dd(Yh.AZTEC_PARAM).decode(i,e)}catch(t){throw new I}for(var a=0,o=0;o<r;o++)a=(a<<4)+i[o];return a},Wd.prototype.getBullsEyeCorners=function(t){var e=t,n=t,r=t,i=t,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var a=this.getFirstDifferent(e,o,1,-1),s=this.getFirstDifferent(n,o,1,1),l=this.getFirstDifferent(r,o,-1,1),u=this.getFirstDifferent(i,o,-1,-1);if(2<this.nbCenterLayers){var c=this.distancePoint(u,a)*this.nbCenterLayers/(this.distancePoint(i,e)*(this.nbCenterLayers+2));if(c<.75||1.25<c||!this.isWhiteOrBlackRectangle(a,s,l,u))break}e=a,n=s,r=l,i=u,o=!o}if(5!==this.nbCenterLayers&&7!==this.nbCenterLayers)throw new I;this.compact=5===this.nbCenterLayers;var t=new x(e.getX()+.5,e.getY()-.5),h=new x(n.getX()+.5,n.getY()+.5),d=new x(r.getX()-.5,r.getY()+.5),p=new x(i.getX()-.5,i.getY()-.5);return this.expandSquare([t,h,d,p],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},Wd.prototype.getMatrixCenter=function(){try{r=(t=new kd(this.image).detect())[0],i=t[1],o=t[2],a=t[3]}catch(t){var e=this.image.getWidth()/2,n=this.image.getHeight()/2,r=this.getFirstDifferent(new zd(7+e,n-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new zd(7+e,7+n),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new zd(e-7,7+n),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new zd(e-7,n-7),!1,-1,-1).toResultPoint()}var t,e=md.round((r.getX()+a.getX()+i.getX()+o.getX())/4),n=md.round((r.getY()+a.getY()+i.getY()+o.getY())/4);try{r=(t=new kd(this.image,15,e,n).detect())[0],i=t[1],o=t[2],a=t[3]}catch(t){r=this.getFirstDifferent(new zd(e+7,n-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new zd(e+7,n+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new zd(e-7,n+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new zd(e-7,n-7),!1,-1,-1).toResultPoint()}return e=md.round((r.getX()+a.getX()+i.getX()+o.getX())/4),n=md.round((r.getY()+a.getY()+i.getY()+o.getY())/4),new zd(e,n)},Wd.prototype.getMatrixCornerPoints=function(t){return this.expandSquare(t,2*this.nbCenterLayers,this.getDimension())},Wd.prototype.sampleGrid=function(t,e,n,r,i){var o=Vd.getInstance(),a=this.getDimension(),s=a/2-this.nbCenterLayers,l=a/2+this.nbCenterLayers;return o.sampleGrid(t,a,a,s,s,l,s,l,l,s,l,e.getX(),e.getY(),n.getX(),n.getY(),r.getX(),r.getY(),i.getX(),i.getY())},Wd.prototype.sampleLine=function(t,e,n){for(var r=0,i=this.distanceResultPoint(t,e),o=i/n,a=t.getX(),s=t.getY(),l=o*(e.getX()-t.getX())/i,u=o*(e.getY()-t.getY())/i,c=0;c<n;c++)this.image.get(md.round(a+c*l),md.round(s+c*u))&&(r|=1<<n-c-1);return r},Wd.prototype.isWhiteOrBlackRectangle=function(t,e,n,r){t=new zd(t.getX()-3,t.getY()+3),e=new zd(e.getX()-3,e.getY()-3),n=new zd(n.getX()+3,n.getY()-3),r=new zd(r.getX()+3,r.getY()+3);var i=this.getColor(r,t);return 0!==i&&this.getColor(t,e)===i&&this.getColor(e,n)===i&&this.getColor(n,r)===i},Wd.prototype.getColor=function(t,e){for(var n=this.distancePoint(t,e),r=(e.getX()-t.getX())/n,i=(e.getY()-t.getY())/n,o=0,a=t.getX(),s=t.getY(),l=this.image.get(t.getX(),t.getY()),u=Math.ceil(n),c=0;c<u;c++)s+=i,this.image.get(md.round(a+=r),md.round(s))!==l&&o++;e=o/n;return.1<e&&e<.9?0:e<=.1===l?1:-1},Wd.prototype.getFirstDifferent=function(t,e,n,r){for(var i=t.getX()+n,o=t.getY()+r;this.isValid(i,o)&&this.image.get(i,o)===e;)i+=n,o+=r;for(i-=n,o-=r;this.isValid(i,o)&&this.image.get(i,o)===e;)i+=n;for(i-=n;this.isValid(i,o)&&this.image.get(i,o)===e;)o+=r;return new zd(i,o-=r)},Wd.prototype.expandSquare=function(t,e,n){var n=n/(2*e),e=t[0].getX()-t[2].getX(),r=t[0].getY()-t[2].getY(),i=(t[0].getX()+t[2].getX())/2,o=(t[0].getY()+t[2].getY())/2,a=new x(i+n*e,o+n*r),s=new x(i-n*e,o-n*r),e=t[1].getX()-t[3].getX(),r=t[1].getY()-t[3].getY(),i=(t[1].getX()+t[3].getX())/2,o=(t[1].getY()+t[3].getY())/2;return[a,new x(i+n*e,o+n*r),s,new x(i-n*e,o-n*r)]},Wd.prototype.isValid=function(t,e){return 0<=t&&t<this.image.getWidth()&&0<e&&e<this.image.getHeight()},Wd.prototype.isValidPoint=function(t){var e=md.round(t.getX()),t=md.round(t.getY());return this.isValid(e,t)},Wd.prototype.distancePoint=function(t,e){return md.distance(t.getX(),t.getY(),e.getX(),e.getY())},Wd.prototype.distanceResultPoint=function(t,e){return md.distance(t.getX(),t.getY(),e.getX(),e.getY())},Wd.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(Ac.truncDivision(this.nbLayers-4,8)+1)+15};var qd=Wd;function Wd(t){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=t}Kd.prototype.decode=function(t,e){void 0===e&&(e=null);var n=null,t=new qd(t.getBlackMatrix()),r=null,i=null;try{r=(o=t.detectMirror(!1)).getPoints();this.reportFoundResultPoints(e,r),i=(new fd).decode(o)}catch(t){n=t}if(null==i)try{r=(o=t.detectMirror(!0)).getPoints(),this.reportFoundResultPoints(e,r),i=(new fd).decode(o)}catch(t){if(null!=n)throw n;throw t}var t=new Nh(i.getText(),i.getRawBytes(),i.getNumBits(),r,k.AZTEC,uc.currentTimeMillis()),e=i.getByteSegments(),o=(null!=e&&t.putMetadata(Ph.BYTE_SEGMENTS,e),i.getECLevel());return null!=o&&t.putMetadata(Ph.ERROR_CORRECTION_LEVEL,o),t},Kd.prototype.reportFoundResultPoints=function(t,e){var r;null!=t&&null!=(r=t.get(xc.NEED_RESULT_POINT_CALLBACK))&&e.forEach(function(t,e,n){r.foundPossibleResultPoint(t)})},Kd.prototype.reset=function(){};var Gd,$d=Kd;function Kd(){}function Xd(t){return void 0===t&&(t=500),Gd.call(this,new $d,t)||this}var Zd=Xd,u=Gd=r;function Yd(){this.constructor=Zd}var Qd=Zd,Jd=u,tp=((Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(Qd,Jd),Zd.prototype=null===u?Object.create(u):(Yd.prototype=u.prototype,new Yd),ep.prototype.decode=function(e,n){try{return this.doDecode(e,n)}catch(t){if(n&&!0===n.get(xc.TRY_HARDER)&&e.isRotateSupported()){var e=e.rotateCounterClockwise(),n=this.doDecode(e,n),r=n.getResultMetadata(),i=270,o=(null!==r&&!0===r.get(Ph.ORIENTATION)&&(i+=r.get(Ph.ORIENTATION)%360),n.putMetadata(Ph.ORIENTATION,i),n.getResultPoints());if(null!==o)for(var a=e.getHeight(),s=0;s<o.length;s++)o[s]=new x(a-o[s].getY()-1,o[s].getX());return n}throw new I}},ep.prototype.reset=function(){},ep.prototype.doDecode=function(t,i){for(var o=t.getWidth(),e=t.getHeight(),a=new Lc(o),n=i&&!0===i.get(xc.TRY_HARDER),r=Math.max(1,e>>(n?8:5)),s=n?e:15,l=Math.trunc(e/2),u=0;u<s;u++){var c=Math.trunc((u+1)/2),h=l+r*(0==(1&u)?c:-c);if(h<0||e<=h)break;try{a=t.getBlackRow(h,a)}catch(t){continue}for(var d=this,p=0;p<2;p++){var f=(t=>{var n;1===t&&(a.reverse(),i)&&!0===i.get(xc.NEED_RESULT_POINT_CALLBACK)&&(n=new Map,i.forEach(function(t,e){return n.set(e,t)}),n.delete(xc.NEED_RESULT_POINT_CALLBACK),i=n);try{var e,r=d.decodeRow(h,a,i);return 1===t&&(r.putMetadata(Ph.ORIENTATION,180),null!==(e=r.getResultPoints()))&&(e[0]=new x(o-e[0].getX()-1,e[0].getY()),e[1]=new x(o-e[1].getX()-1,e[1].getY())),{value:r}}catch(t){}})(p);if("object"==typeof f)return f.value}}throw new I},ep.recordPattern=function(t,e,n){for(var r=n.length,i=0;i<r;i++)n[i]=0;var o=t.getSize();if(o<=e)throw new I;for(var a=!t.get(e),s=0,l=e;l<o;){if(t.get(l)!==a)n[s]++;else{if(++s===r)break;n[s]=1,a=!a}l++}if(s!==r&&(s!==r-1||l!==o))throw new I},ep.recordPatternInReverse=function(t,e,n){for(var r=n.length,i=t.get(e);0<e&&0<=r;)t.get(--e)!==i&&(r--,i=!i);if(0<=r)throw new I;ep.recordPattern(t,e+1,n)},ep.patternMatchVariance=function(t,e,n){for(var r=t.length,i=0,o=0,a=0;a<r;a++)i+=t[a],o+=e[a];if(i<o)return Number.POSITIVE_INFINITY;for(var s=i/o,l=(n*=s,0),u=0;u<r;u++){var c=t[u],h=e[u]*s,h=h<c?c-h:h-c;if(n<h)return Number.POSITIVE_INFINITY;l+=h}return l/i},ep);function ep(){}var np=N,rp=op=tp;function ip(){this.constructor=np}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(np,rp),np.prototype=null===rp?Object.create(rp):(ip.prototype=rp.prototype,new ip),N.findStartPattern=function(t){for(var e=t.getSize(),n=t.getNextSet(0),r=0,i=Int32Array.from([0,0,0,0,0,0]),o=n,a=!1,s=n;s<e;s++)if(t.get(s)!==a)i[r]++;else{if(5===r){for(var l=N.MAX_AVG_VARIANCE,u=-1,c=N.CODE_START_A;c<=N.CODE_START_C;c++){var h=tp.patternMatchVariance(i,N.CODE_PATTERNS[c],N.MAX_INDIVIDUAL_VARIANCE);h<l&&(l=h,u=c)}if(0<=u&&t.isRange(Math.max(0,o-(s-o)/2),o,!1))return Int32Array.from([o,s,u]);o+=i[0]+i[1],(i=i.slice(2,i.length))[r-1]=0,i[r]=0,r--}else r++;i[r]=1,a=!a}throw new I},N.decodeCode=function(t,e,n){tp.recordPattern(t,n,e);for(var r=N.MAX_AVG_VARIANCE,i=-1,o=0;o<N.CODE_PATTERNS.length;o++){var a=N.CODE_PATTERNS[o],a=this.patternMatchVariance(e,a,N.MAX_INDIVIDUAL_VARIANCE);a<r&&(r=a,i=o)}if(0<=i)return i;throw new I},N.prototype.decodeRow=function(t,e,n){var r,i=n&&!0===n.get(xc.ASSUME_GS1),n=N.findStartPattern(e),o=n[2],a=0,s=new Uint8Array(20);switch(s[a++]=o){case N.CODE_START_A:r=N.CODE_CODE_A;break;case N.CODE_START_B:r=N.CODE_CODE_B;break;case N.CODE_START_C:r=N.CODE_CODE_C;break;default:throw new A}for(var l=!1,u=!1,c="",h=n[0],d=n[1],p=Int32Array.from([0,0,0,0,0,0]),f=0,g=0,m=o,y=0,v=!0,_=!1,w=!1;!l;){var b=u,u=!1,f=g,g=N.decodeCode(e,p,d);switch((s[a++]=g)!==N.CODE_STOP&&(v=!0),g!==N.CODE_STOP&&(m+=++y*g),h=d,d+=p.reduce(function(t,e){return t+e},0),g){case N.CODE_START_A:case N.CODE_START_B:case N.CODE_START_C:throw new A}switch(r){case N.CODE_CODE_A:if(g<64)c+=w===_?String.fromCharCode(" ".charCodeAt(0)+g):String.fromCharCode(" ".charCodeAt(0)+g+128),w=!1;else if(g<96)c+=w===_?String.fromCharCode(g-64):String.fromCharCode(g+64),w=!1;else switch(g!==N.CODE_STOP&&(v=!1),g){case N.CODE_FNC_1:i&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case N.CODE_FNC_2:case N.CODE_FNC_3:break;case N.CODE_FNC_4_A:w=!_&&w?!(_=!0):!_||!w||(_=!1);break;case N.CODE_SHIFT:u=!0,r=N.CODE_CODE_B;break;case N.CODE_CODE_B:r=N.CODE_CODE_B;break;case N.CODE_CODE_C:r=N.CODE_CODE_C;break;case N.CODE_STOP:l=!0}break;case N.CODE_CODE_B:if(g<96)c+=w===_?String.fromCharCode(" ".charCodeAt(0)+g):String.fromCharCode(" ".charCodeAt(0)+g+128),w=!1;else switch(g!==N.CODE_STOP&&(v=!1),g){case N.CODE_FNC_1:i&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case N.CODE_FNC_2:case N.CODE_FNC_3:break;case N.CODE_FNC_4_B:w=!_&&w?!(_=!0):!_||!w||(_=!1);break;case N.CODE_SHIFT:u=!0,r=N.CODE_CODE_A;break;case N.CODE_CODE_A:r=N.CODE_CODE_A;break;case N.CODE_CODE_C:r=N.CODE_CODE_C;break;case N.CODE_STOP:l=!0}break;case N.CODE_CODE_C:if(g<100)g<10&&(c+="0"),c+=g;else switch(g!==N.CODE_STOP&&(v=!1),g){case N.CODE_FNC_1:i&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case N.CODE_CODE_A:r=N.CODE_CODE_A;break;case N.CODE_CODE_B:r=N.CODE_CODE_B;break;case N.CODE_STOP:l=!0}}b&&(r=r===N.CODE_CODE_A?N.CODE_CODE_B:N.CODE_CODE_A)}o=d-h,d=e.getNextUnset(d);if(!e.isRange(d,Math.min(e.getSize(),d+(d-h)/2),!1))throw new I;if((m-=y*f)%103!==f)throw new ac;var C=c.length;if(0===C)throw new I;0<C&&v&&(c=r===N.CODE_CODE_C?c.substring(0,C-2):c.substring(0,C-1));for(var C=(n[1]+n[0])/2,n=h+o/2,E=s.length,S=new Uint8Array(E),T=0;T<E;T++)S[T]=s[T];o=[new x(C,t),new x(n,t)];return new Nh(c,S,0,o,k.CODE_128,(new Date).getTime())},N.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],N.MAX_AVG_VARIANCE=.25,N.MAX_INDIVIDUAL_VARIANCE=.7,N.CODE_SHIFT=98,N.CODE_CODE_C=99,N.CODE_CODE_B=100,N.CODE_CODE_A=101,N.CODE_FNC_1=102,N.CODE_FNC_2=97,N.CODE_FNC_3=96,N.CODE_FNC_4_A=101,N.CODE_FNC_4_B=100,N.CODE_START_A=103,N.CODE_START_B=104,N.CODE_START_C=105,N.CODE_STOP=106;var op,ap=N;function N(){return null!==op&&op.apply(this,arguments)||this}sp=function(t,e){return(sp=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var sp,lp,up=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},cp=(function(t,e){function n(){this.constructor=t}sp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(hp,lp=tp),hp.prototype.decodeRow=function(t,e,n){var r,i,o,a=this.counters,s=(a.fill(0),this.decodeRowResult="",hp.findAsteriskPattern(e,a)),l=e.getNextSet(s[1]),u=e.getSize();do{hp.recordPattern(e,l,a);var c=hp.toNarrowWidePattern(a);if(c<0)throw new I;c=hp.patternToChar(c),this.decodeRowResult+=c,o=l;try{r=void 0;for(var h=up(a),d=h.next();!d.done;d=h.next())l+=d.value}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}while(l=e.getNextSet(l),"*"!==c);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var p=0;try{for(var f=up(a),g=f.next();!g.done;g=f.next())p+=g.value}catch(t){w={error:t}}finally{try{g&&!g.done&&(_=f.return)&&_.call(f)}finally{if(w)throw w.error}}if(l!==u&&2*(l-o-p)<p)throw new I;if(this.usingCheckDigit){for(var m=this.decodeRowResult.length-1,y=0,v=0;v<m;v++)y+=hp.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(v));if(this.decodeRowResult.charAt(m)!==hp.ALPHABET_STRING.charAt(y%43))throw new ac;this.decodeRowResult=this.decodeRowResult.substring(0,m)}if(0===this.decodeRowResult.length)throw new I;var _=this.extendedMode?hp.decodeExtended(this.decodeRowResult):this.decodeRowResult,w=(s[1]+s[0])/2,u=o+p/2;return new Nh(_,null,0,[new x(w,t),new x(u,t)],k.CODE_39,(new Date).getTime())},hp.findAsteriskPattern=function(t,e){for(var n=t.getSize(),r=t.getNextSet(0),i=0,o=r,a=!1,s=e.length,l=r;l<n;l++)if(t.get(l)!==a)e[i]++;else{if(i===s-1){if(this.toNarrowWidePattern(e)===hp.ASTERISK_ENCODING&&t.isRange(Math.max(0,o-Math.floor((l-o)/2)),o,!1))return[o,l];o+=e[0]+e[1],e.copyWithin(0,2,2+i-1),e[i-1]=0,e[i]=0,i--}else i++;e[i]=1,a=!a}throw new I},hp.toNarrowWidePattern=function(t){var e,n,r=t.length,i=0;do{var o=2147483647;try{e=void 0;for(var a=up(t),s=a.next();!s.done;s=a.next())(d=s.value)<o&&i<d&&(o=d)}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}for(var i=o,l=0,u=0,c=0,h=0;h<r;h++)i<(d=t[h])&&(c|=1<<r-1-h,l++,u+=d);if(3===l){for(h=0;h<r&&0<l;h++){var d=t[h];if(i<d&&(l--,u<=2*d))return-1}return c}}while(3<l);return-1},hp.patternToChar=function(t){for(var e=0;e<hp.CHARACTER_ENCODINGS.length;e++)if(hp.CHARACTER_ENCODINGS[e]===t)return hp.ALPHABET_STRING.charAt(e);if(t===hp.ASTERISK_ENCODING)return"*";throw new I},hp.decodeExtended=function(t){for(var e=t.length,n="",r=0;r<e;r++){var i=t.charAt(r);if("+"===i||"$"===i||"%"===i||"/"===i){var o=t.charAt(r+1),a="\0";switch(i){case"+":if(!("A"<=o&&o<="Z"))throw new A;a=String.fromCharCode(o.charCodeAt(0)+32);break;case"$":if(!("A"<=o&&o<="Z"))throw new A;a=String.fromCharCode(o.charCodeAt(0)-64);break;case"%":if("A"<=o&&o<="E")a=String.fromCharCode(o.charCodeAt(0)-38);else if("F"<=o&&o<="J")a=String.fromCharCode(o.charCodeAt(0)-11);else if("K"<=o&&o<="O")a=String.fromCharCode(o.charCodeAt(0)+16);else if("P"<=o&&o<="T")a=String.fromCharCode(o.charCodeAt(0)+43);else if("U"===o)a="\0";else if("V"===o)a="@";else if("W"===o)a="`";else{if("X"!==o&&"Y"!==o&&"Z"!==o)throw new A;a=""}break;case"/":if("A"<=o&&o<="O")a=String.fromCharCode(o.charCodeAt(0)-32);else{if("Z"!==o)throw new A;a=":"}}n+=a,r++}else n+=i}return n},hp.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",hp.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],hp.ASTERISK_ENCODING=148,hp);function hp(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var n=lp.call(this)||this;return n.usingCheckDigit=t,n.extendedMode=e,n.decodeRowResult="",n.counters=new Int32Array(9),n}dp=function(t,e){return(dp=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var dp,pp,fp=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},gp=(function(t,e){function n(){this.constructor=t}dp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(mp,pp=tp),mp.prototype.decodeRow=function(t,e,n){var r,i,o,a=this.findAsteriskPattern(e),s=e.getNextSet(a[1]),l=e.getSize(),u=this.counters;u.fill(0),this.decodeRowResult="";do{mp.recordPattern(e,s,u);var c=this.toPattern(u);if(c<0)throw new I;c=this.patternToChar(c),this.decodeRowResult+=c,o=s;try{r=void 0;for(var h=fp(u),d=h.next();!d.done;d=h.next())s+=d.value}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}while(s=e.getNextSet(s),"*"!==c);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var p=0;try{for(var f=fp(u),g=f.next();!g.done;g=f.next())p+=g.value}catch(t){y={error:t}}finally{try{g&&!g.done&&(m=f.return)&&m.call(f)}finally{if(y)throw y.error}}if(s===l||!e.get(s))throw new I;if(this.decodeRowResult.length<2)throw new I;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var m=this.decodeExtended(this.decodeRowResult),y=(a[1]+a[0])/2,l=o+p/2;return new Nh(m,null,0,[new x(y,t),new x(l,t)],k.CODE_93,(new Date).getTime())},mp.prototype.findAsteriskPattern=function(t){for(var e=t.getSize(),n=t.getNextSet(0),r=(this.counters.fill(0),this.counters),i=n,o=!1,a=r.length,s=0,l=n;l<e;l++)if(t.get(l)!==o)r[s]++;else{if(s===a-1){if(this.toPattern(r)===mp.ASTERISK_ENCODING)return new Int32Array([i,l]);i+=r[0]+r[1],r.copyWithin(0,2,2+s-1),r[s-1]=0,r[s]=0,s--}else s++;r[s]=1,o=!o}throw new I},mp.prototype.toPattern=function(t){var e,n,r=0;try{for(var i=fp(t),o=i.next();!o.done;o=i.next())r+=o.value}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}for(var a=0,s=t.length,l=0;l<s;l++){var u=Math.round(9*t[l]/r);if(u<1||4<u)return-1;if(0==(1&l))for(var c=0;c<u;c++)a=a<<1|1;else a<<=u}return a},mp.prototype.patternToChar=function(t){for(var e=0;e<mp.CHARACTER_ENCODINGS.length;e++)if(mp.CHARACTER_ENCODINGS[e]===t)return mp.ALPHABET_STRING.charAt(e);throw new I},mp.prototype.decodeExtended=function(t){for(var e=t.length,n="",r=0;r<e;r++){var i=t.charAt(r);if("a"<=i&&i<="d"){if(e-1<=r)throw new A;var o=t.charAt(r+1),a="\0";switch(i){case"d":if(!("A"<=o&&o<="Z"))throw new A;a=String.fromCharCode(o.charCodeAt(0)+32);break;case"a":if(!("A"<=o&&o<="Z"))throw new A;a=String.fromCharCode(o.charCodeAt(0)-64);break;case"b":if("A"<=o&&o<="E")a=String.fromCharCode(o.charCodeAt(0)-38);else if("F"<=o&&o<="J")a=String.fromCharCode(o.charCodeAt(0)-11);else if("K"<=o&&o<="O")a=String.fromCharCode(o.charCodeAt(0)+16);else if("P"<=o&&o<="T")a=String.fromCharCode(o.charCodeAt(0)+43);else if("U"===o)a="\0";else if("V"===o)a="@";else if("W"===o)a="`";else{if(!("X"<=o&&o<="Z"))throw new A;a=String.fromCharCode(127)}break;case"c":if("A"<=o&&o<="O")a=String.fromCharCode(o.charCodeAt(0)-32);else{if("Z"!==o)throw new A;a=":"}}n+=a,r++}else n+=i}return n},mp.prototype.checkChecksums=function(t){var e=t.length;this.checkOneChecksum(t,e-2,20),this.checkOneChecksum(t,e-1,15)},mp.prototype.checkOneChecksum=function(t,e,n){for(var r=1,i=0,o=e-1;0<=o;o--)i+=r*mp.ALPHABET_STRING.indexOf(t.charAt(o)),++r>n&&(r=1);if(t.charAt(e)!==mp.ALPHABET_STRING[i%47])throw new ac},mp.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",mp.ASTERISK_ENCODING=(mp.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350])[47],mp);function mp(){var t=pp.call(this)||this;return t.decodeRowResult="",t.counters=new Int32Array(6),t}yp=function(t,e){return(yp=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var yp,vp,_p=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wp=(function(t,e){function n(){this.constructor=t}yp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(bp,vp=tp),bp.prototype.decodeRow=function(t,e,n){var r,i,o=this.decodeStart(e),a=this.decodeEnd(e),s=new Kc,e=(bp.decodeMiddle(e,o[1],a[0],s),s.toString()),s=null,l=(null==(s=null!=n?n.get(xc.ALLOWED_LENGTHS):s)&&(s=bp.DEFAULT_ALLOWED_LENGTHS),e.length),u=!1,c=0;try{for(var h=_p(s),d=h.next();!d.done;d=h.next()){var p=d.value;if(l===p){u=!0;break}c<p&&(c=p)}}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}if(u=!u&&c<l?!0:u)return n=[new x(o[1],t),new x(a[0],t)],new Nh(e,null,0,n,k.ITF,(new Date).getTime());throw new A},bp.decodeMiddle=function(t,e,n,r){var i=new Int32Array(10),o=new Int32Array(5),a=new Int32Array(5);for(i.fill(0),o.fill(0),a.fill(0);e<n;){tp.recordPattern(t,e,i);for(var s=0;s<5;s++){var l=2*s;o[s]=i[l],a[s]=i[1+l]}var u=bp.decodeDigit(o);r.append(u.toString()),u=this.decodeDigit(a),r.append(u.toString()),i.forEach(function(t){e+=t})}},bp.prototype.decodeStart=function(t){var e=bp.skipWhiteSpace(t),e=bp.findGuardPattern(t,e,bp.START_PATTERN);return this.narrowLineWidth=(e[1]-e[0])/4,this.validateQuietZone(t,e[0]),e},bp.prototype.validateQuietZone=function(t,e){for(var n=(n=10*this.narrowLineWidth)<e?n:e,r=e-1;0<n&&0<=r&&!t.get(r);r--)n--;if(0!==n)throw new I},bp.skipWhiteSpace=function(t){var e=t.getSize(),t=t.getNextSet(0);if(t===e)throw new I;return t},bp.prototype.decodeEnd=function(e){e.reverse();try{var n=bp.skipWhiteSpace(e),r=void 0;try{r=bp.findGuardPattern(e,n,bp.END_PATTERN_REVERSED[0])}catch(t){t instanceof I&&(r=bp.findGuardPattern(e,n,bp.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,r[0]);var t=r[0];return r[0]=e.getSize()-r[1],r[1]=e.getSize()-t,r}finally{e.reverse()}},bp.findGuardPattern=function(t,e,n){var r=n.length,i=new Int32Array(r),o=t.getSize(),a=!1,s=0,l=e;i.fill(0);for(var u=e;u<o;u++)if(t.get(u)!==a)i[s]++;else{if(s===r-1){if(tp.patternMatchVariance(i,n,bp.MAX_INDIVIDUAL_VARIANCE)<bp.MAX_AVG_VARIANCE)return[l,u];l+=i[0]+i[1],uc.arraycopy(i,2,i,0,s-1),i[s-1]=0,i[s]=0,s--}else s++;i[s]=1,a=!a}throw new I},bp.decodeDigit=function(t){for(var e=bp.MAX_AVG_VARIANCE,n=-1,r=bp.PATTERNS.length,i=0;i<r;i++){var o=bp.PATTERNS[i],o=tp.patternMatchVariance(t,o,bp.MAX_INDIVIDUAL_VARIANCE);o<e?(e=o,n=i):o===e&&(n=-1)}if(0<=n)return n%10;throw new I},bp.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],bp.MAX_AVG_VARIANCE=.38,bp.MAX_INDIVIDUAL_VARIANCE=.5,bp.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],bp.START_PATTERN=Int32Array.from([1,1,1,1]),bp.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],bp);function bp(){var t=null!==vp&&vp.apply(this,arguments)||this;return t.narrowLineWidth=-1,t}var Cp=Ip,Ep=Tp=tp;function Sp(){this.constructor=Cp}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Cp,Ep),Cp.prototype=null===Ep?Object.create(Ep):(Sp.prototype=Ep.prototype,new Sp),Ip.findStartGuardPattern=function(t){var e=!1,n=0;for(Int32Array.from([0,0,0]);!e;){var r,i=Int32Array.from([0,0,0]),i=(r=Ip.findGuardPattern(t,n,!1,this.START_END_PATTERN,i))[0],o=i-((n=r[1])-i);0<=o&&(e=t.isRange(o,i,!1))}return r},Ip.checkChecksum=function(t){return Ip.checkStandardUPCEANChecksum(t)},Ip.checkStandardUPCEANChecksum=function(t){var e,n=t.length;return 0!==n&&(e=parseInt(t.charAt(n-1),10),Ip.getStandardUPCEANChecksum(t.substring(0,n-1))===e)},Ip.getStandardUPCEANChecksum=function(t){for(var e=t.length,n=0,r=e-1;0<=r;r-=2){if((i=t.charAt(r).charCodeAt(0)-"0".charCodeAt(0))<0||9<i)throw new A;n+=i}n*=3;for(var i,r=e-2;0<=r;r-=2){if((i=t.charAt(r).charCodeAt(0)-"0".charCodeAt(0))<0||9<i)throw new A;n+=i}return(1e3-n)%10},Ip.decodeEnd=function(t,e){return Ip.findGuardPattern(t,e,!1,Ip.START_END_PATTERN,new Int32Array(Ip.START_END_PATTERN.length).fill(0))},Ip.findGuardPatternWithoutCounters=function(t,e,n,r){return this.findGuardPattern(t,e,n,r,new Int32Array(r.length))},Ip.findGuardPattern=function(t,e,n,r,i){for(var o=t.getSize(),a=0,s=e=n?t.getNextUnset(e):t.getNextSet(e),l=r.length,u=n,c=e;c<o;c++)if(t.get(c)!==u)i[a]++;else{if(a===l-1){if(tp.patternMatchVariance(i,r,Ip.MAX_INDIVIDUAL_VARIANCE)<Ip.MAX_AVG_VARIANCE)return Int32Array.from([s,c]);s+=i[0]+i[1];for(var h=i.slice(2,i.length),d=0;d<a-1;d++)i[d]=h[d];i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,u=!u}throw new I},Ip.decodeDigit=function(t,e,n,r){this.recordPattern(t,n,e);for(var i=this.MAX_AVG_VARIANCE,o=-1,a=r.length,s=0;s<a;s++){var l=r[s],l=tp.patternMatchVariance(e,l,Ip.MAX_INDIVIDUAL_VARIANCE);l<i&&(i=l,o=s)}if(0<=o)return o;throw new I},Ip.MAX_AVG_VARIANCE=.48,Ip.MAX_INDIVIDUAL_VARIANCE=.7,Ip.START_END_PATTERN=Int32Array.from([1,1,1]),Ip.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ip.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ip.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];var Tp,Ap=Ip;function Ip(){var t=null!==Tp&&Tp.apply(this,arguments)||this;return t.decodeRowStringBuffer="",t}var Lp=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},kp=(xp.prototype.decodeRow=function(t,e,n){var r=this.decodeRowStringBuffer,e=this.decodeMiddle(e,n,r),r=r.toString(),i=xp.parseExtensionString(r),n=[new x((n[0]+n[1])/2,t),new x(e,t)],e=new Nh(r,null,0,n,k.UPC_EAN_EXTENSION,(new Date).getTime());return null!=i&&e.putAllMetadata(i),e},xp.prototype.decodeMiddle=function(t,e,n){for(var r,i,o=this.decodeMiddleCounters,a=(o[0]=0,o[1]=0,o[2]=0,o[3]=0,t.getSize()),s=e[1],l=0,u=0;u<5&&s<a;u++){var c=Ap.decodeDigit(t,o,s,Ap.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+c%10);try{r=void 0;for(var h=Lp(o),d=h.next();!d.done;d=h.next())s+=d.value}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}10<=c&&(l|=1<<4-u),4!==u&&(s=t.getNextSet(s),s=t.getNextUnset(s))}if(5!==n.length)throw new I;e=this.determineCheckDigit(l);if(xp.extensionChecksum(n.toString())!==e)throw new I;return s},xp.extensionChecksum=function(t){for(var e=t.length,n=0,r=e-2;0<=r;r-=2)n+=t.charAt(r).charCodeAt(0)-"0".charCodeAt(0);n*=3;for(r=e-1;0<=r;r-=2)n+=t.charAt(r).charCodeAt(0)-"0".charCodeAt(0);return(n*=3)%10},xp.prototype.determineCheckDigit=function(t){for(var e=0;e<10;e++)if(t===this.CHECK_DIGIT_ENCODINGS[e])return e;throw new I},xp.parseExtensionString=function(t){return 5!==t.length||null==(t=xp.parseExtension5String(t))?null:new Map([[Ph.SUGGESTED_PRICE,t]])},xp.parseExtension5String=function(t){var e;switch(t.charAt(0)){case"0":e="Â£";break;case"5":e="$";break;case"9":switch(t){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}e="";break;default:e=""}var n=parseInt(t.substring(1)),r=n%100;return e+(n/100).toString()+"."+(r<10?"0"+r:r.toString())},xp);function xp(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}var Dp=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Np=(Rp.prototype.decodeRow=function(t,e,n){var r=this.decodeRowStringBuffer,e=this.decodeMiddle(e,n,r),r=r.toString(),i=Rp.parseExtensionString(r),n=[new x((n[0]+n[1])/2,t),new x(e,t)],e=new Nh(r,null,0,n,k.UPC_EAN_EXTENSION,(new Date).getTime());return null!=i&&e.putAllMetadata(i),e},Rp.prototype.decodeMiddle=function(t,e,n){for(var r,i,o=this.decodeMiddleCounters,a=(o[0]=0,o[1]=0,o[2]=0,o[3]=0,t.getSize()),s=e[1],l=0,u=0;u<2&&s<a;u++){var c=Ap.decodeDigit(t,o,s,Ap.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+c%10);try{r=void 0;for(var h=Dp(o),d=h.next();!d.done;d=h.next())s+=d.value}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}10<=c&&(l|=1<<1-u),1!==u&&(s=t.getNextSet(s),s=t.getNextUnset(s))}if(2!==n.length)throw new I;if(parseInt(n.toString())%4!==l)throw new I;return s},Rp.parseExtensionString=function(t){return 2!==t.length?null:new Map([[Ph.ISSUE_NUMBER,parseInt(t)]])},Rp);function Rp(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}Op.decodeRow=function(e,n,r){r=Ap.findGuardPattern(n,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new kp).decodeRow(e,n,r)}catch(t){return(new Np).decodeRow(e,n,r)}},Op.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);var Pp=Op;function Op(){}var Mp=Hp,Bp=Fp=Ap;function Up(){this.constructor=Mp}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Mp,Bp),Mp.prototype=null===Bp?Object.create(Bp):(Up.prototype=Bp.prototype,new Up),Hp.prototype.decodeRow=function(t,e,n){var r=Hp.findStartGuardPattern(e),i=null==n?null:n.get(xc.NEED_RESULT_POINT_CALLBACK),o=(null!=i&&(o=new x((r[0]+r[1])/2,t),i.foundPossibleResultPoint(o)),this.decodeMiddle(e,r,this.decodeRowStringBuffer)),a=o.rowOffset,o=o.resultString,s=(null!=i&&(s=new x(a,t),i.foundPossibleResultPoint(s)),Hp.decodeEnd(e,a)),i=(null!=i&&(a=new x((s[0]+s[1])/2,t),i.foundPossibleResultPoint(a)),s[1]),a=i+(i-s[0]);if(a>=e.getSize()||!e.isRange(i,a,!1))throw new I;i=o.toString();if(i.length<8)throw new A;if(!Hp.checkChecksum(i))throw new ac;var a=(r[1]+r[0])/2,o=(s[1]+s[0])/2,r=this.getBarcodeFormat(),a=[new x(a,t),new x(o,t)],o=new Nh(i,null,0,a,r,(new Date).getTime()),l=0;try{var u=Pp.decodeRow(t,e,s[1]);o.putMetadata(Ph.UPC_EAN_EXTENSION,u.getText()),o.putAllMetadata(u.getResultMetadata()),o.addResultPoints(u.getResultPoints()),l=u.getText().length}catch(t){}i=null==n?null:n.get(xc.ALLOWED_EAN_EXTENSIONS);if(null!=i){var c,h=!1;for(c in i)if(l.toString()===c){h=!0;break}if(!h)throw new I}return r!==k.EAN_13&&k.UPC_A,o},Hp.checkChecksum=function(t){return Hp.checkStandardUPCEANChecksum(t)},Hp.checkStandardUPCEANChecksum=function(t){var e,n=t.length;return 0!==n&&(e=parseInt(t.charAt(n-1),10),Hp.getStandardUPCEANChecksum(t.substring(0,n-1))===e)},Hp.getStandardUPCEANChecksum=function(t){for(var e=t.length,n=0,r=e-1;0<=r;r-=2){if((i=t.charAt(r).charCodeAt(0)-"0".charCodeAt(0))<0||9<i)throw new A;n+=i}n*=3;for(var i,r=e-2;0<=r;r-=2){if((i=t.charAt(r).charCodeAt(0)-"0".charCodeAt(0))<0||9<i)throw new A;n+=i}return(1e3-n)%10},Hp.decodeEnd=function(t,e){return Hp.findGuardPattern(t,e,!1,Hp.START_END_PATTERN,new Int32Array(Hp.START_END_PATTERN.length).fill(0))};var Fp,Vp=Hp;function Hp(){var t=Fp.call(this)||this;t.decodeRowStringBuffer="",Hp.L_AND_G_PATTERNS=Hp.L_PATTERNS.map(function(t){return Int32Array.from(t)});for(var e=10;e<20;e++){for(var n=Hp.L_PATTERNS[e-10],r=new Int32Array(n.length),i=0;i<n.length;i++)r[i]=n[n.length-i-1];Hp.L_AND_G_PATTERNS[e]=r}return t}zp=function(t,e){return(zp=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var zp,jp,qp=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Wp=(function(t,e){function n(){this.constructor=t}zp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(Gp,jp=Vp),Gp.prototype.decodeMiddle=function(t,e,n){for(var r,i,o,a,s=this.decodeMiddleCounters,l=(s[0]=0,s[1]=0,s[2]=0,s[3]=0,t.getSize()),u=e[1],c=0,h=0;h<6&&u<l;h++){var d=Vp.decodeDigit(t,s,u,Vp.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+d%10);try{r=void 0;for(var p=qp(s),f=p.next();!f.done;f=p.next())u+=f.value}catch(t){r={error:t}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}10<=d&&(c|=1<<5-h)}n=Gp.determineFirstDigit(n,c);for(u=Vp.findGuardPattern(t,u,!0,Vp.MIDDLE_PATTERN,new Int32Array(Vp.MIDDLE_PATTERN.length).fill(0))[1],h=0;h<6&&u<l;h++){d=Vp.decodeDigit(t,s,u,Vp.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+d);try{o=void 0;for(var g=qp(s),m=g.next();!m.done;m=g.next())u+=m.value}catch(t){o={error:t}}finally{try{m&&!m.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}}return{rowOffset:u,resultString:n}},Gp.prototype.getBarcodeFormat=function(){return k.EAN_13},Gp.determineFirstDigit=function(t,e){for(var n=0;n<10;n++)if(e===this.FIRST_DIGIT_ENCODINGS[n])return t=String.fromCharCode("0".charCodeAt(0)+n)+t;throw new I},Gp.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],Gp);function Gp(){var t=jp.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}$p=function(t,e){return($p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var $p,Kp,Xp=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Zp=(function(t,e){function n(){this.constructor=t}$p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(Yp,Kp=Vp),Yp.prototype.decodeMiddle=function(t,e,n){for(var r,i,o,a,s=this.decodeMiddleCounters,l=(s[0]=0,s[1]=0,s[2]=0,s[3]=0,t.getSize()),u=e[1],c=0;c<4&&u<l;c++){var h=Vp.decodeDigit(t,s,u,Vp.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+h);try{r=void 0;for(var d=Xp(s),p=d.next();!p.done;p=d.next())u+=p.value}catch(t){r={error:t}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}}for(u=Vp.findGuardPattern(t,u,!0,Vp.MIDDLE_PATTERN,new Int32Array(Vp.MIDDLE_PATTERN.length).fill(0))[1],c=0;c<4&&u<l;c++){h=Vp.decodeDigit(t,s,u,Vp.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+h);try{o=void 0;for(var f=Xp(s),g=f.next();!g.done;g=f.next())u+=g.value}catch(t){o={error:t}}finally{try{g&&!g.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}}return{rowOffset:u,resultString:n}},Yp.prototype.getBarcodeFormat=function(){return k.EAN_8},Yp);function Yp(){var t=Kp.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}var Qp=rf,Jp=ef=Vp;function tf(){this.constructor=Qp}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Qp,Jp),Qp.prototype=null===Jp?Object.create(Jp):(tf.prototype=Jp.prototype,new tf),rf.prototype.getBarcodeFormat=function(){return k.UPC_A},rf.prototype.decode=function(t,e){return this.maybeReturnResult(this.ean13Reader.decode(t))},rf.prototype.decodeRow=function(t,e,n){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,e,n))},rf.prototype.decodeMiddle=function(t,e,n){return this.ean13Reader.decodeMiddle(t,e,n)},rf.prototype.maybeReturnResult=function(t){var e=t.getText();if("0"===e.charAt(0))return e=new Nh(e.substring(1),null,null,t.getResultPoints(),k.UPC_A),null!=t.getResultMetadata()&&e.putAllMetadata(t.getResultMetadata()),e;throw new I},rf.prototype.reset=function(){this.ean13Reader.reset()};var ef,nf=rf;function rf(){var t=null!==ef&&ef.apply(this,arguments)||this;return t.ean13Reader=new Wp,t}of=function(t,e){return(of=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var of,af,sf=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},lf=(function(t,e){function n(){this.constructor=t}of(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(uf,af=Vp),uf.prototype.decodeMiddle=function(t,e,n){for(var r,i,o=this.decodeMiddleCounters.map(function(t){return t}),a=(o[0]=0,o[1]=0,o[2]=0,o[3]=0,t.getSize()),s=e[1],l=0,u=0;u<6&&s<a;u++){var c=uf.decodeDigit(t,o,s,uf.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+c%10);try{r=void 0;for(var h=sf(o),d=h.next();!d.done;d=h.next())s+=d.value}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}10<=c&&(l|=1<<5-u)}return uf.determineNumSysAndCheckDigit(new Kc(n),l),s},uf.prototype.decodeEnd=function(t,e){return uf.findGuardPatternWithoutCounters(t,e,!0,uf.MIDDLE_END_PATTERN)},uf.prototype.checkChecksum=function(t){return Vp.checkChecksum(uf.convertUPCEtoUPCA(t))},uf.determineNumSysAndCheckDigit=function(t,e){for(var n=0;n<=1;n++)for(var r=0;r<10;r++)if(e===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[n][r])return t.insert(0,"0"+n),void t.append("0"+r);throw I.getNotFoundInstance()},uf.prototype.getBarcodeFormat=function(){return k.UPC_E},uf.convertUPCEtoUPCA=function(t){var e=t.slice(1,7).split("").map(function(t){return t.charCodeAt(0)}),n=new Kc,r=(n.append(t.charAt(0)),e[5]);switch(r){case 0:case 1:case 2:n.appendChars(e,0,2),n.append(r),n.append("0000"),n.appendChars(e,2,3);break;case 3:n.appendChars(e,0,3),n.append("00000"),n.appendChars(e,3,2);break;case 4:n.appendChars(e,0,4),n.append("00000"),n.append(e[4]);break;default:n.appendChars(e,0,5),n.append("0000"),n.append(r)}return 8<=t.length&&n.append(t.charAt(7)),n.toString()},uf.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),uf.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],uf);function uf(){var t=af.call(this)||this;return t.decodeMiddleCounters=new Int32Array(4),t}cf=function(t,e){return(cf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var cf,hf,df=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},pf=(function(t,e){function n(){this.constructor=t}cf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(ff,hf=tp),ff.prototype.decodeRow=function(t,e,n){var r,i;try{for(var o=df(this.readers),a=o.next();!a.done;a=o.next()){var s=a.value;try{var l,u,c=s.decodeRow(t,e,n),h=c.getBarcodeFormat()===k.EAN_13&&"0"===c.getText().charAt(0),d=null==n?null:n.get(xc.POSSIBLE_FORMATS),p=null==d||d.includes(k.UPC_A);return h&&p?(l=c.getRawBytes(),(u=new Nh(c.getText().substring(1),l,l?l.length:null,c.getResultPoints(),k.UPC_A)).putAllMetadata(c.getResultMetadata()),u):c}catch(t){}}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}throw new I},ff.prototype.reset=function(){var e,t;try{for(var n=df(this.readers),r=n.next();!r.done;r=n.next())r.value.reset()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},ff);function ff(t){var e=hf.call(this)||this,t=null==t?null:t.get(xc.POSSIBLE_FORMATS),n=[];return null!=t&&(-1<t.indexOf(k.EAN_13)&&n.push(new Wp),-1<t.indexOf(k.UPC_A)&&n.push(new nf),-1<t.indexOf(k.EAN_8)&&n.push(new Zp),-1<t.indexOf(k.UPC_E))&&n.push(new lf),0===n.length&&(n.push(new Wp),n.push(new nf),n.push(new Zp),n.push(new lf)),e.readers=n,e}var gf=wf,mf=vf=tp;function yf(){this.constructor=gf}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(gf,mf),gf.prototype=null===mf?Object.create(mf):(yf.prototype=mf.prototype,new yf),wf.prototype.decodeRow=function(t,e,n){e=this.getValidRowData(e);if(e){var r=this.codaBarDecodeRow(e.row);if(r)return new Nh(r,null,0,[new x(e.left,t),new x(e.right,t)],k.CODABAR,(new Date).getTime())}throw new I},wf.prototype.getValidRowData=function(t){var e=t.toArray(),t=e.indexOf(!0);if(-1===t)return null;var n=e.lastIndexOf(!0);if(n<=t)return null;for(var r=[],i=(e=e.slice(t,n+1))[0],o=1,a=1;a<e.length;a++)e[a]===i?o++:(i=e[a],r.push(o),o=1);return r.push(o),r.length<23&&(r.length+1)%8!=0?null:{row:r,left:t,right:n}},wf.prototype.codaBarDecodeRow=function(t){for(var e=[],n=Math.ceil(t.reduce(function(t,e){return(t+e)/2},0));0<t.length;){var r=t.splice(0,8).splice(0,7).map(function(t){return t<n?"n":"w"}).join("");if(void 0===this.CODA_BAR_CHAR_SET[r])return null;e.push(this.CODA_BAR_CHAR_SET[r])}var i=e.join("");return this.validCodaBarString(i)?i:null},wf.prototype.validCodaBarString=function(t){return/^[A-D].{1,}[A-D]$/.test(t)};var vf,_f=wf;function wf(){var t=null!==vf&&vf.apply(this,arguments)||this;return t.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},t}bf=function(t,e){return(bf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var bf,Cf,Ef=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Sf=(function(t,e){function n(){this.constructor=t}bf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(Tf,Cf=tp),Tf.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},Tf.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},Tf.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},Tf.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},Tf.prototype.getOddCounts=function(){return this.oddCounts},Tf.prototype.getEvenCounts=function(){return this.evenCounts},Tf.prototype.parseFinderValue=function(t,e){for(var n=0;n<e.length;n++)if(tp.patternMatchVariance(t,e[n],Tf.MAX_INDIVIDUAL_VARIANCE)<Tf.MAX_AVG_VARIANCE)return n;throw new I},Tf.count=function(t){return md.sum(new Int32Array(t))},Tf.increment=function(t,e){for(var n=0,r=e[0],i=1;i<t.length;i++)e[i]>r&&(r=e[i],n=i);t[n]++},Tf.decrement=function(t,e){for(var n=0,r=e[0],i=1;i<t.length;i++)e[i]<r&&(r=e[i],n=i);t[n]--},Tf.isFinderPattern=function(t){var e,n,r=t[0]+t[1],r=r/(r+t[2]+t[3]);if(Tf.MIN_FINDER_PATTERN_RATIO<=r&&r<=Tf.MAX_FINDER_PATTERN_RATIO){var i=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER;try{for(var a=Ef(t),s=a.next();!s.done;s=a.next()){var l=s.value;o<l&&(o=l),l<i&&(i=l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return o<10*i}return!1},Tf.MAX_AVG_VARIANCE=.2,Tf.MAX_INDIVIDUAL_VARIANCE=.45,Tf.MIN_FINDER_PATTERN_RATIO=9.5/12,Tf.MAX_FINDER_PATTERN_RATIO=12.5/14,Tf);function Tf(){var t=Cf.call(this)||this;return t.decodeFinderCounters=new Int32Array(4),t.dataCharacterCounters=new Int32Array(8),t.oddRoundingErrors=new Array(4),t.evenRoundingErrors=new Array(4),t.oddCounts=new Array(t.dataCharacterCounters.length/2),t.evenCounts=new Array(t.dataCharacterCounters.length/2),t}If.prototype.getValue=function(){return this.value},If.prototype.getChecksumPortion=function(){return this.checksumPortion},If.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},If.prototype.equals=function(t){return t instanceof If&&this.value===t.value&&this.checksumPortion===t.checksumPortion},If.prototype.hashCode=function(){return this.value^this.checksumPortion};var Af=If;function If(t,e){this.value=t,this.checksumPortion=e}kf.prototype.getValue=function(){return this.value},kf.prototype.getStartEnd=function(){return this.startEnd},kf.prototype.getResultPoints=function(){return this.resultPoints},kf.prototype.equals=function(t){return t instanceof kf&&this.value===t.value},kf.prototype.hashCode=function(){return this.value};var Lf=kf;function kf(t,e,n,r,i){this.value=t,this.startEnd=e,this.value=t,this.startEnd=e,this.resultPoints=new Array,this.resultPoints.push(new x(n,i)),this.resultPoints.push(new x(r,i))}var xf=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Df=(Nf.getRSSvalue=function(t,e,n){var r,i,o=0;try{for(var a=xf(t),s=a.next();!s.done;s=a.next())o+=s.value}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}for(var l=0,u=0,c=t.length,h=0;h<c-1;h++){var d=void 0,d=1;for(u|=1<<h;d<t[h];d++,u&=~(1<<h)){var p=Nf.combins(o-d-1,c-h-2);if(n&&0===u&&c-h-1<=o-d-(c-h-1)&&(p-=Nf.combins(o-d-(c-h),c-h-2)),1<c-h-1){for(var f=0,g=o-d-(c-h-2);e<g;g--)f+=Nf.combins(o-d-g-1,c-h-3);p-=f*(c-1-h)}else e<o-d&&p--;l+=p}o-=d}return l},Nf.combins=function(t,e){for(var n,r=e<t-e?t-(n=e):(n=t-e,e),i=1,o=1,a=t;r<a;a--)i*=a,o<=n&&(i/=o,o++);for(;o<=n;)i/=o,o++;return i},Nf);function Nf(){}Pf.buildBitArray=function(t){var e=2*t.length-1;null==t[t.length-1].getRightChar()&&--e;for(var n=new Lc(12*e),r=0,i=t[0].getRightChar().getValue(),o=11;0<=o;--o)0!=(i&1<<o)&&n.set(r),r++;for(o=1;o<t.length;++o){for(var a=t[o],s=a.getLeftChar().getValue(),l=11;0<=l;--l)0!=(s&1<<l)&&n.set(r),r++;if(null!==a.getRightChar())for(var u=a.getRightChar().getValue(),l=11;0<=l;--l)0!=(u&1<<l)&&n.set(r),r++}return n};var Rf=Pf;function Pf(){}Mf.prototype.getDecodedInformation=function(){return this.decodedInformation},Mf.prototype.isFinished=function(){return this.finished};var Of=Mf;function Mf(t,e){e?this.decodedInformation=null:(this.finished=t,this.decodedInformation=e)}function Bf(t){this.newPosition=t}Bf.prototype.getNewPosition=function(){return this.newPosition};var Uf=jf,Ff=Hf=M=Bf;function Vf(){this.constructor=Uf}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Uf,Ff),Uf.prototype=null===Ff?Object.create(Ff):(Vf.prototype=Ff.prototype,new Vf),jf.prototype.getValue=function(){return this.value},jf.prototype.isFNC1=function(){return this.value===jf.FNC1},jf.FNC1="$";var Hf,zf=jf;function jf(t,e){t=Hf.call(this,t)||this;return t.value=e,t}var qf=Xf,Wf=$f=M;function Gf(){this.constructor=qf}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(qf,Wf),qf.prototype=null===Wf?Object.create(Wf):(Gf.prototype=Wf.prototype,new Gf),Xf.prototype.getNewString=function(){return this.newString},Xf.prototype.isRemaining=function(){return this.remaining},Xf.prototype.getRemainingValue=function(){return this.remainingValue};var $f,Kf=Xf;function Xf(t,e,n){t=$f.call(this,t)||this;return n?(t.remaining=!0,t.remainingValue=t.remainingValue):(t.remaining=!1,t.remainingValue=0),t.newString=e,t}var Zf=eg,Yf=Jf=M;function Qf(){this.constructor=Zf}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Zf,Yf),Zf.prototype=null===Yf?Object.create(Yf):(Qf.prototype=Yf.prototype,new Qf),eg.prototype.getFirstDigit=function(){return this.firstDigit},eg.prototype.getSecondDigit=function(){return this.secondDigit},eg.prototype.getValue=function(){return 10*this.firstDigit+this.secondDigit},eg.prototype.isFirstDigitFNC1=function(){return this.firstDigit===eg.FNC1},eg.prototype.isSecondDigitFNC1=function(){return this.secondDigit===eg.FNC1},eg.prototype.isAnyFNC1=function(){return this.firstDigit===eg.FNC1||this.secondDigit===eg.FNC1},eg.FNC1=10;var Jf,tg=eg;function eg(t,e,n){t=Jf.call(this,t)||this;if(e<0||10<e||n<0||10<n)throw new A;return t.firstDigit=e,t.secondDigit=n,t}var ng=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rg=(T.parseFieldsInGeneralPurpose=function(t){var e,n,r,i,o,a,s,l;if(!t)return null;if(!(t.length<2)){var u=t.substring(0,2);try{for(var c=ng(T.TWO_DIGIT_DATA_LENGTH),h=c.next();!h.done;h=c.next())if((v=h.value)[0]===u)return v[1]===T.VARIABLE_LENGTH?T.processVariableAI(2,v[2],t):T.processFixedAI(2,v[1],t)}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}if(!(t.length<3)){var d=t.substring(0,3);try{for(var p=ng(T.THREE_DIGIT_DATA_LENGTH),f=p.next();!f.done;f=p.next())if((v=f.value)[0]===d)return v[1]===T.VARIABLE_LENGTH?T.processVariableAI(3,v[2],t):T.processFixedAI(3,v[1],t)}catch(t){r={error:t}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}try{for(var g=ng(T.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),m=g.next();!m.done;m=g.next())if((v=m.value)[0]===d)return v[1]===T.VARIABLE_LENGTH?T.processVariableAI(4,v[2],t):T.processFixedAI(4,v[1],t)}catch(t){o={error:t}}finally{try{m&&!m.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}if(!(t.length<4)){var y=t.substring(0,4);try{for(var v,_=ng(T.FOUR_DIGIT_DATA_LENGTH),w=_.next();!w.done;w=_.next())if((v=w.value)[0]===y)return v[1]===T.VARIABLE_LENGTH?T.processVariableAI(4,v[2],t):T.processFixedAI(4,v[1],t)}catch(t){s={error:t}}finally{try{w&&!w.done&&(l=_.return)&&l.call(_)}finally{if(s)throw s.error}}}}}throw new I},T.processFixedAI=function(t,e,n){if(n.length<t)throw new I;var r=n.substring(0,t);if(n.length<t+e)throw new I;var i=n.substring(t,t+e),n=n.substring(t+e),t="("+r+")"+i,e=T.parseFieldsInGeneralPurpose(n);return null==e?t:t+e},T.processVariableAI=function(t,e,n){var r=n.substring(0,t),e=n.length<t+e?n.length:t+e,t=n.substring(t,e),n=n.substring(e),e="("+r+")"+t,r=T.parseFieldsInGeneralPurpose(n);return null==r?e:e+r},T.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",T.VARIABLE_LENGTH=[],20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",T.VARIABLE_LENGTH,20],["22",T.VARIABLE_LENGTH,29],["30",T.VARIABLE_LENGTH,8],["37",T.VARIABLE_LENGTH,8],["90",T.VARIABLE_LENGTH,30],["91",T.VARIABLE_LENGTH,30],["92",T.VARIABLE_LENGTH,30],["93",T.VARIABLE_LENGTH,30],["94",T.VARIABLE_LENGTH,30],["95",T.VARIABLE_LENGTH,30],["96",T.VARIABLE_LENGTH,30],["97",T.VARIABLE_LENGTH,3],["98",T.VARIABLE_LENGTH,30],["99",T.VARIABLE_LENGTH,30]],T.THREE_DIGIT_DATA_LENGTH=[["240",T.VARIABLE_LENGTH,30],["241",T.VARIABLE_LENGTH,30],["242",T.VARIABLE_LENGTH,6],["250",T.VARIABLE_LENGTH,30],["251",T.VARIABLE_LENGTH,30],["253",T.VARIABLE_LENGTH,17],["254",T.VARIABLE_LENGTH,20],["400",T.VARIABLE_LENGTH,30],["401",T.VARIABLE_LENGTH,30],["402",17],["403",T.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",T.VARIABLE_LENGTH,20],["421",T.VARIABLE_LENGTH,15],["422",3],["423",T.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],T.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",T.VARIABLE_LENGTH,15],["391",T.VARIABLE_LENGTH,18],["392",T.VARIABLE_LENGTH,15],["393",T.VARIABLE_LENGTH,18],["703",T.VARIABLE_LENGTH,30]],T.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",T.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",T.VARIABLE_LENGTH,20],["8003",T.VARIABLE_LENGTH,30],["8004",T.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",T.VARIABLE_LENGTH,30],["8008",T.VARIABLE_LENGTH,12],["8018",18],["8020",T.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",T.VARIABLE_LENGTH,70],["8200",T.VARIABLE_LENGTH,70]],T);function T(){}og.prototype.decodeAllCodes=function(t,e){for(var n=e,r=null;;){var i=this.decodeGeneralPurposeField(n,r),o=rg.parseFieldsInGeneralPurpose(i.getNewString());if(null!=o&&t.append(o),r=i.isRemaining()?""+i.getRemainingValue():null,n===i.getNewPosition())break;n=i.getNewPosition()}return t.toString()},og.prototype.isStillNumeric=function(t){if(t+7>this.information.getSize())return t+4<=this.information.getSize();for(var e=t;e<t+3;++e)if(this.information.get(e))return!0;return this.information.get(t+3)},og.prototype.decodeNumeric=function(t){var e;return t+7>this.information.getSize()?(e=this.extractNumericValueFromBitArray(t,4),new tg(this.information.getSize(),0===e?tg.FNC1:e-1,tg.FNC1)):(e=this.extractNumericValueFromBitArray(t,7),new tg(t+7,(e-8)/11,(e-8)%11))},og.prototype.extractNumericValueFromBitArray=function(t,e){return og.extractNumericValueFromBitArray(this.information,t,e)},og.extractNumericValueFromBitArray=function(t,e,n){for(var r=0,i=0;i<n;++i)t.get(e+i)&&(r|=1<<n-i-1);return r},og.prototype.decodeGeneralPurposeField=function(t,e){this.buffer.setLengthToZero(),null!=e&&this.buffer.append(e),this.current.setPosition(t);e=this.parseBlocks();return null!=e&&e.isRemaining()?new Kf(this.current.getPosition(),this.buffer.toString(),e.getRemainingValue()):new Kf(this.current.getPosition(),this.buffer.toString())},og.prototype.parseBlocks=function(){var t;do{var e=this.current.getPosition(),n=(t=this.current.isAlpha()?this.parseAlphaBlock():this.current.isIsoIec646()?this.parseIsoIec646Block():this.parseNumericBlock()).isFinished()}while((e!==this.current.getPosition()||n)&&!n);return t.getDecodedInformation()},og.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var t,e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1())return t=void 0,t=e.isSecondDigitFNC1()?new Kf(this.current.getPosition(),this.buffer.toString()):new Kf(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Of(!0,t);if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1())return t=new Kf(this.current.getPosition(),this.buffer.toString()),new Of(!0,t);this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Of(!1)},og.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var t,e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1())return t=new Kf(this.current.getPosition(),this.buffer.toString()),new Of(!0,t);this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Of(!1)},og.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var t,e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1())return t=new Kf(this.current.getPosition(),this.buffer.toString()),new Of(!0,t);this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Of(!1)},og.prototype.isStillIsoIec646=function(t){var e;return!(t+5>this.information.getSize())&&(5<=(e=this.extractNumericValueFromBitArray(t,5))&&e<16||!(t+7>this.information.getSize())&&(64<=(e=this.extractNumericValueFromBitArray(t,7))&&e<116||!(t+8>this.information.getSize())&&232<=(e=this.extractNumericValueFromBitArray(t,8))&&e<253))},og.prototype.decodeIsoIec646=function(t){var e=this.extractNumericValueFromBitArray(t,5);if(15===e)return new zf(t+5,zf.FNC1);if(5<=e&&e<15)return new zf(t+5,"0"+(e-5));var n,e=this.extractNumericValueFromBitArray(t,7);if(64<=e&&e<90)return new zf(t+7,""+(e+1));if(90<=e&&e<116)return new zf(t+7,""+(e+7));switch(this.extractNumericValueFromBitArray(t,8)){case 232:n="!";break;case 233:n='"';break;case 234:n="%";break;case 235:n="&";break;case 236:n="'";break;case 237:n="(";break;case 238:n=")";break;case 239:n="*";break;case 240:n="+";break;case 241:n=",";break;case 242:n="-";break;case 243:n=".";break;case 244:n="/";break;case 245:n=":";break;case 246:n=";";break;case 247:n="<";break;case 248:n="=";break;case 249:n=">";break;case 250:n="?";break;case 251:n="_";break;case 252:n=" ";break;default:throw new A}return new zf(t+8,n)},og.prototype.isStillAlpha=function(t){var e;return!(t+5>this.information.getSize())&&(5<=(e=this.extractNumericValueFromBitArray(t,5))&&e<16||!(t+6>this.information.getSize())&&16<=(e=this.extractNumericValueFromBitArray(t,6))&&e<63)},og.prototype.decodeAlphanumeric=function(t){var e=this.extractNumericValueFromBitArray(t,5);if(15===e)return new zf(t+5,zf.FNC1);if(5<=e&&e<15)return new zf(t+5,"0"+(e-5));var n,r=this.extractNumericValueFromBitArray(t,6);if(32<=r&&r<58)return new zf(t+6,""+(r+33));switch(r){case 58:n="*";break;case 59:n=",";break;case 60:n="-";break;case 61:n=".";break;case 62:n="/";break;default:throw new ud("Decoding invalid alphanumeric value: "+r)}return new zf(t+6,n)},og.prototype.isAlphaTo646ToAlphaLatch=function(t){if(t+1>this.information.getSize())return!1;for(var e=0;e<5&&e+t<this.information.getSize();++e)if(2===e){if(!this.information.get(t+2))return!1}else if(this.information.get(t+e))return!1;return!0},og.prototype.isAlphaOr646ToNumericLatch=function(t){if(t+3>this.information.getSize())return!1;for(var e=t;e<t+3;++e)if(this.information.get(e))return!1;return!0},og.prototype.isNumericToAlphaNumericLatch=function(t){if(t+1>this.information.getSize())return!1;for(var e=0;e<4&&e+t<this.information.getSize();++e)if(this.information.get(t+e))return!1;return!0};var ig=og;function og(t){this.buffer=new Kc,this.information=t}function ag(t){this.information=t,this.generalDecoder=new ig(t)}ag.prototype.getInformation=function(){return this.information},ag.prototype.getGeneralDecoder=function(){return this.generalDecoder};var sg=dg,lg=cg=t=ag;function ug(){this.constructor=sg}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(sg,lg),sg.prototype=null===lg?Object.create(lg):(ug.prototype=lg.prototype,new ug),dg.prototype.encodeCompressedGtin=function(t,e){t.append("(01)");var n=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,e,n)},dg.prototype.encodeCompressedGtinWithoutAI=function(t,e,n){for(var r=0;r<4;++r){var i=this.getGeneralDecoder().extractNumericValueFromBitArray(e+10*r,10);i/100==0&&t.append("0"),i/10==0&&t.append("0"),t.append(i)}dg.appendCheckDigit(t,n)},dg.appendCheckDigit=function(t,e){for(var n=0,r=0;r<13;r++){var i=t.charAt(r+e).charCodeAt(0)-"0".charCodeAt(0);n+=0==(1&r)?3*i:i}t.append(n=10===(n=10-n%10)?0:n)},dg.GTIN_SIZE=40;var cg,hg=dg;function dg(t){return cg.call(this,t)||this}var pg=vg,fg=mg=hg;function gg(){this.constructor=pg}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(pg,fg),pg.prototype=null===fg?Object.create(fg):(gg.prototype=fg.prototype,new gg),vg.prototype.parseInformation=function(){var t=new Kc,e=(t.append("(01)"),t.length()),n=this.getGeneralDecoder().extractNumericValueFromBitArray(vg.HEADER_SIZE,4);return t.append(n),this.encodeCompressedGtinWithoutAI(t,vg.HEADER_SIZE+4,e),this.getGeneralDecoder().decodeAllCodes(t,vg.HEADER_SIZE+44)},vg.HEADER_SIZE=4;var mg,yg=vg;function vg(t){return mg.call(this,t)||this}var _g=Sg,wg=Cg=t;function bg(){this.constructor=_g}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(_g,wg),_g.prototype=null===wg?Object.create(wg):(bg.prototype=wg.prototype,new bg),Sg.prototype.parseInformation=function(){var t=new Kc;return this.getGeneralDecoder().decodeAllCodes(t,Sg.HEADER_SIZE)},Sg.HEADER_SIZE=5;var Cg,Eg=Sg;function Sg(t){return Cg.call(this,t)||this}var Tg=xg,Ag=Lg=hg;function Ig(){this.constructor=Tg}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Tg,Ag),Tg.prototype=null===Ag?Object.create(Ag):(Ig.prototype=Ag.prototype,new Ig),xg.prototype.encodeCompressedWeight=function(t,e,n){for(var e=this.getGeneralDecoder().extractNumericValueFromBitArray(e,n),r=(this.addWeightCode(t,e),this.checkWeight(e)),i=1e5,o=0;o<5;++o)r/i==0&&t.append("0"),i/=10;t.append(r)};var Lg,kg=xg;function xg(t){return Lg.call(this,t)||this}var Dg,Ng=Og,Rg=Dg=kg;function Pg(){this.constructor=Ng}function Og(t){return Dg.call(this,t)||this}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Ng,Rg),Ng.prototype=null===Rg?Object.create(Rg):(Pg.prototype=Rg.prototype,new Pg),Og.prototype.parseInformation=function(){if(this.getInformation().getSize()!==Og.HEADER_SIZE+kg.GTIN_SIZE+Og.WEIGHT_SIZE)throw new I;var t=new Kc;return this.encodeCompressedGtin(t,Og.HEADER_SIZE),this.encodeCompressedWeight(t,Og.HEADER_SIZE+kg.GTIN_SIZE,Og.WEIGHT_SIZE),t.toString()},Og.HEADER_SIZE=5,Og.WEIGHT_SIZE=15;var Mg=Hg,Bg=Fg=oo=Og;function Ug(){this.constructor=Mg}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Mg,Bg),Mg.prototype=null===Bg?Object.create(Bg):(Ug.prototype=Bg.prototype,new Ug),Hg.prototype.addWeightCode=function(t,e){t.append("(3103)")},Hg.prototype.checkWeight=function(t){return t};var Fg,Vg=Hg;function Hg(t){return Fg.call(this,t)||this}var zg=$g,jg=Wg=oo;function qg(){this.constructor=zg}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(zg,jg),zg.prototype=null===jg?Object.create(jg):(qg.prototype=jg.prototype,new qg),$g.prototype.addWeightCode=function(t,e){e<1e4?t.append("(3202)"):t.append("(3203)")},$g.prototype.checkWeight=function(t){return t<1e4?t:t-1e4};var Wg,Gg=$g;function $g(t){return Wg.call(this,t)||this}var Kg=Jg,Xg=Yg=hg;function Zg(){this.constructor=Kg}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Kg,Xg),Kg.prototype=null===Xg?Object.create(Xg):(Zg.prototype=Xg.prototype,new Zg),Jg.prototype.parseInformation=function(){if(this.getInformation().getSize()<Jg.HEADER_SIZE+hg.GTIN_SIZE)throw new I;var t=new Kc,e=(this.encodeCompressedGtin(t,Jg.HEADER_SIZE),this.getGeneralDecoder().extractNumericValueFromBitArray(Jg.HEADER_SIZE+hg.GTIN_SIZE,Jg.LAST_DIGIT_SIZE)),e=(t.append("(392"),t.append(e),t.append(")"),this.getGeneralDecoder().decodeGeneralPurposeField(Jg.HEADER_SIZE+hg.GTIN_SIZE+Jg.LAST_DIGIT_SIZE,null));return t.append(e.getNewString()),t.toString()},Jg.HEADER_SIZE=8,Jg.LAST_DIGIT_SIZE=2;var Yg,Qg=Jg;function Jg(t){return Yg.call(this,t)||this}var t1=o1,e1=r1=hg;function n1(){this.constructor=t1}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(t1,e1),t1.prototype=null===e1?Object.create(e1):(n1.prototype=e1.prototype,new n1),o1.prototype.parseInformation=function(){if(this.getInformation().getSize()<o1.HEADER_SIZE+hg.GTIN_SIZE)throw new I;var t=new Kc,e=(this.encodeCompressedGtin(t,o1.HEADER_SIZE),this.getGeneralDecoder().extractNumericValueFromBitArray(o1.HEADER_SIZE+hg.GTIN_SIZE,o1.LAST_DIGIT_SIZE)),e=(t.append("(393"),t.append(e),t.append(")"),this.getGeneralDecoder().extractNumericValueFromBitArray(o1.HEADER_SIZE+hg.GTIN_SIZE+o1.LAST_DIGIT_SIZE,o1.FIRST_THREE_DIGITS_SIZE)),e=(e/100==0&&t.append("0"),e/10==0&&t.append("0"),t.append(e),this.getGeneralDecoder().decodeGeneralPurposeField(o1.HEADER_SIZE+hg.GTIN_SIZE+o1.LAST_DIGIT_SIZE+o1.FIRST_THREE_DIGITS_SIZE,null));return t.append(e.getNewString()),t.toString()},o1.HEADER_SIZE=8,o1.LAST_DIGIT_SIZE=2,o1.FIRST_THREE_DIGITS_SIZE=10;var r1,i1=o1;function o1(t){return r1.call(this,t)||this}var a1=h1,s1=u1=kg;function l1(){this.constructor=a1}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(a1,s1),a1.prototype=null===s1?Object.create(s1):(l1.prototype=s1.prototype,new l1),h1.prototype.parseInformation=function(){if(this.getInformation().getSize()!==h1.HEADER_SIZE+h1.GTIN_SIZE+h1.WEIGHT_SIZE+h1.DATE_SIZE)throw new I;var t=new Kc;return this.encodeCompressedGtin(t,h1.HEADER_SIZE),this.encodeCompressedWeight(t,h1.HEADER_SIZE+h1.GTIN_SIZE,h1.WEIGHT_SIZE),this.encodeCompressedDate(t,h1.HEADER_SIZE+h1.GTIN_SIZE+h1.WEIGHT_SIZE),t.toString()},h1.prototype.encodeCompressedDate=function(t,e){var n,r,e=this.getGeneralDecoder().extractNumericValueFromBitArray(e,h1.DATE_SIZE);38400!==e&&(t.append("("),t.append(this.dateCode),t.append(")"),n=e%32,r=(e/=32)%12+1,(e=e/=12)/10==0&&t.append("0"),t.append(e),r/10==0&&t.append("0"),t.append(r),n/10==0&&t.append("0"),t.append(n))},h1.prototype.addWeightCode=function(t,e){t.append("("),t.append(this.firstAIdigits),t.append(e/1e5),t.append(")")},h1.prototype.checkWeight=function(t){return t%1e5},h1.HEADER_SIZE=8,h1.WEIGHT_SIZE=20,h1.DATE_SIZE=16;var u1,c1=h1;function h1(t,e,n){t=u1.call(this,t)||this;return t.dateCode=n,t.firstAIdigits=e,t}p1.prototype.mayBeLast=function(){return this.maybeLast},p1.prototype.getLeftChar=function(){return this.leftchar},p1.prototype.getRightChar=function(){return this.rightchar},p1.prototype.getFinderPattern=function(){return this.finderpattern},p1.prototype.mustBeLast=function(){return null==this.rightchar},p1.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(null==this.finderpattern?"null":this.finderpattern.getValue())+" ]"},p1.equals=function(t,e){return t instanceof p1&&p1.equalsOrNull(t.leftchar,e.leftchar)&&p1.equalsOrNull(t.rightchar,e.rightchar)&&p1.equalsOrNull(t.finderpattern,e.finderpattern)},p1.equalsOrNull=function(t,e){return null===t?null===e:p1.equals(t,e)},p1.prototype.hashCode=function(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()};var d1=p1;function p1(t,e,n,r){this.leftchar=t,this.rightchar=e,this.finderpattern=n,this.maybeLast=r}g1.prototype.getPairs=function(){return this.pairs},g1.prototype.getRowNumber=function(){return this.rowNumber},g1.prototype.isReversed=function(){return this.wasReversed},g1.prototype.isEquivalent=function(t){return this.checkEqualitity(this,t)},g1.prototype.toString=function(){return"{ "+this.pairs+" }"},g1.prototype.equals=function(t,e){return t instanceof g1&&this.checkEqualitity(t,e)&&t.wasReversed===e.wasReversed},g1.prototype.checkEqualitity=function(t,n){var r;if(t&&n)return t.forEach(function(e,t){n.forEach(function(t){e.getLeftChar().getValue()===t.getLeftChar().getValue()&&e.getRightChar().getValue()===t.getRightChar().getValue()&&e.getFinderPatter().getValue()===t.getFinderPatter().getValue()&&(r=!0)})}),r};var f1=g1;function g1(t,e,n){this.pairs=t,this.rowNumber=e,this.wasReversed=n}m1=function(t,e){return(m1=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var m1,y1,v1=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_1=(function(t,e){function n(){this.constructor=t}m1(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(R,y1=Sf),R.prototype.decodeRow=function(t,e,n){this.pairs.length=0,this.startFromEven=!1;try{return R.constructResult(this.decodeRow2pairs(t,e))}catch(t){}return this.pairs.length=0,this.startFromEven=!0,R.constructResult(this.decodeRow2pairs(t,e))},R.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},R.prototype.decodeRow2pairs=function(t,e){for(var n=!1;!n;)try{this.pairs.push(this.retrieveNextPair(e,this.pairs,t))}catch(t){if(t instanceof I){if(!this.pairs.length)throw new I;n=!0}}if(this.checkChecksum())return this.pairs;if(r=!!this.rows.length,this.storeRow(t,!1),r){var r=this.checkRowsBoolean(!1);if(null!=r)return r;if(null!=(r=this.checkRowsBoolean(!0)))return r}throw new I},R.prototype.checkRowsBoolean=function(t){if(25<this.rows.length)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());var e=null;try{e=this.checkRows(new Array,0)}catch(t){console.log(t)}return t&&(this.rows=this.rows.reverse()),e},R.prototype.checkRows=function(t,e){for(var n,r,i=e;i<this.rows.length;i++){var o=this.rows[i];this.pairs.length=0;try{n=void 0;for(var a=v1(t),s=a.next();!s.done;s=a.next()){var l=s.value;this.pairs.push(l.getPairs())}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}if(this.pairs.push(o.getPairs()),R.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var u=new Array(t);u.push(o);try{return this.checkRows(u,i+1)}catch(t){console.log(t)}}}throw new I},R.isValidSequence=function(t){var e,n;try{for(var r=v1(R.FINDER_PATTERN_SEQUENCES),i=r.next();!i.done;i=r.next()){var o=i.value;if(!(t.length>o.length)){for(var a=!0,s=0;s<t.length;s++)if(t[s].getFinderPattern().getValue()!==o[s]){a=!1;break}if(a)return!0}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!1},R.prototype.storeRow=function(t,e){for(var n=0,r=!1,i=!1;n<this.rows.length;){var o=this.rows[n];if(o.getRowNumber()>t){i=o.isEquivalent(this.pairs);break}r=o.isEquivalent(this.pairs),n++}i||r||R.isPartialRow(this.pairs,this.rows)||(this.rows.push(n,new f1(this.pairs,t,e)),this.removePartialRows(this.pairs,this.rows))},R.prototype.removePartialRows=function(t,e){var n,r,i,o,a,s;try{for(var l=v1(e),u=l.next();!u.done;u=l.next()){var c=u.value;if(c.getPairs().length!==t.length)try{i=void 0;for(var h=v1(c.getPairs()),d=h.next();!d.done;d=h.next()){var p=d.value;try{a=void 0;for(var f=v1(t),g=f.next();!g.done;g=f.next()){var m=g.value;if(d1.equals(p,m)){0;break}}}catch(t){a={error:t}}finally{try{g&&!g.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}}}catch(t){i={error:t}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}},R.isPartialRow=function(t,e){var n,r,i,o,a,s;try{for(var l=v1(e),u=l.next();!u.done;u=l.next()){var c=u.value,h=!0;try{i=void 0;for(var d=v1(t),p=d.next();!p.done;p=d.next()){var f=p.value,g=!1;try{a=void 0;for(var m=v1(c.getPairs()),y=m.next();!y.done;y=m.next()){var v=y.value;if(f.equals(v)){g=!0;break}}}catch(t){a={error:t}}finally{try{y&&!y.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!g){h=!1;break}}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}if(h)return!0}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return!1},R.prototype.getRows=function(){return this.rows},R.constructResult=function(t){var e=(e=>{try{if(e.get(1))return new yg(e);if(!e.get(2))return new Eg(e);switch(ig.extractNumericValueFromBitArray(e,1,4)){case 4:return new Vg(e);case 5:return new Gg(e)}switch(ig.extractNumericValueFromBitArray(e,1,5)){case 12:return new Qg(e);case 13:return new i1(e)}switch(ig.extractNumericValueFromBitArray(e,1,7)){case 56:return new c1(e,"310","11");case 57:return new c1(e,"320","11");case 58:return new c1(e,"310","13");case 59:return new c1(e,"320","13");case 60:return new c1(e,"310","15");case 61:return new c1(e,"320","15");case 62:return new c1(e,"310","17");case 63:return new c1(e,"320","17")}}catch(t){throw console.log(t),new ud("unknown decoder: "+e)}})(Rf.buildBitArray(t)).parseInformation(),n=t[0].getFinderPattern().getResultPoints(),t=t[t.length-1].getFinderPattern().getResultPoints(),n=[n[0],n[1],t[0],t[1]];return new Nh(e,null,null,n,k.RSS_EXPANDED,null)},R.prototype.checkChecksum=function(){var t=this.pairs.get(0),e=t.getLeftChar(),t=t.getRightChar();if(null===t)return!1;for(var n=t.getChecksumPortion(),r=2,i=1;i<this.pairs.size();++i){var o=this.pairs.get(i),o=(n+=o.getLeftChar().getChecksumPortion(),r++,o.getRightChar());null!=o&&(n+=o.getChecksumPortion(),r++)}return 211*(r-4)+(n%=211)===e.getValue()},R.getNextSecondBar=function(t,e){var n=t.get(e)?(n=t.getNextUnset(e),t.getNextSet(n)):(n=t.getNextSet(e),t.getNextUnset(n));return n},R.prototype.retrieveNextPair=function(t,e,n){for(var r,i=e.length%2==0,o=(this.startFromEven&&(i=!i),!0),a=-1;this.findNextPair(t,e,a),null===(r=this.parseFoundFinderPattern(t,n,i))?a=R.getNextSecondBar(t,this.startEnd[0]):o=!1,o;);var s,l=this.decodeDataCharacter(t,r,i,!0);if(!this.isEmptyPair(e)&&e[e.length-1].mustBeLast())throw new I;try{s=this.decodeDataCharacter(t,r,i,!1)}catch(t){s=null,console.log(t)}return new d1(l,s,r,!0)},R.prototype.isEmptyPair=function(t){return 0===t.length},R.prototype.findNextPair=function(t,e,n){for(var r,i=this.getDecodeFinderCounters(),o=(i[0]=0,i[1]=0,i[2]=0,i[3]=0,t.getSize()),a=(r=0<=n?n:this.isEmptyPair(e)?0:e[e.length-1].getFinderPattern().getStartEnd()[1],e.length%2!=0),s=(this.startFromEven&&(a=!a),!1);r<o&&(s=!t.get(r));)r++;for(var l=0,u=r,c=r;c<o;c++)if(t.get(c)!==s)i[l]++;else{if(3===l){if(a&&R.reverseCounters(i),R.isFinderPattern(i))return this.startEnd[0]=u,void(this.startEnd[1]=c);a&&R.reverseCounters(i),u+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,l--}else l++;i[l]=1,s=!s}throw new I},R.reverseCounters=function(t){for(var e=t.length,n=0;n<e/2;++n){var r=t[n];t[n]=t[e-n-1],t[e-n-1]=r}},R.prototype.parseFoundFinderPattern=function(t,e,n){var r,i,o;if(n){for(var a=this.startEnd[0]-1;0<=a&&!t.get(a);)a--;r=this.startEnd[0]-++a,i=a,o=this.startEnd[1]}else i=this.startEnd[0],r=(o=t.getNextUnset(this.startEnd[1]+1))-this.startEnd[1];var s,n=this.getDecodeFinderCounters();uc.arraycopy(n,0,n,1,n.length-1),n[0]=r;try{s=this.parseFinderValue(n,R.FINDER_PATTERNS)}catch(t){return null}return new Lf(s,[i,o],i,o,e)},R.prototype.decodeDataCharacter=function(t,e,n,r){for(var i=this.getDataCharacterCounters(),o=0;o<i.length;o++)i[o]=0;if(r)R.recordPatternInReverse(t,e.getStartEnd()[0],i);else{R.recordPattern(t,e.getStartEnd()[1],i);for(var a=0,s=i.length-1;a<s;a++,s--){var l=i[a];i[a]=i[s],i[s]=l}}var u=md.sum(new Int32Array(i))/17,t=(e.getStartEnd()[1]-e.getStartEnd()[0])/15;if(.3<Math.abs(u-t)/t)throw new I;for(var c=this.getOddCounts(),h=this.getEvenCounts(),d=this.getOddRoundingErrors(),p=this.getEvenRoundingErrors(),a=0;a<i.length;a++){var f=+i[a]/u,g=.5+f;if(g<1){if(f<.3)throw new I;g=1}else if(8<g){if(8.7<f)throw new I;g=8}var m=a/2;0==(1&a)?(c[m]=g,d[m]=f-g):(h[m]=g,p[m]=f-g)}this.adjustOddEvenCounts(17);for(var y=4*e.getValue()+(n?0:2)+(r?0:1)-1,v=0,_=0,a=c.length-1;0<=a;a--)R.isNotA1left(e,n,r)&&(w=R.WEIGHTS[y][2*a],_+=c[a]*w),v+=c[a];for(var w,b=0,a=h.length-1;0<=a;a--)R.isNotA1left(e,n,r)&&(w=R.WEIGHTS[y][2*a+1],b+=h[a]*w);t=_+b;if(0!=(1&v)||13<v||v<4)throw new I;var C=(13-v)/2,E=R.SYMBOL_WIDEST[C],S=9-E,E=Df.getRSSvalue(c,E,!0),S=Df.getRSSvalue(h,S,!1),T=R.EVEN_TOTAL_SUBSET[C],C=R.GSUM[C];return new Af(E*T+S+C,t)},R.isNotA1left=function(t,e,n){return!(0===t.getValue()&&e&&n)},R.prototype.adjustOddEvenCounts=function(t){var e=md.sum(new Int32Array(this.getOddCounts())),n=md.sum(new Int32Array(this.getEvenCounts())),r=!1,i=!1,o=(13<e?i=!0:e<4&&(r=!0),!1),a=!1,t=(13<n?a=!0:n<4&&(o=!0),e+n-t),s=1==(1&e),l=0==(1&n);if(1==t)if(s){if(l)throw new I;i=!0}else{if(!l)throw new I;a=!0}else if(-1==t)if(s){if(l)throw new I;r=!0}else{if(!l)throw new I;o=!0}else{if(0!=t)throw new I;if(s){if(!l)throw new I;e<n?a=r=!0:o=i=!0}else if(l)throw new I}if(r){if(i)throw new I;R.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&R.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(a)throw new I;R.increment(this.getEvenCounts(),this.getOddRoundingErrors())}a&&R.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},R.SYMBOL_WIDEST=[7,5,4,3,1],R.EVEN_TOTAL_SUBSET=[4,20,52,104,204],R.GSUM=[0,348,1388,2948,3988],R.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],R.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],R.FINDER_PATTERN_SEQUENCES=[[R.FINDER_PAT_A=0,R.FINDER_PAT_A],[R.FINDER_PAT_A,R.FINDER_PAT_B=1,R.FINDER_PAT_B],[R.FINDER_PAT_A,R.FINDER_PAT_C=2,R.FINDER_PAT_B,R.FINDER_PAT_D=3],[R.FINDER_PAT_A,R.FINDER_PAT_E=4,R.FINDER_PAT_B,R.FINDER_PAT_D,R.FINDER_PAT_C],[R.FINDER_PAT_A,R.FINDER_PAT_E,R.FINDER_PAT_B,R.FINDER_PAT_D,R.FINDER_PAT_D,R.FINDER_PAT_F=5],[R.FINDER_PAT_A,R.FINDER_PAT_E,R.FINDER_PAT_B,R.FINDER_PAT_D,R.FINDER_PAT_E,R.FINDER_PAT_F,R.FINDER_PAT_F],[R.FINDER_PAT_A,R.FINDER_PAT_A,R.FINDER_PAT_B,R.FINDER_PAT_B,R.FINDER_PAT_C,R.FINDER_PAT_C,R.FINDER_PAT_D,R.FINDER_PAT_D],[R.FINDER_PAT_A,R.FINDER_PAT_A,R.FINDER_PAT_B,R.FINDER_PAT_B,R.FINDER_PAT_C,R.FINDER_PAT_C,R.FINDER_PAT_D,R.FINDER_PAT_E,R.FINDER_PAT_E],[R.FINDER_PAT_A,R.FINDER_PAT_A,R.FINDER_PAT_B,R.FINDER_PAT_B,R.FINDER_PAT_C,R.FINDER_PAT_C,R.FINDER_PAT_D,R.FINDER_PAT_E,R.FINDER_PAT_F,R.FINDER_PAT_F],[R.FINDER_PAT_A,R.FINDER_PAT_A,R.FINDER_PAT_B,R.FINDER_PAT_B,R.FINDER_PAT_C,R.FINDER_PAT_D,R.FINDER_PAT_D,R.FINDER_PAT_E,R.FINDER_PAT_E,R.FINDER_PAT_F,R.FINDER_PAT_F]],R.MAX_PAIRS=11,R);function R(){var t=null!==y1&&y1.apply(this,arguments)||this;return t.pairs=new Array(R.MAX_PAIRS),t.rows=new Array,t.startEnd=[2],t}var w1=T1,b1=E1=Af;function C1(){this.constructor=w1}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(w1,b1),w1.prototype=null===b1?Object.create(b1):(C1.prototype=b1.prototype,new C1),T1.prototype.getFinderPattern=function(){return this.finderPattern},T1.prototype.getCount=function(){return this.count},T1.prototype.incrementCount=function(){this.count++};var E1,S1=T1;function T1(t,e,n){t=E1.call(this,t,e)||this;return t.count=0,t.finderPattern=n,t}A1=function(t,e){return(A1=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var A1,I1,L1=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},k1=(function(t,e){function n(){this.constructor=t}A1(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(x1,I1=Sf),x1.prototype.decodeRow=function(t,e,n){var r,i,o,a,s=this.decodePair(e,!1,t,n),s=(x1.addOrTally(this.possibleLeftPairs,s),e.reverse(),this.decodePair(e,!0,t,n));x1.addOrTally(this.possibleRightPairs,s),e.reverse();try{for(var l=L1(this.possibleLeftPairs),u=l.next();!u.done;u=l.next()){var c=u.value;if(1<c.getCount())try{o=void 0;for(var h=L1(this.possibleRightPairs),d=h.next();!d.done;d=h.next()){var p=d.value;if(1<p.getCount()&&x1.checkChecksum(c,p))return x1.constructResult(c,p)}}catch(t){o={error:t}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}throw new I},x1.addOrTally=function(t,e){var n,r;if(null!=e){var i=!1;try{for(var o=L1(t),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.getValue()===e.getValue()){s.incrementCount(),i=!0;break}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}i||t.push(e)}},x1.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},x1.constructResult=function(t,e){for(var n=4537077*t.getValue()+e.getValue(),n=new String(n).toString(),r=new Kc,i=13-n.length;0<i;i--)r.append("0");r.append(n);for(var o=0,i=0;i<13;i++){var a=r.charAt(i).charCodeAt(0)-"0".charCodeAt(0);o+=0==(1&i)?3*a:a}r.append((o=10===(o=10-o%10)?0:o).toString());n=t.getFinderPattern().getResultPoints(),t=e.getFinderPattern().getResultPoints();return new Nh(r.toString(),null,0,[n[0],n[1],t[0],t[1]],k.RSS_14,(new Date).getTime())},x1.checkChecksum=function(t,e){var n=(t.getChecksumPortion()+16*e.getChecksumPortion())%79,t=9*t.getFinderPattern().getValue()+e.getFinderPattern().getValue();return 72<t&&t--,8<t&&t--,n===t},x1.prototype.decodePair=function(t,e,n,r){try{var i,o=this.findFinderPattern(t,e),a=this.parseFoundFinderPattern(t,n,e,o),s=null==r?null:r.get(xc.NEED_RESULT_POINT_CALLBACK),l=(null!=s&&(i=(o[0]+o[1])/2,e&&(i=t.getSize()-1-i),s.foundPossibleResultPoint(new x(i,n))),this.decodeDataCharacter(t,a,!0)),u=this.decodeDataCharacter(t,a,!1);return new S1(1597*l.getValue()+u.getValue(),l.getChecksumPortion()+4*u.getChecksumPortion(),a)}catch(t){return null}},x1.prototype.decodeDataCharacter=function(t,e,n){for(var r=this.getDataCharacterCounters(),i=0;i<r.length;i++)r[i]=0;if(n)tp.recordPatternInReverse(t,e.getStartEnd()[0],r);else{tp.recordPattern(t,e.getStartEnd()[1]+1,r);for(var o=0,a=r.length-1;o<a;o++,a--){var s=r[o];r[o]=r[a],r[a]=s}}for(var t=n?16:15,l=md.sum(new Int32Array(r))/t,u=this.getOddCounts(),c=this.getEvenCounts(),h=this.getOddRoundingErrors(),d=this.getEvenRoundingErrors(),o=0;o<r.length;o++){var p=r[o]/l,f=Math.floor(.5+p),g=(f<1?f=1:8<f&&(f=8),Math.floor(o/2));0==(1&o)?(u[g]=f,h[g]=p-f):(c[g]=f,d[g]=p-f)}this.adjustOddEvenCounts(n,t);for(var m=0,y=0,o=u.length-1;0<=o;o--)y=(y*=9)+u[o],m+=u[o];for(var v=0,_=0,o=c.length-1;0<=o;o--)v=(v*=9)+c[o],_+=c[o];e=y+3*v;if(n){if(0!=(1&m)||12<m||m<4)throw new I;var w=(12-m)/2,b=9-(T=x1.OUTSIDE_ODD_WIDEST[w]),C=Df.getRSSvalue(u,T,!1),E=Df.getRSSvalue(c,b,!0),t=x1.OUTSIDE_EVEN_TOTAL_SUBSET[w],S=x1.OUTSIDE_GSUM[w];return new Af(C*t+E+S,e)}if(0!=(1&_)||10<_||_<4)throw new I;var T,w=(10-_)/2,b=9-(T=x1.INSIDE_ODD_WIDEST[w]),C=Df.getRSSvalue(u,T,!0),E=Df.getRSSvalue(c,b,!1),n=x1.INSIDE_ODD_TOTAL_SUBSET[w],S=x1.INSIDE_GSUM[w];return new Af(E*n+C+S,e)},x1.prototype.findFinderPattern=function(t,e){for(var n=this.getDecodeFinderCounters(),r=(n[0]=0,n[1]=0,n[2]=0,n[3]=0,t.getSize()),i=!1,o=0;o<r&&e!==(i=!t.get(o));)o++;for(var a=0,s=o,l=o;l<r;l++)if(t.get(l)!==i)n[a]++;else{if(3===a){if(Sf.isFinderPattern(n))return[s,l];s+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,a--}else a++;n[a]=1,i=!i}throw new I},x1.prototype.parseFoundFinderPattern=function(t,e,n,r){for(var i=t.get(r[0]),o=r[0]-1;0<=o&&i!==t.get(o);)o--;var a=r[0]-++o,s=this.getDecodeFinderCounters(),l=new Int32Array(s.length),s=(uc.arraycopy(s,0,l,1,s.length-1),l[0]=a,this.parseFinderValue(l,x1.FINDER_PATTERNS)),a=o,l=r[1];return n&&(a=t.getSize()-1-a,l=t.getSize()-1-l),new Lf(s,[o,r[1]],a,l,e)},x1.prototype.adjustOddEvenCounts=function(t,e){var n=md.sum(new Int32Array(this.getOddCounts())),r=md.sum(new Int32Array(this.getEvenCounts())),i=!1,o=!1,a=!1,s=!1,e=(t?(12<n?o=!0:n<4&&(i=!0),12<r?s=!0:r<4&&(a=!0)):(11<n?o=!0:n<5&&(i=!0),10<r?s=!0:r<4&&(a=!0)),n+r-e),t=(1&n)==(t?1:0),l=1==(1&r);if(1==e)if(t){if(l)throw new I;o=!0}else{if(!l)throw new I;s=!0}else if(-1==e)if(t){if(l)throw new I;i=!0}else{if(!l)throw new I;a=!0}else{if(0!=e)throw new I;if(t){if(!l)throw new I;n<r?s=i=!0:a=o=!0}else if(l)throw new I}if(i){if(o)throw new I;Sf.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&Sf.decrement(this.getOddCounts(),this.getOddRoundingErrors()),a){if(s)throw new I;Sf.increment(this.getEvenCounts(),this.getOddRoundingErrors())}s&&Sf.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},x1.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],x1.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],x1.OUTSIDE_GSUM=[0,161,961,2015,2715],x1.INSIDE_GSUM=[0,336,1036,1516],x1.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],x1.INSIDE_ODD_WIDEST=[2,4,6,8],x1.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],x1);function x1(){var t=null!==I1&&I1.apply(this,arguments)||this;return t.possibleLeftPairs=[],t.possibleRightPairs=[],t}var D1=B1,N1=P1=tp;function R1(){this.constructor=D1}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(D1,N1),D1.prototype=null===N1?Object.create(N1):(R1.prototype=N1.prototype,new R1),B1.prototype.decodeRow=function(t,e,n){for(var r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(t,e,n)}catch(t){}throw new I},B1.prototype.reset=function(){this.readers.forEach(function(t){return t.reset()})};var P1,O1,M1=B1;function B1(t){var e=P1.call(this)||this,n=(e.readers=[],t?t.get(xc.POSSIBLE_FORMATS):null),r=t&&void 0!==t.get(xc.ASSUME_CODE_39_CHECK_DIGIT),i=t&&void 0!==t.get(xc.ENABLE_CODE_39_EXTENDED_MODE);return n&&((n.includes(k.EAN_13)||n.includes(k.UPC_A)||n.includes(k.EAN_8)||n.includes(k.UPC_E))&&e.readers.push(new pf(t)),n.includes(k.CODE_39)&&e.readers.push(new cp(r,i)),n.includes(k.CODE_93)&&e.readers.push(new gp),n.includes(k.CODE_128)&&e.readers.push(new ap),n.includes(k.ITF)&&e.readers.push(new wp),n.includes(k.CODABAR)&&e.readers.push(new _f),n.includes(k.RSS_14)&&e.readers.push(new k1),n.includes(k.RSS_EXPANDED))&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),e.readers.push(new _1)),0===e.readers.length&&(e.readers.push(new pf(t)),e.readers.push(new cp),e.readers.push(new gp),e.readers.push(new pf(t)),e.readers.push(new ap),e.readers.push(new wp),e.readers.push(new k1)),e}function U1(t,e){return void 0===t&&(t=500),O1.call(this,new M1(e),t,e)||this}var F1=U1,e=O1=r;function V1(){this.constructor=F1}var H1=F1,z1=e,j1=((Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(H1,z1),F1.prototype=null===e?Object.create(e):(V1.prototype=e.prototype,new V1),function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}),q1=(W1.prototype.getECCodewords=function(){return this.ecCodewords},W1.prototype.getECBlocks=function(){return this.ecBlocks},W1);function W1(t,e,n){this.ecCodewords=t,this.ecBlocks=[e],n&&this.ecBlocks.push(n)}$1.prototype.getCount=function(){return this.count},$1.prototype.getDataCodewords=function(){return this.dataCodewords};var G1=$1;function $1(t,e){this.count=t,this.dataCodewords=e}X1.prototype.getVersionNumber=function(){return this.versionNumber},X1.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},X1.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},X1.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},X1.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},X1.prototype.getTotalCodewords=function(){return this.totalCodewords},X1.prototype.getECBlocks=function(){return this.ecBlocks},X1.getVersionForDimensions=function(t,e){var n,r;if(0==(1&t)&&0==(1&e))try{for(var i=j1(X1.VERSIONS),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.symbolSizeRows===t&&a.symbolSizeColumns===e)return a}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}throw new A},X1.prototype.toString=function(){return""+this.versionNumber},X1.VERSIONS=(X1.buildVersions=function(){return[new X1(1,10,10,8,8,new q1(5,new G1(1,3))),new X1(2,12,12,10,10,new q1(7,new G1(1,5))),new X1(3,14,14,12,12,new q1(10,new G1(1,8))),new X1(4,16,16,14,14,new q1(12,new G1(1,12))),new X1(5,18,18,16,16,new q1(14,new G1(1,18))),new X1(6,20,20,18,18,new q1(18,new G1(1,22))),new X1(7,22,22,20,20,new q1(20,new G1(1,30))),new X1(8,24,24,22,22,new q1(24,new G1(1,36))),new X1(9,26,26,24,24,new q1(28,new G1(1,44))),new X1(10,32,32,14,14,new q1(36,new G1(1,62))),new X1(11,36,36,16,16,new q1(42,new G1(1,86))),new X1(12,40,40,18,18,new q1(48,new G1(1,114))),new X1(13,44,44,20,20,new q1(56,new G1(1,144))),new X1(14,48,48,22,22,new q1(68,new G1(1,174))),new X1(15,52,52,24,24,new q1(42,new G1(2,102))),new X1(16,64,64,14,14,new q1(56,new G1(2,140))),new X1(17,72,72,16,16,new q1(36,new G1(4,92))),new X1(18,80,80,18,18,new q1(48,new G1(4,114))),new X1(19,88,88,20,20,new q1(56,new G1(4,144))),new X1(20,96,96,22,22,new q1(68,new G1(4,174))),new X1(21,104,104,24,24,new q1(56,new G1(6,136))),new X1(22,120,120,18,18,new q1(68,new G1(6,175))),new X1(23,132,132,20,20,new q1(62,new G1(8,163))),new X1(24,144,144,22,22,new q1(62,new G1(8,156),new G1(2,155))),new X1(25,8,18,6,16,new q1(7,new G1(1,5))),new X1(26,8,32,6,14,new q1(11,new G1(1,10))),new X1(27,12,26,10,24,new q1(14,new G1(1,16))),new X1(28,12,36,10,16,new q1(18,new G1(1,22))),new X1(29,16,36,14,16,new q1(24,new G1(1,32))),new X1(30,16,48,14,22,new q1(28,new G1(1,49)))]})();var K1=X1;function X1(t,e,n,r,i,o){this.versionNumber=t,this.symbolSizeRows=e,this.symbolSizeColumns=n,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=i;var a,s,l=0,u=(this.ecBlocks=o).getECCodewords(),t=o.getECBlocks();try{for(var c=j1(t),h=c.next();!h.done;h=c.next()){var d=h.value;l+=d.getCount()*(d.getDataCodewords()+u)}}catch(t){a={error:t}}finally{try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}this.totalCodewords=l}Y1.prototype.getVersion=function(){return this.version},Y1.readVersion=function(t){var e=t.getHeight(),t=t.getWidth();return K1.getVersionForDimensions(e,t)},Y1.prototype.readCodewords=function(){var t=new Int8Array(this.version.getTotalCodewords()),e=0,n=4,r=0,i=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),a=!1,s=!1,l=!1,u=!1;do{if(n!==i||0!==r||a)if(n!==i-2||0!==r||0==(3&o)||s)if(n!==i+4||2!==r||0!=(7&o)||l)if(n!==i-2||0!==r||4!=(7&o)||u){for(;n<i&&0<=r&&!this.readMappingMatrix.get(r,n)&&(t[e++]=255&this.readUtah(n,r,i,o)),r+=2,0<=(n-=2)&&r<o;);for(n+=1,r+=3;0<=n&&r<o&&!this.readMappingMatrix.get(r,n)&&(t[e++]=255&this.readUtah(n,r,i,o)),r-=2,(n+=2)<i&&0<=r;);n+=3,r+=1}else t[e++]=255&this.readCorner4(i,o),n-=2,r+=2,u=!0;else t[e++]=255&this.readCorner3(i,o),n-=2,r+=2,l=!0;else t[e++]=255&this.readCorner2(i,o),n-=2,r+=2,s=!0;else t[e++]=255&this.readCorner1(i,o),n-=2,r+=2,a=!0}while(n<i||r<o);if(e!==this.version.getTotalCodewords())throw new A;return t},Y1.prototype.readModule=function(t,e,n,r){return t<0&&(t+=n,e+=4-(n+4&7)),e<0&&(e+=r,t+=4-(r+4&7)),this.readMappingMatrix.set(e,t),this.mappingBitMatrix.get(e,t)},Y1.prototype.readUtah=function(t,e,n,r){var i=0;return this.readModule(t-2,e-2,n,r)&&(i|=1),i<<=1,this.readModule(t-2,e-1,n,r)&&(i|=1),i<<=1,this.readModule(t-1,e-2,n,r)&&(i|=1),i<<=1,this.readModule(t-1,e-1,n,r)&&(i|=1),i<<=1,this.readModule(t-1,e,n,r)&&(i|=1),i<<=1,this.readModule(t,e-2,n,r)&&(i|=1),i<<=1,this.readModule(t,e-1,n,r)&&(i|=1),i<<=1,this.readModule(t,e,n,r)&&(i|=1),i},Y1.prototype.readCorner1=function(t,e){var n=0;return this.readModule(t-1,0,t,e)&&(n|=1),n<<=1,this.readModule(t-1,1,t,e)&&(n|=1),n<<=1,this.readModule(t-1,2,t,e)&&(n|=1),n<<=1,this.readModule(0,e-2,t,e)&&(n|=1),n<<=1,this.readModule(0,e-1,t,e)&&(n|=1),n<<=1,this.readModule(1,e-1,t,e)&&(n|=1),n<<=1,this.readModule(2,e-1,t,e)&&(n|=1),n<<=1,this.readModule(3,e-1,t,e)&&(n|=1),n},Y1.prototype.readCorner2=function(t,e){var n=0;return this.readModule(t-3,0,t,e)&&(n|=1),n<<=1,this.readModule(t-2,0,t,e)&&(n|=1),n<<=1,this.readModule(t-1,0,t,e)&&(n|=1),n<<=1,this.readModule(0,e-4,t,e)&&(n|=1),n<<=1,this.readModule(0,e-3,t,e)&&(n|=1),n<<=1,this.readModule(0,e-2,t,e)&&(n|=1),n<<=1,this.readModule(0,e-1,t,e)&&(n|=1),n<<=1,this.readModule(1,e-1,t,e)&&(n|=1),n},Y1.prototype.readCorner3=function(t,e){var n=0;return this.readModule(t-1,0,t,e)&&(n|=1),n<<=1,this.readModule(t-1,e-1,t,e)&&(n|=1),n<<=1,this.readModule(0,e-3,t,e)&&(n|=1),n<<=1,this.readModule(0,e-2,t,e)&&(n|=1),n<<=1,this.readModule(0,e-1,t,e)&&(n|=1),n<<=1,this.readModule(1,e-3,t,e)&&(n|=1),n<<=1,this.readModule(1,e-2,t,e)&&(n|=1),n<<=1,this.readModule(1,e-1,t,e)&&(n|=1),n},Y1.prototype.readCorner4=function(t,e){var n=0;return this.readModule(t-3,0,t,e)&&(n|=1),n<<=1,this.readModule(t-2,0,t,e)&&(n|=1),n<<=1,this.readModule(t-1,0,t,e)&&(n|=1),n<<=1,this.readModule(0,e-2,t,e)&&(n|=1),n<<=1,this.readModule(0,e-1,t,e)&&(n|=1),n<<=1,this.readModule(1,e-1,t,e)&&(n|=1),n<<=1,this.readModule(2,e-1,t,e)&&(n|=1),n<<=1,this.readModule(3,e-1,t,e)&&(n|=1),n},Y1.prototype.extractDataRegion=function(t){var e=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(t.getHeight()!==e)throw new Qu("Dimension of bitMatrix must match the version size");for(var r=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),o=e/r|0,a=n/i|0,s=new Zc(a*i,o*r),l=0;l<o;++l)for(var u=l*r,c=0;c<a;++c)for(var h=c*i,d=0;d<r;++d)for(var p=l*(r+2)+1+d,f=u+d,g=0;g<i;++g)t.get(c*(i+2)+1+g,p)&&s.set(h+g,f);return s};var Z1=Y1;function Y1(t){var e=t.getHeight();if(e<8||144<e||0!=(1&e))throw new A;this.version=Y1.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new Zc(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}var Q1=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},J1=(tm.getDataBlocks=function(t,e){var n,r,i,o,a=e.getECBlocks(),s=0,l=a.getECBlocks();try{for(var u=Q1(l),c=u.next();!c.done;c=u.next())s+=(g=c.value).getCount()}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}var h=new Array(s),d=0;try{for(var p=Q1(l),f=p.next();!f.done;f=p.next())for(var g=f.value,m=0;m<g.getCount();m++){var y=g.getDataCodewords(),v=a.getECCodewords()+y;h[d++]=new tm(y,new Uint8Array(v))}}catch(t){i={error:t}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}for(var _=h[0].codewords.length-a.getECCodewords(),w=_-1,b=0,m=0;m<w;m++)for(var C=0;C<d;C++)h[C].codewords[m]=t[b++];for(var E=24===e.getVersionNumber(),S=E?8:d,C=0;C<S;C++)h[C].codewords[_-1]=t[b++];for(var T=h[0].codewords.length,m=_;m<T;m++)for(C=0;C<d;C++){var A=E?(C+8)%d:C;h[A].codewords[E&&7<A?m-1:m]=t[b++]}if(b!==t.length)throw new Qu;return h},tm.prototype.getNumDataCodewords=function(){return this.numDataCodewords},tm.prototype.getCodewords=function(){return this.codewords},tm);function tm(t,e){this.numDataCodewords=t,this.codewords=e}rm.prototype.getBitOffset=function(){return this.bitOffset},rm.prototype.getByteOffset=function(){return this.byteOffset},rm.prototype.readBits=function(t){if(t<1||32<t||t>this.available())throw new Qu(""+t);var e,n,r,i=0,o=this.bitOffset,a=this.byteOffset,s=this.bytes;if(0<o&&(r=255>>8-(e=t<(n=8-o)?t:n)<<(n=n-e),i=(s[a]&r)>>n,t-=e,8===(o+=e))&&(o=0,a++),0<t){for(;8<=t;)i=i<<8|255&s[a],a++,t-=8;0<t&&(r=255>>(n=8-t)<<n,i=i<<t|(s[a]&r)>>n,o+=t)}return this.bitOffset=o,this.byteOffset=a,i},rm.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset};var em,nm=rm;function rm(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}(iv=em=em||{})[iv.PAD_ENCODE=0]="PAD_ENCODE",iv[iv.ASCII_ENCODE=1]="ASCII_ENCODE",iv[iv.C40_ENCODE=2]="C40_ENCODE",iv[iv.TEXT_ENCODE=3]="TEXT_ENCODE",iv[iv.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",iv[iv.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",iv[iv.BASE256_ENCODE=6]="BASE256_ENCODE",om.decode=function(t){var e=new nm(t),n=new Kc,r=new Kc,i=new Array,o=em.ASCII_ENCODE;do{if(o===em.ASCII_ENCODE)o=this.decodeAsciiSegment(e,n,r);else{switch(o){case em.C40_ENCODE:this.decodeC40Segment(e,n);break;case em.TEXT_ENCODE:this.decodeTextSegment(e,n);break;case em.ANSIX12_ENCODE:this.decodeAnsiX12Segment(e,n);break;case em.EDIFACT_ENCODE:this.decodeEdifactSegment(e,n);break;case em.BASE256_ENCODE:this.decodeBase256Segment(e,n,i);break;default:throw new A}o=em.ASCII_ENCODE}}while(o!==em.PAD_ENCODE&&0<e.available());return 0<r.length()&&n.append(r.toString()),new Oh(t,n.toString(),0===i.length?null:i,null)},om.decodeAsciiSegment=function(t,e,n){var r=!1;do{var i=t.readBits(8);if(0===i)throw new A;if(i<=128)return r&&(i+=128),e.append(String.fromCharCode(i-1)),em.ASCII_ENCODE;if(129===i)return em.PAD_ENCODE;if(i<=229){var o=i-130;o<10&&e.append("0"),e.append(""+o)}else switch(i){case 230:return em.C40_ENCODE;case 231:return em.BASE256_ENCODE;case 232:e.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:r=!0;break;case 236:e.append("[)>05"),n.insert(0,"");break;case 237:e.append("[)>06"),n.insert(0,"");break;case 238:return em.ANSIX12_ENCODE;case 239:return em.TEXT_ENCODE;case 240:return em.EDIFACT_ENCODE;case 241:break;default:if(254!==i||0!==t.available())throw new A}}while(0<t.available());return em.ASCII_ENCODE},om.decodeC40Segment=function(t,e){var n=!1,r=[],i=0;do{if(8===t.available())return;var o=t.readBits(8);if(254===o)return;this.parseTwoBytes(o,t.readBits(8),r);for(var a=0;a<3;a++){var s=r[a];switch(i){case 0:if(s<3)i=s+1;else{if(!(s<this.C40_BASIC_SET_CHARS.length))throw new A;var l=this.C40_BASIC_SET_CHARS[s];n?(e.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):e.append(l)}break;case 1:n?(e.append(String.fromCharCode(s+128)),n=!1):e.append(String.fromCharCode(s)),i=0;break;case 2:if(s<this.C40_SHIFT2_SET_CHARS.length){l=this.C40_SHIFT2_SET_CHARS[s];n?(e.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):e.append(l)}else switch(s){case 27:e.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new A}i=0;break;case 3:n?(e.append(String.fromCharCode(s+224)),n=!1):e.append(String.fromCharCode(s+96)),i=0;break;default:throw new A}}}while(0<t.available())},om.decodeTextSegment=function(t,e){var n=!1,r=[],i=0;do{if(8===t.available())return;var o=t.readBits(8);if(254===o)return;this.parseTwoBytes(o,t.readBits(8),r);for(var a=0;a<3;a++){var s=r[a];switch(i){case 0:if(s<3)i=s+1;else{if(!(s<this.TEXT_BASIC_SET_CHARS.length))throw new A;var l=this.TEXT_BASIC_SET_CHARS[s];n?(e.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):e.append(l)}break;case 1:n?(e.append(String.fromCharCode(s+128)),n=!1):e.append(String.fromCharCode(s)),i=0;break;case 2:if(s<this.TEXT_SHIFT2_SET_CHARS.length){l=this.TEXT_SHIFT2_SET_CHARS[s];n?(e.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):e.append(l)}else switch(s){case 27:e.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new A}i=0;break;case 3:if(!(s<this.TEXT_SHIFT3_SET_CHARS.length))throw new A;l=this.TEXT_SHIFT3_SET_CHARS[s];n?(e.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):e.append(l),i=0;break;default:throw new A}}}while(0<t.available())},om.decodeAnsiX12Segment=function(t,e){var n=[];do{if(8===t.available())return;var r=t.readBits(8);if(254===r)return;this.parseTwoBytes(r,t.readBits(8),n);for(var i=0;i<3;i++){var o=n[i];switch(o){case 0:e.append("\r");break;case 1:e.append("*");break;case 2:e.append(">");break;case 3:e.append(" ");break;default:if(o<14)e.append(String.fromCharCode(o+44));else{if(!(o<40))throw new A;e.append(String.fromCharCode(o+51))}}}}while(0<t.available())},om.parseTwoBytes=function(t,e,n){t=(t<<8)+e-1,e=Math.floor(t/1600);t-=1600*(n[0]=e),e=Math.floor(t/40),n[1]=e,n[2]=t-40*e},om.decodeEdifactSegment=function(t,e){do{if(t.available()<=16)return;for(var n=0;n<4;n++){var r,i=t.readBits(6);if(31===i)return void(8!=(r=8-t.getBitOffset())&&t.readBits(r));0==(32&i)&&(i|=64),e.append(String.fromCharCode(i))}}while(0<t.available())},om.decodeBase256Segment=function(t,e,n){var r=1+t.getByteOffset(),i=this.unrandomize255State(t.readBits(8),r++),o=0===i?t.available()/8|0:i<250?i:250*(i-249)+this.unrandomize255State(t.readBits(8),r++);if(o<0)throw new A;for(var a=new Uint8Array(o),s=0;s<o;s++){if(t.available()<8)throw new A;a[s]=this.unrandomize255State(t.readBits(8),r++)}n.push(a);try{e.append(qc.decode(a,Gc.ISO88591))}catch(t){throw new ud("Platform does not support required encoding: "+t.message)}},om.unrandomize255State=function(t,e){t-=149*e%255+1;return 0<=t?t:256+t},om.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],om.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],om.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],om.TEXT_SHIFT2_SET_CHARS=om.C40_SHIFT2_SET_CHARS,om.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];var im=om;function om(){}var am=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},sm=(lm.prototype.decode=function(t){var e,n,t=new Z1(t),r=t.getVersion(),t=t.readCodewords(),i=J1.getDataBlocks(t,r),o=0;try{for(var a=am(i),s=a.next();!s.done;s=a.next())o+=s.value.getNumDataCodewords()}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}for(var l=new Uint8Array(o),u=i.length,c=0;c<u;c++){var h=i[c],d=h.getCodewords(),p=h.getNumDataCodewords();this.correctErrors(d,p);for(var f=0;f<p;f++)l[f*u+c]=d[f]}return im.decode(l)},lm.prototype.correctErrors=function(t,e){var n=new Int32Array(t);try{this.rsDecoder.decode(n,t.length-e)}catch(t){throw new ac}for(var r=0;r<e;r++)t[r]=n[r]},lm);function lm(){this.rsDecoder=new dd(Yh.DATA_MATRIX_FIELD_256)}cm.prototype.detect=function(){var t,e,n,r,i,o=this.rectangleDetector.detect(),o=this.detectSolid1(o);if((o=this.detectSolid2(o))[3]=this.correctTopRight(o),o[3])return t=(o=this.shiftToModuleCenter(o))[0],e=o[1],n=o[2],1==(1&(i=this.transitionsBetween(t,o=o[3])+1))&&(i+=1),1==(1&(r=this.transitionsBetween(n,o)+1))&&(r+=1),4*i<7*r&&4*r<7*i&&(i=r=Math.max(i,r)),i=cm.sampleGrid(this.image,t,e,n,o,i,r),new bd(i,[t,e,n,o]);throw new I},cm.shiftPoint=function(t,e,n){var r=(e.getX()-t.getX())/(n+1),e=(e.getY()-t.getY())/(n+1);return new x(t.getX()+r,t.getY()+e)},cm.moveAway=function(t,e,n){var r=t.getX(),t=t.getY();return r<e?--r:r+=1,t<n?--t:t+=1,new x(r,t)},cm.prototype.detectSolid1=function(t){var e=t[0],n=t[1],r=t[3],t=t[2],i=this.transitionsBetween(e,n),o=this.transitionsBetween(n,r),a=this.transitionsBetween(r,t),s=this.transitionsBetween(t,e),l=[t,e,n,r];return o<i&&(i=o,l[0]=e,l[1]=n,l[2]=r,l[3]=t),a<i&&(i=a,l[0]=n,l[1]=r,l[2]=t,l[3]=e),s<i&&(l[0]=r,l[1]=t,l[2]=e,l[3]=n),l},cm.prototype.detectSolid2=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=this.transitionsBetween(e,i),a=cm.shiftPoint(n,r,4*(o+1)),o=cm.shiftPoint(r,n,4*(o+1));return this.transitionsBetween(a,e)<this.transitionsBetween(o,i)?(t[0]=e,t[1]=n,t[2]=r,t[3]=i):(t[0]=n,t[1]=r,t[2]=i,t[3]=e),t},cm.prototype.correctTopRight=function(t){var e=t[0],n=t[1],r=t[2],t=t[3],i=this.transitionsBetween(e,t),o=this.transitionsBetween(n,t),a=cm.shiftPoint(e,n,4*(o+1)),s=cm.shiftPoint(r,n,4*(i+1)),i=this.transitionsBetween(a,t),o=this.transitionsBetween(s,t),r=new x(t.getX()+(r.getX()-n.getX())/(i+1),t.getY()+(r.getY()-n.getY())/(i+1)),i=new x(t.getX()+(e.getX()-n.getX())/(o+1),t.getY()+(e.getY()-n.getY())/(o+1));return this.isValid(r)?!this.isValid(i)||(t=this.transitionsBetween(a,r)+this.transitionsBetween(s,r),this.transitionsBetween(a,i)+this.transitionsBetween(s,i)<t)?r:i:this.isValid(i)?i:null},cm.prototype.shiftToModuleCenter=function(t){var e=t[0],n=t[1],r=t[2],t=t[3],i=this.transitionsBetween(e,t)+1,o=this.transitionsBetween(r,t)+1,a=cm.shiftPoint(e,n,4*o),s=cm.shiftPoint(r,n,4*i),l=(1==(1&(i=this.transitionsBetween(a,t)+1))&&(i+=1),1==(1&(o=this.transitionsBetween(s,t)+1))&&(o+=1),(e.getX()+n.getX()+r.getX()+t.getX())/4),u=(e.getY()+n.getY()+r.getY()+t.getY())/4,e=cm.moveAway(e,l,u),n=cm.moveAway(n,l,u),r=cm.moveAway(r,l,u),t=cm.moveAway(t,l,u),a=cm.shiftPoint(e,n,4*o);return a=cm.shiftPoint(a,t,4*i),l=cm.shiftPoint(n,e,4*o),l=cm.shiftPoint(l,r,4*i),s=cm.shiftPoint(r,t,4*o),s=cm.shiftPoint(s,n,4*i),u=cm.shiftPoint(t,r,4*o),[a,l,s,cm.shiftPoint(u,e,4*i)]},cm.prototype.isValid=function(t){return 0<=t.getX()&&t.getX()<this.image.getWidth()&&0<t.getY()&&t.getY()<this.image.getHeight()},cm.sampleGrid=function(t,e,n,r,i,o,a){return Vd.getInstance().sampleGrid(t,o,a,.5,.5,o-.5,.5,o-.5,a-.5,.5,a-.5,e.getX(),e.getY(),i.getX(),i.getY(),r.getX(),r.getY(),n.getX(),n.getY())},cm.prototype.transitionsBetween=function(t,e){for(var n=Math.trunc(t.getX()),t=Math.trunc(t.getY()),r=Math.trunc(e.getX()),i=Math.trunc(e.getY()),o=Math.abs(i-t)>Math.abs(r-n),a=(o&&(e=n,n=t,t=e,e=r,r=i,i=e),Math.abs(r-n)),s=Math.abs(i-t),l=-a/2,u=t<i?1:-1,c=n<r?1:-1,h=0,d=this.image.get(o?t:n,o?n:t),p=n,f=t;p!==r;p+=c){var g=this.image.get(o?f:p,o?p:f);if(g!==d&&(h++,d=g),0<(l+=s)){if(f===i)break;f+=u,l-=a}}return h};var um=cm;function cm(t){this.image=t,this.rectangleDetector=new kd(this.image)}pm.prototype.decode=function(t,e){t=null!=(e=void 0===e?null:e)&&e.has(xc.PURE_BARCODE)?(e=pm.extractPureBits(t.getBlackMatrix()),n=this.decoder.decode(e),pm.NO_POINTS):(e=new um(t.getBlackMatrix()).detect(),n=this.decoder.decode(e.getBits()),e.getPoints());var n,e=n.getRawBytes(),e=new Nh(n.getText(),e,8*e.length,t,k.DATA_MATRIX,uc.currentTimeMillis()),t=n.getByteSegments(),t=(null!=t&&e.putMetadata(Ph.BYTE_SEGMENTS,t),n.getECLevel());return null!=t&&e.putMetadata(Ph.ERROR_CORRECTION_LEVEL,t),e},pm.prototype.reset=function(){},pm.extractPureBits=function(t){var e=t.getTopLeftOnBit(),n=t.getBottomRightOnBit();if(null==e||null==n)throw new I;var r=this.moduleSize(e,t),i=e[1],o=n[1],a=e[0],s=(n[0]-a+1)/r,l=(o-i+1)/r;if(s<=0||l<=0)throw new I;for(var e=r/2,u=(i+=e,a+=e,new Zc(s,l)),c=0;c<l;c++)for(var h=i+c*r,d=0;d<s;d++)t.get(a+d*r,h)&&u.set(d,c);return u},pm.moduleSize=function(t,e){for(var n=e.getWidth(),r=t[0],i=t[1];r<n&&e.get(r,i);)r++;if(r===n)throw new I;t=r-t[0];if(0==t)throw new I;return t},pm.NO_POINTS=[];var hm,dm=pm;function pm(){this.decoder=new sm}function fm(t){return void 0===t&&(t=500),hm.call(this,new dm,t)||this}var gm=fm,o=hm=r;function mm(){this.constructor=gm}var ym=gm,vm=o,_m=((Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(ym,vm),gm.prototype=null===o?Object.create(o):(mm.prototype=o.prototype,new mm),(p=Bv=Bv||{})[p.L=0]="L",p[p.M=1]="M",p[p.Q=2]="Q",p[p.H=3]="H",wm.prototype.getValue=function(){return this.value},wm.prototype.getBits=function(){return this.bits},wm.fromString=function(t){switch(t){case"L":return wm.L;case"M":return wm.M;case"Q":return wm.Q;case"H":return wm.H;default:throw new Gu(t+"not available")}},wm.prototype.toString=function(){return this.stringValue},wm.prototype.equals=function(t){return t instanceof wm&&this.value===t.value},wm.forBits=function(t){if(t<0||t>=wm.FOR_BITS.size)throw new Qu;return wm.FOR_BITS.get(t)},wm.FOR_BITS=new Map,wm.FOR_VALUE=new Map,wm.L=new wm(Bv.L,"L",1),wm.M=new wm(Bv.M,"M",0),wm.Q=new wm(Bv.Q,"Q",3),wm.H=new wm(Bv.H,"H",2),wm);function wm(t,e,n){this.value=t,this.stringValue=e,this.bits=n,wm.FOR_BITS.set(n,this),wm.FOR_VALUE.set(t,this)}var bm=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Cm=(Em.numBitsDiffering=function(t,e){return Ac.bitCount(t^e)},Em.decodeFormatInformation=function(t,e){var n=Em.doDecodeFormatInformation(t,e);return null!==n?n:Em.doDecodeFormatInformation(t^Em.FORMAT_INFO_MASK_QR,e^Em.FORMAT_INFO_MASK_QR)},Em.doDecodeFormatInformation=function(t,e){var n,r,i=Number.MAX_SAFE_INTEGER,o=0;try{for(var a=bm(Em.FORMAT_INFO_DECODE_LOOKUP),s=a.next();!s.done;s=a.next()){var l=s.value,u=l[0];if(u===t||u===e)return new Em(l[1]);var c=Em.numBitsDiffering(t,u);c<i&&(o=l[1],i=c),t!==e&&(c=Em.numBitsDiffering(e,u))<i&&(o=l[1],i=c)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i<=3?new Em(o):null},Em.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},Em.prototype.getDataMask=function(){return this.dataMask},Em.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},Em.prototype.equals=function(t){return t instanceof Em&&this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask},Em.FORMAT_INFO_MASK_QR=21522,Em.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],Em);function Em(t){this.errorCorrectionLevel=_m.forBits(t>>3&3),this.dataMask=7&t}var Sm=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=(Tm.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},Tm.prototype.getNumBlocks=function(){var e,t,n=0,r=this.ecBlocks;try{for(var i=Sm(r),o=i.next();!o.done;o=i.next())n+=o.value.getCount()}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n},Tm.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},Tm.prototype.getECBlocks=function(){return this.ecBlocks},Tm);function Tm(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.ecCodewordsPerBlock=t,this.ecBlocks=e}function Am(t,e){this.count=t,this.dataCodewords=e}Am.prototype.getCount=function(){return this.count},Am.prototype.getDataCodewords=function(){return this.dataCodewords},l=Am;var Im=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Lm=(c.prototype.getVersionNumber=function(){return this.versionNumber},c.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},c.prototype.getTotalCodewords=function(){return this.totalCodewords},c.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},c.prototype.getECBlocksForLevel=function(t){return this.ecBlocks[t.getValue()]},c.getProvisionalVersionForDimension=function(t){if(t%4!=1)throw new A;try{return this.getVersionForNumber((t-17)/4)}catch(t){throw new A}},c.getVersionForNumber=function(t){if(t<1||40<t)throw new Qu;return c.VERSIONS[t-1]},c.decodeVersionInformation=function(t){for(var e=Number.MAX_SAFE_INTEGER,n=0,r=0;r<c.VERSION_DECODE_INFO.length;r++){var i=c.VERSION_DECODE_INFO[r];if(i===t)return c.getVersionForNumber(r+7);i=Cm.numBitsDiffering(t,i);i<e&&(n=r+7,e=i)}return e<=3?c.getVersionForNumber(n):null},c.prototype.buildFunctionPattern=function(){for(var t=this.getDimensionForVersion(),e=new Zc(t),n=(e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8),this.alignmentPatternCenters.length),r=0;r<n;r++)for(var i=this.alignmentPatternCenters[r]-2,o=0;o<n;o++)0===r&&(0===o||o===n-1)||r===n-1&&0===o||e.setRegion(this.alignmentPatternCenters[o]-2,i,5,5);return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),6<this.versionNumber&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e},c.prototype.toString=function(){return""+this.versionNumber},c.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),c.VERSIONS=[new c(1,new Int32Array(0),new i(7,new l(1,19)),new i(10,new l(1,16)),new i(13,new l(1,13)),new i(17,new l(1,9))),new c(2,Int32Array.from([6,18]),new i(10,new l(1,34)),new i(16,new l(1,28)),new i(22,new l(1,22)),new i(28,new l(1,16))),new c(3,Int32Array.from([6,22]),new i(15,new l(1,55)),new i(26,new l(1,44)),new i(18,new l(2,17)),new i(22,new l(2,13))),new c(4,Int32Array.from([6,26]),new i(20,new l(1,80)),new i(18,new l(2,32)),new i(26,new l(2,24)),new i(16,new l(4,9))),new c(5,Int32Array.from([6,30]),new i(26,new l(1,108)),new i(24,new l(2,43)),new i(18,new l(2,15),new l(2,16)),new i(22,new l(2,11),new l(2,12))),new c(6,Int32Array.from([6,34]),new i(18,new l(2,68)),new i(16,new l(4,27)),new i(24,new l(4,19)),new i(28,new l(4,15))),new c(7,Int32Array.from([6,22,38]),new i(20,new l(2,78)),new i(18,new l(4,31)),new i(18,new l(2,14),new l(4,15)),new i(26,new l(4,13),new l(1,14))),new c(8,Int32Array.from([6,24,42]),new i(24,new l(2,97)),new i(22,new l(2,38),new l(2,39)),new i(22,new l(4,18),new l(2,19)),new i(26,new l(4,14),new l(2,15))),new c(9,Int32Array.from([6,26,46]),new i(30,new l(2,116)),new i(22,new l(3,36),new l(2,37)),new i(20,new l(4,16),new l(4,17)),new i(24,new l(4,12),new l(4,13))),new c(10,Int32Array.from([6,28,50]),new i(18,new l(2,68),new l(2,69)),new i(26,new l(4,43),new l(1,44)),new i(24,new l(6,19),new l(2,20)),new i(28,new l(6,15),new l(2,16))),new c(11,Int32Array.from([6,30,54]),new i(20,new l(4,81)),new i(30,new l(1,50),new l(4,51)),new i(28,new l(4,22),new l(4,23)),new i(24,new l(3,12),new l(8,13))),new c(12,Int32Array.from([6,32,58]),new i(24,new l(2,92),new l(2,93)),new i(22,new l(6,36),new l(2,37)),new i(26,new l(4,20),new l(6,21)),new i(28,new l(7,14),new l(4,15))),new c(13,Int32Array.from([6,34,62]),new i(26,new l(4,107)),new i(22,new l(8,37),new l(1,38)),new i(24,new l(8,20),new l(4,21)),new i(22,new l(12,11),new l(4,12))),new c(14,Int32Array.from([6,26,46,66]),new i(30,new l(3,115),new l(1,116)),new i(24,new l(4,40),new l(5,41)),new i(20,new l(11,16),new l(5,17)),new i(24,new l(11,12),new l(5,13))),new c(15,Int32Array.from([6,26,48,70]),new i(22,new l(5,87),new l(1,88)),new i(24,new l(5,41),new l(5,42)),new i(30,new l(5,24),new l(7,25)),new i(24,new l(11,12),new l(7,13))),new c(16,Int32Array.from([6,26,50,74]),new i(24,new l(5,98),new l(1,99)),new i(28,new l(7,45),new l(3,46)),new i(24,new l(15,19),new l(2,20)),new i(30,new l(3,15),new l(13,16))),new c(17,Int32Array.from([6,30,54,78]),new i(28,new l(1,107),new l(5,108)),new i(28,new l(10,46),new l(1,47)),new i(28,new l(1,22),new l(15,23)),new i(28,new l(2,14),new l(17,15))),new c(18,Int32Array.from([6,30,56,82]),new i(30,new l(5,120),new l(1,121)),new i(26,new l(9,43),new l(4,44)),new i(28,new l(17,22),new l(1,23)),new i(28,new l(2,14),new l(19,15))),new c(19,Int32Array.from([6,30,58,86]),new i(28,new l(3,113),new l(4,114)),new i(26,new l(3,44),new l(11,45)),new i(26,new l(17,21),new l(4,22)),new i(26,new l(9,13),new l(16,14))),new c(20,Int32Array.from([6,34,62,90]),new i(28,new l(3,107),new l(5,108)),new i(26,new l(3,41),new l(13,42)),new i(30,new l(15,24),new l(5,25)),new i(28,new l(15,15),new l(10,16))),new c(21,Int32Array.from([6,28,50,72,94]),new i(28,new l(4,116),new l(4,117)),new i(26,new l(17,42)),new i(28,new l(17,22),new l(6,23)),new i(30,new l(19,16),new l(6,17))),new c(22,Int32Array.from([6,26,50,74,98]),new i(28,new l(2,111),new l(7,112)),new i(28,new l(17,46)),new i(30,new l(7,24),new l(16,25)),new i(24,new l(34,13))),new c(23,Int32Array.from([6,30,54,78,102]),new i(30,new l(4,121),new l(5,122)),new i(28,new l(4,47),new l(14,48)),new i(30,new l(11,24),new l(14,25)),new i(30,new l(16,15),new l(14,16))),new c(24,Int32Array.from([6,28,54,80,106]),new i(30,new l(6,117),new l(4,118)),new i(28,new l(6,45),new l(14,46)),new i(30,new l(11,24),new l(16,25)),new i(30,new l(30,16),new l(2,17))),new c(25,Int32Array.from([6,32,58,84,110]),new i(26,new l(8,106),new l(4,107)),new i(28,new l(8,47),new l(13,48)),new i(30,new l(7,24),new l(22,25)),new i(30,new l(22,15),new l(13,16))),new c(26,Int32Array.from([6,30,58,86,114]),new i(28,new l(10,114),new l(2,115)),new i(28,new l(19,46),new l(4,47)),new i(28,new l(28,22),new l(6,23)),new i(30,new l(33,16),new l(4,17))),new c(27,Int32Array.from([6,34,62,90,118]),new i(30,new l(8,122),new l(4,123)),new i(28,new l(22,45),new l(3,46)),new i(30,new l(8,23),new l(26,24)),new i(30,new l(12,15),new l(28,16))),new c(28,Int32Array.from([6,26,50,74,98,122]),new i(30,new l(3,117),new l(10,118)),new i(28,new l(3,45),new l(23,46)),new i(30,new l(4,24),new l(31,25)),new i(30,new l(11,15),new l(31,16))),new c(29,Int32Array.from([6,30,54,78,102,126]),new i(30,new l(7,116),new l(7,117)),new i(28,new l(21,45),new l(7,46)),new i(30,new l(1,23),new l(37,24)),new i(30,new l(19,15),new l(26,16))),new c(30,Int32Array.from([6,26,52,78,104,130]),new i(30,new l(5,115),new l(10,116)),new i(28,new l(19,47),new l(10,48)),new i(30,new l(15,24),new l(25,25)),new i(30,new l(23,15),new l(25,16))),new c(31,Int32Array.from([6,30,56,82,108,134]),new i(30,new l(13,115),new l(3,116)),new i(28,new l(2,46),new l(29,47)),new i(30,new l(42,24),new l(1,25)),new i(30,new l(23,15),new l(28,16))),new c(32,Int32Array.from([6,34,60,86,112,138]),new i(30,new l(17,115)),new i(28,new l(10,46),new l(23,47)),new i(30,new l(10,24),new l(35,25)),new i(30,new l(19,15),new l(35,16))),new c(33,Int32Array.from([6,30,58,86,114,142]),new i(30,new l(17,115),new l(1,116)),new i(28,new l(14,46),new l(21,47)),new i(30,new l(29,24),new l(19,25)),new i(30,new l(11,15),new l(46,16))),new c(34,Int32Array.from([6,34,62,90,118,146]),new i(30,new l(13,115),new l(6,116)),new i(28,new l(14,46),new l(23,47)),new i(30,new l(44,24),new l(7,25)),new i(30,new l(59,16),new l(1,17))),new c(35,Int32Array.from([6,30,54,78,102,126,150]),new i(30,new l(12,121),new l(7,122)),new i(28,new l(12,47),new l(26,48)),new i(30,new l(39,24),new l(14,25)),new i(30,new l(22,15),new l(41,16))),new c(36,Int32Array.from([6,24,50,76,102,128,154]),new i(30,new l(6,121),new l(14,122)),new i(28,new l(6,47),new l(34,48)),new i(30,new l(46,24),new l(10,25)),new i(30,new l(2,15),new l(64,16))),new c(37,Int32Array.from([6,28,54,80,106,132,158]),new i(30,new l(17,122),new l(4,123)),new i(28,new l(29,46),new l(14,47)),new i(30,new l(49,24),new l(10,25)),new i(30,new l(24,15),new l(46,16))),new c(38,Int32Array.from([6,32,58,84,110,136,162]),new i(30,new l(4,122),new l(18,123)),new i(28,new l(13,46),new l(32,47)),new i(30,new l(48,24),new l(14,25)),new i(30,new l(42,15),new l(32,16))),new c(39,Int32Array.from([6,26,54,82,110,138,166]),new i(30,new l(20,117),new l(4,118)),new i(28,new l(40,47),new l(7,48)),new i(30,new l(43,24),new l(22,25)),new i(30,new l(10,15),new l(67,16))),new c(40,Int32Array.from([6,30,58,86,114,142,170]),new i(30,new l(19,118),new l(6,119)),new i(28,new l(18,47),new l(31,48)),new i(30,new l(34,24),new l(34,25)),new i(30,new l(20,15),new l(61,16)))],c);function c(t,e){for(var n,r,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];this.versionNumber=t,this.alignmentPatternCenters=e;var a=0,s=(this.ecBlocks=i)[0].getECCodewordsPerBlock(),t=i[0].getECBlocks();try{for(var l=Im(t),u=l.next();!u.done;u=l.next()){var c=u.value;a+=c.getCount()*(c.getDataCodewords()+s)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}this.totalCodewords=a}(u=N2=N2||{})[u.DATA_MASK_000=0]="DATA_MASK_000",u[u.DATA_MASK_001=1]="DATA_MASK_001",u[u.DATA_MASK_010=2]="DATA_MASK_010",u[u.DATA_MASK_011=3]="DATA_MASK_011",u[u.DATA_MASK_100=4]="DATA_MASK_100",u[u.DATA_MASK_101=5]="DATA_MASK_101",u[u.DATA_MASK_110=6]="DATA_MASK_110",u[u.DATA_MASK_111=7]="DATA_MASK_111",xm.prototype.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var r=0;r<e;r++)this.isMasked(n,r)&&t.flip(r,n)},xm.values=new Map([[N2.DATA_MASK_000,new xm(N2.DATA_MASK_000,function(t,e){return 0==(t+e&1)})],[N2.DATA_MASK_001,new xm(N2.DATA_MASK_001,function(t,e){return 0==(1&t)})],[N2.DATA_MASK_010,new xm(N2.DATA_MASK_010,function(t,e){return e%3==0})],[N2.DATA_MASK_011,new xm(N2.DATA_MASK_011,function(t,e){return(t+e)%3==0})],[N2.DATA_MASK_100,new xm(N2.DATA_MASK_100,function(t,e){return 0==(Math.floor(t/2)+Math.floor(e/3)&1)})],[N2.DATA_MASK_101,new xm(N2.DATA_MASK_101,function(t,e){return t*e%6==0})],[N2.DATA_MASK_110,new xm(N2.DATA_MASK_110,function(t,e){return t*e%6<3})],[N2.DATA_MASK_111,new xm(N2.DATA_MASK_111,function(t,e){return 0==(t+e+t*e%3&1)})]]);var km=xm;function xm(t,e){this.value=t,this.isMasked=e}Nm.prototype.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var t=0,e=0;e<6;e++)t=this.copyBit(e,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t);for(var t=this.copyBit(8,7,t),n=5;0<=n;n--)t=this.copyBit(8,n,t);for(var r=this.bitMatrix.getHeight(),i=0,o=r-7,n=r-1;o<=n;n--)i=this.copyBit(8,n,i);for(e=r-8;e<r;e++)i=this.copyBit(e,8,i);if(this.parsedFormatInfo=Cm.decodeFormatInformation(t,i),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new A},Nm.prototype.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var t=this.bitMatrix.getHeight(),e=Math.floor((t-17)/4);if(e<=6)return Lm.getVersionForNumber(e);for(var n=0,r=t-11,i=5;0<=i;i--)for(var o=t-9;r<=o;o--)n=this.copyBit(o,i,n);e=Lm.decodeVersionInformation(n);if(null!==e&&e.getDimensionForVersion()===t)return this.parsedVersion=e;for(n=0,o=5;0<=o;o--)for(i=t-9;r<=i;i--)n=this.copyBit(o,i,n);if(null!==(e=Lm.decodeVersionInformation(n))&&e.getDimensionForVersion()===t)return this.parsedVersion=e;throw new A},Nm.prototype.copyBit=function(t,e,n){return(this.isMirror?this.bitMatrix.get(e,t):this.bitMatrix.get(t,e))?n<<1|1:n<<1},Nm.prototype.readCodewords=function(){for(var t=this.readFormatInformation(),e=this.readVersion(),t=km.values.get(t.getDataMask()),n=this.bitMatrix.getHeight(),r=(t.unmaskBitMatrix(this.bitMatrix,n),e.buildFunctionPattern()),i=!0,o=new Uint8Array(e.getTotalCodewords()),a=0,s=0,l=0,u=n-1;0<u;u-=2){6===u&&u--;for(var c=0;c<n;c++)for(var h=i?n-1-c:c,d=0;d<2;d++)r.get(u-d,h)||(l++,s<<=1,this.bitMatrix.get(u-d,h)&&(s|=1),8===l&&(o[a++]=s,s=l=0));i=!i}if(a!==e.getTotalCodewords())throw new A;return o},Nm.prototype.remask=function(){var t,e;null!==this.parsedFormatInfo&&(t=km.values.get(this.parsedFormatInfo.getDataMask()),e=this.bitMatrix.getHeight(),t.unmaskBitMatrix(this.bitMatrix,e))},Nm.prototype.setMirror=function(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t},Nm.prototype.mirror=function(){for(var t=this.bitMatrix,e=0,n=t.getWidth();e<n;e++)for(var r=e+1,i=t.getHeight();r<i;r++)t.get(e,r)!==t.get(r,e)&&(t.flip(r,e),t.flip(e,r))};var Dm=Nm;function Nm(t){var e=t.getHeight();if(e<21||1!=(3&e))throw new A;this.bitMatrix=t}var Rm=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Pm=(Om.getDataBlocks=function(t,e,n){var r,i,o,a;if(t.length!==e.getTotalCodewords())throw new Qu;var s=e.getECBlocksForLevel(n),l=0,e=s.getECBlocks();try{for(var u=Rm(e),c=u.next();!c.done;c=u.next())l+=(g=c.value).getCount()}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}var h=new Array(l),d=0;try{for(var p=Rm(e),f=p.next();!f.done;f=p.next())for(var g=f.value,m=0;m<g.getCount();m++){var y=g.getDataCodewords(),v=s.getECCodewordsPerBlock()+y;h[d++]=new Om(y,new Uint8Array(v))}}catch(t){o={error:t}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}for(var _=h[0].codewords.length,w=h.length-1;0<=w&&h[w].codewords.length!==_;)w--;w++;for(var b=_-s.getECCodewordsPerBlock(),C=0,m=0;m<b;m++)for(var E=0;E<d;E++)h[E].codewords[m]=t[C++];for(E=w;E<d;E++)h[E].codewords[b]=t[C++];for(var S=h[0].codewords.length,m=b;m<S;m++)for(E=0;E<d;E++)h[E].codewords[E<w?m:m+1]=t[C++];return h},Om.prototype.getNumDataCodewords=function(){return this.numDataCodewords},Om.prototype.getCodewords=function(){return this.codewords},Om);function Om(t,e){this.numDataCodewords=t,this.codewords=e}(M=W2=W2||{})[M.TERMINATOR=0]="TERMINATOR",M[M.NUMERIC=1]="NUMERIC",M[M.ALPHANUMERIC=2]="ALPHANUMERIC",M[M.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",M[M.BYTE=4]="BYTE",M[M.ECI=5]="ECI",M[M.KANJI=6]="KANJI",M[M.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",M[M.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",M[M.HANZI=9]="HANZI",Bm.forBits=function(t){t=Bm.FOR_BITS.get(t);if(void 0===t)throw new Qu;return t},Bm.prototype.getCharacterCountBits=function(t){t=t.getVersionNumber(),t=t<=9?0:t<=26?1:2;return this.characterCountBitsForVersions[t]},Bm.prototype.getValue=function(){return this.value},Bm.prototype.getBits=function(){return this.bits},Bm.prototype.equals=function(t){return t instanceof Bm&&this.value===t.value},Bm.prototype.toString=function(){return this.stringValue},Bm.FOR_BITS=new Map,Bm.FOR_VALUE=new Map,Bm.TERMINATOR=new Bm(W2.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Bm.NUMERIC=new Bm(W2.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Bm.ALPHANUMERIC=new Bm(W2.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Bm.STRUCTURED_APPEND=new Bm(W2.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Bm.BYTE=new Bm(W2.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Bm.ECI=new Bm(W2.ECI,"ECI",Int32Array.from([0,0,0]),7),Bm.KANJI=new Bm(W2.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Bm.FNC1_FIRST_POSITION=new Bm(W2.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Bm.FNC1_SECOND_POSITION=new Bm(W2.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Bm.HANZI=new Bm(W2.HANZI,"HANZI",Int32Array.from([8,10,12]),13);var Mm=Bm;function Bm(t,e,n,r){this.value=t,this.stringValue=e,this.characterCountBitsForVersions=n,this.bits=r,Bm.FOR_BITS.set(r,this),Bm.FOR_VALUE.set(t,this)}Fm.decode=function(t,e,n,r){var i=new nm(t),o=new Kc,a=new Array,s=-1,l=-1;try{var u,c=null,h=!1,d=void 0;do{switch(d=i.available()<4?Mm.TERMINATOR:(u=i.readBits(4),Mm.forBits(u))){case Mm.TERMINATOR:break;case Mm.FNC1_FIRST_POSITION:case Mm.FNC1_SECOND_POSITION:h=!0;break;case Mm.STRUCTURED_APPEND:if(i.available()<16)throw new A;s=i.readBits(8),l=i.readBits(8);break;case Mm.ECI:var p=Fm.parseECIValue(i);if(null===(c=Bc.getCharacterSetECIByValue(p)))throw new A;break;case Mm.HANZI:var f=i.readBits(4),g=i.readBits(d.getCharacterCountBits(e));f===Fm.GB2312_SUBSET&&Fm.decodeHanziSegment(i,o,g);break;default:var m=i.readBits(d.getCharacterCountBits(e));switch(d){case Mm.NUMERIC:Fm.decodeNumericSegment(i,o,m);break;case Mm.ALPHANUMERIC:Fm.decodeAlphanumericSegment(i,o,m,h);break;case Mm.BYTE:Fm.decodeByteSegment(i,o,m,c,a,r);break;case Mm.KANJI:Fm.decodeKanjiSegment(i,o,m);break;default:throw new A}}}while(d!==Mm.TERMINATOR)}catch(t){throw new A}return new Oh(t,o.toString(),0===a.length?null:a,null===n?null:n.toString(),s,l)},Fm.decodeHanziSegment=function(t,e,n){if(13*n>t.available())throw new A;for(var r=new Uint8Array(2*n),i=0;0<n;){var o=t.readBits(13),o=o/96<<8&4294967295|o%96;o+=o<959?41377:42657,r[i]=o>>8&255,r[i+1]=255&o,i+=2,n--}try{e.append(qc.decode(r,Gc.GB2312))}catch(t){throw new A(t)}},Fm.decodeKanjiSegment=function(t,e,n){if(13*n>t.available())throw new A;for(var r=new Uint8Array(2*n),i=0;0<n;){var o=t.readBits(13),o=o/192<<8&4294967295|o%192;o+=o<7936?33088:49472,r[i]=o>>8,r[i+1]=o,i+=2,n--}try{e.append(qc.decode(r,Gc.SHIFT_JIS))}catch(t){throw new A(t)}},Fm.decodeByteSegment=function(t,e,n,r,i,o){if(8*n>t.available())throw new A;for(var a=new Uint8Array(n),s=0;s<n;s++)a[s]=t.readBits(8);o=null===r?Gc.guessEncoding(a,o):r.getName();try{e.append(qc.decode(a,o))}catch(t){throw new A(t)}i.push(a)},Fm.toAlphaNumericChar=function(t){if(t>=Fm.ALPHANUMERIC_CHARS.length)throw new A;return Fm.ALPHANUMERIC_CHARS[t]},Fm.decodeAlphanumericSegment=function(t,e,n,r){for(var i=e.length();1<n;){if(t.available()<11)throw new A;var o=t.readBits(11);e.append(Fm.toAlphaNumericChar(Math.floor(o/45))),e.append(Fm.toAlphaNumericChar(o%45)),n-=2}if(1===n){if(t.available()<6)throw new A;e.append(Fm.toAlphaNumericChar(t.readBits(6)))}if(r)for(var a=i;a<e.length();a++)"%"===e.charAt(a)&&(a<e.length()-1&&"%"===e.charAt(a+1)?e.deleteCharAt(a+1):e.setCharAt(a,String.fromCharCode(29)))},Fm.decodeNumericSegment=function(t,e,n){for(;3<=n;){if(t.available()<10)throw new A;var r=t.readBits(10);if(1e3<=r)throw new A;e.append(Fm.toAlphaNumericChar(Math.floor(r/100))),e.append(Fm.toAlphaNumericChar(Math.floor(r/10)%10)),e.append(Fm.toAlphaNumericChar(r%10)),n-=3}if(2===n){if(t.available()<7)throw new A;var i=t.readBits(7);if(100<=i)throw new A;e.append(Fm.toAlphaNumericChar(Math.floor(i/10))),e.append(Fm.toAlphaNumericChar(i%10))}else if(1===n){if(t.available()<4)throw new A;i=t.readBits(4);if(10<=i)throw new A;e.append(Fm.toAlphaNumericChar(i))}},Fm.parseECIValue=function(t){var e=t.readBits(8);if(0==(128&e))return 127&e;if(128==(192&e))return(63&e)<<8&4294967295|t.readBits(8);if(192==(224&e))return(31&e)<<16&4294967295|t.readBits(16);throw new A},Fm.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Fm.GB2312_SUBSET=1;var Um=Fm;function Fm(){}Hm.prototype.isMirrored=function(){return this.mirrored},Hm.prototype.applyMirroredCorrection=function(t){var e;!this.mirrored||null===t||t.length<3||(e=t[0],t[0]=t[2],t[2]=e)};var Vm=Hm;function Hm(t){this.mirrored=t}var zm=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},jm=(qm.prototype.decodeBooleanArray=function(t,e){return this.decodeBitMatrix(Zc.parseFromBooleanArray(t),e)},qm.prototype.decodeBitMatrix=function(t,e){var t=new Dm(t),n=null;try{return this.decodeBitMatrixParser(t,e)}catch(t){n=t}try{t.remask(),t.setMirror(!0),t.readVersion(),t.readFormatInformation(),t.mirror();var r=this.decodeBitMatrixParser(t,e);return r.setOther(new Vm(!0)),r}catch(t){if(null!==n)throw n;throw t}},qm.prototype.decodeBitMatrixParser=function(t,e){var n,r,i,o,a=t.readVersion(),s=t.readFormatInformation().getErrorCorrectionLevel(),t=t.readCodewords(),t=Pm.getDataBlocks(t,a,s),l=0;try{for(var u=zm(t),c=u.next();!c.done;c=u.next())l+=(g=c.value).getNumDataCodewords()}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}var h=new Uint8Array(l),d=0;try{for(var p=zm(t),f=p.next();!f.done;f=p.next()){var g,m=(g=f.value).getCodewords(),y=g.getNumDataCodewords();this.correctErrors(m,y);for(var v=0;v<y;v++)h[d++]=m[v]}}catch(t){i={error:t}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}return Um.decode(h,a,s,e)},qm.prototype.correctErrors=function(t,e){var n=new Int32Array(t);try{this.rsDecoder.decode(n,t.length-e)}catch(t){throw new ac}for(var r=0;r<e;r++)t[r]=n[r]},qm);function qm(){this.rsDecoder=new dd(Yh.QR_CODE_FIELD_256)}var Wm=Zm,Gm=Km=x;function $m(){this.constructor=Wm}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Wm,Gm),Wm.prototype=null===Gm?Object.create(Gm):($m.prototype=Gm.prototype,new $m),Zm.prototype.aboutEquals=function(t,e,n){return Math.abs(e-this.getY())<=t&&Math.abs(n-this.getX())<=t&&((e=Math.abs(t-this.estimatedModuleSize))<=1||e<=this.estimatedModuleSize)},Zm.prototype.combineEstimate=function(t,e,n){return new Zm((this.getX()+e)/2,(this.getY()+t)/2,(this.estimatedModuleSize+n)/2)};var Km,Xm=Zm;function Zm(t,e,n){t=Km.call(this,t,e)||this;return t.estimatedModuleSize=n,t}var Ym=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Qm=(Jm.prototype.find=function(){for(var t=this.startX,e=this.height,n=t+this.width,r=this.startY+e/2,i=new Int32Array(3),o=this.image,a=0;a<e;a++){for(var s=r+(0==(1&a)?Math.floor((a+1)/2):-Math.floor((a+1)/2)),l=(i[0]=0,i[1]=0,i[2]=0,t);l<n&&!o.get(l,s);)l++;for(var u,c=0;l<n;){if(o.get(l,s))if(1===c)i[1]++;else if(2===c){if(this.foundPatternCross(i))if(null!==(u=this.handlePossibleCenter(i,s,l)))return u;i[0]=i[2],i[1]=1,i[2]=0,c=1}else i[++c]++;else 1===c&&c++,i[c]++;l++}if(this.foundPatternCross(i))if(null!==(u=this.handlePossibleCenter(i,s,n)))return u}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new I},Jm.centerFromEnd=function(t,e){return e-t[2]-t[1]/2},Jm.prototype.foundPatternCross=function(t){for(var e=this.moduleSize,n=e/2,r=0;r<3;r++)if(Math.abs(e-t[r])>=n)return!1;return!0},Jm.prototype.crossCheckVertical=function(t,e,n,r){for(var i=this.image,o=i.getHeight(),a=this.crossCheckStateCount,s=(a[0]=0,a[1]=0,a[2]=0,t);0<=s&&i.get(e,s)&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;0<=s&&!i.get(e,s)&&a[0]<=n;)a[0]++,s--;if(n<a[0])return NaN;for(s=t+1;s<o&&i.get(e,s)&&a[1]<=n;)a[1]++,s++;if(s===o||a[1]>n)return NaN;for(;s<o&&!i.get(e,s)&&a[2]<=n;)a[2]++,s++;return!(n<a[2])&&!(5*Math.abs(a[0]+a[1]+a[2]-r)>=2*r)&&this.foundPatternCross(a)?Jm.centerFromEnd(a,s):NaN},Jm.prototype.handlePossibleCenter=function(t,e,n){var r,i,o=t[0]+t[1]+t[2],a=Jm.centerFromEnd(t,n),s=this.crossCheckVertical(e,a,2*t[1],o);if(!isNaN(s)){var l=(t[0]+t[1]+t[2])/3;try{for(var u=Ym(this.possibleCenters),c=u.next();!c.done;c=u.next()){var h=c.value;if(h.aboutEquals(l,s,a))return h.combineEstimate(s,a,l)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}n=new Xm(a,s,l);this.possibleCenters.push(n),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(n)}return null},Jm);function Jm(t,e,n,r,i,o,a){this.image=t,this.startX=e,this.startY=n,this.width=r,this.height=i,this.moduleSize=o,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}var t0=o0,e0=r0=x;function n0(){this.constructor=t0}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(t0,e0),t0.prototype=null===e0?Object.create(e0):(n0.prototype=e0.prototype,new n0),o0.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},o0.prototype.getCount=function(){return this.count},o0.prototype.aboutEquals=function(t,e,n){return Math.abs(e-this.getY())<=t&&Math.abs(n-this.getX())<=t&&((e=Math.abs(t-this.estimatedModuleSize))<=1||e<=this.estimatedModuleSize)},o0.prototype.combineEstimate=function(t,e,n){var r=this.count+1;return new o0((this.count*this.getX()+e)/r,(this.count*this.getY()+t)/r,(this.count*this.estimatedModuleSize+n)/r,r)};var r0,i0=o0;function o0(t,e,n,r){t=r0.call(this,t,e)||this;return t.estimatedModuleSize=n,void 0===(t.count=r)&&(t.count=1),t}s0.prototype.getBottomLeft=function(){return this.bottomLeft},s0.prototype.getTopLeft=function(){return this.topLeft},s0.prototype.getTopRight=function(){return this.topRight};var a0=s0;function s0(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}var l0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u0=(c0.prototype.getImage=function(){return this.image},c0.prototype.getPossibleCenters=function(){return this.possibleCenters},c0.prototype.find=function(t){for(var e=null!=t&&void 0!==t.get(xc.TRY_HARDER),n=null!=t&&void 0!==t.get(xc.PURE_BARCODE),r=this.image,i=r.getHeight(),o=r.getWidth(),a=(((c=Math.floor(3*i/(4*c0.MAX_MODULES)))<c0.MIN_SKIP||e)&&(c=c0.MIN_SKIP),!1),s=new Int32Array(5),l=c-1;l<i&&!a;l+=c){s[0]=0,s[1]=0,s[2]=0,s[3]=0;for(var u,c,h=s[4]=0,d=0;d<o;d++)r.get(d,l)?(1==(1&h)&&h++,s[h]++):0==(1&h)?4===h?!c0.foundPatternCross(s)||!0!==this.handlePossibleCenter(s,l,d,n)?(s[0]=s[2],s[1]=s[3],s[2]=s[4],s[3]=1,s[4]=0,h=3):(c=2,!0===this.hasSkipped?a=this.haveMultiplyConfirmedCenters():(u=this.findRowSkip())>s[2]&&(l+=u-s[2]-c,d=o-1),s[h=0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0):s[++h]++:s[h]++;c0.foundPatternCross(s)&&!0===this.handlePossibleCenter(s,l,o,n)&&(c=s[0],this.hasSkipped)&&(a=this.haveMultiplyConfirmedCenters())}t=this.selectBestPatterns();return x.orderBestPatterns(t),new a0(t)},c0.centerFromEnd=function(t,e){return e-t[4]-t[3]-t[2]/2},c0.foundPatternCross=function(t){for(var e,n,r=0,i=0;i<5;i++){var o=t[i];if(0===o)return!1;r+=o}return!(r<7)&&(n=(e=r/7)/2,Math.abs(e-t[0])<n)&&Math.abs(e-t[1])<n&&Math.abs(3*e-t[2])<3*n&&Math.abs(e-t[3])<n&&Math.abs(e-t[4])<n},c0.prototype.getCrossCheckStateCount=function(){var t=this.crossCheckStateCount;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t},c0.prototype.crossCheckDiagonal=function(t,e,n,r){for(var i=this.getCrossCheckStateCount(),o=0,a=this.image;o<=t&&o<=e&&a.get(e-o,t-o);)i[2]++,o++;if(t<o||e<o)return!1;for(;o<=t&&o<=e&&!a.get(e-o,t-o)&&i[1]<=n;)i[1]++,o++;if(t<o||e<o||i[1]>n)return!1;for(;o<=t&&o<=e&&a.get(e-o,t-o)&&i[0]<=n;)i[0]++,o++;if(i[0]>n)return!1;for(var s,l=a.getHeight(),u=a.getWidth(),o=1;t+o<l&&e+o<u&&a.get(e+o,t+o);)i[2]++,o++;if(l<=t+o||u<=e+o)return!1;for(;t+o<l&&e+o<u&&!a.get(e+o,t+o)&&i[3]<n;)i[3]++,o++;if(l<=t+o||u<=e+o||i[3]>=n)return!1;for(;t+o<l&&e+o<u&&a.get(e+o,t+o)&&i[4]<n;)i[4]++,o++;return!(i[4]>=n)&&(s=i[0]+i[1]+i[2]+i[3]+i[4],Math.abs(s-r)<2*r)&&c0.foundPatternCross(i)},c0.prototype.crossCheckVertical=function(t,e,n,r){for(var i=this.image,o=i.getHeight(),a=this.getCrossCheckStateCount(),s=t;0<=s&&i.get(e,s);)a[2]++,s--;if(s<0)return NaN;for(;0<=s&&!i.get(e,s)&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;0<=s&&i.get(e,s)&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=t+1;s<o&&i.get(e,s);)a[2]++,s++;if(s===o)return NaN;for(;s<o&&!i.get(e,s)&&a[3]<n;)a[3]++,s++;if(s===o||a[3]>=n)return NaN;for(;s<o&&i.get(e,s)&&a[4]<n;)a[4]++,s++;return!(n<=a[4])&&!(5*Math.abs(a[0]+a[1]+a[2]+a[3]+a[4]-r)>=2*r)&&c0.foundPatternCross(a)?c0.centerFromEnd(a,s):NaN},c0.prototype.crossCheckHorizontal=function(t,e,n,r){for(var i=this.image,o=i.getWidth(),a=this.getCrossCheckStateCount(),s=t;0<=s&&i.get(s,e);)a[2]++,s--;if(s<0)return NaN;for(;0<=s&&!i.get(s,e)&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;0<=s&&i.get(s,e)&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=t+1;s<o&&i.get(s,e);)a[2]++,s++;if(s===o)return NaN;for(;s<o&&!i.get(s,e)&&a[3]<n;)a[3]++,s++;if(s===o||a[3]>=n)return NaN;for(;s<o&&i.get(s,e)&&a[4]<n;)a[4]++,s++;return!(n<=a[4])&&!(5*Math.abs(a[0]+a[1]+a[2]+a[3]+a[4]-r)>=r)&&c0.foundPatternCross(a)?c0.centerFromEnd(a,s):NaN},c0.prototype.handlePossibleCenter=function(t,e,n,r){var i=t[0]+t[1]+t[2]+t[3]+t[4],o=c0.centerFromEnd(t,n),a=this.crossCheckVertical(e,Math.floor(o),t[2],i);if(isNaN(a)||(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(a),t[2],i),isNaN(o))||r&&!this.crossCheckDiagonal(Math.floor(a),Math.floor(o),t[2],i))return!1;for(var s=i/7,l=!1,u=this.possibleCenters,c=0,h=u.length;c<h;c++){var d=u[c];if(d.aboutEquals(s,a,o)){u[c]=d.combineEstimate(a,o,s),l=!0;break}}return l||(n=new i0(o,a,s),u.push(n),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(n)),!0},c0.prototype.findRowSkip=function(){var e,t,n=this.possibleCenters.length;if(!(n<=1)){var r=null;try{for(var i=l0(this.possibleCenters),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.getCount()>=c0.CENTER_QUORUM){if(null!=r)return this.hasSkipped=!0,Math.floor((Math.abs(r.getX()-a.getX())-Math.abs(r.getY()-a.getY()))/2);r=a}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}return 0},c0.prototype.haveMultiplyConfirmedCenters=function(){var e,t,n,r,i=0,o=0,a=this.possibleCenters.length;try{for(var s=l0(this.possibleCenters),l=s.next();!l.done;l=s.next())(p=l.value).getCount()>=c0.CENTER_QUORUM&&(i++,o+=p.getEstimatedModuleSize())}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}if(i<3)return!1;var u=o/a,c=0;try{for(var h=l0(this.possibleCenters),d=h.next();!d.done;d=h.next()){var p=d.value;c+=Math.abs(p.getEstimatedModuleSize()-u)}}catch(t){n={error:t}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}return c<=.05*o},c0.prototype.selectBestPatterns=function(){var e,n,t,r=this.possibleCenters.length;if(r<3)throw new I;var i=this.possibleCenters;if(3<r){var o=0,a=0;try{for(var s=l0(this.possibleCenters),l=s.next();!l.done;l=s.next()){var u=l.value.getEstimatedModuleSize();o+=u,a+=u*u}}catch(t){e={error:t}}finally{try{l&&!l.done&&(h=s.return)&&h.call(s)}finally{if(e)throw e.error}}for(var c=o/r,h=Math.sqrt(a/r-c*c),d=(i.sort(function(t,e){e=Math.abs(e.getEstimatedModuleSize()-c),t=Math.abs(t.getEstimatedModuleSize()-c);return e<t?-1:t<e?1:0}),Math.max(.2*c,h)),p=0;p<i.length&&3<i.length;p++){var f=i[p];Math.abs(f.getEstimatedModuleSize()-c)>d&&(i.splice(p,1),p--)}}if(3<i.length){o=0;try{for(var g=l0(i),m=g.next();!m.done;m=g.next())o+=m.value.getEstimatedModuleSize()}catch(t){n={error:t}}finally{try{m&&!m.done&&(t=g.return)&&t.call(g)}finally{if(n)throw n.error}}c=o/i.length,i.sort(function(t,e){var n,r;return e.getCount()===t.getCount()?(n=Math.abs(e.getEstimatedModuleSize()-c))<(r=Math.abs(t.getEstimatedModuleSize()-c))?1:r<n?-1:0:e.getCount()-t.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]},c0.CENTER_QUORUM=2,c0.MIN_SKIP=3,c0.MAX_MODULES=57,c0);function c0(t,e){this.image=t,this.resultPointCallback=e,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=e}d0.prototype.getImage=function(){return this.image},d0.prototype.getResultPointCallback=function(){return this.resultPointCallback},d0.prototype.detect=function(t){this.resultPointCallback=null==t?null:t.get(xc.NEED_RESULT_POINT_CALLBACK);t=new u0(this.image,this.resultPointCallback).find(t);return this.processFinderPatternInfo(t)},d0.prototype.processFinderPatternInfo=function(t){var e=t.getTopLeft(),n=t.getTopRight(),t=t.getBottomLeft(),r=this.calculateModuleSize(e,n,t);if(r<1)throw new I("No pattern found in proccess finder.");var i=d0.computeDimension(e,n,t,r),o=Lm.getProvisionalVersionForDimension(i),a=o.getDimensionForVersion()-7,s=null;if(0<o.getAlignmentPatternCenters().length)for(var o=n.getX()-e.getX()+t.getX(),l=n.getY()-e.getY()+t.getY(),a=1-3/a,u=Math.floor(e.getX()+a*(o-e.getX())),c=Math.floor(e.getY()+a*(l-e.getY())),h=4;h<=16;h<<=1)try{s=this.findAlignmentInRegion(r,u,c,h);break}catch(t){if(!(t instanceof I))throw t}o=d0.createTransform(e,n,t,s,i),a=d0.sampleGrid(this.image,o,i),l=null===s?[t,e,n]:[t,e,n,s];return new bd(a,l)},d0.createTransform=function(t,e,n,r,i){var o,a,i=i-3.5,s=r=null!==r?(o=r.getX(),a=r.getY(),i-3):(o=e.getX()-t.getX()+n.getX(),a=e.getY()-t.getY()+n.getY(),i);return Rd.quadrilateralToQuadrilateral(3.5,3.5,i,3.5,r,s,3.5,i,t.getX(),t.getY(),e.getX(),e.getY(),o,a,n.getX(),n.getY())},d0.sampleGrid=function(t,e,n){return Vd.getInstance().sampleGridWithTransform(t,n,n,e)},d0.computeDimension=function(t,e,n,r){var e=md.round(x.distance(t,e)/r),t=md.round(x.distance(t,n)/r),i=Math.floor((e+t)/2)+7;switch(3&i){case 0:i++;break;case 2:i--;break;case 3:throw new I("Dimensions could be not found.")}return i},d0.prototype.calculateModuleSize=function(t,e,n){return(this.calculateModuleSizeOneWay(t,e)+this.calculateModuleSizeOneWay(t,n))/2},d0.prototype.calculateModuleSizeOneWay=function(t,e){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY())),e=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(n)?e/7:isNaN(e)?n/7:(n+e)/14},d0.prototype.sizeOfBlackWhiteBlackRunBothWays=function(t,e,n,r){var i=this.sizeOfBlackWhiteBlackRun(t,e,n,r),o=1,n=t-(n-t),r=(n<0?(o=t/(t-n),n=0):n>=this.image.getWidth()&&(o=(this.image.getWidth()-1-t)/(n-t),n=this.image.getWidth()-1),Math.floor(e-(r-e)*o)),o=1;return r<0?(o=e/(e-r),r=0):r>=this.image.getHeight()&&(o=(this.image.getHeight()-1-e)/(r-e),r=this.image.getHeight()-1),n=Math.floor(t+(n-t)*o),(i+=this.sizeOfBlackWhiteBlackRun(t,e,n,r))-1},d0.prototype.sizeOfBlackWhiteBlackRun=function(t,e,n,r){for(var i,o=Math.abs(r-e)>Math.abs(n-t),a=(o&&(i=t,t=e,e=i,i=n,n=r,r=i),Math.abs(n-t)),s=Math.abs(r-e),l=-a/2,u=t<n?1:-1,c=e<r?1:-1,h=0,d=n+u,p=t,f=e;p!==d;p+=u){if(1===h===this.image.get(o?f:p,o?p:f)){if(2===h)return md.distance(p,f,t,e);h++}if(0<(l+=s)){if(f===r)break;f+=c,l-=a}}return 2===h?md.distance(n+u,r,t,e):NaN},d0.prototype.findAlignmentInRegion=function(t,e,n,r){var r=Math.floor(r*t),i=Math.max(0,e-r),e=Math.min(this.image.getWidth()-1,e+r);if(e-i<3*t)throw new I("Alignment top exceeds estimated module size.");var o=Math.max(0,n-r),n=Math.min(this.image.getHeight()-1,n+r);if(n-o<3*t)throw new I("Alignment bottom exceeds estimated module size.");return new Qm(this.image,i,o,e-i,n-o,t,this.resultPointCallback).find()};var h0=d0;function d0(t){this.image=t}f0.prototype.getDecoder=function(){return this.decoder},f0.prototype.decode=function(t,e){e=null!=e&&void 0!==e.get(xc.PURE_BARCODE)?(n=f0.extractPureBits(t.getBlackMatrix()),n=this.decoder.decodeBitMatrix(n,e),f0.NO_POINTS):(t=new h0(t.getBlackMatrix()).detect(e),n=this.decoder.decodeBitMatrix(t.getBits(),e),t.getPoints()),n.getOther()instanceof Vm&&n.getOther().applyMirroredCorrection(e);var n,t=new Nh(n.getText(),n.getRawBytes(),void 0,e,k.QR_CODE,void 0),e=n.getByteSegments(),e=(null!==e&&t.putMetadata(Ph.BYTE_SEGMENTS,e),n.getECLevel());return null!==e&&t.putMetadata(Ph.ERROR_CORRECTION_LEVEL,e),n.hasStructuredAppend()&&(t.putMetadata(Ph.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),t.putMetadata(Ph.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),t},f0.prototype.reset=function(){},f0.extractPureBits=function(t){var e=t.getTopLeftOnBit(),n=t.getBottomRightOnBit();if(null===e||null===n)throw new I;var r=this.moduleSize(e,t),i=e[1],o=n[1],a=e[0],e=n[0];if(e<=a||o<=i)throw new I;if(o-i!=e-a&&(e=a+(o-i))>=t.getWidth())throw new I;var s=Math.round((e-a+1)/r),l=Math.round((o-i+1)/r);if(s<=0||l<=0)throw new I;if(l!==s)throw new I;n=Math.floor(r/2),i+=n,e=(a+=n)+Math.floor((s-1)*r)-e;if(0<e){if(n<e)throw new I;a-=e}e=i+Math.floor((l-1)*r)-o;if(0<e){if(n<e)throw new I;i-=e}for(var u=new Zc(s,l),c=0;c<l;c++)for(var h=i+Math.floor(c*r),d=0;d<s;d++)t.get(a+Math.floor(d*r),h)&&u.set(d,c);return u},f0.moduleSize=function(t,e){for(var n=e.getHeight(),r=e.getWidth(),i=t[0],o=t[1],a=!0,s=0;i<r&&o<n;){if(a!==e.get(i,o)){if(5==++s)break;a=!a}i++,o++}if(i===r||o===n)throw new I;return(i-t[0])/7},f0.NO_POINTS=new Array;var p0=f0;function f0(){this.decoder=new jm}var g0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},m0=(y0.prototype.PDF417Common=function(){},y0.getBitCountSum=function(t){return md.sum(t)},y0.toIntArray=function(t){var e,n;if(null==t||!t.length)return y0.EMPTY_INT_ARRAY;var r=new Int32Array(t.length),i=0;try{for(var o=g0(t),a=o.next();!a.done;a=o.next()){var s=a.value;r[i++]=s}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},y0.getCodeword=function(t){t=Sc.binarySearch(y0.SYMBOL_TABLE,262143&t);return t<0?-1:(y0.CODEWORD_TABLE[t]-1)%y0.NUMBER_OF_CODEWORDS},y0.MAX_CODEWORDS_IN_BARCODE=(y0.NUMBER_OF_CODEWORDS=929)-1,y0.MIN_ROWS_IN_BARCODE=3,y0.MAX_ROWS_IN_BARCODE=90,y0.MODULES_IN_CODEWORD=17,y0.MODULES_IN_STOP_PATTERN=18,y0.BARS_IN_MODULE=8,y0.EMPTY_INT_ARRAY=new Int32Array([]),y0.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),y0.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),y0);function y0(){}_0.prototype.getBits=function(){return this.bits},_0.prototype.getPoints=function(){return this.points};var v0=_0;function _0(t,e){this.bits=t,this.points=e}var w0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},b0=(C0.detectMultiple=function(t,e,n){var t=t.getBlackMatrix(),r=C0.detect(n,t);return r.length||((t=t.clone()).rotate180(),r=C0.detect(n,t)),new v0(t,r)},C0.detect=function(t,e){for(var n,r,i=new Array,o=0,a=0,s=!1;o<e.getHeight();){var l=C0.findVertices(e,o,a);if(null==l[0]&&null==l[3]){if(!s)break;s=!1,a=0;try{n=void 0;for(var u=w0(i),c=u.next();!c.done;c=u.next()){var h=c.value;null!=h[1]&&(o=Math.trunc(Math.max(o,h[1].getY()))),null!=h[3]&&(o=Math.max(o,Math.trunc(h[3].getY())))}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}o+=C0.ROW_STEP}else{if(s=!0,i.push(l),!t)break;o=null!=l[2]?(a=Math.trunc(l[2].getX()),Math.trunc(l[2].getY())):(a=Math.trunc(l[4].getX()),Math.trunc(l[4].getY()))}}return i},C0.findVertices=function(t,e,n){var r=t.getHeight(),i=t.getWidth(),o=new Array(8);return C0.copyToResult(o,C0.findRowsWithPattern(t,r,i,e,n,C0.START_PATTERN),C0.INDEXES_START_PATTERN),null!=o[4]&&(n=Math.trunc(o[4].getX()),e=Math.trunc(o[4].getY())),C0.copyToResult(o,C0.findRowsWithPattern(t,r,i,e,n,C0.STOP_PATTERN),C0.INDEXES_STOP_PATTERN),o},C0.copyToResult=function(t,e,n){for(var r=0;r<n.length;r++)t[n[r]]=e[r]},C0.findRowsWithPattern=function(t,e,n,r,i,o){for(var a=new Array(4),s=!1,l=new Int32Array(o.length);r<e;r+=C0.ROW_STEP)if(null!=(c=C0.findGuardPattern(t,i,r,n,!1,o,l))){for(;0<r;){if(null==(d=C0.findGuardPattern(t,i,--r,n,!1,o,l))){r++;break}c=d}a[0]=new x(c[0],r),a[1]=new x(c[1],r),s=!0;break}var u=r+1;if(s){for(var c,h=0,d=Int32Array.from([Math.trunc(a[0].getX()),Math.trunc(a[1].getX())]);u<e;u++)if(null!=(c=C0.findGuardPattern(t,d[0],u,n,!1,o,l))&&Math.abs(d[0]-c[0])<C0.MAX_PATTERN_DRIFT&&Math.abs(d[1]-c[1])<C0.MAX_PATTERN_DRIFT)d=c,h=0;else{if(C0.SKIPPED_ROW_COUNT_MAX<h)break;h++}a[2]=new x(d[0],u-=h+1),a[3]=new x(d[1],u)}return u-r<C0.BARCODE_MIN_HEIGHT&&Sc.fill(a,null),a},C0.findGuardPattern=function(t,e,n,r,i,o,a){Sc.fillWithin(a,0,a.length,0);for(var s=e,l=0;t.get(s,n)&&0<s&&l++<C0.MAX_PIXEL_DRIFT;)s--;for(var u=s,c=0,h=o.length,d=i;u<r;u++)if(t.get(u,n)!==d)a[c]++;else{if(c===h-1){if(C0.patternMatchVariance(a,o,C0.MAX_INDIVIDUAL_VARIANCE)<C0.MAX_AVG_VARIANCE)return new Int32Array([s,u]);s+=a[0]+a[1],uc.arraycopy(a,2,a,0,c-1),a[c-1]=0,a[c]=0,c--}else c++;a[c]=1,d=!d}return c===h-1&&C0.patternMatchVariance(a,o,C0.MAX_INDIVIDUAL_VARIANCE)<C0.MAX_AVG_VARIANCE?new Int32Array([s,u-1]):null},C0.patternMatchVariance=function(t,e,n){for(var r=t.length,i=0,o=0,a=0;a<r;a++)i+=t[a],o+=e[a];if(i<o)return 1/0;for(var s=i/o,l=(n*=s,0),u=0;u<r;u++){var c=t[u],h=e[u]*s,h=h<c?c-h:h-c;if(n<h)return 1/0;l+=h}return l/i},C0.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),C0.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),C0.MAX_AVG_VARIANCE=.42,C0.MAX_INDIVIDUAL_VARIANCE=.8,C0.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),C0.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),C0.MAX_PIXEL_DRIFT=3,C0.MAX_PATTERN_DRIFT=5,C0.SKIPPED_ROW_COUNT_MAX=25,C0.ROW_STEP=5,C0.BARCODE_MIN_HEIGHT=10,C0);function C0(){}var E0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},S0=(T0.prototype.getCoefficients=function(){return this.coefficients},T0.prototype.getDegree=function(){return this.coefficients.length-1},T0.prototype.isZero=function(){return 0===this.coefficients[0]},T0.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},T0.prototype.evaluateAt=function(t){var e,n;if(0===t)return this.getCoefficient(0);if(1===t){var r=0;try{for(var i=E0(this.coefficients),o=i.next();!o.done;o=i.next())var a=o.value,r=this.field.add(r,a)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}for(var s=this.coefficients[0],l=this.coefficients.length,u=1;u<l;u++)s=this.field.add(this.field.multiply(t,s),this.coefficients[u]);return s},T0.prototype.add=function(t){if(!this.field.equals(t.field))throw new Qu("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;var e=this.coefficients,n=t.coefficients,r=(e.length>n.length&&(t=e,e=n,n=t),new Int32Array(n.length)),i=n.length-e.length;uc.arraycopy(n,0,r,0,i);for(var o=i;o<n.length;o++)r[o]=this.field.add(e[o-i],n[o]);return new T0(this.field,r)},T0.prototype.subtract=function(t){if(this.field.equals(t.field))return t.isZero()?this:this.add(t.negative());throw new Qu("ModulusPolys do not have same ModulusGF field")},T0.prototype.multiply=function(t){return t instanceof T0?this.multiplyOther(t):this.multiplyScalar(t)},T0.prototype.multiplyOther=function(t){if(!this.field.equals(t.field))throw new Qu("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new T0(this.field,new Int32Array([0]));for(var e=this.coefficients,n=e.length,r=t.coefficients,i=r.length,o=new Int32Array(n+i-1),a=0;a<n;a++)for(var s=e[a],l=0;l<i;l++)o[a+l]=this.field.add(o[a+l],this.field.multiply(s,r[l]));return new T0(this.field,o)},T0.prototype.negative=function(){for(var t=this.coefficients.length,e=new Int32Array(t),n=0;n<t;n++)e[n]=this.field.subtract(0,this.coefficients[n]);return new T0(this.field,e)},T0.prototype.multiplyScalar=function(t){if(0===t)return new T0(this.field,new Int32Array([0]));if(1===t)return this;for(var e=this.coefficients.length,n=new Int32Array(e),r=0;r<e;r++)n[r]=this.field.multiply(this.coefficients[r],t);return new T0(this.field,n)},T0.prototype.multiplyByMonomial=function(t,e){if(t<0)throw new Qu;if(0===e)return new T0(this.field,new Int32Array([0]));for(var n=this.coefficients.length,r=new Int32Array(n+t),i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],e);return new T0(this.field,r)},T0.prototype.toString=function(){for(var t=new Kc,e=this.getDegree();0<=e;e--){var n=this.getCoefficient(e);0!==n&&(n<0?(t.append(" - "),n=-n):0<t.length()&&t.append(" + "),0!==e&&1===n||t.append(n),0!==e)&&(1===e?t.append("x"):(t.append("x^"),t.append(e)))}return t.toString()},T0);function T0(t,e){if(0===e.length)throw new Qu;this.field=t;var n=e.length;if(1<n&&0===e[0]){for(var r=1;r<n&&0===e[r];)r++;r===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-r),uc.arraycopy(e,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}function A0(){}A0.prototype.add=function(t,e){return(t+e)%this.modulus},A0.prototype.subtract=function(t,e){return(this.modulus+t-e)%this.modulus},A0.prototype.exp=function(t){return this.expTable[t]},A0.prototype.log=function(t){if(0===t)throw new Qu;return this.logTable[t]},A0.prototype.inverse=function(t){if(0===t)throw new Wh;return this.expTable[this.modulus-this.logTable[t]-1]},A0.prototype.multiply=function(t,e){return 0===t||0===e?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.modulus-1)]},A0.prototype.getSize=function(){return this.modulus},A0.prototype.equals=function(t){return t===this};var I0=N0,L0=x0=A0;function k0(){this.constructor=I0}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(I0,L0),I0.prototype=null===L0?Object.create(L0):(k0.prototype=L0.prototype,new k0),N0.prototype.getZero=function(){return this.zero},N0.prototype.getOne=function(){return this.one},N0.prototype.buildMonomial=function(t,e){if(t<0)throw new Qu;return 0===e?this.zero:((t=new Int32Array(t+1))[0]=e,new S0(this,t))},N0.PDF417_GF=new N0(m0.NUMBER_OF_CODEWORDS,3);var x0,D0=N0;function N0(t,e){for(var n=x0.call(this)||this,r=(n.modulus=t,n.expTable=new Int32Array(t),n.logTable=new Int32Array(t),1),i=0;i<t;i++)r=(n.expTable[i]=r)*e%t;for(i=0;i<t-1;i++)n.logTable[n.expTable[i]]=i;return n.zero=new S0(n,new Int32Array([0])),n.one=new S0(n,new Int32Array([1])),n}var R0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},t=(P0.prototype.decode=function(t,e,n){for(var r=new S0(this.field,t),i=new Int32Array(e),o=!1,a=e;0<a;a--){var s=r.evaluateAt(this.field.exp(a));0!==(i[e-a]=s)&&(o=!0)}if(!o)return 0;var l=this.field.getOne();if(null!=n)try{for(var u=R0(n),c=u.next();!c.done;c=u.next())var h=c.value,d=this.field.exp(t.length-1-h),p=new S0(this.field,new Int32Array([this.field.subtract(0,d),1])),l=l.multiply(p)}catch(t){g={error:t}}finally{try{c&&!c.done&&(f=u.return)&&f.call(u)}finally{if(g)throw g.error}}for(var n=new S0(this.field,i),f=this.runEuclideanAlgorithm(this.field.buildMonomial(e,1),n,e),g=f[0],n=f[1],m=this.findErrorLocations(g),y=this.findErrorMagnitudes(n,g,m),a=0;a<m.length;a++){var v=t.length-1-this.field.log(m[a]);if(v<0)throw ac.getChecksumInstance();t[v]=this.field.subtract(t[v],y[a])}return m.length},P0.prototype.runEuclideanAlgorithm=function(t,e,n){t.getDegree()<e.getDegree()&&(p=t,t=e,e=p);for(var r=t,i=e,o=this.field.getZero(),a=this.field.getOne();i.getDegree()>=Math.round(n/2);){var s=r,l=o,o=a;if((r=i).isZero())throw ac.getChecksumInstance();i=s;for(var u=this.field.getZero(),s=r.getCoefficient(r.getDegree()),c=this.field.inverse(s);i.getDegree()>=r.getDegree()&&!i.isZero();)var h=i.getDegree()-r.getDegree(),d=this.field.multiply(i.getCoefficient(i.getDegree()),c),u=u.add(this.field.buildMonomial(h,d)),i=i.subtract(r.multiplyByMonomial(h,d));a=u.multiply(o).subtract(l).negative()}var p=a.getCoefficient(0);if(0===p)throw ac.getChecksumInstance();t=this.field.inverse(p);return[a.multiply(t),i.multiply(t)]},P0.prototype.findErrorLocations=function(t){for(var e=t.getDegree(),n=new Int32Array(e),r=0,i=1;i<this.field.getSize()&&r<e;i++)0===t.evaluateAt(i)&&(n[r]=this.field.inverse(i),r++);if(r!==e)throw ac.getChecksumInstance();return n},P0.prototype.findErrorMagnitudes=function(t,e,n){for(var r=e.getDegree(),i=new Int32Array(r),o=1;o<=r;o++)i[r-o]=this.field.multiply(o,e.getCoefficient(o));for(var a=new S0(this.field,i),s=n.length,l=new Int32Array(s),o=0;o<s;o++){var u=this.field.inverse(n[o]),c=this.field.subtract(0,t.evaluateAt(u)),u=this.field.inverse(a.evaluateAt(u));l[o]=this.field.multiply(c,u)}return l},P0);function P0(){this.field=D0.PDF417_GF}M0.prototype.constructor_1=function(t,e,n,r,i){var o=null==e||null==n,a=null==r||null==i;if(o&&a)throw new I;o?(e=new x(0,r.getY()),n=new x(0,i.getY())):a&&(r=new x(t.getWidth()-1,e.getY()),i=new x(t.getWidth()-1,n.getY())),this.image=t,this.topLeft=e,this.bottomLeft=n,this.topRight=r,this.bottomRight=i,this.minX=Math.trunc(Math.min(e.getX(),n.getX())),this.maxX=Math.trunc(Math.max(r.getX(),i.getX())),this.minY=Math.trunc(Math.min(e.getY(),r.getY())),this.maxY=Math.trunc(Math.max(n.getY(),i.getY()))},M0.prototype.constructor_2=function(t){this.image=t.image,this.topLeft=t.getTopLeft(),this.bottomLeft=t.getBottomLeft(),this.topRight=t.getTopRight(),this.bottomRight=t.getBottomRight(),this.minX=t.getMinX(),this.maxX=t.getMaxX(),this.minY=t.getMinY(),this.maxY=t.getMaxY()},M0.merge=function(t,e){return null==t?e:null==e?t:new M0(t.image,t.topLeft,t.bottomLeft,e.topRight,e.bottomRight)},M0.prototype.addMissingRows=function(t,e,n){var r,i=this.topLeft,o=this.bottomLeft,a=this.topRight,s=this.bottomRight;return 0<t&&(r=n?this.topLeft:this.topRight,(t=Math.trunc(r.getY()-t))<0&&(t=0),r=new x(r.getX(),t),n?i=r:a=r),0<e&&(t=n?this.bottomLeft:this.bottomRight,(r=Math.trunc(t.getY()+e))>=this.image.getHeight()&&(r=this.image.getHeight()-1),e=new x(t.getX(),r),n?o=e:s=e),new M0(this.image,i,o,a,s)},M0.prototype.getMinX=function(){return this.minX},M0.prototype.getMaxX=function(){return this.maxX},M0.prototype.getMinY=function(){return this.minY},M0.prototype.getMaxY=function(){return this.maxY},M0.prototype.getTopLeft=function(){return this.topLeft},M0.prototype.getTopRight=function(){return this.topRight},M0.prototype.getBottomLeft=function(){return this.bottomLeft},M0.prototype.getBottomRight=function(){return this.bottomRight};var O0=M0;function M0(t,e,n,r,i){t instanceof M0?this.constructor_2(t):this.constructor_1(t,e,n,r,i)}U0.prototype.getColumnCount=function(){return this.columnCount},U0.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},U0.prototype.getRowCount=function(){return this.rowCount},U0.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},U0.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart};var B0=U0;function U0(t,e,n,r){this.columnCount=t,this.errorCorrectionLevel=r,this.rowCountUpperPart=e,this.rowCountLowerPart=n,this.rowCount=e+n}V0.form=function(t,c){var h=-1;return t.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(t,e,n,r,i,o){if("%%"===t)return"%";if(void 0!==c[++h]){t=r?parseInt(r.substr(1)):void 0;var a=i?parseInt(i.substr(1)):void 0;switch(o){case"s":s=c[h];break;case"c":s=c[h][0];break;case"f":s=parseFloat(c[h]).toFixed(t);break;case"p":s=parseFloat(c[h]).toPrecision(t);break;case"e":s=parseFloat(c[h]).toExponential(t);break;case"x":s=parseInt(c[h]).toString(a||16);break;case"d":s=parseFloat(parseInt(c[h],a||10).toPrecision(t)).toFixed(0)}for(var s="object"==typeof s?JSON.stringify(s):(+s).toString(a),l=parseInt(n),u=n&&n[0]+""=="0"?"0":" ";s.length<l;)s=void 0!==e?s+u:u+s;return s}})},V0.prototype.format=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.buffer+=V0.form(t,e)},V0.prototype.toString=function(){return this.buffer};var F0=V0;function V0(){this.buffer=""}var H0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},z0=(j0.prototype.getCodewordNearby=function(t){var e=this.getCodeword(t);if(null!=e)return e;for(var n=1;n<j0.MAX_NEARBY_DISTANCE;n++){var r=this.imageRowToCodewordIndex(t)-n;if(0<=r&&null!=(e=this.codewords[r]))return e;if((r=this.imageRowToCodewordIndex(t)+n)<this.codewords.length&&null!=(e=this.codewords[r]))return e}return null},j0.prototype.imageRowToCodewordIndex=function(t){return t-this.boundingBox.getMinY()},j0.prototype.setCodeword=function(t,e){this.codewords[this.imageRowToCodewordIndex(t)]=e},j0.prototype.getCodeword=function(t){return this.codewords[this.imageRowToCodewordIndex(t)]},j0.prototype.getBoundingBox=function(){return this.boundingBox},j0.prototype.getCodewords=function(){return this.codewords},j0.prototype.toString=function(){var e,t,n=new F0,r=0;try{for(var i=H0(this.codewords),o=i.next();!o.done;o=i.next()){var a=o.value;null==a?n.format("%3d:    |   %n",r++):n.format("%3d: %3d|%3d%n",r++,a.getRowNumber(),a.getValue())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n.toString()},j0.MAX_NEARBY_DISTANCE=5,j0);function j0(t){this.boundingBox=new O0(t),this.codewords=new Array(t.getMaxY()-t.getMinY()+1)}var q0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},W0=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},G0=($0.prototype.setValue=function(t){t=Math.trunc(t);var e=this.values.get(t);null==e&&(e=0),this.values.set(t,++e)},$0.prototype.getValue=function(){var e,t,i=-1,o=new Array;try{for(var n=q0(this.values.entries()),r=n.next();!r.done;r=n.next()){var a=W0(r.value,2);((t,e)=>{var n=function(){return t},r=function(){return e};r()>i?(i=r(),(o=[]).push(n())):r()===i&&o.push(n())})(a[0],a[1])}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return m0.toIntArray(o)},$0.prototype.getConfidence=function(t){return this.values.get(t)},$0);function $0(){this.values=new Map}K0=function(t,e){return(K0=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var K0,X0,Z0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Y0=(function(t,e){function n(){this.constructor=t}K0(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(Q0,X0=z0),Q0.prototype.setRowNumbers=function(){var e,t;try{for(var n=Z0(this.getCodewords()),r=n.next();!r.done;r=n.next()){var i=r.value;null!=i&&i.setRowNumberAsRowIndicatorColumn()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},Q0.prototype.adjustCompleteIndicatorColumnRowNumbers=function(t){for(var e=this.getCodewords(),n=(this.setRowNumbers(),this.removeIncorrectCodewords(e,t),this.getBoundingBox()),r=this._isLeft?n.getTopLeft():n.getTopRight(),n=this._isLeft?n.getBottomLeft():n.getBottomRight(),r=this.imageRowToCodewordIndex(Math.trunc(r.getY())),i=this.imageRowToCodewordIndex(Math.trunc(n.getY())),o=-1,a=1,s=0,l=r;l<i;l++)if(null!=e[l]){var u=e[l],c=u.getRowNumber()-o;if(0==c)s++;else if(1==c)a=Math.max(a,s),s=1,o=u.getRowNumber();else if(c<0||u.getRowNumber()>=t.getRowCount()||l<c)e[l]=null;else{for(var h=void 0,d=l<=(h=2<a?(a-2)*c:c),p=1;p<=h&&!d;p++)d=null!=e[l-p];d?e[l]=null:(o=u.getRowNumber(),s=1)}}},Q0.prototype.getRowHeights=function(){var e,t,n=this.getBarcodeMetadata();if(null==n)return null;this.adjustIncompleteIndicatorColumnRowNumbers(n);var r=new Int32Array(n.getRowCount());try{for(var i=Z0(this.getCodewords()),o=i.next();!o.done;o=i.next()){var a,s=o.value;null==s||(a=s.getRowNumber())>=r.length||r[a]++}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},Q0.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(t){for(var e,n,r=this.getBoundingBox(),i=this._isLeft?r.getTopLeft():r.getTopRight(),r=this._isLeft?r.getBottomLeft():r.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(i.getY())),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),a=this.getCodewords(),s=-1,l=i;l<o;l++)null!=a[l]&&((e=a[l]).setRowNumberAsRowIndicatorColumn(),0!=(n=e.getRowNumber()-s))&&(1!=n&&e.getRowNumber()>=t.getRowCount()?a[l]=null:s=e.getRowNumber())},Q0.prototype.getBarcodeMetadata=function(){var e,t,n=this.getCodewords(),r=new G0,i=new G0,o=new G0,a=new G0;try{for(var s=Z0(n),l=s.next();!l.done;l=s.next()){var u=l.value;if(null!=u){u.setRowNumberAsRowIndicatorColumn();var c=u.getValue()%30,h=u.getRowNumber();switch(this._isLeft||(h+=2),h%3){case 0:i.setValue(3*c+1);break;case 1:a.setValue(c/3),o.setValue(c%3);break;case 2:r.setValue(1+c)}}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return 0===r.getValue().length||0===i.getValue().length||0===o.getValue().length||0===a.getValue().length||r.getValue()[0]<1||i.getValue()[0]+o.getValue()[0]<m0.MIN_ROWS_IN_BARCODE||i.getValue()[0]+o.getValue()[0]>m0.MAX_ROWS_IN_BARCODE?null:(t=new B0(r.getValue()[0],i.getValue()[0],o.getValue()[0],a.getValue()[0]),this.removeIncorrectCodewords(n,t),t)},Q0.prototype.removeIncorrectCodewords=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(null!=t[n]){var i=r.getValue()%30,r=r.getRowNumber();if(r>e.getRowCount())t[n]=null;else switch(this._isLeft||(r+=2),r%3){case 0:3*i+1!==e.getRowCountUpperPart()&&(t[n]=null);break;case 1:Math.trunc(i/3)===e.getErrorCorrectionLevel()&&i%3===e.getRowCountLowerPart()||(t[n]=null);break;case 2:1+i!==e.getColumnCount()&&(t[n]=null)}}}},Q0.prototype.isLeft=function(){return this._isLeft},Q0.prototype.toString=function(){return"IsLeft: "+this._isLeft+"\n"+X0.prototype.toString.call(this)},Q0);function Q0(t,e){t=X0.call(this,t)||this;return t._isLeft=e,t}var J0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ty=(ey.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);for(var t,e=m0.MAX_CODEWORDS_IN_BARCODE;t=e,0<(e=this.adjustRowNumbersAndGetCount())&&e<t;);return this.detectionResultColumns},ey.prototype.adjustIndicatorColumnRowNumbers=function(t){null!=t&&t.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},ey.prototype.adjustRowNumbersAndGetCount=function(){var t=this.adjustRowNumbersByRow();if(0===t)return 0;for(var e=1;e<this.barcodeColumnCount+1;e++)for(var n=this.detectionResultColumns[e].getCodewords(),r=0;r<n.length;r++)null==n[r]||n[r].hasValidRowNumber()||this.adjustRowNumbers(e,r,n);return t},ey.prototype.adjustRowNumbersByRow=function(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()},ey.prototype.adjustRowNumbersFromBothRI=function(){if(null!=this.detectionResultColumns[0]&&null!=this.detectionResultColumns[this.barcodeColumnCount+1])for(var t=this.detectionResultColumns[0].getCodewords(),e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<t.length;n++)if(null!=t[n]&&null!=e[n]&&t[n].getRowNumber()===e[n].getRowNumber())for(var r=1;r<=this.barcodeColumnCount;r++){var i=this.detectionResultColumns[r].getCodewords()[n];null==i||(i.setRowNumber(t[n].getRowNumber()),i.hasValidRowNumber())||(this.detectionResultColumns[r].getCodewords()[n]=null)}},ey.prototype.adjustRowNumbersFromRRI=function(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;for(var t=0,e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(null!=e[n])for(var r=e[n].getRowNumber(),i=0,o=this.barcodeColumnCount+1;0<o&&i<this.ADJUST_ROW_NUMBER_SKIP;o--){var a=this.detectionResultColumns[o].getCodewords()[n];null!=a&&(i=ey.adjustRowNumberIfValid(r,i,a),a.hasValidRowNumber()||t++)}return t},ey.prototype.adjustRowNumbersFromLRI=function(){if(null==this.detectionResultColumns[0])return 0;for(var t=0,e=this.detectionResultColumns[0].getCodewords(),n=0;n<e.length;n++)if(null!=e[n])for(var r=e[n].getRowNumber(),i=0,o=1;o<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;o++){var a=this.detectionResultColumns[o].getCodewords()[n];null!=a&&(i=ey.adjustRowNumberIfValid(r,i,a),a.hasValidRowNumber()||t++)}return t},ey.adjustRowNumberIfValid=function(t,e,n){return null==n||n.hasValidRowNumber()||(n.isValidRowNumber(t)?(n.setRowNumber(t),e=0):++e),e},ey.prototype.adjustRowNumbers=function(t,e,n){var r,i;if(null!=this.detectionResultColumns[t-1]){var o=n[e],a=this.detectionResultColumns[t-1].getCodewords(),s=a,t=(null!=this.detectionResultColumns[t+1]&&(s=this.detectionResultColumns[t+1].getCodewords()),new Array(14));t[2]=a[e],t[3]=s[e],0<e&&(t[0]=n[e-1],t[4]=a[e-1],t[5]=s[e-1]),1<e&&(t[8]=n[e-2],t[10]=a[e-2],t[11]=s[e-2]),e<n.length-1&&(t[1]=n[e+1],t[6]=a[e+1],t[7]=s[e+1]),e<n.length-2&&(t[9]=n[e+2],t[12]=a[e+2],t[13]=s[e+2]);try{for(var l=J0(t),u=l.next();!u.done;u=l.next()){var c=u.value;if(ey.adjustRowNumber(o,c))return}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}},ey.adjustRowNumber=function(t,e){return null!=e&&!(!e.hasValidRowNumber()||e.getBucket()!==t.getBucket()||(t.setRowNumber(e.getRowNumber()),0))},ey.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},ey.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},ey.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},ey.prototype.setBoundingBox=function(t){this.boundingBox=t},ey.prototype.getBoundingBox=function(){return this.boundingBox},ey.prototype.setDetectionResultColumn=function(t,e){this.detectionResultColumns[t]=e},ey.prototype.getDetectionResultColumn=function(t){return this.detectionResultColumns[t]},ey.prototype.toString=function(){for(var t=this.detectionResultColumns[0],e=(null==t&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]),new F0),n=0;n<t.getCodewords().length;n++){e.format("CW %3d:",n);for(var r,i=0;i<this.barcodeColumnCount+2;i++)null==this.detectionResultColumns[i]?e.format("    |   "):null==(r=this.detectionResultColumns[i].getCodewords()[n])?e.format("    |   "):e.format(" %3d|%3d",r.getRowNumber(),r.getValue());e.format("%n")}return e.toString()},ey);function ey(t,e){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=e,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}ry.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},ry.prototype.isValidRowNumber=function(t){return t!==ry.BARCODE_ROW_UNKNOWN&&this.bucket===t%3*3},ry.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))},ry.prototype.getWidth=function(){return this.endX-this.startX},ry.prototype.getStartX=function(){return this.startX},ry.prototype.getEndX=function(){return this.endX},ry.prototype.getBucket=function(){return this.bucket},ry.prototype.getValue=function(){return this.value},ry.prototype.getRowNumber=function(){return this.rowNumber},ry.prototype.setRowNumber=function(t){this.rowNumber=t},ry.prototype.toString=function(){return this.rowNumber+"|"+this.value},ry.BARCODE_ROW_UNKNOWN=-1;var ny=ry;function ry(t,e,n,r){this.rowNumber=ry.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(t),this.endX=Math.trunc(e),this.bucket=Math.trunc(n),this.value=Math.trunc(r)}oy.initialize=function(){for(var t=0;t<m0.SYMBOL_TABLE.length;t++)for(var e=m0.SYMBOL_TABLE[t],n=1&e,r=0;r<m0.BARS_IN_MODULE;r++){for(var i=0;(1&e)===n;)i+=1,e>>=1;n=1&e,oy.RATIOS_TABLE[t]||(oy.RATIOS_TABLE[t]=new Array(m0.BARS_IN_MODULE)),oy.RATIOS_TABLE[t][m0.BARS_IN_MODULE-r-1]=Math.fround(i/m0.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},oy.getDecodedValue=function(t){var e=oy.getDecodedCodewordValue(oy.sampleBitCounts(t));return-1!==e?e:oy.getClosestDecodedValue(t)},oy.sampleBitCounts=function(t){for(var e=md.sum(t),n=new Int32Array(m0.BARS_IN_MODULE),r=0,i=0,o=0;o<m0.MODULES_IN_CODEWORD;o++){var a=e/(2*m0.MODULES_IN_CODEWORD)+o*e/m0.MODULES_IN_CODEWORD;i+t[r]<=a&&(i+=t[r],r++),n[r]++}return n},oy.getDecodedCodewordValue=function(t){t=oy.getBitValue(t);return-1===m0.getCodeword(t)?-1:t},oy.getBitValue=function(t){for(var e=0,n=0;n<t.length;n++)for(var r=0;r<t[n];r++)e=e<<1|(n%2==0?1:0);return Math.trunc(e)},oy.getClosestDecodedValue=function(t){var e=md.sum(t),n=new Array(m0.BARS_IN_MODULE);if(1<e)for(var r=0;r<n.length;r++)n[r]=Math.fround(t[r]/e);var i=vd.MAX_VALUE,o=-1;this.bSymbolTableReady||oy.initialize();for(var a=0;a<oy.RATIOS_TABLE.length;a++){for(var s=0,l=oy.RATIOS_TABLE[a],u=0;u<m0.BARS_IN_MODULE;u++){var c=Math.fround(l[u]-n[u]);if(i<=(s+=Math.fround(c*c)))break}s<i&&(i=s,o=m0.SYMBOL_TABLE[a])}return o},oy.bSymbolTableReady=!1,oy.RATIOS_TABLE=new Array(m0.SYMBOL_TABLE.length).map(function(t){return new Array(m0.BARS_IN_MODULE)});var iy=oy;function oy(){}sy.prototype.getSegmentIndex=function(){return this.segmentIndex},sy.prototype.setSegmentIndex=function(t){this.segmentIndex=t},sy.prototype.getFileId=function(){return this.fileId},sy.prototype.setFileId=function(t){this.fileId=t},sy.prototype.getOptionalData=function(){return this.optionalData},sy.prototype.setOptionalData=function(t){this.optionalData=t},sy.prototype.isLastSegment=function(){return this.lastSegment},sy.prototype.setLastSegment=function(t){this.lastSegment=t},sy.prototype.getSegmentCount=function(){return this.segmentCount},sy.prototype.setSegmentCount=function(t){this.segmentCount=t},sy.prototype.getSender=function(){return this.sender||null},sy.prototype.setSender=function(t){this.sender=t},sy.prototype.getAddressee=function(){return this.addressee||null},sy.prototype.setAddressee=function(t){this.addressee=t},sy.prototype.getFileName=function(){return this.fileName},sy.prototype.setFileName=function(t){this.fileName=t},sy.prototype.getFileSize=function(){return this.fileSize},sy.prototype.setFileSize=function(t){this.fileSize=t},sy.prototype.getChecksum=function(){return this.checksum},sy.prototype.setChecksum=function(t){this.checksum=t},sy.prototype.getTimestamp=function(){return this.timestamp},sy.prototype.setTimestamp=function(t){this.timestamp=t};var ay=sy;function sy(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}uy.parseLong=function(t,e){return void 0===e&&(e=void 0),parseInt(t,e)};var ly=uy;function uy(){}var cy=gy,hy=py=n;function dy(){this.constructor=cy}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(cy,hy),cy.prototype=null===hy?Object.create(hy):(dy.prototype=hy.prototype,new dy),gy.kind="NullPointerException";var py,fy=gy;function gy(){return null!==py&&py.apply(this,arguments)||this}function my(){}my.prototype.writeBytes=function(t){this.writeBytesOffset(t,0,t.length)},my.prototype.writeBytesOffset=function(t,e,n){if(null==t)throw new fy;if(e<0||e>t.length||n<0||e+n>t.length||e+n<0)throw new gc;if(0!==n)for(var r=0;r<n;r++)this.write(t[e+r])},my.prototype.flush=function(){},my.prototype.close=function(){},oo=my;var yy=Cy,vy=wy=n;function _y(){this.constructor=yy}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(yy,vy),yy.prototype=null===vy?Object.create(vy):(_y.prototype=vy.prototype,new _y);var wy,by=Cy;function Cy(){return null!==wy&&wy.apply(this,arguments)||this}var Ey=xy,Sy=Ay=oo;function Ty(){this.constructor=Ey}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Ey,Sy),Ey.prototype=null===Sy?Object.create(Sy):(Ty.prototype=Sy.prototype,new Ty),xy.prototype.ensureCapacity=function(t){0<t-this.buf.length&&this.grow(t)},xy.prototype.grow=function(t){var e=this.buf.length<<1;if((e=e-t<0?t:e)<0){if(t<0)throw new by;e=Ac.MAX_VALUE}this.buf=Sc.copyOfUint8Array(this.buf,e)},xy.prototype.write=function(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1},xy.prototype.writeBytesOffset=function(t,e,n){if(e<0||e>t.length||n<0||0<e+n-t.length)throw new gc;this.ensureCapacity(this.count+n),uc.arraycopy(t,e,this.buf,this.count,n),this.count+=n},xy.prototype.writeTo=function(t){t.writeBytesOffset(this.buf,0,this.count)},xy.prototype.reset=function(){this.count=0},xy.prototype.toByteArray=function(){return Sc.copyOfUint8Array(this.buf,this.count)},xy.prototype.size=function(){return this.count},xy.prototype.toString=function(t){return t?"string"==typeof t?this.toString_string(t):this.toString_number(t):this.toString_void()},xy.prototype.toString_void=function(){return new String(this.buf).toString()},xy.prototype.toString_string=function(t){return new String(this.buf).toString()},xy.prototype.toString_number=function(t){return new String(this.buf).toString()},xy.prototype.close=function(){};var Ay,Iy,Ly,ky=xy;function xy(t){void 0===t&&(t=32);var e=Ay.call(this)||this;if(t<(e.count=0))throw new Qu("Negative initial size: "+t);return e.buf=new Uint8Array(t),e}function Dy(){if("undefined"!=typeof window)return window.BigInt||null;if("undefined"!=typeof global)return global.BigInt||null;if("undefined"!=typeof self)return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}function Ny(t){if(null===(Ly=void 0===Ly?Dy():Ly))throw new Error("BigInt is not supported!");return Ly(t)}(e=Iy=Iy||{})[e.ALPHA=0]="ALPHA",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.PUNCT=3]="PUNCT",e[e.ALPHA_SHIFT=4]="ALPHA_SHIFT",e[e.PUNCT_SHIFT=5]="PUNCT_SHIFT",g.decode=function(t,e){for(var n=new Kc(""),r=Bc.ISO8859_1,i=(n.enableDecoding(r),1),o=t[i++],a=new ay;i<t[0];){switch(o){case g.TEXT_COMPACTION_MODE_LATCH:i=g.textCompaction(t,i,n);break;case g.BYTE_COMPACTION_MODE_LATCH:case g.BYTE_COMPACTION_MODE_LATCH_6:i=g.byteCompaction(o,t,r,i,n);break;case g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[i++]);break;case g.NUMERIC_COMPACTION_MODE_LATCH:i=g.numericCompaction(t,i,n);break;case g.ECI_CHARSET:Bc.getCharacterSetECIByValue(t[i++]);break;case g.ECI_GENERAL_PURPOSE:i+=2;break;case g.ECI_USER_DEFINED:i++;break;case g.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=g.decodeMacroBlock(t,i,a);break;case g.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case g.MACRO_PDF417_TERMINATOR:throw new A;default:i=g.textCompaction(t,--i,n)}if(!(i<t.length))throw A.getFormatInstance();o=t[i++]}if(0===n.length())throw A.getFormatInstance();e=new Oh(null,n.toString(),null,e);return e.setOther(a),e},g.decodeMacroBlock=function(t,e,n){if(e+g.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw A.getFormatInstance();for(var r=new Int32Array(g.NUMBER_OF_SEQUENCE_CODEWORDS),i=0;i<g.NUMBER_OF_SEQUENCE_CODEWORDS;i++,e++)r[i]=t[e];n.setSegmentIndex(Ac.parseInt(g.decodeBase900toBase10(r,g.NUMBER_OF_SEQUENCE_CODEWORDS)));var o,a=new Kc,a=(e=g.textCompaction(t,e,a),n.setFileId(a.toString()),-1);for(t[e]===g.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(a=e+1);e<t[0];)switch(t[e]){case g.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t[++e]){case g.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var s=new Kc;e=g.textCompaction(t,e+1,s),n.setFileName(s.toString());break;case g.MACRO_PDF417_OPTIONAL_FIELD_SENDER:s=new Kc;e=g.textCompaction(t,e+1,s),n.setSender(s.toString());break;case g.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var l=new Kc;e=g.textCompaction(t,e+1,l),n.setAddressee(l.toString());break;case g.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:l=new Kc;e=g.numericCompaction(t,e+1,l),n.setSegmentCount(Ac.parseInt(l.toString()));break;case g.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var u=new Kc;e=g.numericCompaction(t,e+1,u),n.setTimestamp(ly.parseLong(u.toString()));break;case g.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:u=new Kc;e=g.numericCompaction(t,e+1,u),n.setChecksum(Ac.parseInt(u.toString()));break;case g.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var c=new Kc;e=g.numericCompaction(t,e+1,c),n.setFileSize(ly.parseLong(c.toString()));break;default:throw A.getFormatInstance()}break;case g.MACRO_PDF417_TERMINATOR:e++,n.setLastSegment(!0);break;default:throw A.getFormatInstance()}return-1!==a&&(o=e-a,n.isLastSegment()&&o--,n.setOptionalData(Sc.copyOfRange(t,a,a+o))),e},g.textCompaction=function(t,e,n){for(var r=new Int32Array(2*(t[0]-e)),i=new Int32Array(2*(t[0]-e)),o=0,a=!1;e<t[0]&&!a;){var s=t[e++];if(s<g.TEXT_COMPACTION_MODE_LATCH)r[o]=s/30,r[o+1]=s%30,o+=2;else switch(s){case g.TEXT_COMPACTION_MODE_LATCH:r[o++]=g.TEXT_COMPACTION_MODE_LATCH;break;case g.BYTE_COMPACTION_MODE_LATCH:case g.BYTE_COMPACTION_MODE_LATCH_6:case g.NUMERIC_COMPACTION_MODE_LATCH:case g.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case g.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case g.MACRO_PDF417_TERMINATOR:e--,a=!0;break;case g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r[o]=g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,s=t[e++],i[o]=s,o++}}return g.decodeTextCompaction(r,i,o,n),e},g.decodeTextCompaction=function(t,e,n,r){for(var i=Iy.ALPHA,o=Iy.ALPHA,a=0;a<n;){var s=t[a],l="";switch(i){case Iy.ALPHA:if(s<26)l=String.fromCharCode(65+s);else switch(s){case 26:l=" ";break;case g.LL:i=Iy.LOWER;break;case g.ML:i=Iy.MIXED;break;case g.PS:o=i,i=Iy.PUNCT_SHIFT;break;case g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[a]);break;case g.TEXT_COMPACTION_MODE_LATCH:i=Iy.ALPHA}break;case Iy.LOWER:if(s<26)l=String.fromCharCode(97+s);else switch(s){case 26:l=" ";break;case g.AS:o=i,i=Iy.ALPHA_SHIFT;break;case g.ML:i=Iy.MIXED;break;case g.PS:o=i,i=Iy.PUNCT_SHIFT;break;case g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[a]);break;case g.TEXT_COMPACTION_MODE_LATCH:i=Iy.ALPHA}break;case Iy.MIXED:if(s<g.PL)l=g.MIXED_CHARS[s];else switch(s){case g.PL:i=Iy.PUNCT;break;case 26:l=" ";break;case g.LL:i=Iy.LOWER;break;case g.AL:i=Iy.ALPHA;break;case g.PS:o=i,i=Iy.PUNCT_SHIFT;break;case g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[a]);break;case g.TEXT_COMPACTION_MODE_LATCH:i=Iy.ALPHA}break;case Iy.PUNCT:if(s<g.PAL)l=g.PUNCT_CHARS[s];else switch(s){case g.PAL:i=Iy.ALPHA;break;case g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[a]);break;case g.TEXT_COMPACTION_MODE_LATCH:i=Iy.ALPHA}break;case Iy.ALPHA_SHIFT:if(i=o,s<26)l=String.fromCharCode(65+s);else switch(s){case 26:l=" ";break;case g.TEXT_COMPACTION_MODE_LATCH:i=Iy.ALPHA}break;case Iy.PUNCT_SHIFT:if(i=o,s<g.PAL)l=g.PUNCT_CHARS[s];else switch(s){case g.PAL:i=Iy.ALPHA;break;case g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[a]);break;case g.TEXT_COMPACTION_MODE_LATCH:i=Iy.ALPHA}}""!==l&&r.append(l),a++}},g.byteCompaction=function(t,e,n,r,i){var o=new ky,a=0,s=0,l=!1;switch(t){case g.BYTE_COMPACTION_MODE_LATCH:for(var u=new Int32Array(6),c=e[r++];r<e[0]&&!l;)switch(s=900*s+(u[a++]=c),c=e[r++]){case g.TEXT_COMPACTION_MODE_LATCH:case g.BYTE_COMPACTION_MODE_LATCH:case g.NUMERIC_COMPACTION_MODE_LATCH:case g.BYTE_COMPACTION_MODE_LATCH_6:case g.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case g.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case g.MACRO_PDF417_TERMINATOR:r--,l=!0;break;default:if(a%5==0&&0<a){for(var h=0;h<6;++h)o.write(Number(Ny(s)>>Ny(8*(5-h))));a=s=0}}r===e[0]&&c<g.TEXT_COMPACTION_MODE_LATCH&&(u[a++]=c);for(var d=0;d<a;d++)o.write(u[d]);break;case g.BYTE_COMPACTION_MODE_LATCH_6:for(;r<e[0]&&!l;){var p=e[r++];if(p<g.TEXT_COMPACTION_MODE_LATCH)a++,s=900*s+p;else switch(p){case g.TEXT_COMPACTION_MODE_LATCH:case g.BYTE_COMPACTION_MODE_LATCH:case g.NUMERIC_COMPACTION_MODE_LATCH:case g.BYTE_COMPACTION_MODE_LATCH_6:case g.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case g.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case g.MACRO_PDF417_TERMINATOR:r--,l=!0}if(a%5==0&&0<a){for(h=0;h<6;++h)o.write(Number(Ny(s)>>Ny(8*(5-h))));a=s=0}}}return i.append(qc.decode(o.toByteArray(),n)),r},g.numericCompaction=function(t,e,n){for(var r=0,i=!1,o=new Int32Array(g.MAX_NUMERIC_CODEWORDS);e<t[0]&&!i;){var a=t[e++];if(e===t[0]&&(i=!0),a<g.TEXT_COMPACTION_MODE_LATCH)o[r]=a,r++;else switch(a){case g.TEXT_COMPACTION_MODE_LATCH:case g.BYTE_COMPACTION_MODE_LATCH:case g.BYTE_COMPACTION_MODE_LATCH_6:case g.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case g.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case g.MACRO_PDF417_TERMINATOR:e--,i=!0}(r%g.MAX_NUMERIC_CODEWORDS==0||a===g.NUMERIC_COMPACTION_MODE_LATCH||i)&&0<r&&(n.append(g.decodeBase900toBase10(o,r)),r=0)}return e},g.decodeBase900toBase10=function(t,e){for(var n=Ny(0),r=0;r<e;r++)n+=g.EXP900[e-r-1]*Ny(t[r]);var i=n.toString();if("1"!==i.charAt(0))throw new A;return i.substring(1)},g.TEXT_COMPACTION_MODE_LATCH=900,g.BYTE_COMPACTION_MODE_LATCH=901,g.NUMERIC_COMPACTION_MODE_LATCH=902,g.BYTE_COMPACTION_MODE_LATCH_6=924,g.ECI_USER_DEFINED=925,g.ECI_GENERAL_PURPOSE=926,g.ECI_CHARSET=927,g.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,g.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,g.MACRO_PDF417_TERMINATOR=922,g.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,g.MAX_NUMERIC_CODEWORDS=15,g.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,g.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,g.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,g.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,g.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,g.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,g.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,g.PL=25,g.LL=27,g.AS=27,g.ML=28,g.AL=28,g.PS=29,g.PAL=29,g.PUNCT_CHARS=";<>@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'",g.MIXED_CHARS="0123456789&\r\t,:#-.$/+%*=^",g.EXP900=Dy()?(()=>{var t=[],e=(t[0]=Ny(1),Ny(900));t[1]=e;for(var n=2;n<16;n++)t[n]=t[n-1]*e;return t})():[],g.NUMBER_OF_SEQUENCE_CODEWORDS=2;var Ry=g;function g(){}var Py=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Oy=(P.decode=function(t,e,n,r,i,o,a){for(var s,l=new O0(t,e,n,r,i),u=null,c=null,h=!0;;h=!1){if(null!=e&&(u=P.getRowIndicatorColumn(t,l,e,!0,o,a)),null!=r&&(c=P.getRowIndicatorColumn(t,l,r,!1,o,a)),null==(s=P.merge(u,c)))throw I.getNotFoundInstance();var d=s.getBoundingBox();if(!h||null==d||!(d.getMinY()<l.getMinY()||d.getMaxY()>l.getMaxY()))break;l=d}s.setBoundingBox(l);for(var p=s.getBarcodeColumnCount()+1,f=(s.setDetectionResultColumn(0,u),s.setDetectionResultColumn(p,c),null!=u),g=1;g<=p;g++){var m=f?g:p-g;if(void 0===s.getDetectionResultColumn(m)){var y=void 0,y=0===m||m===p?new Y0(l,0===m):new z0(l);s.setDetectionResultColumn(m,y);for(var v=-1,_=v,w=l.getMinY();w<=l.getMaxY();w++){if((v=P.getStartColumn(s,m,w,f))<0||v>l.getMaxX()){if(-1===_)continue;v=_}var b=P.detectCodeword(t,l.getMinX(),l.getMaxX(),f,v,w,o,a);null!=b&&(y.setCodeword(w,b),_=v,o=Math.min(o,b.getWidth()),a=Math.max(a,b.getWidth()))}}}return P.createDecoderResult(s)},P.merge=function(t,e){var n;return null==t&&null==e||null==(n=P.getBarcodeMetadata(t,e))?null:(t=O0.merge(P.adjustBoundingBox(t),P.adjustBoundingBox(e)),new ty(n,t))},P.adjustBoundingBox=function(t){var e,n;if(null==t)return null;var r=t.getRowHeights();if(null==r)return null;var i=P.getMax(r),o=0;try{for(var a=Py(r),s=a.next();!s.done;s=a.next()){var l=s.value;if(o+=i-l,0<l)break}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}for(var u=t.getCodewords(),c=0;0<o&&null==u[c];c++)o--;for(var h=0,c=r.length-1;0<=c&&(h+=i-r[c],!(0<r[c]));c--);for(c=u.length-1;0<h&&null==u[c];c--)h--;return t.getBoundingBox().addMissingRows(o,h,t.isLeft())},P.getMax=function(t){var e,n,r=-1;try{for(var i=Py(t),o=i.next();!o.done;o=i.next())var a=o.value,r=Math.max(r,a)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},P.getBarcodeMetadata=function(t,e){return null==t||null==(t=t.getBarcodeMetadata())?null==e?null:e.getBarcodeMetadata():null!=e&&null!=(e=e.getBarcodeMetadata())&&t.getColumnCount()!==e.getColumnCount()&&t.getErrorCorrectionLevel()!==e.getErrorCorrectionLevel()&&t.getRowCount()!==e.getRowCount()?null:t},P.getRowIndicatorColumn=function(t,e,n,r,i,o){for(var a=new Y0(e,r),s=0;s<2;s++)for(var l=0===s?1:-1,u=Math.trunc(Math.trunc(n.getX())),c=Math.trunc(Math.trunc(n.getY()));c<=e.getMaxY()&&c>=e.getMinY();c+=l){var h=P.detectCodeword(t,0,t.getWidth(),r,u,c,i,o);null!=h&&(a.setCodeword(c,h),u=r?h.getStartX():h.getEndX())}return a},P.adjustCodewordCount=function(t,e){var e=e[0][1],n=e.getValue(),t=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-P.getNumberOfECCodeWords(t.getBarcodeECLevel());if(0===n.length){if(t<1||t>m0.MAX_CODEWORDS_IN_BARCODE)throw I.getNotFoundInstance();e.setValue(t)}else n[0]!==t&&e.setValue(t)},P.createDecoderResult=function(t){for(var e=P.createBarcodeMatrix(t),n=(P.adjustCodewordCount(t,e),new Array),r=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),i=[],o=new Array,a=0;a<t.getBarcodeRowCount();a++)for(var s=0;s<t.getBarcodeColumnCount();s++){var l=e[a][s+1].getValue(),u=a*t.getBarcodeColumnCount()+s;0===l.length?n.push(u):1===l.length?r[u]=l[0]:(o.push(u),i.push(l))}for(var c=new Array(i.length),h=0;h<c.length;h++)c[h]=i[h];return P.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),r,m0.toIntArray(n),m0.toIntArray(o),c)},P.createDecoderResultFromAmbiguousValues=function(t,e,n,r,i){for(var o=new Int32Array(r.length),a=100;0<a--;){for(var s=0;s<o.length;s++)e[r[s]]=i[s][o[s]];try{return P.decodeCodewords(e,t,n)}catch(t){if(!(t instanceof ac))throw t}if(0===o.length)throw ac.getChecksumInstance();for(s=0;s<o.length;s++){if(o[s]<i[s].length-1){o[s]++;break}if(o[s]=0,s===o.length-1)throw ac.getChecksumInstance()}}throw ac.getChecksumInstance()},P.createBarcodeMatrix=function(t){for(var e,n,r,i,o=Array.from({length:t.getBarcodeRowCount()},function(){return new Array(t.getBarcodeColumnCount()+2)}),a=0;a<o.length;a++)for(var s=0;s<o[a].length;s++)o[a][s]=new G0;var l=0;try{for(var u=Py(t.getDetectionResultColumns()),c=u.next();!c.done;c=u.next()){var h=c.value;if(null!=h)try{r=void 0;for(var d=Py(h.getCodewords()),p=d.next();!p.done;p=d.next()){var f,g=p.value;null!=g&&0<=(f=g.getRowNumber())&&(f>=o.length||o[f][l].setValue(g.getValue()))}}catch(t){r={error:t}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}l++}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return o},P.isValidBarcodeColumn=function(t,e){return 0<=e&&e<=t.getBarcodeColumnCount()+1},P.getStartColumn=function(t,e,n,r){var i,o,a=r?1:-1,s=null;if(null!=(s=P.isValidBarcodeColumn(t,e-a)?t.getDetectionResultColumn(e-a).getCodeword(n):s))return r?s.getEndX():s.getStartX();if(null!=(s=t.getDetectionResultColumn(e).getCodewordNearby(n)))return r?s.getStartX():s.getEndX();if(null!=(s=P.isValidBarcodeColumn(t,e-a)?t.getDetectionResultColumn(e-a).getCodewordNearby(n):s))return r?s.getEndX():s.getStartX();for(var l=0;P.isValidBarcodeColumn(t,e-a);){e-=a;try{i=void 0;for(var u=Py(t.getDetectionResultColumn(e).getCodewords()),c=u.next();!c.done;c=u.next()){var h=c.value;if(null!=h)return(r?h.getEndX():h.getStartX())+a*l*(h.getEndX()-h.getStartX())}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}l++}return r?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()},P.detectCodeword=function(t,e,n,r,i,o,a,s){i=P.adjustCodewordStartColumn(t,e,n,r,i,o);var l,u=P.getModuleBitCount(t,e,n,r,i,o);if(null==u)return null;t=md.sum(u);if(r)l=i+t;else{for(var c=0;c<u.length/2;c++){var h=u[c];u[c]=u[u.length-1-c],u[u.length-1-c]=h}i=(l=i)-t}return!P.checkCodewordSkew(t,a,s)||(e=iy.getDecodedValue(u),-1===(n=m0.getCodeword(e)))?null:new ny(i,l,P.getCodewordBucketNumber(e),n)},P.getModuleBitCount=function(t,e,n,r,i,o){for(var a=i,s=new Int32Array(8),l=0,u=r?1:-1,c=r;(r?a<n:e<=a)&&l<s.length;)t.get(a,o)===c?(s[l]++,a+=u):(l++,c=!c);return l===s.length||a===(r?n:e)&&l===s.length-1?s:null},P.getNumberOfECCodeWords=function(t){return 2<<t},P.adjustCodewordStartColumn=function(t,e,n,r,i,o){for(var a=i,s=r?-1:1,l=0;l<2;l++){for(;(r?e<=a:a<n)&&r===t.get(a,o);){if(Math.abs(i-a)>P.CODEWORD_SKEW_SIZE)return i;a+=s}s=-s,r=!r}return a},P.checkCodewordSkew=function(t,e,n){return e-P.CODEWORD_SKEW_SIZE<=t&&t<=n+P.CODEWORD_SKEW_SIZE},P.decodeCodewords=function(t,e,n){if(0===t.length)throw A.getFormatInstance();var r=1<<e+1,i=P.correctErrors(t,n,r),r=(P.verifyCodewordCount(t,r),Ry.decode(t,""+e));return r.setErrorsCorrected(i),r.setErasures(n.length),r},P.correctErrors=function(t,e,n){if(null!=e&&e.length>n/2+P.MAX_ERRORS||n<0||P.MAX_EC_CODEWORDS<n)throw ac.getChecksumInstance();return P.errorCorrection.decode(t,n,e)},P.verifyCodewordCount=function(t,e){if(t.length<4)throw A.getFormatInstance();var n=t[0];if(t.length<n)throw A.getFormatInstance();if(0===n){if(!(e<t.length))throw A.getFormatInstance();t[0]=t.length-e}},P.getBitCountForCodeword=function(t){for(var e=new Int32Array(8),n=0,r=e.length-1;!((1&t)!==n&&(n=1&t,--r<0));)e[r]++,t>>=1;return e},P.getCodewordBucketNumber=function(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)},P.getCodewordBucketNumber_number=function(t){return P.getCodewordBucketNumber(P.getBitCountForCodeword(t))},P.getCodewordBucketNumber_Int32Array=function(t){return(t[0]-t[2]+t[4]-t[6]+9)%9},P.toString=function(t){for(var e=new F0,n=0;n<t.length;n++){e.format("Row %2d: ",n);for(var r=0;r<t[n].length;r++){var i=t[n][r];0===i.getValue().length?e.format("        ",null):e.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}e.format("%n")}return e.toString()},P.CODEWORD_SKEW_SIZE=2,P.MAX_ERRORS=3,P.MAX_EC_CODEWORDS=512,P.errorCorrection=new t,P);function P(){}var My=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},By=(Uy.prototype.decode=function(t,e){t=Uy.decode(t,e=void 0===e?null:e,!1);if(null==t||0===t.length||null==t[0])throw I.getNotFoundInstance();return t[0]},Uy.prototype.decodeMultiple=function(t,e){void 0===e&&(e=null);try{return Uy.decode(t,e,!0)}catch(t){if(t instanceof A||t instanceof ac)throw I.getNotFoundInstance();throw t}},Uy.decode=function(t,e,n){var r,i,o=new Array,a=b0.detectMultiple(t,e,n);try{for(var s=My(a.getPoints()),l=s.next();!l.done;l=s.next()){var u=l.value,c=Oy.decode(a.getBits(),u[4],u[5],u[6],u[7],Uy.getMinCodewordWidth(u),Uy.getMaxCodewordWidth(u)),h=new Nh(c.getText(),c.getRawBytes(),void 0,u,k.PDF_417),d=(h.putMetadata(Ph.ERROR_CORRECTION_LEVEL,c.getECLevel()),c.getOther());null!=d&&h.putMetadata(Ph.PDF417_EXTRA_METADATA,d),o.push(h)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o.map(function(t){return t})},Uy.getMaxWidth=function(t,e){return null==t||null==e?0:Math.trunc(Math.abs(t.getX()-e.getX()))},Uy.getMinWidth=function(t,e){return null==t||null==e?Ac.MAX_VALUE:Math.trunc(Math.abs(t.getX()-e.getX()))},Uy.getMaxCodewordWidth=function(t){return Math.floor(Math.max(Math.max(Uy.getMaxWidth(t[0],t[4]),Uy.getMaxWidth(t[6],t[2])*m0.MODULES_IN_CODEWORD/m0.MODULES_IN_STOP_PATTERN),Math.max(Uy.getMaxWidth(t[1],t[5]),Uy.getMaxWidth(t[7],t[3])*m0.MODULES_IN_CODEWORD/m0.MODULES_IN_STOP_PATTERN)))},Uy.getMinCodewordWidth=function(t){return Math.floor(Math.min(Math.min(Uy.getMinWidth(t[0],t[4]),Uy.getMinWidth(t[6],t[2])*m0.MODULES_IN_CODEWORD/m0.MODULES_IN_STOP_PATTERN),Math.min(Uy.getMinWidth(t[1],t[5]),Uy.getMinWidth(t[7],t[3])*m0.MODULES_IN_CODEWORD/m0.MODULES_IN_STOP_PATTERN)))},Uy.prototype.reset=function(){},Uy);function Uy(){}var Fy=qy,Vy=zy=n;function Hy(){this.constructor=Fy}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Fy,Vy),Fy.prototype=null===Vy?Object.create(Vy):(Hy.prototype=Vy.prototype,new Hy),qy.kind="ReaderException";var zy,jy=qy;function qy(){return null!==zy&&zy.apply(this,arguments)||this}var Wy=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Gy=($y.prototype.decode=function(t,e){return this.setHints(e),this.decodeInternal(t)},$y.prototype.decodeWithState=function(t){return null==this.readers&&this.setHints(null),this.decodeInternal(t)},$y.prototype.setHints=function(t){var e,n=null!=(this.hints=t)&&void 0!==t.get(xc.TRY_HARDER),r=null==t?null:t.get(xc.POSSIBLE_FORMATS),i=new Array;null!=r&&((e=r.some(function(t){return t===k.UPC_A||t===k.UPC_E||t===k.EAN_13||t===k.EAN_8||t===k.CODABAR||t===k.CODE_39||t===k.CODE_93||t===k.CODE_128||t===k.ITF||t===k.RSS_14||t===k.RSS_EXPANDED}))&&!n&&i.push(new M1(t)),r.includes(k.QR_CODE)&&i.push(new p0),r.includes(k.DATA_MATRIX)&&i.push(new dm),r.includes(k.AZTEC)&&i.push(new $d),r.includes(k.PDF_417)&&i.push(new By),e)&&n&&i.push(new M1(t)),0===i.length&&(n||i.push(new M1(t)),i.push(new p0),i.push(new dm),i.push(new $d),i.push(new By),n)&&i.push(new M1(t)),this.readers=i},$y.prototype.reset=function(){var e,t;if(null!==this.readers)try{for(var n=Wy(this.readers),r=n.next();!r.done;r=n.next())r.value.reset()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},$y.prototype.decodeInternal=function(t){var e,n;if(null===this.readers)throw new jy("No readers where selected, nothing can be read.");try{for(var r=Wy(this.readers),i=r.next();!i.done;i=r.next()){var o=i.value;try{return o.decode(t,this.hints)}catch(t){[]instanceof jy}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}throw new I("No MultiFormat Readers were able to detect the code.")},$y);function $y(){}var Ky=ev,Xy=Yy=r;function Zy(){this.constructor=Ky}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Ky,Xy),Ky.prototype=null===Xy?Object.create(Xy):(Zy.prototype=Xy.prototype,new Zy),ev.prototype.decodeBitmap=function(t){return this.reader.decodeWithState(t)};var Yy,Qy,Jy,tv=ev;function ev(t,e){void 0===t&&(t=null),void 0===e&&(e=500);var n=new Gy;return n.setHints(t),Yy.call(this,n,e)||this}function nv(t){return void 0===t&&(t=500),Qy.call(this,new By,t)||this}var rv=nv,iv=Qy=r;function ov(){this.constructor=rv}function av(t){return void 0===t&&(t=500),Jy.call(this,new p0,t)||this}var sv=rv,lv=iv,uv=((Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(sv,lv),rv.prototype=null===iv?Object.create(iv):(ov.prototype=iv.prototype,new ov),av),o=Jy=r;function cv(){this.constructor=uv}var hv=uv,dv=o,pv=((Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(hv,dv),uv.prototype=null===o?Object.create(o):(cv.prototype=o.prototype,new cv),(p=Vv=Vv||{})[p.ERROR_CORRECTION=0]="ERROR_CORRECTION",p[p.CHARACTER_SET=1]="CHARACTER_SET",p[p.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",p[p.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",p[p.MIN_SIZE=4]="MIN_SIZE",p[p.MAX_SIZE=5]="MAX_SIZE",p[p.MARGIN=6]="MARGIN",p[p.PDF417_COMPACT=7]="PDF417_COMPACT",p[p.PDF417_COMPACTION=8]="PDF417_COMPACTION",p[p.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",p[p.AZTEC_LAYERS=10]="AZTEC_LAYERS",p[p.QR_VERSION=11]="QR_VERSION",p[p.GS1_FORMAT=12]="GS1_FORMAT",p[p.FORCE_C40=13]="FORCE_C40",Vv),fv=(gv.prototype.buildGenerator=function(t){var e=this.cachedGenerators;if(t>=e.length)for(var n=e[e.length-1],r=this.field,i=e.length;i<=t;i++){var o=n.multiply(new Fh(r,Int32Array.from([1,r.exp(i-1+r.getGeneratorBase())])));e.push(o),n=o}return e[t]},gv.prototype.encode=function(t,e){if(0===e)throw new Qu("No error correction bytes");var n=t.length-e;if(n<=0)throw new Qu("No data bytes provided");var r=this.buildGenerator(e),i=new Int32Array(n);uc.arraycopy(t,0,i,0,n);for(var i=new Fh(this.field,i).multiplyByMonomial(e,1).divide(r)[1].getCoefficients(),o=e-i.length,a=0;a<o;a++)t[n+a]=0;uc.arraycopy(i,0,t,n+o,i.length)},gv);function gv(t){this.field=t,this.cachedGenerators=[],this.cachedGenerators.push(new Fh(t,Int32Array.from([1])))}yv.applyMaskPenaltyRule1=function(t){return yv.applyMaskPenaltyRule1Internal(t,!0)+yv.applyMaskPenaltyRule1Internal(t,!1)},yv.applyMaskPenaltyRule2=function(t){for(var e=0,n=t.getArray(),r=t.getWidth(),i=t.getHeight(),o=0;o<i-1;o++)for(var a=n[o],s=0;s<r-1;s++){var l=a[s];l===a[s+1]&&l===n[o+1][s]&&l===n[o+1][s+1]&&e++}return yv.N2*e},yv.applyMaskPenaltyRule3=function(t){for(var e=0,n=t.getArray(),r=t.getWidth(),i=t.getHeight(),o=0;o<i;o++)for(var a=0;a<r;a++){var s=n[o];a+6<r&&1===s[a]&&0===s[a+1]&&1===s[a+2]&&1===s[a+3]&&1===s[a+4]&&0===s[a+5]&&1===s[a+6]&&(yv.isWhiteHorizontal(s,a-4,a)||yv.isWhiteHorizontal(s,a+7,a+11))&&e++,o+6<i&&1===n[o][a]&&0===n[o+1][a]&&1===n[o+2][a]&&1===n[o+3][a]&&1===n[o+4][a]&&0===n[o+5][a]&&1===n[o+6][a]&&(yv.isWhiteVertical(n,a,o-4,o)||yv.isWhiteVertical(n,a,o+7,o+11))&&e++}return e*yv.N3},yv.isWhiteHorizontal=function(t,e,n){e=Math.max(e,0),n=Math.min(n,t.length);for(var r=e;r<n;r++)if(1===t[r])return!1;return!0},yv.isWhiteVertical=function(t,e,n,r){n=Math.max(n,0),r=Math.min(r,t.length);for(var i=n;i<r;i++)if(1===t[i][e])return!1;return!0},yv.applyMaskPenaltyRule4=function(t){for(var e=0,n=t.getArray(),r=t.getWidth(),i=t.getHeight(),o=0;o<i;o++)for(var a=n[o],s=0;s<r;s++)1===a[s]&&e++;t=t.getHeight()*t.getWidth();return Math.floor(10*Math.abs(2*e-t)/t)*yv.N4},yv.getDataMaskBit=function(t,e,n){var r,i;switch(t){case 0:r=n+e&1;break;case 1:r=1&n;break;case 2:r=e%3;break;case 3:r=(n+e)%3;break;case 4:r=Math.floor(n/2)+Math.floor(e/3)&1;break;case 5:r=(1&(i=n*e))+i%3;break;case 6:r=(1&(i=n*e))+i%3&1;break;case 7:r=(i=n*e)%3+(n+e&1)&1;break;default:throw new Qu("Invalid mask pattern: "+t)}return 0===r},yv.applyMaskPenaltyRule1Internal=function(t,e){for(var n=0,r=e?t.getHeight():t.getWidth(),i=e?t.getWidth():t.getHeight(),o=t.getArray(),a=0;a<r;a++){for(var s=0,l=-1,u=0;u<i;u++){var c=e?o[a][u]:o[u][a];c===l?s++:(5<=s&&(n+=yv.N1+(s-5)),s=1,l=c)}5<=s&&(n+=yv.N1+(s-5))}return n},yv.N1=3,yv.N2=3,yv.N3=40,yv.N4=10;var mv=yv;function yv(){}var vv=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_v=(wv.prototype.getHeight=function(){return this.height},wv.prototype.getWidth=function(){return this.width},wv.prototype.get=function(t,e){return this.bytes[e][t]},wv.prototype.getArray=function(){return this.bytes},wv.prototype.setNumber=function(t,e,n){this.bytes[e][t]=n},wv.prototype.setBoolean=function(t,e,n){this.bytes[e][t]=n?1:0},wv.prototype.clear=function(t){var e,n;try{for(var r=vv(this.bytes),i=r.next();!i.done;i=r.next()){var o=i.value;Sc.fill(o,t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},wv.prototype.equals=function(t){if(!(t instanceof wv))return!1;var e=t;if(this.width!==e.width)return!1;if(this.height!==e.height)return!1;for(var n=0,r=this.height;n<r;++n)for(var i=this.bytes[n],o=e.bytes[n],a=0,s=this.width;a<s;++a)if(i[a]!==o[a])return!1;return!0},wv.prototype.toString=function(){for(var t=new Kc,e=0,n=this.height;e<n;++e){for(var r=this.bytes[e],i=0,o=this.width;i<o;++i)switch(r[i]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ")}t.append("\n")}return t.toString()},wv);function wv(t,e){this.width=t,this.height=e;for(var n=new Array(e),r=0;r!==e;r++)n[r]=new Uint8Array(t);this.bytes=n}Cv.prototype.getMode=function(){return this.mode},Cv.prototype.getECLevel=function(){return this.ecLevel},Cv.prototype.getVersion=function(){return this.version},Cv.prototype.getMaskPattern=function(){return this.maskPattern},Cv.prototype.getMatrix=function(){return this.matrix},Cv.prototype.toString=function(){var t=new Kc;return t.append("<<\n"),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append("\n ecLevel: "),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append("\n version: "),t.append(this.version?this.version.toString():"null"),t.append("\n maskPattern: "),t.append(this.maskPattern.toString()),this.matrix?(t.append("\n matrix:\n"),t.append(this.matrix.toString())):t.append("\n matrix: null\n"),t.append(">>\n"),t.toString()},Cv.prototype.setMode=function(t){this.mode=t},Cv.prototype.setECLevel=function(t){this.ecLevel=t},Cv.prototype.setVersion=function(t){this.version=t},Cv.prototype.setMaskPattern=function(t){this.maskPattern=t},Cv.prototype.setMatrix=function(t){this.matrix=t},Cv.isValidMaskPattern=function(t){return 0<=t&&t<Cv.NUM_MASK_PATTERNS},Cv.NUM_MASK_PATTERNS=8;var bv=Cv;function Cv(){this.maskPattern=-1}var Ev=Iv,p=Tv=n;function Sv(){this.constructor=Ev}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(Ev,p),Ev.prototype=null===p?Object.create(p):(Sv.prototype=p.prototype,new Sv),Iv.kind="WriterException";var Tv,Av=Iv;function Iv(){return null!==Tv&&Tv.apply(this,arguments)||this}O.clearMatrix=function(t){t.clear(255)},O.buildMatrix=function(t,e,n,r,i){O.clearMatrix(i),O.embedBasicPatterns(n,i),O.embedTypeInfo(e,r,i),O.maybeEmbedVersionInfo(n,i),O.embedDataBits(t,r,i)},O.embedBasicPatterns=function(t,e){O.embedPositionDetectionPatternsAndSeparators(e),O.embedDarkDotAtLeftBottomCorner(e),O.maybeEmbedPositionAdjustmentPatterns(t,e),O.embedTimingPatterns(e)},O.embedTypeInfo=function(t,e,n){var r=new Lc;O.makeTypeInfoBits(t,e,r);for(var i=0,o=r.getSize();i<o;++i){var a,s,l=r.get(r.getSize()-1-i),u=O.TYPE_INFO_COORDINATES[i],c=u[0];n.setBoolean(c,u[1],l),i<8?(a=n.getWidth()-i-1,n.setBoolean(a,s=8,l)):(a=8,s=n.getHeight()-7+(i-8),n.setBoolean(a,s,l))}},O.maybeEmbedVersionInfo=function(t,e){if(!(t.getVersionNumber()<7))for(var n=new Lc,r=(O.makeVersionInfoBits(t,n),17),i=0;i<6;++i)for(var o=0;o<3;++o){var a=n.get(r);r--,e.setBoolean(i,e.getHeight()-11+o,a),e.setBoolean(e.getHeight()-11+o,i,a)}},O.embedDataBits=function(t,e,n){for(var r=0,i=-1,o=n.getWidth()-1,a=n.getHeight()-1;0<o;){for(6===o&&--o;0<=a&&a<n.getHeight();){for(var s=0;s<2;++s){var l,u=o-s;O.isEmpty(n.get(u,a))&&(l=void 0,r<t.getSize()?(l=t.get(r),++r):l=!1,255!==e&&mv.getDataMaskBit(e,u,a)&&(l=!l),n.setBoolean(u,a,l))}a+=i}a+=i=-i,o-=2}if(r!==t.getSize())throw new Av("Not all bits consumed: "+r+"/"+t.getSize())},O.findMSBSet=function(t){return 32-Ac.numberOfLeadingZeros(t)},O.calculateBCHCode=function(t,e){if(0===e)throw new Qu("0 polynomial");var n=O.findMSBSet(e);for(t<<=n-1;O.findMSBSet(t)>=n;)t^=e<<O.findMSBSet(t)-n;return t},O.makeTypeInfoBits=function(t,e,n){if(!bv.isValidMaskPattern(e))throw new Av("Invalid mask pattern");t=t.getBits()<<3|e,n.appendBits(t,5),e=O.calculateBCHCode(t,O.TYPE_INFO_POLY),n.appendBits(e,10),t=new Lc;if(t.appendBits(O.TYPE_INFO_MASK_PATTERN,15),n.xor(t),15!==n.getSize())throw new Av("should not happen but we got: "+n.getSize())},O.makeVersionInfoBits=function(t,e){e.appendBits(t.getVersionNumber(),6);t=O.calculateBCHCode(t.getVersionNumber(),O.VERSION_INFO_POLY);if(e.appendBits(t,12),18!==e.getSize())throw new Av("should not happen but we got: "+e.getSize())},O.isEmpty=function(t){return 255===t},O.embedTimingPatterns=function(t){for(var e=8;e<t.getWidth()-8;++e){var n=(e+1)%2;O.isEmpty(t.get(e,6))&&t.setNumber(e,6,n),O.isEmpty(t.get(6,e))&&t.setNumber(6,e,n)}},O.embedDarkDotAtLeftBottomCorner=function(t){if(0===t.get(8,t.getHeight()-8))throw new Av;t.setNumber(8,t.getHeight()-8,1)},O.embedHorizontalSeparationPattern=function(t,e,n){for(var r=0;r<8;++r){if(!O.isEmpty(n.get(t+r,e)))throw new Av;n.setNumber(t+r,e,0)}},O.embedVerticalSeparationPattern=function(t,e,n){for(var r=0;r<7;++r){if(!O.isEmpty(n.get(t,e+r)))throw new Av;n.setNumber(t,e+r,0)}},O.embedPositionAdjustmentPattern=function(t,e,n){for(var r=0;r<5;++r)for(var i=O.POSITION_ADJUSTMENT_PATTERN[r],o=0;o<5;++o)n.setNumber(t+o,e+r,i[o])},O.embedPositionDetectionPattern=function(t,e,n){for(var r=0;r<7;++r)for(var i=O.POSITION_DETECTION_PATTERN[r],o=0;o<7;++o)n.setNumber(t+o,e+r,i[o])},O.embedPositionDetectionPatternsAndSeparators=function(t){var e=O.POSITION_DETECTION_PATTERN[0].length;O.embedPositionDetectionPattern(0,0,t),O.embedPositionDetectionPattern(t.getWidth()-e,0,t),O.embedPositionDetectionPattern(0,t.getWidth()-e,t),O.embedHorizontalSeparationPattern(0,7,t),O.embedHorizontalSeparationPattern(t.getWidth()-8,7,t),O.embedHorizontalSeparationPattern(0,t.getWidth()-8,t);O.embedVerticalSeparationPattern(7,0,t),O.embedVerticalSeparationPattern(t.getHeight()-7-1,0,t),O.embedVerticalSeparationPattern(7,t.getHeight()-7,t)},O.maybeEmbedPositionAdjustmentPatterns=function(t,e){if(!(t.getVersionNumber()<2))for(var t=t.getVersionNumber()-1,n=O.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[t],r=0,i=n.length;r!==i;r++){var o=n[r];if(0<=o)for(var a=0;a!==i;a++){var s=n[a];0<=s&&O.isEmpty(e.get(s,o))&&O.embedPositionAdjustmentPattern(s-2,o-2,e)}}},O.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),O.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),O.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),O.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),O.VERSION_INFO_POLY=7973,O.TYPE_INFO_POLY=1335,O.TYPE_INFO_MASK_PATTERN=21522;var Lv=O;function O(){}xv.prototype.getDataBytes=function(){return this.dataBytes},xv.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes};var kv=xv;function xv(t,e){this.dataBytes=t,this.errorCorrectionBytes=e}var Dv,Nv,Rv=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function Pv(){}function Ov(t,e,n,r,i,o,a,s){var l=Dv.call(this,o,a)||this;if(l.yuvData=t,l.dataWidth=e,l.dataHeight=n,l.left=r,l.top=i,e<r+o||n<i+a)throw new Qu("Crop rectangle does not fit within image data.");return s&&l.reverseHorizontal(o,a),l}Pv.calculateMaskPenalty=function(t){return mv.applyMaskPenaltyRule1(t)+mv.applyMaskPenaltyRule2(t)+mv.applyMaskPenaltyRule3(t)+mv.applyMaskPenaltyRule4(t)},Pv.encode=function(t,e,n){var r=Pv.DEFAULT_BYTE_MODE_ENCODING,i=null!==(n=void 0===n?null:n)&&void 0!==n.get(pv.CHARACTER_SET),o=(i&&(r=n.get(pv.CHARACTER_SET).toString()),this.chooseMode(t,r)),a=new Lc,i=(o!==Mm.BYTE||!i&&Pv.DEFAULT_BYTE_MODE_ENCODING===r||void 0!==(i=Bc.getCharacterSetECIByName(r))&&this.appendECI(i,a),this.appendModeInfo(o,a),new Lc);if(this.appendBytes(t,o,i,r),null!==n&&void 0!==n.get(pv.QR_VERSION)){var r=Number.parseInt(n.get(pv.QR_VERSION).toString(),10),s=Lm.getVersionForNumber(r),n=this.calculateBitsNeeded(o,a,i,s);if(!this.willFit(n,s,e))throw new Av("Data too big for requested version")}else s=this.recommendVersion(e,o,a,i);r=new Lc,r.appendBitArray(a),n=o===Mm.BYTE?i.getSizeInBytes():t.length,this.appendLengthInfo(n,s,o,r),r.appendBitArray(i),a=s.getECBlocksForLevel(e),t=s.getTotalCodewords()-a.getTotalECCodewords(),this.terminateBits(t,r),n=this.interleaveWithECBytes(r,s.getTotalCodewords(),t,a.getNumBlocks()),i=new bv,i.setECLevel(e),i.setMode(o),i.setVersion(s),r=s.getDimensionForVersion(),t=new _v(r,r),a=this.chooseMaskPattern(n,e,s,t);return i.setMaskPattern(a),Lv.buildMatrix(n,e,s,a,t),i.setMatrix(t),i},Pv.recommendVersion=function(t,e,n,r){var i=this.calculateBitsNeeded(e,n,r,Lm.getVersionForNumber(1)),i=this.chooseVersion(i,t),e=this.calculateBitsNeeded(e,n,r,i);return this.chooseVersion(e,t)},Pv.calculateBitsNeeded=function(t,e,n,r){return e.getSize()+t.getCharacterCountBits(r)+n.getSize()},Pv.getAlphanumericCode=function(t){return t<Pv.ALPHANUMERIC_TABLE.length?Pv.ALPHANUMERIC_TABLE[t]:-1},Pv.chooseMode=function(t,e){if(void 0===e&&(e=null),Bc.SJIS.getName()===e&&this.isOnlyDoubleByteKanji(t))return Mm.KANJI;for(var n=!1,r=!1,i=0,o=t.length;i<o;++i){var a=t.charAt(i);if(Pv.isDigit(a))n=!0;else{if(-1===this.getAlphanumericCode(a.charCodeAt(0)))return Mm.BYTE;r=!0}}return r?Mm.ALPHANUMERIC:n?Mm.NUMERIC:Mm.BYTE},Pv.isOnlyDoubleByteKanji=function(t){var e;try{e=qc.encode(t,Bc.SJIS)}catch(t){return!1}var n=e.length;if(n%2!=0)return!1;for(var r=0;r<n;r+=2){var i=255&e[r];if((i<129||159<i)&&(i<224||235<i))return!1}return!0},Pv.chooseMaskPattern=function(t,e,n,r){for(var i=Number.MAX_SAFE_INTEGER,o=-1,a=0;a<bv.NUM_MASK_PATTERNS;a++){Lv.buildMatrix(t,e,n,a,r);var s=this.calculateMaskPenalty(r);s<i&&(i=s,o=a)}return o},Pv.chooseVersion=function(t,e){for(var n=1;n<=40;n++){var r=Lm.getVersionForNumber(n);if(Pv.willFit(t,r,e))return r}throw new Av("Data too big")},Pv.willFit=function(t,e,n){return(t+7)/8<=e.getTotalCodewords()-e.getECBlocksForLevel(n).getTotalECCodewords()},Pv.terminateBits=function(t,e){var n=8*t;if(e.getSize()>n)throw new Av("data bits cannot fit in the QR Code"+e.getSize()+" > "+n);for(var r=0;r<4&&e.getSize()<n;++r)e.appendBit(!1);var i=7&e.getSize();if(0<i)for(r=i;r<8;r++)e.appendBit(!1);for(var o=t-e.getSizeInBytes(),r=0;r<o;++r)e.appendBits(0==(1&r)?236:17,8);if(e.getSize()!==n)throw new Av("Bits size does not equal capacity")},Pv.getNumDataBytesAndNumECBytesForBlockID=function(t,e,n,r,i,o){if(n<=r)throw new Av("Block ID too large");var a=t%n,s=n-a,l=Math.floor(t/n),u=l+1,e=Math.floor(e/n),c=e+1,l=l-e,u=u-c;if(l!=u)throw new Av("EC bytes mismatch");if(n!==s+a)throw new Av("RS blocks mismatch");if(t!==(e+l)*s+(c+u)*a)throw new Av("Total bytes mismatch");r<s?(i[0]=e,o[0]=l):(i[0]=c,o[0]=u)},Pv.interleaveWithECBytes=function(t,e,n,r){var i,o,a,s;if(t.getSizeInBytes()!==n)throw new Av("Number of bits and data bytes does not match");for(var l=0,u=0,c=0,h=new Array,d=0;d<r;++d){var p=new Int32Array(1),f=new Int32Array(1),g=(Pv.getNumDataBytesAndNumECBytesForBlockID(e,n,r,d,p,f),p[0]),m=new Uint8Array(g),y=(t.toBytes(8*l,m,0,g),Pv.generateECBytes(m,f[0]));h.push(new kv(m,y)),u=Math.max(u,g),c=Math.max(c,y.length),l+=p[0]}if(n!==l)throw new Av("Data bytes does not match offset");for(var v=new Lc,d=0;d<u;++d)try{i=void 0;for(var _=Rv(h),w=_.next();!w.done;w=_.next())d<(m=w.value.getDataBytes()).length&&v.appendBits(m[d],8)}catch(t){i={error:t}}finally{try{w&&!w.done&&(o=_.return)&&o.call(_)}finally{if(i)throw i.error}}for(d=0;d<c;++d)try{a=void 0;for(var b=Rv(h),C=b.next();!C.done;C=b.next())d<(y=C.value.getErrorCorrectionBytes()).length&&v.appendBits(y[d],8)}catch(t){a={error:t}}finally{try{C&&!C.done&&(s=b.return)&&s.call(b)}finally{if(a)throw a.error}}if(e!==v.getSizeInBytes())throw new Av("Interleaving error: "+e+" and "+v.getSizeInBytes()+" differ.");return v},Pv.generateECBytes=function(t,e){for(var n=t.length,r=new Int32Array(n+e),i=0;i<n;i++)r[i]=255&t[i];new fv(Yh.QR_CODE_FIELD_256).encode(r,e);for(var o=new Uint8Array(e),i=0;i<e;i++)o[i]=r[n+i];return o},Pv.appendModeInfo=function(t,e){e.appendBits(t.getBits(),4)},Pv.appendLengthInfo=function(t,e,n,r){n=n.getCharacterCountBits(e);if(1<<n<=t)throw new Av(t+" is bigger than "+((1<<n)-1));r.appendBits(t,n)},Pv.appendBytes=function(t,e,n,r){switch(e){case Mm.NUMERIC:Pv.appendNumericBytes(t,n);break;case Mm.ALPHANUMERIC:Pv.appendAlphanumericBytes(t,n);break;case Mm.BYTE:Pv.append8BitBytes(t,n,r);break;case Mm.KANJI:Pv.appendKanjiBytes(t,n);break;default:throw new Av("Invalid mode: "+e)}},Pv.getDigit=function(t){return t.charCodeAt(0)-48},Pv.isDigit=function(t){t=Pv.getDigit(t);return 0<=t&&t<=9},Pv.appendNumericBytes=function(t,e){for(var n=t.length,r=0;r<n;){var i,o,a=Pv.getDigit(t.charAt(r));r+2<n?(o=Pv.getDigit(t.charAt(r+1)),i=Pv.getDigit(t.charAt(r+2)),e.appendBits(100*a+10*o+i,10),r+=3):r+1<n?(o=Pv.getDigit(t.charAt(r+1)),e.appendBits(10*a+o,7),r+=2):(e.appendBits(a,4),r++)}},Pv.appendAlphanumericBytes=function(t,e){for(var n=t.length,r=0;r<n;){var i=Pv.getAlphanumericCode(t.charCodeAt(r));if(-1===i)throw new Av;if(r+1<n){var o=Pv.getAlphanumericCode(t.charCodeAt(r+1));if(-1===o)throw new Av;e.appendBits(45*i+o,11),r+=2}else e.appendBits(i,6),r++}},Pv.append8BitBytes=function(t,e,n){var r;try{r=qc.encode(t,n)}catch(t){throw new Av(t)}for(var i=0,o=r.length;i!==o;i++){var a=r[i];e.appendBits(a,8)}},Pv.appendKanjiBytes=function(t,e){var n;try{n=qc.encode(t,Bc.SJIS)}catch(t){throw new Av(t)}for(var r=n.length,i=0;i<r;i+=2){var o=(255&n[i])<<8&4294967295|255&n[i+1],a=-1;if(33088<=o&&o<=40956?a=o-33088:57408<=o&&o<=60351&&(a=o-49472),-1===a)throw new Av("Invalid byte sequence");e.appendBits(192*(a>>8)+(255&a),13)}},Pv.appendECI=function(t,e){e.appendBits(Mm.ECI.getBits(),4),e.appendBits(t.getValue(),8)},Pv.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Pv.DEFAULT_BYTE_MODE_ENCODING=Bc.UTF8.getName();var Mv=Ov,Bv=Dv=pe;function Uv(){this.constructor=Mv}function Fv(t,e,n,r,i,o,a){var s=Nv.call(this,e,n)||this;if(s.dataWidth=r,s.dataHeight=i,s.left=o,s.top=a,4===t.BYTES_PER_ELEMENT){for(var l=e*n,u=new Uint8ClampedArray(l),c=0;c<l;c++){var h=t[c];u[c]=((h>>16&255)+(h>>7&510)+(255&h))/4&255}s.luminances=u}else s.luminances=t;if(void 0===r&&(s.dataWidth=e),void 0===i&&(s.dataHeight=n),void 0===o&&(s.left=0),void 0===a&&(s.top=0),s.dataWidth<s.left+e||s.top+n>s.dataHeight)throw new Qu("Crop rectangle does not fit within image data.");return s}var Vv=Mv,n=Bv,Hv=((Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(Vv,n),Mv.prototype=null===Bv?Object.create(Bv):(Uv.prototype=Bv.prototype,new Uv),Ov.prototype.getRow=function(t,e){if(t<0||t>=this.getHeight())throw new Qu("Requested row is outside the image: "+t);var n=this.getWidth(),t=((null==e||e.length<n)&&(e=new Uint8ClampedArray(n)),(t+this.top)*this.dataWidth+this.left);return uc.arraycopy(this.yuvData,t,e,0,n),e},Ov.prototype.getMatrix=function(){var t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.yuvData;var n=t*e,r=new Uint8ClampedArray(n),i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)uc.arraycopy(this.yuvData,i,r,0,n);else for(var o=0;o<e;o++)uc.arraycopy(this.yuvData,i,r,o*t,t),i+=this.dataWidth;return r},Ov.prototype.isCropSupported=function(){return!0},Ov.prototype.crop=function(t,e,n,r){return new Ov(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+e,n,r,!1)},Ov.prototype.renderThumbnail=function(){for(var t=this.getWidth()/Ov.THUMBNAIL_SCALE_FACTOR,e=this.getHeight()/Ov.THUMBNAIL_SCALE_FACTOR,n=new Int32Array(t*e),r=this.yuvData,i=this.top*this.dataWidth+this.left,o=0;o<e;o++){for(var a=o*t,s=0;s<t;s++){var l=255&r[i+s*Ov.THUMBNAIL_SCALE_FACTOR];n[a+s]=4278190080|65793*l}i+=this.dataWidth*Ov.THUMBNAIL_SCALE_FACTOR}return n},Ov.prototype.getThumbnailWidth=function(){return this.getWidth()/Ov.THUMBNAIL_SCALE_FACTOR},Ov.prototype.getThumbnailHeight=function(){return this.getHeight()/Ov.THUMBNAIL_SCALE_FACTOR},Ov.prototype.reverseHorizontal=function(t,e){for(var n=this.yuvData,r=0,i=this.top*this.dataWidth+this.left;r<e;r++,i+=this.dataWidth)for(var o=i+t/2,a=i,s=i+t-1;a<o;a++,s--){var l=n[a];n[a]=n[s],n[s]=l}},Ov.prototype.invert=function(){return new _h(this)},Ov.THUMBNAIL_SCALE_FACTOR=2,Fv),i=Nv=pe;function zv(){this.constructor=Hv}var p=Hv,Vv=i,jv=((Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(p,Vv),Hv.prototype=null===i?Object.create(i):(zv.prototype=i.prototype,new zv),Fv.prototype.getRow=function(t,e){if(t<0||t>=this.getHeight())throw new Qu("Requested row is outside the image: "+t);var n=this.getWidth(),t=((null==e||e.length<n)&&(e=new Uint8ClampedArray(n)),(t+this.top)*this.dataWidth+this.left);return uc.arraycopy(this.luminances,t,e,0,n),e},Fv.prototype.getMatrix=function(){var t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.luminances;var n=t*e,r=new Uint8ClampedArray(n),i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)uc.arraycopy(this.luminances,i,r,0,n);else for(var o=0;o<e;o++)uc.arraycopy(this.luminances,i,r,o*t,t),i+=this.dataWidth;return r},Fv.prototype.isCropSupported=function(){return!0},Fv.prototype.crop=function(t,e,n,r){return new Fv(this.luminances,n,r,this.dataWidth,this.dataHeight,this.left+t,this.top+e)},Fv.prototype.invert=function(){return new _h(this)},$v),n=Wv=Bc;function qv(){this.constructor=jv}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(jv,n),jv.prototype=null===n?Object.create(n):(qv.prototype=n.prototype,new qv),$v.forName=function(t){return this.getCharacterSetECIByName(t)};var Wv,Gv=$v;function $v(){return null!==Wv&&Wv.apply(this,arguments)||this}Xv.ISO_8859_1=Bc.ISO8859_1;var Kv=Xv;function Xv(){}((t,e)=>{for(var n=1,r=0;r<255;r++)t[e[r]=n]=r,256<=(n*=2)&&(n^=301);return{LOG:t,ALOG:e}})([],[]).LOG;var Zv="[)>05",Yv="[)>06",Qv=(Jv.prototype.getEncodingMode=function(){return 0},Jv.prototype.encode=function(t){if(2<=A2.determineConsecutiveDigitCount(t.getMessage(),t.pos))t.writeCodeword(this.encodeASCIIDigits(t.getMessage().charCodeAt(t.pos),t.getMessage().charCodeAt(t.pos+1))),t.pos+=2;else{var e=t.getCurrentChar(),n=A2.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(n!==this.getEncodingMode())switch(n){case 5:return t.writeCodeword(231),void t.signalEncoderChange(5);case 1:return t.writeCodeword(230),void t.signalEncoderChange(1);case 3:t.writeCodeword(238),t.signalEncoderChange(3);break;case 2:t.writeCodeword(239),t.signalEncoderChange(2);break;case 4:t.writeCodeword(240),t.signalEncoderChange(4);break;default:throw new Error("Illegal mode: "+n)}else A2.isExtendedASCII(e)?(t.writeCodeword(235),t.writeCodeword(e-128+1)):t.writeCodeword(e+1),t.pos++}},Jv.prototype.encodeASCIIDigits=function(t,e){if(A2.isDigit(t)&&A2.isDigit(e))return 130+(10*(t-48)+(e-48));throw new Error("not digits: "+t+e)},Jv);function Jv(){}e2.prototype.getEncodingMode=function(){return 5},e2.prototype.encode=function(t){var e=new Kc;for(e.append(0);t.hasMoreCharacters();){var n=t.getCurrentChar();if(e.append(n),t.pos++,A2.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode())!==this.getEncodingMode()){t.signalEncoderChange(0);break}}var r=e.length()-1,i=t.getCodewordCount()+r+1,i=(t.updateSymbolInfo(i),0<t.getSymbolInfo().getDataCapacity()-i);if(t.hasMoreCharacters()||i)if(r<=249)e.setCharAt(0,Gc.getCharAt(r));else{if(!(r<=1555))throw new Error("Message length not in valid ranges: "+r);e.setCharAt(0,Gc.getCharAt(Math.floor(r/250)+249)),e.insert(1,Gc.getCharAt(r%250))}for(var o=0,n=e.length();o<n;o++)t.writeCodeword(this.randomize255State(e.charAt(o).charCodeAt(0),t.getCodewordCount()+1))},e2.prototype.randomize255State=function(t,e){t+=149*e%255+1;return t<=255?t:t-256};var t2=e2;function e2(){}r2.prototype.getEncodingMode=function(){return 1},r2.prototype.encodeMaximal=function(t){for(var e,n,r=new Kc,i=0,o=t.pos,a=0;t.hasMoreCharacters();){var s=t.getCurrentChar();t.pos++,i=this.encodeChar(s,r),r.length()%3==0&&(o=t.pos,a=r.length())}a!==r.length()&&(e=Math.floor(r.length()/3*2),e=Math.floor(t.getCodewordCount()+e+1),t.updateSymbolInfo(e),e=t.getSymbolInfo().getDataCapacity()-e,2===(n=Math.floor(r.length()%3))&&2!=e||1===n&&(3<i||1!=e))&&(t.pos=o),0<r.length()&&t.writeCodeword(230),this.handleEOD(t,r)},r2.prototype.encode=function(t){for(var e=new Kc;t.hasMoreCharacters();){var n=t.getCurrentChar(),r=(t.pos++,this.encodeChar(n,e)),n=2*Math.floor(e.length()/3),n=t.getCodewordCount()+n,i=(t.updateSymbolInfo(n),t.getSymbolInfo().getDataCapacity()-n);if(!t.hasMoreCharacters()){var o=new Kc;for(e.length()%3==2&&2!=i&&(r=this.backtrackOneCharacter(t,e,o,r));e.length()%3==1&&(3<r||1!=i);)r=this.backtrackOneCharacter(t,e,o,r);break}n=e.length();if(n%3==0)if(A2.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode())!==this.getEncodingMode()){t.signalEncoderChange(0);break}}this.handleEOD(t,e)},r2.prototype.backtrackOneCharacter=function(t,e,n,r){var i=e.length(),i=e.toString().substring(0,i-r),e=(e.setLengthToZero(),e.append(i),t.pos--,t.getCurrentChar());return r=this.encodeChar(e,n),t.resetSymbolInfo(),r},r2.prototype.writeNextTriplet=function(t,e){t.writeCodewords(this.encodeToCodewords(e.toString()));t=e.toString().substring(3);e.setLengthToZero(),e.append(t)},r2.prototype.handleEOD=function(t,e){var n=Math.floor(e.length()/3*2),r=e.length()%3,n=t.getCodewordCount()+n,n=(t.updateSymbolInfo(n),t.getSymbolInfo().getDataCapacity()-n);if(2==r){for(e.append("\0");3<=e.length();)this.writeNextTriplet(t,e);t.hasMoreCharacters()&&t.writeCodeword(254)}else if(1==n&&1==r){for(;3<=e.length();)this.writeNextTriplet(t,e);t.hasMoreCharacters()&&t.writeCodeword(254),t.pos--}else{if(0!=r)throw new Error("Unexpected case. Please report!");for(;3<=e.length();)this.writeNextTriplet(t,e);(0<n||t.hasMoreCharacters())&&t.writeCodeword(254)}t.signalEncoderChange(0)},r2.prototype.encodeChar=function(t,e){if(t===" ".charCodeAt(0))return e.append(3),1;if(t>="0".charCodeAt(0)&&t<="9".charCodeAt(0))return e.append(t-48+4),1;if(t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0))return e.append(t-65+14),1;if(t<" ".charCodeAt(0))return e.append(0),e.append(t),2;if(t<="/".charCodeAt(0))return e.append(1),e.append(t-33),2;if(t<="@".charCodeAt(0))return e.append(1),e.append(t-58+15),2;if(t<="_".charCodeAt(0))return e.append(1),e.append(t-91+22),2;if(t<=127)return e.append(2),e.append(t-96),2;e.append("1");var n=2;return n+=this.encodeChar(t-128,e)},r2.prototype.encodeToCodewords=function(t){var t=1600*t.charCodeAt(0)+40*t.charCodeAt(1)+t.charCodeAt(2)+1,e=t/256,t=t%256,n=new Kc;return n.append(e),n.append(t),n.toString()};var n2=r2;function r2(){}o2.prototype.getEncodingMode=function(){return 4},o2.prototype.encode=function(t){for(var e=new Kc;t.hasMoreCharacters();){var n=t.getCurrentChar();if(this.encodeChar(n,e),t.pos++,4<=e.length()){t.writeCodewords(this.encodeToCodewords(e.toString()));n=e.toString().substring(4);if(e.setLengthToZero(),e.append(n),A2.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode())!==this.getEncodingMode()){t.signalEncoderChange(0);break}}}e.append(Gc.getCharAt(31)),this.handleEOD(t,e)},o2.prototype.handleEOD=function(t,e){try{var n=e.length();if(0!==n){if(1===n){t.updateSymbolInfo();var r=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount(),i=t.getRemainingCharacters();if(r<i&&(t.updateSymbolInfo(t.getCodewordCount()+1),r=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount()),i<=r&&r<=2)return}if(4<n)throw new Error("Count must not exceed 4");var o=n-1,a=this.encodeToCodewords(e.toString()),s=!t.hasMoreCharacters()&&o<=2;o<=2&&(t.updateSymbolInfo(t.getCodewordCount()+o),3<=(r=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount()))&&(s=!1,t.updateSymbolInfo(t.getCodewordCount()+a.length)),s?(t.resetSymbolInfo(),t.pos-=o):t.writeCodewords(a)}}finally{t.signalEncoderChange(0)}},o2.prototype.encodeChar=function(t,e){t>=" ".charCodeAt(0)&&t<="?".charCodeAt(0)?e.append(t):t>="@".charCodeAt(0)&&t<="^".charCodeAt(0)?e.append(Gc.getCharAt(t-64)):A2.illegalCharacter(Gc.getCharAt(t))},o2.prototype.encodeToCodewords=function(t){var e=t.length;if(0===e)throw new Error("StringBuilder must not be empty");var t=(t.charAt(0).charCodeAt(0)<<18)+((2<=e?t.charAt(1).charCodeAt(0):0)<<12)+((3<=e?t.charAt(2).charCodeAt(0):0)<<6)+(4<=e?t.charAt(3).charCodeAt(0):0),n=t>>16&255,r=t>>8&255,t=255&t,i=new Kc;return i.append(n),2<=e&&i.append(r),3<=e&&i.append(t),i.toString()};var i2=o2;function o2(){}a2=function(t,e){return(a2=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)};var a2,l=function(t,e){function n(){this.constructor=t}a2(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s2=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l2=(u2.lookup=function(t,e,n,r,i){var o,a;void 0===e&&(e=0),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0);try{for(var s=s2(d2),l=s.next();!l.done;l=s.next()){var u=l.value;if((1!==e||!u.rectangular)&&((2!==e||u.rectangular)&&(null==n||!(u.getSymbolWidth()<n.getWidth()||u.getSymbolHeight()<n.getHeight()))&&(null==r||!(u.getSymbolWidth()>r.getWidth()||u.getSymbolHeight()>r.getHeight()))&&t<=u.dataCapacity))return u}}catch(t){o={error:t}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}if(i)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+t);return null},u2.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},u2.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},u2.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},u2.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},u2.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+2*this.getHorizontalDataRegions()},u2.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+2*this.getVerticalDataRegions()},u2.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},u2.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},u2.prototype.getDataCapacity=function(){return this.dataCapacity},u2.prototype.getErrorCodewords=function(){return this.errorCodewords},u2.prototype.getDataLengthForInterleavedBlock=function(t){return this.rsBlockData},u2.prototype.getErrorLengthForInterleavedBlock=function(t){return this.rsBlockError},u2);function u2(t,e,n,r,i,o,a,s){void 0===a&&(a=0),void 0===s&&(s=0),this.rectangular=t,this.dataCapacity=e,this.errorCodewords=n,this.matrixWidth=r,this.matrixHeight=i,this.dataRegions=o,this.rsBlockData=a,this.rsBlockError=s}l(h2,c2=l2),h2.prototype.getInterleavedBlockCount=function(){return 10},h2.prototype.getDataLengthForInterleavedBlock=function(t){return t<=8?156:155};var c2,u=h2;function h2(){return c2.call(this,!1,1558,620,22,22,36,-1,62)||this}var d2=[new l2(!1,3,5,8,8,1),new l2(!1,5,7,10,10,1),new l2(!0,5,7,16,6,1),new l2(!1,8,10,12,12,1),new l2(!0,10,11,14,6,2),new l2(!1,12,12,14,14,1),new l2(!0,16,14,24,10,1),new l2(!1,18,14,16,16,1),new l2(!1,22,18,18,18,1),new l2(!0,22,18,16,10,2),new l2(!1,30,20,20,20,1),new l2(!0,32,24,16,14,2),new l2(!1,36,24,22,22,1),new l2(!1,44,28,24,24,1),new l2(!0,49,28,22,14,2),new l2(!1,62,36,14,14,4),new l2(!1,86,42,16,16,4),new l2(!1,114,48,18,18,4),new l2(!1,144,56,20,20,4),new l2(!1,174,68,22,22,4),new l2(!1,204,84,24,24,4,102,42),new l2(!1,280,112,14,14,16,140,56),new l2(!1,368,144,16,16,16,92,36),new l2(!1,456,192,18,18,16,114,48),new l2(!1,576,224,20,20,16,144,56),new l2(!1,696,272,22,22,16,174,68),new l2(!1,816,336,24,24,16,136,56),new l2(!1,1050,408,18,18,36,175,68),new l2(!1,1304,496,20,20,36,163,62),new u],p2=(f2.prototype.setSymbolShape=function(t){this.shape=t},f2.prototype.setSizeConstraints=function(t,e){this.minSize=t,this.maxSize=e},f2.prototype.getMessage=function(){return this.msg},f2.prototype.setSkipAtEnd=function(t){this.skipAtEnd=t},f2.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},f2.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},f2.prototype.getCodewords=function(){return this.codewords},f2.prototype.writeCodewords=function(t){this.codewords.append(t)},f2.prototype.writeCodeword=function(t){this.codewords.append(t)},f2.prototype.getCodewordCount=function(){return this.codewords.length()},f2.prototype.getNewEncoding=function(){return this.newEncoding},f2.prototype.signalEncoderChange=function(t){this.newEncoding=t},f2.prototype.resetEncoderSignal=function(){this.newEncoding=-1},f2.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},f2.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},f2.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},f2.prototype.getSymbolInfo=function(){return this.symbolInfo},f2.prototype.updateSymbolInfo=function(t){void 0===t&&(t=this.getCodewordCount()),(null==this.symbolInfo||t>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=l2.lookup(t,this.shape,this.minSize,this.maxSize,!0))},f2.prototype.resetSymbolInfo=function(){this.symbolInfo=null},f2);function f2(t){this.msg=t,this.pos=0,this.skipAtEnd=0;for(var e=t.split("").map(function(t){return t.charCodeAt(0)}),n=new Kc,r=0,i=e.length;r<i;r++){var o=String.fromCharCode(255&e[r]);if("?"===o&&"?"!==t.charAt(r))throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new Kc,this.newEncoding=-1}var g2=_2,Bv=y2=n2;function m2(){this.constructor=g2}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(g2,Bv),g2.prototype=null===Bv?Object.create(Bv):(m2.prototype=Bv.prototype,new m2),_2.prototype.getEncodingMode=function(){return 3},_2.prototype.encode=function(t){for(var e=new Kc;t.hasMoreCharacters();){var n=t.getCurrentChar(),n=(t.pos++,this.encodeChar(n,e),e.length());if(n%3==0)if(this.writeNextTriplet(t,e),A2.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode())!==this.getEncodingMode()){t.signalEncoderChange(0);break}}this.handleEOD(t,e)},_2.prototype.encodeChar=function(t,e){switch(t){case 13:e.append(0);break;case"*".charCodeAt(0):e.append(1);break;case">".charCodeAt(0):e.append(2);break;case" ".charCodeAt(0):e.append(3);break;default:t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)?e.append(t-48+4):t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)?e.append(t-65+14):A2.illegalCharacter(Gc.getCharAt(t))}return 1},_2.prototype.handleEOD=function(t,e){t.updateSymbolInfo();var n=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount(),e=e.length();t.pos-=e,(1<t.getRemainingCharacters()||1<n||t.getRemainingCharacters()!==n)&&t.writeCodeword(254),t.getNewEncoding()<0&&t.signalEncoderChange(0)};var y2,v2=_2;function _2(){return null!==y2&&y2.apply(this,arguments)||this}var w2=S2,p=C2=n2;function b2(){this.constructor=w2}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(w2,p),w2.prototype=null===p?Object.create(p):(b2.prototype=p.prototype,new b2),S2.prototype.getEncodingMode=function(){return 2},S2.prototype.encodeChar=function(t,e){if(t===" ".charCodeAt(0))return e.append(3),1;if(t>="0".charCodeAt(0)&&t<="9".charCodeAt(0))return e.append(t-48+4),1;if(t>="a".charCodeAt(0)&&t<="z".charCodeAt(0))return e.append(t-97+14),1;if(t<" ".charCodeAt(0))return e.append(0),e.append(t),2;if(t<="/".charCodeAt(0))return e.append(1),e.append(t-33),2;if(t<="@".charCodeAt(0))return e.append(1),e.append(t-58+15),2;if(t>="[".charCodeAt(0)&&t<="_".charCodeAt(0))return e.append(1),e.append(t-91+22),2;if(t==="`".charCodeAt(0))return e.append(2),e.append(0),2;if(t<="Z".charCodeAt(0))return e.append(2),e.append(t-65+1),2;if(t<=127)return e.append(2),e.append(t-123+27),2;e.append("1");var n=2;return n+=this.encodeChar(t-128,e)};var C2,E2=S2;function S2(){return null!==C2&&C2.apply(this,arguments)||this}function T2(){}T2.randomize253State=function(t){t=129+(149*t%253+1);return t<=254?t:t-254},T2.encodeHighLevel=function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!1);var o=new n2,a=[new Qv,o,new E2,new v2,new i2,new t2],s=new p2(t),l=(s.setSymbolShape(e),s.setSizeConstraints(n,r),t.startsWith(Zv)&&t.endsWith("")?(s.writeCodeword(236),s.setSkipAtEnd(2),s.pos+=Zv.length):t.startsWith(Yv)&&t.endsWith("")&&(s.writeCodeword(237),s.setSkipAtEnd(2),s.pos+=Yv.length),0);for(i&&(o.encodeMaximal(s),l=s.getNewEncoding(),s.resetEncoderSignal());s.hasMoreCharacters();)a[l].encode(s),0<=s.getNewEncoding()&&(l=s.getNewEncoding(),s.resetEncoderSignal());var e=s.getCodewordCount(),u=(s.updateSymbolInfo(),s.getSymbolInfo().getDataCapacity()),c=(e<u&&0!==l&&5!==l&&4!==l&&s.writeCodeword("Ã¾"),s.getCodewords());for(c.length()<u&&c.append(129);c.length()<u;)c.append(this.randomize253State(c.length()+1));return s.getCodewords().toString()},T2.lookAheadTest=function(t,e,n){var r=this.lookAheadTestIntern(t,e,n);if(3===n&&3===r){for(var i=Math.min(e+3,t.length),o=e;o<i;o++)if(!this.isNativeX12(t.charCodeAt(o)))return 0}else if(4===n&&4===r)for(i=Math.min(e+4,t.length),o=e;o<i;o++)if(!this.isNativeEDIFACT(t.charCodeAt(o)))return 0;return r},T2.lookAheadTestIntern=function(t,e,n){if(e>=t.length)return n;0===n?r=[0,1,1,1,1,1.25]:(r=[1,2,2,2,2,2.25])[n]=0;for(var r,i=0,o=new Uint8Array(6),a=[];;){if(e+i===t.length){Sc.fill(o,0),Sc.fill(a,0);var s=this.findMinimums(r,a,Ac.MAX_VALUE,o),l=this.getMinimumCount(o);if(a[0]===s)return 0;if(1===l){if(0<o[5])return 5;if(0<o[4])return 4;if(0<o[2])return 2;if(0<o[3])return 3}return 1}s=t.charCodeAt(e+i);if(i++,this.isDigit(s)?r[0]+=.5:this.isExtendedASCII(s)?(r[0]=Math.ceil(r[0]),r[0]+=2):(r[0]=Math.ceil(r[0]),r[0]++),this.isNativeC40(s)?r[1]+=2/3:this.isExtendedASCII(s)?r[1]+=8/3:r[1]+=4/3,this.isNativeText(s)?r[2]+=2/3:this.isExtendedASCII(s)?r[2]+=8/3:r[2]+=4/3,this.isNativeX12(s)?r[3]+=2/3:this.isExtendedASCII(s)?r[3]+=13/3:r[3]+=10/3,this.isNativeEDIFACT(s)?r[4]+=.75:this.isExtendedASCII(s)?r[4]+=4.25:r[4]+=3.25,this.isSpecialB256(s)?r[5]+=4:r[5]++,4<=i){if(Sc.fill(o,0),Sc.fill(a,0),this.findMinimums(r,a,Ac.MAX_VALUE,o),a[0]<this.min(a[5],a[1],a[2],a[3],a[4]))return 0;if(a[5]<a[0]||a[5]+1<this.min(a[1],a[2],a[3],a[4]))return 5;if(a[4]+1<this.min(a[5],a[1],a[2],a[3],a[0]))return 4;if(a[2]+1<this.min(a[5],a[1],a[4],a[3],a[0]))return 2;if(a[3]+1<this.min(a[5],a[1],a[4],a[2],a[0]))return 3;if(a[1]+1<this.min(a[0],a[5],a[4],a[2])){if(a[1]<a[3])return 1;if(a[1]===a[3]){for(var u=e+i+1;u<t.length;){var c=t.charCodeAt(u);if(this.isX12TermSep(c))return 3;if(!this.isNativeX12(c))break;u++}return 1}}}}},T2.min=function(t,e,n,r,i){t=Math.min(t,Math.min(e,Math.min(n,r)));return void 0===i?t:Math.min(t,i)},T2.findMinimums=function(t,e,n,r){for(var i=0;i<6;i++){var o=e[i]=Math.ceil(t[i]);o<n&&(n=o,Sc.fill(r,0)),n===o&&(r[i]=r[i]+1)}return n},T2.getMinimumCount=function(t){for(var e=0,n=0;n<6;n++)e+=t[n];return e||0},T2.isDigit=function(t){return t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)},T2.isExtendedASCII=function(t){return 128<=t&&t<=255},T2.isNativeC40=function(t){return t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)},T2.isNativeText=function(t){return t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)},T2.isNativeX12=function(t){return this.isX12TermSep(t)||t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)},T2.isX12TermSep=function(t){return 13===t||t==="*".charCodeAt(0)||t===">".charCodeAt(0)},T2.isNativeEDIFACT=function(t){return t>=" ".charCodeAt(0)&&t<="^".charCodeAt(0)},T2.isSpecialB256=function(t){return!1},T2.determineConsecutiveDigitCount=function(t,e){for(var n=t.length,r=e=void 0===e?0:e;r<n&&this.isDigit(t.charCodeAt(r));)r++;return r-e},T2.illegalCharacter=function(t){var e=Ac.toHexString(t.charCodeAt(0)),e="0000".substring(0,4-e.length)+e;throw new Error("Illegal character: "+t+" (0x"+e+")")};var A2=T2,I2=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},L2=(k2.prototype.canEncode=function(t){try{return null!=qc.encode(t,this.charset)}catch(t){return!1}},k2);function k2(t){this.charset=t,this.name=t.name}D2.prototype.length=function(){return this.encoders.length},D2.prototype.getCharsetName=function(t){if(t<this.length())return this.encoders[t].name;throw new Error("index must be less than length")},D2.prototype.getCharset=function(t){if(t<this.length())return this.encoders[t].charset;throw new Error("index must be less than length")},D2.prototype.getECIValue=function(t){return this.encoders[t].charset.getValueIdentifier()},D2.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},D2.prototype.canEncode=function(t,e){if(e<this.length())return!0;throw new Error("index must be less than length")},D2.prototype.encode=function(t,e){if(e<this.length())return qc.encode(Gc.getCharAt(t),this.encoders[e].name);throw new Error("index must be less than length")};var x2=D2;function D2(t,e,n){this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(t){return new L2(Gv.forName(t))}),this.encoders=[];for(var r,i,o,a,s,l,u=[],c=(u.push(new L2(Kv.ISO_8859_1)),null!=e&&e.name.startsWith("UTF")),h=0;h<t.length;h++){var d=!1;try{r=void 0;for(var p=I2(u),f=p.next();!f.done;f=p.next()){var g=f.value,m=t.charAt(h);if(m.charCodeAt(0)===n||g.canEncode(m)){d=!0;break}}}catch(t){r={error:t}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}if(!d)try{o=void 0;for(var y=I2(this.ENCODERS),v=y.next();!v.done;v=y.next())if((g=v.value).canEncode(t.charAt(h))){u.push(g),d=!0;break}}catch(t){o={error:t}}finally{try{v&&!v.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}d||(c=!0)}if(1!==u.length||c){this.encoders=[];var _=0;try{for(var w=I2(u),b=w.next();!b.done;b=w.next()){g=b.value;this.encoders[_++]=g}}catch(t){s={error:t}}finally{try{b&&!b.done&&(l=w.return)&&l.call(w)}finally{if(s)throw s.error}}}else this.encoders=[u[0]];var C=-1;if(null!=e)for(h=0;h<this.encoders.length;h++)if(null!=this.encoders[h]&&e.name===this.encoders[h].name){C=h;break}this.priorityEncoderIndex=C}R2.prototype.getFNC1Character=function(){return this.fnc1},R2.prototype.length=function(){return this.bytes.length},R2.prototype.haveNCharacters=function(t,e){if(t+e-1>=this.bytes.length)return!1;for(var n=0;n<e;n++)if(this.isECI(t+n))return!1;return!0},R2.prototype.charAt=function(t){if(t<0||t>=this.length())throw new Error(""+t);if(this.isECI(t))throw new Error("value at "+t+" is not a character but an ECI");return this.isFNC1(t)?this.fnc1:this.bytes[t]},R2.prototype.subSequence=function(t,e){if(t<0||e<t||e>this.length())throw new Error(""+t);for(var n=new Kc,r=t;r<e;r++){if(this.isECI(r))throw new Error("value at "+r+" is not a character but an ECI");n.append(this.charAt(r))}return n.toString()},R2.prototype.isECI=function(t){if(t<0||t>=this.length())throw new Error(""+t);return 255<this.bytes[t]&&this.bytes[t]<=999},R2.prototype.isFNC1=function(t){if(t<0||t>=this.length())throw new Error(""+t);return 1e3===this.bytes[t]},R2.prototype.getECIValue=function(t){if(t<0||t>=this.length())throw new Error(""+t);if(this.isECI(t))return this.bytes[t]-256;throw new Error("value at "+t+" is not an ECI but a character")},R2.prototype.addEdge=function(t,e,n){(null==t[e][n.encoderIndex]||t[e][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(t[e][n.encoderIndex]=n)},R2.prototype.addEdges=function(t,e,n,r,i,o){var a=t.charAt(r).charCodeAt(0),t=0,s=e.length();0<=e.getPriorityEncoderIndex()&&(a===o||e.canEncode(a,e.getPriorityEncoderIndex()))&&(s=(t=e.getPriorityEncoderIndex())+1);for(var l=t;l<s;l++)a!==o&&!e.canEncode(a,l)||this.addEdge(n,r+1,new O2(a,e,l,i,o))},R2.prototype.encodeMinimally=function(t,e,n){var r=t.length,i=new O2[r+1][e.length()];this.addEdges(t,e,i,0,null,n);for(var o=1;o<=r;o++){for(var a=0;a<e.length();a++)null!=i[o][a]&&o<r&&this.addEdges(t,e,i,o,i[o][a],n);for(a=0;a<e.length();a++)i[o-1][a]=null}for(var s,l=-1,u=Ac.MAX_VALUE,a=0;a<e.length();a++)null!=i[r][a]&&(s=i[r][a]).cachedTotalSize<u&&(u=s.cachedTotalSize,l=a);if(l<0)throw new Error('Failed to encode "'+t+'"');for(var c=[],h=i[r][l];null!=h;){if(h.isFNC1())c.unshift(1e3);else for(var d=e.encode(h.c,h.encoderIndex),o=d.length-1;0<=o;o--)c.unshift(255&d[o]);(null===h.previous?0:h.previous.encoderIndex)!==h.encoderIndex&&c.unshift(256+e.getECIValue(h.encoderIndex)),h=h.previous}for(var p=[],o=0;o<p.length;o++)p[o]=c[o];return p};var N2=R2;function R2(t,e,n){this.fnc1=n;e=new x2(t,e,n);if(1===e.length())for(var r=0;r<this.bytes.length;r++){var i=t.charAt(r).charCodeAt(0);this.bytes[r]=i===n?1e3:i}else this.bytes=this.encodeMinimally(t,e,n)}M2.prototype.isFNC1=function(){return 1e3===this.c};var P2,O2=M2;function M2(t,e,n,r,i){this.c=t,this.encoderSet=e,this.encoderIndex=n,this.previous=r,this.fnc1=i,this.c=t===i?1e3:t;i=this.isFNC1()?1:e.encode(t,n).length;(null===r?0:r.encoderIndex)!==n&&(i+=3),null!=r&&(i+=r.cachedTotalSize),this.cachedTotalSize=i}function B2(t,e,n,r,i){t=P2.call(this,t,e,n)||this;return t.shape=r,t.macroId=i,t}var U2=B2,M=P2=N2;function F2(){this.constructor=U2}function V2(t){this.previous=t}var Vv=U2,i=M,H2=((Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(Vv,i),U2.prototype=null===M?Object.create(M):(F2.prototype=M.prototype,new F2),B2.prototype.getMacroId=function(){return this.macroId},B2.prototype.getShapeHint=function(){return this.shape},V2.prototype.getPrevious=function(){return this.previous},G2),n=j2=V2;function z2(){this.constructor=H2}(function(t,e){(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(t,e)})(H2,n),H2.prototype=null===n?Object.create(n):(z2.prototype=n.prototype,new z2),G2.prototype.appendTo=function(t,e){t.appendBits(this.value,this.bitCount)},G2.prototype.add=function(t,e){return new G2(this,t,e)},G2.prototype.addBinaryShift=function(t,e){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new G2(this,t,e)},G2.prototype.toString=function(){var t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+Ac.toBinaryString(t|1<<this.bitCount).substring(1)+">"};var j2,q2,W2=G2;function G2(t,e,n){t=j2.call(this,t)||this;return t.value=e,t.bitCount=n,t}function $2(t,e,n){t=q2.call(this,t,0,0)||this;return t.binaryShiftStart=e,t.binaryShiftByteCount=n,t}var K2=$2,oo=q2=W2;function X2(){this.constructor=K2}l=K2,u=oo;(Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}))(l,u),K2.prototype=null===oo?Object.create(oo):(X2.prototype=oo.prototype,new X2),$2.prototype.appendTo=function(t,e){for(var n=0;n<this.binaryShiftByteCount;n++)(0===n||31===n&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),62<this.binaryShiftByteCount?t.appendBits(this.binaryShiftByteCount-31,16):0===n?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(e[this.binaryShiftStart+n],8)},$2.prototype.addBinaryShift=function(t,e){return new $2(this,t,e)},$2.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},new W2(null,0,0);var Z2,Y2,e=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};t=Sc.createInt32Array(6,6);try{for(var Q2=e(t),J2=Q2.next();!J2.done;J2=Q2.next()){var t_=J2.value;Sc.fill(t_,-1)}}catch(t){Z2={error:t}}finally{try{J2&&!J2.done&&(Y2=Q2.return)&&Y2.call(Q2)}finally{if(Z2)throw Z2.error}}t[0][4]=0,t[1][4]=0,t[1][0]=28,t[3][4]=0,t[2][4]=0,t[2][0]=15;for(var e_=Sc.createInt32Array(5,256),iv=Gc.getCharCode(" "),r=Gc.getCharCode("."),o=Gc.getCharCode(","),n_=(e_[0][iv]=1,Gc.getCharCode("Z")),r_=Gc.getCharCode("A"),i_=r_;i_<=n_;i_++)e_[0][i_]=i_-r_+2;e_[1][iv]=1;for(var o_=Gc.getCharCode("z"),a_=Gc.getCharCode("a"),i_=a_;i_<=o_;i_++)e_[1][i_]=i_-a_+2;e_[2][iv]=1;for(var s_=Gc.getCharCode("9"),l_=Gc.getCharCode("0"),i_=l_;i_<=s_;i_++)e_[2][i_]=i_-l_+2;e_[2][o]=12,e_[2][r]=13;for(var u_=["\0"," ","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","@","\\","^","_","`","|","~",""],c_=0;c_<u_.length;c_++)e_[3][Gc.getCharCode(u_[c_])]=c_;for(var h_=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],c_=0;c_<h_.length;c_++)0<Gc.getCharCode(h_[c_])&&(e_[4][Gc.getCharCode(h_[c_])]=c_);class d_ extends cs{static get selector(){return".question input.zxing-result"}static get helpersRequired(){return["evaluate"]}_init(){this._addDomElements(),this.codeReader=new tv,this.$video=this.$widget.find(".video"),this.videoId="video"+this.element.getAttribute("name"),this.$video.attr("id",this.videoId),this.$sourceSelect=this.$widget.find(".sourceSelect"),this.$start=this.$widget.find(".startButton"),this.$stop=this.$widget.find(".stopButton"),this.$showResult=this.$widget.find(".showResult"),this.$start.on("click",()=>{this._startDecoding()}),this.$stop.on("click",()=>{this._stopDecoding()}),this.$video.hide(),this.$stop.hide(),this.codeReader.listVideoInputDevices().then(t=>{this.selectedDeviceId=t[0].deviceId,1<=t.length&&(t.forEach(t=>{var e=document.createElement("option");e.text=t.label,e.value=t.deviceId,this.$sourceSelect.append(e)}),this.$sourceSelect.on("change",t=>{this.selectedDeviceId=t.target.value,this.codeReader.isVideoPlaying(this.$video[0])&&(this.codeReader.reset(),this._startDecoding())}))}).catch(t=>{console.error(t)}),this.originalInputValue&&(this.value=this.originalInputValue)}_addDomElements(){this.$widget=m(`<div class="center-block">
                <label data-i18n="barcode.select_device">${C("barcode.select_device")}</label>
                <select class="sourceSelect ignore" style="max-width:400px">
                </select>
            </div>

            <div>
                <a class="widget form-widget btn btn-primary startButton" data-i18n="literacywidget.start">${C("literacywidget.start")}</a>
                <a class="widget form-widget btn btn-secondary stopButton" data-i18n="barcode.stop">${C("barcode.stop")}</a>
            </div>

            <div>
                <video class="center-block video" style="border: 1px solid gray"></video>
            </div>

            <div>
                <p class="showResult"></p>
            </div>`),m(this.element).hide().after(this.$widget).parent().addClass("clearfix")}_updateValue(){var t=this.originalInputValue,e=this.value;return t!==e&&(this.originalInputValue=e,!0)}_startDecoding(){this.$video.show(),this.$showResult.hide(),this.$start.hide(),this.$stop.show(),this.codeReader.decodeFromVideoDevice(this.selectedDeviceId,this.videoId,(t,e)=>{t&&(this.value=t.text,this._updateValue(),this.element.dispatchEvent(E.Change()),this.$video.hide(),this.$showResult.show(),this.$start.show(),this.$stop.hide(),this.codeReader.reset()),!e||e instanceof I||console.error(e)})}_stopDecoding(){this.$video.hide(),this.$showResult.show(),this.$start.show(),this.$stop.hide(),this.codeReader.reset(),this.value=""}get value(){return this.element.value}set value(t){this.element.value=t=t||"",this.$showResult.text(t)}}let p_=[class{},Ss,Ts,ks,ol,al,class{},sl,ll,ul,hl,dl,pl,fl,_l,El,class{},Sl,Al,Il,Ll,xl,Tl,vu,_u,wu,bu,Cu,Eu,Su,ku,xu,d_],f_=p_.filter(t=>t.selector),g_,m_;function y_(t,e){return e?"form"===e?[m_]:t.classList.contains("question")?[...t.querySelectorAll("input:not(.ignore), select:not(.ignore), textarea:not(.ignore)")].filter(t=>t.matches(e)):[...t.querySelectorAll(e)]:[]}class v_{constructor(t){Array.isArray(t)||(t=[t]),this.elements=t}_instantiateSingleWidget(e,n,t={}){n.condition(e)&&!qe.has(e,n)&&((t=new n(e,t))instanceof Promise?t.then(t=>qe.put(e,n.name,t)):qe.put(e,n.name,t))}_methodCall(e,n){this.elements.forEach(t=>{t=qe.get(t,e.name);t&&t[n]()})}instantiate(e,n){this.elements.forEach(t=>this._instantiateSingleWidget(t,e,n))}update(t){this._methodCall(t,"update")}disable(t){this._methodCall(t,"disable")}enable(t){this._methodCall(t,"enable")}}var __,w_,b_,C_,E_,S_,T_,A_,I_,L_,k_={init:function(t,e={}){if(!this.form)throw new Error("Widgets module not correctly instantiated with form property.");g_=e,m_=this.form.view.html;let l=t&&t.length?t[0]:m_;return f_.forEach(n=>{{var r=l,i,o,a,s;let e={};if(n.name){n.helpersRequired&&0<n.helpersRequired.length&&(e.helpers={},n.helpersRequired.forEach(t=>{e.helpers[t]=g_[t]}));let t=y_(r,n.selector);t.length&&(new v_(t).instantiate(n,e),i=n,0<(o=t).length&&m_.addEventListener(E.ChangeLanguage().type,()=>{new v_(o).update(i)}),a=n,0<(r=t).length&&(a.list||a.options)&&m(r).on(E.ChangeOption().type,function(){new v_(this).update(a)}),s=n,0<(r=t).length)&&r[0].matches("input, select, textarea")&&r.forEach(t=>t.addEventListener(E.InputUpdate().type,t=>{new v_(t.target).update(s)}))}else console.error("widget doesn't have a name")}}),!0},enable:function(n){f_.forEach(t=>{var e=y_(n,t.selector).filter(t=>"select"===t.nodeName.toLowerCase()?!t.hasAttribute("readonly"):!t.readOnly);new v_(e).enable(t)})},disable:function(n){f_.forEach(t=>{var e=y_(n,t.selector);new v_(e).disable(t)})}},x_={init(t){if(!this.form)throw new Error("Language module not correctly instantiated with form property.");var e,n,r=this.form.view.html.closest("body")||this.form.view.html.parentNode;r&&((n=r.querySelector(".form-language-selector")).classList.add("hide"),e=this.form.view.html.querySelector("#form-languages"))&&(this.languages=[...e.querySelectorAll("option")].map(t=>t.value),n&&(n.append(e),1<this.languages.length)&&n.classList.remove("hide"),this.formLanguages=r.querySelector("#form-languages"),this.defaultLanguage=this.formLanguages.dataset.defaultLang||void 0,t&&this.languages.includes(t)&&1<this.languages.length?(this._currentLang=t,this.setFormUi(this._currentLang)):this._currentLang=this.defaultLanguage||this.languages[0]||"",n=(e=this.formLanguages.querySelector(`[value="${this._currentLang}"]`))&&e.dataset.dir||"ltr",this.formLanguages.value=this._currentLang,this.form.view.html.setAttribute("dir",n),this.languages.length<2||(this.formLanguages.addEventListener(E.Change().type,t=>{t.preventDefault(),this._currentLang=t.target.value,this.setFormUi(this._currentLang)}),this.form.view.html.addEventListener(E.AddRepeat().type,t=>this.setFormUi(this._currentLang,t.target))))},get currentLanguage(){return this._currentLang},get currentLangDesc(){var t=this.formLanguages.querySelector(`[value="${this._currentLang}"]`);return t?t.textContent:null},get languagesUsed(){return this.languages||[]},setFormUi(e,t=this.form.view.html){var n=this.formLanguages.querySelector(`[value="${e}"]`).dataset.dir||"ltr",t=[...t.querySelectorAll("[lang]")];this.form.view.html.setAttribute("dir",n),t.forEach(t=>t.classList.remove("active")),t.filter(t=>t.matches(`[lang="${e}"], [lang=""]`)&&(!t.classList.contains("or-form-short")||t.classList.contains("or-form-short")&&!Me(t,".or-form-long"))).forEach(t=>t.classList.add("active")),window.enketoFormLocale=e,this.form.view.html.querySelectorAll("select, datalist").forEach(t=>this.setSelect(t)),this.form.view.html.dispatchEvent(E.ChangeLanguage())},setSelect(t){let o=t.nodeName.toLowerCase();var e=t.closest(".question, .or-repeat-info");let a=e?e.querySelector(".or-option-translations"):null;a&&[...t.children].filter(t=>t.matches("option")&&!t.matches('[value=""], [data-value=""]')).forEach(e=>{var n="datalist"===o?e.value:e.textContent,r="datalist"===o&&e.dataset.value||e.value,i=a.querySelector(`.active[data-option-value="${r}"]`);if(i){let t=n;i&&i.textContent&&(t=i.textContent),e.value=r,e.textContent=t}})}},D_={init(){if(!this.form)throw new Error("Preload module not correctly instantiated with form property.");this.form.view.html.querySelectorAll("input[data-preload], select[data-preload], textarea[data-preload]").forEach(t=>{var e,n,r=this.form.input.getProps(t),i=t.dataset&&t.dataset.preload?t.dataset.preload.toLowerCase():void 0,t=t.dataset&&t.dataset.preloadParams?t.dataset.preloadParams.toLowerCase():void 0;void 0!==this[i]?(e=this.form.model.node(r.path,r.index)).getElements().length&&(n=e.getVal(),t=this[i]({param:t,curVal:n,dataNode:e}),e.setVal(t,r.xmlType)):console.warn(`Preload "${i}" not supported. May or may not be a big deal.`)})},timestamp:function(t){let e,n=this;return"start"===t.param?0<t.curVal.length?t.curVal:this.form.model.evaluate("now()","string"):"end"===t.param?(document.body.addEventListener(E.BeforeSave().type,()=>{e=n.form.model.evaluate("now()","string"),t.dataNode.setVal(e,"datetime")}),this.form.model.evaluate("now()","string")):"error - unknown timestamp parameter"},date:function(t){var e;return 0===t.curVal.length?(e=new Date(this.form.model.evaluate("today()","string"))).getFullYear().toString().padStart(4,"0")+`-${(e.getMonth()+1).toString().padStart(2,"0")}-`+e.getDate().toString().padStart(2,"0"):t.curVal},property:function(t){var e;return 0===t.curVal.length?(e=this.form.model.node('instance("__session")/session/context/'+t.param)).getElements().length?e.getVal():`no ${t.param} property in enketo`:t.curVal},context:function(t){return 0===t.curVal.length?"application"===t.param?"enketo":t.param+" not supported in enketo":t.curVal},patient:function(t){return 0===t.curVal.length?"patient preload item not supported in enketo":t.curVal},user:function(t){return 0===t.curVal.length?"user preload item not supported in enketo yet":t.curVal},uid:function(t){return 0===t.curVal.length?this.form.model.evaluate('concat("uuid:", uuid())',"string"):t.curVal},instance:function(t){return gLoadedInstanceID||(window.gLoadedInstanceID=0<t.curVal.length?t.curVal:model.evaluate("concat('uuid:', uuid())","string")),$form.data({instanceID:gLoadedInstanceID}),gLoadedInstanceID}},N_={update(t){let a={},s="",l=this;if(!this.form)throw new Error("Output module not correctly instantiated with form property.");t=this.form.getRelatedNodes("data-value",".or-output",t);let u=this.form.repeatsPresent&&this.form.view.html.querySelector(".or-repeat.clone");t.each(function(){var n=m(this);if(!n.closest(".or-branch").parent().closest(".disabled").length){var r=this.dataset.value;let t=this.closest(".question, .or-group"),e=(t.matches(".or-group")||(t=t.querySelector("[name]")),l.form.input.getName(t));m(t).children(`.or-repeat-info[data-name="${e}"]`).length&&!m(t).children(`.or-repeat[name="${e}"]`).length&&(e=null);var i=u&&0<n.parentsUntil(".or",".or-repeat").length,o=i&&0<n.parentsUntil(".or",".or-repeat.clone").length&&e?l.form.input.getIndex(t):0;void 0!==a[r]?s=a[r]:(s=l.form.model.evaluate(r,"string",e,o,!0),i||(a[r]=s)),n.html()!==s&&n.html(s)}})}},R_={update(o={},t="",a=!1){let e;if(!this.form)throw new Error("Calculation module not correctly instantiated with form property.");(e=(o.relevantPath?this.form.getRelatedNodes("data-calculate",`[name^="${o.relevantPath}/"]`+t).add(this.form.getRelatedNodes("data-calculate",`[name="${o.relevantPath}"]`+t)).add(this.form.getRelatedNodes("data-calculate",`[data-name="${o.relevantPath}"]`+t)):this.form.getRelatedNodes("data-calculate",t,o)).get()).forEach(r=>{var t=this.form.input.getName(r),e=this.form.model.node(t),n=e.getElements();let i={name:t,expr:this.form.input.getCalculation(r),dataType:this.form.input.getXmlType(r),relevantExpr:this.form.input.getRelevant(r),index:0,dataNodesObj:e};1<n.length?o.repeatPath&&-1!==t.indexOf(o.repeatPath+"/")&&n[o.repeatIndex]?(e=-1!==t.lastIndexOf("/")?t.substring(t.lastIndexOf("/")+1):t,(t=this.form.model.node(o.repeatPath,o.repeatIndex).getElement())&&(t=t.querySelector(m.escapeSelector(e)),i.index=n.indexOf(t),this._updateCalc(r,i,a))):"hidden"===r.type?n.forEach((t,e)=>{var n=Object.create(i);n.index=e,this._updateCalc(r,n,a)}):(e=Pe(r.closest(".or-repeat"),".or-repeat")).length===n.length&&(i.index=e.indexOf(r.closest(".or-repeat")),this._updateCalc(r,i,a)):1===n.length&&this._updateCalc(r,i,a)})},_getNodesForAction(t,e){var n;return e.type===(new E.InstanceFirstLoad).type?[...this.form.view.html.querySelectorAll(`.${t} [data-${t}][data-event*="${e.type}"]`)].concat(this.form.filterRadioCheckSiblings([...this.form.view.html.querySelectorAll(`.question [data-${t}][data-event*="${e.type}"]`)])):e.type===(new E.NewRepeat).type?this.form.getRelatedNodes("data-"+t,`.${t} [data-event*="${e.type}"]`,e.detail).get().concat(this.form.getRelatedNodes("data-"+t,`.question [data-event*="${e.type}"]`,e.detail).get()):e.type===(new E.XFormsValueChanged).type?(n=e.target.closest(".question"))?[...n.querySelectorAll(`[data-${t}][data-event*="${e.type}"]`)]:[]:void 0},performAction(r,a){if(a){if(!this.form)throw new Error(r+" action not correctly instantiated with form property.");this._getNodesForAction(r,a).forEach(i=>{var t=this.form.input.getName(i),e=this.form.model.node(t),n=e.getElements();let o={name:t,dataType:this.form.input.getXmlType(i),relevantExpr:this.form.input.getRelevant(i),index:a.detail&&void 0!==a.detail.repeatIndex?a.detail.repeatIndex:0,dataNodesObj:e,type:r};if("setvalue"===r&&(o.expr=i.dataset.setvalue),1<n.length&&a.type!==(new E.NewRepeat).type&&a.type!==(new E.XFormsValueChanged).type)n.forEach((t,e)=>{var n=Object.create(o),r=i;n.index=e,this._updateCalc(r,n)});else if(a.type===(new E.XFormsValueChanged).type){let t=this.form.input.find(o.name,o.index);t||(o.index=0,t=this.form.input.find(o.name,0)),this._updateCalc(t,o)}else n[o.index]?this._updateCalc(i,o):console.error("performAction called for node that does not exist in model.")})}},_updateCalc(e,n,t){var r;!t&&"setvalue"!==n.type&&"setgeopoint"!==n.type&&this._hasNeverBeenRelevant(e,n)&&!this._isRelevant(n)||("setgeopoint"===n.type?(r={enableHighAccuracy:!0,maximumAge:0},js(r).then(({geopoint:t})=>{this._updateValue(e,n,t)}).catch(()=>{this._updateValue(e,n,"")})):(r=!!t&&!this._isRelevant(n),t=this.form.replaceChoiceNameFn(n.expr,"string",n.name,n.index),r=!r&&t?this.form.model.evaluate(t,"string",n.name,n.index):"",this._updateValue(e,n,r)))},_updateValue(t,e,n){e.dataNodesObj.setIndex(e.index);var r=e.dataNodesObj.getVal(),n=(e.dataNodesObj.setVal(n,e.dataType),e.dataNodesObj.getVal());t&&r!==n&&(this.form.input.setVal(t,n),"hidden"!==t.type)&&!0===rt.validateContinuously&&this.form.validateInput(t)},_isRelevant(e){let n=!e.relevantExpr||this.form.model.evaluate(e.relevantExpr,"boolean",e.name,e.index);if(n){var r=e.name.split("/"),r=r.splice(0,r.length-1).join("/");let t;r=(t=0===e.index?this.form.view.html.querySelector(`.or-group[name="${r}"],.or-group-data[name="${r}"]`):this.form.view.html.querySelectorAll(`.or-repeat[name="${r}"]`)[e.index]||this.form.view.html.querySelectorAll(`.or-group[name="${r}"],.or-group-data[name="${r}"]`)[e.index])?[t].concat(Ue(t,".or-group, .or-group-data")):[];r.length&&(n=r.filter(t=>t.matches("[data-relevant]")).map(t=>{var e=this.form.input.getName(t);return{context:e,index:[...this.form.view.html.querySelectorAll(`.or-group[name="${e}"], .or-group-data[name="${e}"]`)].indexOf(t),expr:this.form.input.getRelevant(t)}}).concat([{context:e.name,index:e.index,expr:e.relevantExpr}]).every(t=>!t.expr||this.form.model.evaluate(t.expr,"boolean",t.context,t.index)))}return n},_hasNeverBeenRelevant(t,e){if(t&&t.closest(".pre-init"))return!0;t=e.name.split("/"),t=t.splice(0,t.length-1).join("/");let n;return!!(n=0===e.index?this.form.view.html.querySelector(`.or-group[name="${t}"],.or-group-data[name="${t}"]`):this.form.view.html.querySelectorAll(`.or-repeat[name="${t}"]`)[e.index]||this.form.view.html.querySelectorAll(`.or-group[name="${t}"],.or-group-data[name="${t}"]`)[e.index])&&!!n.closest(".pre-init")}},P_={update(t){let o=this,a={};if(!this.form)throw new Error("Required module not correctly instantiated with form property.");t=this.form.getRelatedNodes("data-required","",t);let s=this.form.repeatsPresent&&this.form.view.html.querySelector(".or-repeat.clone");t.each(function(){var t=m(this),e=o.form.input.getRequired(this),n=o.form.input.getName(this),r=s?o.form.input.getIndex(this):0,i=`${e}__${n.substring(0,n.lastIndexOf("/"))}__`+r;void 0===a[i]&&(a[i]=o.form.model.node(n,r).isRequired(e)),t.closest(".question").find(".required").toggleClass("hide",!a[i])})}},O_={init(){this._setNumberMask('[data-type-xml="int"]',/^(-?[0-9]+$)/,"-0123456789"),this._setNumberMask('[data-type-xml="decimal"]',/^(-?[0-9]+[.,]?[0-9]*$)/,"-0123456789.,")},_setNumberMask(n,r,e){var t=this.form.view.html;t.addEventListener("keydown",t=>{if(t.target.matches(n)){if(this._isNotPrintableKey(t)||this._isKeyboardCutPaste(t)||-1!==e.indexOf(t.key))return!0;t.preventDefault(),t.stopPropagation()}}),t.addEventListener("paste",t=>{if(t.target.matches(n)){var e=Ne(t);if(e&&r.test(e.trim()))return!0;t.target.value="",t.target.dispatchEvent(E.Change()),t.preventDefault(),t.stopPropagation()}}),t.addEventListener("blur",t=>{t.target.matches(n)&&(void 0!==t.target.validity&&void 0!==t.target.validity.badInput&&t.target.validity.badInput||void 0===t.target.validity.badInput&&t.target.value&&!r.test(t.target.value.trim()))&&(t.target.value="")})},_isNotPrintableKey(t){return 1<t.key.length&&"Spacebar"!==t.key},_isKeyboardCutPaste(t){return-1!=="xvc".indexOf(t.key)&&(t.metaKey||t.ctrlKey)}},M_={update(t){this.form.getRelatedNodes("readonly","",t).get().forEach(t=>{t.closest(".question").classList.add("readonly");var e=this.form.input.getName(t),e=this.form.view.html.querySelector(`[data-setvalue][data-event="xforms-value-changed"][name="${e}"], [data-setgeopoint][data-event="xforms-value-changed"][name="${e}"]`),e=!(t.value||t.dataset.calculate||e||t.classList.contains("readonly-forced"));t.classList.toggle("empty",e),e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")})}};function B_(t,e,n){var r=m(t);"string"==typeof t&&(console.deprecate("Form instantiation using a selector","a HTML <form> element"),t=r[0]),this.nonRepeats={},this.all={},this.options="object"!=typeof n?{}:n,this.view={$:r,html:t,clone:t.cloneNode(!0)},this.model=new S(e),this.repeatsPresent=!!this.view.html.querySelector(".or-repeat"),this.widgetsInitialized=!1,this.repeatsInitialized=!1,this.pageNavigationBlocked=!1,this.initialized=!1}m.fn.reverse=[].reverse,(B_.prototype={evaluationCascadeAdditions:[],get evaluationCascade(){return[this.calc.update.bind(this.calc),this.repeats.countUpdate.bind(this.repeats),this.relevant.update.bind(this.relevant),this.output.update.bind(this.output),this.itemset.update.bind(this.itemset),this.required.update.bind(this.required),this.readonly.update.bind(this.readonly),this.validationUpdate].concat(this.evaluationCascadeAdditions)},get recordName(){return this.view.$.attr("name")},set recordName(t){this.view.$.attr("name",t)},get editStatus(){return"true"===this.view.html.dataset.edited},set editStatus(t){t&&t!==this.editStatus&&this.view.html.dispatchEvent(E.Edited()),this.view.html.dataset.edited=t},get surveyName(){return this.view.$.find("#form-title").text()},get instanceID(){return this.model.instanceID},get deprecatedID(){return this.model.deprecatedID},get instanceName(){return this.model.instanceName},get version(){return this.model.version},get encryptionKey(){return this.view.$.data("base64rsapublickey")},get action(){return this.view.$.attr("action")},get method(){return this.view.$.attr("method")},get id(){return this.view.html.dataset.formId},get constraintClassesInvalid(){return["invalid-constraint"]},get constraintAttributes(){return["data-constraint"]},get languages(){return this.langs.languagesUsed},get currentLanguage(){return this.langs.currentLanguage}}).addModule=function(t){return Object.create(t,{form:{value:this}})},B_.prototype.init=function(){let e=[],n=this;if(this.toc=this.addModule(os),this.pages=this.addModule(as),this.langs=this.addModule(x_),this.progress=this.addModule(ls),this.widgets=this.addModule(k_),this.preloads=this.addModule(D_),this.relevant=this.addModule(ss),this.repeats=this.addModule(is),this.input=this.addModule(Ja),this.output=this.addModule(N_),this.itemset=this.addModule(ns),this.calc=this.addModule(R_),this.required=this.addModule(P_),this.mask=this.addModule(O_),this.readonly=this.addModule(M_),this.model.events.addEventListener(E.InstanceFirstLoad().type,t=>{this.calc.performAction("setvalue",t),this.calc.performAction("setgeopoint",t)}),this.view.html.addEventListener("datarefresh",t=>{n.calc.update(t.target)}),window.wfcache=void 0,this.view.html.addEventListener(E.NewRepeat().type,t=>{this.calc.performAction("setvalue",t),this.calc.performAction("setgeopoint",t)}),this.view.html.addEventListener(E.XFormsValueChanged().type,t=>{this.calc.performAction("setvalue",t),this.calc.performAction("setgeopoint",t)}),this.model.events.addEventListener(E.DataUpdate().type,t=>{n.view.html.dispatchEvent(E.DataUpdate(t.detail))}),this.model.events.addEventListener(E.Removed().type,t=>{n.view.html.dispatchEvent(E.Removed(t.detail))}),e=e.concat(this.model.init()),void 0!==this.model&&this.model instanceof S){try{this.preloads.init(),this.view.$.data({instanceID:this.model.instanceID}),this.grosslyViolateStandardComplianceByIgnoringCertainCalcs(),this.calc.update(),this.langs.init(this.options.language),this.pages.init();var t=t=>this.calc.update(t.detail),r=()=>this.all={};return this.view.html.addEventListener(E.AddRepeat().type,t),this.view.html.addEventListener(E.RemoveRepeat().type,r),this.repeatsInitialized=!0,this.repeats.init(),this.view.html.removeEventListener(E.AddRepeat().type,t),this.view.html.removeEventListener(E.RemoveRepeat().type,r),this.output.update(),this.itemset.update(),this.setAllVals(),this.readonly.update(),this.options.input=this.input,this.options.pathToAbsolute=this.pathToAbsolute.bind(this),this.options.evaluate=this.model.evaluate.bind(this.model),this.options.getModelValue=this.getModelValue.bind(this),this.widgetsInitialized=this.widgets.init(null,this.options),this.relevant.update(),this.setEventHandlers(),this.calc.update(),this.required.update(),this.mask.init(),(this.editStatus=!1)!==this.options.printRelevantOnly&&this.view.$.addClass("print-relevant-only"),setTimeout(()=>{n.progress.update()},0),this.initialized=!0,e}catch(t){console.error(t),e.push(t.name+": "+t.message)}document.querySelector("body").scrollIntoView()}else e.push("Form could not be initialized without a model.");return e},B_.prototype.goTo=function(t){var e=[];return this.goToTarget(this.getGoToTarget(t))||e.push(C("alert.gotonotfound.msg",{path:t.substring(t.lastIndexOf("/")+1)})),e},B_.prototype.getDataStr=function(t={}){return!1===t.irrelevant?this.getDataStrWithoutIrrelevantNodes():this.model.getStr()},B_.prototype.resetView=function(){return this.langs.formLanguages&&this.langs.formLanguages.remove(),this.view.html.replaceWith(this.view.clone),document.querySelector("form.or")},B_.prototype.replaceChoiceNameFn=function(s,l,u,c,h){return Ie(s,"jr:choice-name").forEach(r=>{var i=r[1];if(2!==i.length)throw new Ge("jr:choice-name function has incorrect number of parameters: "+r[0]);{let t="",e=this.model.evaluate(i[0],l,u,c,h),n=Le(i[1]).trim();n=n.startsWith("/")?n:function(){let t=[];for(var e=0,n=arguments.length;e<n;e++)t=t.concat(arguments[e].split("/"));for(var r=[],e=0,n=t.length;e<n;e++){var i=t[e];i&&"."!==i&&(".."===i?r.pop():r.push(i))}return""===t[0]&&r.unshift(""),r.join("/")||(r.length?"/":".")}(u,n);var o,i=[...this.view.html.querySelectorAll(`[name="${n}"], [data-name="${n}"]`)],a=i.length?i[0].nodeName.toLowerCase():null;e&&i.length?"select"===a?(o=i.find(t=>t.querySelector(`[value="${e}"]`)),t=o?o.querySelector(`[value="${e}"]`).textContent:""):"input"===a&&((o=i[0].getAttribute("list"))?(a=Me(i[0],"datalist#"+CSS.escape(o)))&&(o=a.querySelector(`[data-value="${e}"]`),t=o?o.getAttribute("value"):""):(o=(a=i.find(t=>t.getAttribute("value")===e))?Me(a,".option-label.active"):[],t=o?o.textContent:"")):t="",s=s.replace(r[0],`"${t}"`)}}),s},B_.prototype.setAllVals=function(t,e){let o=this;t=t&&t.attr("name")?t.attr("name"):null;this.model.node(t,e=void 0!==e?e:null).getElements().reduce((t,e)=>{e=[...e.querySelectorAll("*")].filter(t=>0===t.children.length&&t.textContent);return t.concat(e)},[]).forEach(t=>{try{var e=t.textContent,n=ze(t,"instance"),r=o.model.node(n).getElements().indexOf(t),i=o.input.find(n,r);i&&(o.input.setVal(i,e,null),"binary"===o.input.getXmlType(i))&&e.startsWith("jr://")&&t.getAttribute("src")&&i.setAttribute("data-loaded-url",t.getAttribute("src"))}catch(t){throw console.error(t),new Error(`Could not load input field value with name: ${n} and value: `+e)}})},B_.prototype.getModelValue=function(t){var t=t[0],e=this.input.getName(t),t=this.input.getIndex(t);return this.model.node(e,t).getVal()},B_.prototype.getRelatedNodes=function(e,n,t){let r=null,i;var o;t=t||{},n=n||"",this.nonRepeats[e]||(i=[...this.view.html.querySelectorAll(`:not(.or-repeat-info)[${e}]`)].filter(t=>!t.closest(".or-repeat")),this.nonRepeats[e]=this.filterRadioCheckSiblings(i)),void 0!==t.repeatPath&&0<=t.repeatIndex&&(o=[...this.view.html.querySelectorAll(`.or-repeat[name="${t.repeatPath}"]`)][t.repeatIndex],i=o?[...o.querySelectorAll(`[${e}]`)]:[],r=this.filterRadioCheckSiblings(i)),!this.all[e]||t.repeatPath&&!t.cloned?this.all[e]=this.repeatsInitialized?this.filterRadioCheckSiblings([...this.view.html.querySelectorAll(`[${e}]`)]):this.nonRepeats[e]:t.cloned&&r&&(this.all[e]=this.all[e].concat(r));let a,s=(a=r?this.nonRepeats[e].concat(r):this.all[e],[]),l=(s=t.nodes&&0!==t.nodes.length?(t.nodes.forEach(t=>{s=s.concat(this.getQuerySelectorsForLogic(n,e,t))}),s.concat(this.getQuerySelectorsForLogic(n,e,"*"))):[n+`[${e}]`]).join(", ");return a=l?a.filter(t=>t.matches(l)):a,m(a)},B_.prototype.filterRadioCheckSiblings=t=>{let e=[];return t.filter(t=>{t="radio"===t.type||"checkbox"===t.type?Fe(t,".option-wrapper",".question"):null;if(t){if(e.includes(t))return!1;e.push(t)}return!0})},B_.prototype.getQuerySelectorsForLogic=(t,e,n)=>[t+`[${e}*="/${n} "]`,t+`[${e}*="/${n})"]`,t+`[${e}*="/${n},"]`,t+`[${e}$="/${n}"]`,t+`[${e}*="/${n}]"]`,t+`[${e}*="/${n}["]`],B_.prototype.getDataStrWithoutIrrelevantNodes=function(){let i=this,o=new S(this.model.getStr());return o.init(),this.getRelatedNodes("data-relevant").reverse().each(function(){var t=i.input.getRelevant(this),e=i.input.getIndex(this),n=i.input.getName(this);let r;(r=He(this,`.or-repeat-info[data-name="${n}"]`)&&!He(this,`.or-repeat[name="${n}"]`)?null:o.node(n,e).getElement())&&!i.model.evaluate(t,"boolean",n,e)&&r.remove()}),o.getStr()},B_.prototype.grosslyViolateStandardComplianceByIgnoringCertainCalcs=function(){var t=this.view.$.find('[name$="instanceID"][data-calculate]');0<t.length&&t.removeAttr("data-calculate")},B_.prototype.validationUpdate=function(t=0){},B_.prototype.setEventHandlers=function(){let n=this;this.view.$.attr("onsubmit","return false;"),this.view.$.on("change.file","input:not(.ignore), select:not(.ignore), textarea:not(.ignore)",function(){let t=this,e={path:n.input.getName(t),inputType:n.input.getInputType(t),xmlType:n.input.getXmlType(t),val:n.input.getVal(t),index:n.input.getIndex(t)};0<e.val.length&&"file"===e.inputType&&t.files[0]&&0<t.files[0].size&&(e.val=ke(t.files[0],t.dataset.filenamePostfix)),0<e.val.length&&"drawing"===e.inputType&&(e.val=ke({name:e.val},t.dataset.filenamePostfix)),n.model.node(e.path,e.index).setVal(e.val,e.xmlType)&&n.validateInput(t).then(()=>{t.dispatchEvent(E.XFormsValueChanged({repeatIndex:e.index}))})}),this.view.html.addEventListener("focusin",t=>{this.progress.update(t.target)}),this.view.html.addEventListener(E.FakeFocus().type,t=>{this.progress.update(t.target)}),this.model.events.addEventListener(E.DataUpdate().type,e=>{n.evaluationCascade.forEach(t=>{t.call(n,e.detail)},!0),n.editStatus=!0}),this.view.html.addEventListener(E.AddRepeat().type,e=>{var t=m(e.target);this.setAllVals(t,e.detail.repeatIndex),window.zmwidgets&&zmwidgets.addWidgets(t),m("#main").trigger("zmrepeat"),this.evaluationCascade.forEach(t=>{t.call(n,e.detail)}),this.progress.update()}),this.view.html.addEventListener(E.RemoveRepeat().type,()=>{this.progress.update()}),this.view.html.addEventListener(E.ChangeLanguage().type,()=>{this.output.update()}),this.view.$.find(".or-group > h4").on("click",function(){m(this).closest(".or-group").toggleClass("or-appearance-compact").trigger("resize")})},B_.prototype.setValid=function(t,e){t=this.input.getWrapNode(t);t&&(e=e?["invalid-"+e]:[...t.classList].filter(t=>0===t.indexOf("invalid-")),t.classList.remove(...e))},B_.prototype.setInvalid=function(t,e="constraint"){t=this.input.getWrapNode(t);t&&t.classList.add("invalid-"+e)},B_.prototype.updateValidityInUi=function(t,e){var n=!1!==e.requiredValid&&!1!==e.constraintValid;!1===e.requiredValid?(this.setValid(t,"constraint"),this.setInvalid(t,"required")):!1===e.constraintValid?(this.setValid(t,"required"),this.setInvalid(t,"constraint")):(this.setValid(t,"constraint"),this.setValid(t,"required")),n||t.dispatchEvent(E.Invalidated())},B_.prototype.blockPageNavigation=function(){let t=this;this.pageNavigationBlocked=!0,window.clearTimeout(this.blockPageNavigationTimeout),this.blockPageNavigationTimeout=window.setTimeout(()=>{t.pageNavigationBlocked=!1},600)},B_.prototype.isValid=function(t){var n=[".invalid-required",".invalid-relevant"].concat(this.constraintClassesInvalid.map(t=>"."+t));if(t){let e=this.input.getWrapNode(t).classList;return!n.some(t=>e.contains(t))}return!this.view.html.querySelector(n.join(", "))},B_.prototype.clearNonRelevant=function(){this.relevant.update(null,!0)},B_.prototype.validate=B_.prototype.validateAll=function(){let e=this;return this.clearNonRelevant(),this.validateContent(this.view.$).then(t=>(e.view.html.dispatchEvent(E.ValidationComplete()),t))},B_.prototype.validateContent=function(e){let n=this,r=[".invalid-required",".invalid-relevant"].concat(this.constraintClassesInvalid.map(t=>"."+t)).join(", ");e.find("fieldset:disabled input, fieldset:disabled select, fieldset:disabled textarea, input:disabled, select:disabled, textarea:disabled").each(function(){n.setValid(this)});var t=e.find(".question").addBack(".question").map(function(){var t=this.querySelector("input:not(.ignore):not(:disabled), select:not(.ignore):not(:disabled), textarea:not(.ignore):not(:disabled)");return t?n.validateInput(t):Promise.resolve()}).toArray();return Promise.all(t).then(()=>{var t=e[0],t=t.matches(r)?t:t.querySelector(r);return t&&n.goToTarget(t),!t}).catch(()=>!1)},B_.prototype.pathToAbsolute=function(t,e){return 0===t.indexOf("/")?t:ze(this.model.evaluate(t,"node",e,0,!0),"instance",!1)},B_.prototype.validateInput=function(e){if(!this.initialized)return Promise.resolve();let n=this,t,r={path:this.input.getName(e),inputType:this.input.getInputType(e),xmlType:this.input.getXmlType(e),enabled:this.input.isEnabled(e),constraint:this.input.getConstraint(e),calculation:this.input.getCalculation(e),required:this.input.getRequired(e),readonly:this.input.getReadonly(e),val:this.input.getVal(e)};return!r.readonly||r.val||r.required||r.constraint||r.calculation?(t=r.enabled&&"hidden"!==r.inputType?(r.ind=this.input.getIndex(e),this.model.node(r.path,r.ind).validate(r.constraint,r.required,r.xmlType)):Promise.resolve({requiredValid:!0,constraintValid:!0})).then(t=>("hidden"!==r.inputType&&this.updateValidityInUi(e,t),t)).catch(t=>{throw console.error("validation error",t),n.setInvalid(e,"constraint"),t}):Promise.resolve()},B_.prototype.getGoToTarget=function(t){var e,n;let r,i,o="";var a=/([^[]+)\[(\d+)\]([^[]*$)?/g;if(t&&(n=this.model.node(t).getElement())){if(t=ze(n,"instance",!0),!(r=this.view.html.querySelector(`[name="${t}"]`)))for(i=this.view.html;null!==(e=a.exec(t))&&i;)o+=e[1],(i=i.querySelectorAll(`[name="${o}"], [data-name="${o}"]`)[e[2]])&&e[3]&&(o+=e[3],i=i.querySelector(`[name="${o}"],[data-name="${o}"]`)),r=i;return r&&this.input.getWrapNode(r)}},B_.prototype.goToTarget=function(t){var e;return t&&(this.pages.active&&this.pages.flipToPageContaining(m(t)),t.closest(".calculation, .setvalue, .setgeopoint")&&t.dispatchEvent(E.GoToInvisible()),t.closest(".or-branch.disabled")&&t.dispatchEvent(E.GoToIrrelevant()),t.scrollIntoView(),(e=t.querySelector("input:not(.ignore), textarea:not(.ignore), select:not(.ignore)")).focus(),e.dispatchEvent(E.ApplyFocus())),!!t},B_.requiredTransformerVersion="1.43.0";let U_,F_,V_;function H_(){return F_=F_||(()=>{for(var t in document.styleSheets)if(Object.prototype.hasOwnProperty.call(document.styleSheets,t)){t=document.styleSheets[t];if("print"===t.media.mediaText)return t}return null})(),V_=V_||document.querySelector('link[media="print"]'),F_.media.mediaText="all",V_.setAttribute("media","all"),!!F_}function z_(){F_.media.mediaText="print",V_.setAttribute("media","print"),document.querySelectorAll(".print-height-adjusted, .print-width-adjusted, .main").forEach(t=>{t.removeAttribute("style"),t.classList.remove("print-height-adjusted","print-width-adjusted")}),m(".back-to-screen-view").off("click").remove()}function j_(t,e=500){let n=new We;var r=document.querySelector(".main"),i="print-width-adjusted",o=n.waitForClassChange(r,i);return r.style.width=(t=>{let e={Letter:[8.5,11],Legal:[8.5,14],Tabloid:[11,17],Ledger:[17,11],A0:[33.1,46.8],A1:[23.4,33.1],A2:[16.5,23.4],A3:[11.7,16.5],A4:[8.27,11.7],A5:[5.83,8.27],A6:[4.13,5.83]};return t.landscape="boolean"==typeof t.landscape?t.landscape:"landscape"===t.orientation,delete t.orientation,void 0===t.margin?t.margin=.4:/^[\d.]+in$/.test(t.margin.trim())?t.margin=parseFloat(t.margin,10):/^[\d.]+cm$/.test(t.margin.trim())?t.margin=parseFloat(t.margin,10)/2.54:/^[\d.]+mm$/.test(t.margin.trim())&&(t.margin=parseFloat(t.margin,10)/25.4),t.format="string"==typeof t.format&&void 0!==e[t.format]?t.format:"A4",((!0===t.landscape?e[t.format][1]:e[t.format][0])-2*t.margin)*U_+"px"})(t),r.classList.add(i),o.then(()=>{let r=[],i;var t=document.querySelector("#form-title");let o=t?t.offsetWidth-1:null,a=document.querySelectorAll(".question:not(.draft), .trigger:not(.draft)");return a.forEach((t,e)=>{var e=e===a.length-1,n=m(t).offset().top;n===(i=i||0===i?i:n)&&(r=r.concat(t)),e&&q_(r,o),n>i?(q_(r,o),e&&!r.includes(t)?q_([t],o):(r=[t],i=m(t).offset().top)):i<n&&console.error("unexpected question top position: ",n,"for element:",t,"expected >=",i)}),n.waitForQuietness().then(()=>new Promise(t=>setTimeout(t,e)))})}function q_(t,r){let i=[],o=0,e=0;if(t.forEach(t=>{t=Number(m(t).css("width").replace("px",""));i.push(t),o+=t}),o<r){let n=r-o;t.forEach((t,e)=>{e=i[e]+i[e]/o*n;t.style.width=Math.floor(100*e/r*100)/100+"%",t.classList.add("print-width-adjusted")})}t.forEach(t=>{t=t.offsetHeight;e=t>e?t:e}),t.forEach(t=>{t.classList.contains("or-appearance-image-map")||(t.classList.add("print-height-adjusted"),t.style.height=e+"px")})}function W_(t){if("grid"===t||!t&&/theme-.*grid.*/.test(document.querySelector("form.or").getAttribute("class"))){let e=!1;ts.prompt("Enter valid paper format","A4").then(t=>{if(t)return e=H_(),j_({format:t});throw new Error("Print cancelled by user.")}).then(window.print).catch(console.error).then(()=>{e&&setTimeout(z_,500)})}else window.print()}document.addEventListener("DOMContentLoaded",()=>{return t={},(e=document.body.appendChild(document.createElement("DIV"))).style.width="1in",e.style.padding="0",t.v=e.offsetWidth,e.parentNode.removeChild(e),void(U_=t.v);var t,e}),ot.supportEmail,ot.supportEmail;let G_={};function $_(){console.log("positionPageAndBar called");var t,e,n=m("header.navbar"),r=n.outerHeight()||0,i=m("#feedback-bar"),o=0<i.find("p").length,a=i.outerHeight(),s=m("#page"),l=w_.isShowing(),u=s.outerHeight()||0;s.css({position:n.css("position")}),0<n.length&&"fixed"!==n.css("position")?(o||i.hide(),l||s.hide()):(t=o?r:0-a,e=l?o?t+a:r:0-u,setTimeout(function(){i.css("top",t+"px"),s.css("top",e+"px")},100))}G_.init=function(){__.setup(),w_.init(),m(document).on("click","#feedback-bar .close",function(t){return C_.hide(),!1}),m(document).on("click",".touch #feedback-bar",function(t){C_.hide()}),m(document).on("click","#page .close",function(t){return w_.close(),!1}),m(document).on("click",".side-slider .close",function(t){m("body").removeClass("show-side-slider")}),m("button.print").on("click",function(){W_()}),m(".side-slider-toggle").on("click",function(){m(".lang","aside").each(function(){var t=m(this),e=t.data("lang");console.log("code: "+e),e&&t.html(C(e))});var t=m("body");window.scrollTo(0,0),t.toggleClass("show-side-slider")}),m(".offline-enabled-icon").on("click",function(){G_.alert("<p>This form can now be loaded and used without an Internet connection on this device. Bookmark it for easy offline access.<p>Records are automatically stored and queued on your computer until an Internet connection is available. When the app is online, records will be automatically submitted - one by one.</p><p>Only after a record has been succesfully submitted, it will be removed from the queue. You can safely close down your browser and computer with items in the queue. They will still be there next time you load the form.</p>","Form works offline!","normal")}),m(document).on("click",'a[href^="#"]:not([href="#"]):not(nav ul li a)',function(t){var e=m(this).attr("href");console.log("captured click to nav page, href="+e),"#"!==e&&(t.preventDefault(),m('nav li a[href="'+e+'"]').click())}),m('nav ul li a[href^="#"]').click(function(t){t.preventDefault();t=m(this).attr("href").substr(1);w_.open(t),m(this).closest("li").addClass("active").siblings().removeClass("active")}),m(window).on("onlinestatuschange",function(t,e){b_.connection(e)}),m(document).on("edit","form.jr",function(t,e){b_.edit(e)}),m(document).on("browsersupport",function(t,e){b_.support(e)}),m("#page, #feedback-bar").on("changepagebar",function(){$_()}),m(document).on("xpatherror",function(t,e){var n=ot.supportEmail;G_.alert('A formula evaluation error occurred. Please contact <a href="mailto:'+n+"?subject=xpath errors for: "+location.href+"&body="+e+'" target="_blank" >'+n+'</a> with this error:<ul class="error-list"><li>'+e+"</li></ul>","Formula Error")}),m(".ad .close").on("click",function(){m(this).closest(".ad").remove()}),m("footer").detach().appendTo("#container"),$_(),ot.touch?(Modernizr.touch=!0,m("html").addClass("touch")):!1===ot.touch&&(Modernizr.touch=!1,m("html").removeClass("touch"))},__={setup:function(){m("article.page").each(function(){var t="",e=m(this).attr("id"),n=m(this).attr("data-display-icon")?'<span class="glyphicon glyphicon-'+m(this).attr("data-display-icon")+'" > </span>':m(this).attr("data-display")?m(this).attr("data-display"):e,t=m(this).attr("data-title")?m(this).attr("data-title"):e,e=m(this).attr("data-ext-link")?m(this).attr("data-ext-link"):"#"+e;m('<li class=""><a href="'+e+'" title="'+t+'" >'+n+"</a></li>").appendTo(m(".navbar-right"))})},reset:function(){m("nav ul li").removeClass("active")}},w_={init:function(){this.$pages=m("<pages></pages>"),m("article.page").detach().appendTo(this.$pages)},get:function(t){var e=this.$pages.find('article[id="'+t+'"]');return 0<e.length?e:m('article[id="'+t+'"]')},isShowing:function(t){return 0<m("#page article.page"+(void 0!==t?'[id="'+t+'"]':"")).length},open:function(t){m("header");var e=this;this.isShowing(t)||(1!==(t=this.get(t)).length?console.error("page not found"):(this.isShowing()&&this.close(),m("#page .content").prepend(t.show()).trigger("changepagebar"),m("#page").show(),m(".main").css("opacity","0.3"),m(window).on("resize.pageEvents",function(){m("#page").trigger("changepagebar")}),setTimeout(function(){m(window).on("click.pageEvents",function(t){return 0===m(t.target).parents("#page").length&&e.close(),!0})},1e3)))},close:function(){var t=m("#page .page");0<t.length&&(this.$pages.append(t.detach()),m("#page").trigger("changepagebar"),m(".navbar-right li").removeClass("active"),m(window).off(".pageEvents")),m(".main").css("opacity","1")}},C_={show:function(t,e){var n;e=e?1e3*e:1e4,m("#feedback-bar p").eq(1).remove(),m("#feedback-bar p").html()!==t&&((n=m("<p></p>")).append(t),m("#feedback-bar").prepend(n)),m("#feedback-bar").show().trigger("changepagebar"),setTimeout(function(){void 0!==n&&n.remove(),m("#feedback-bar").trigger("changepagebar")},e)},hide:function(){m("#feedback-bar p").remove(),m("#feedback-bar").trigger("changepagebar")}},G_.feedback=function(t,e,n,r){n=n||"Information",Modernizr.touch?r?G_.confirm({msg:t,heading:n},r,null,e):G_.alert(t,n,"info",e):C_.show(t,e)},G_.alert=function(t,e,n,r){var i,o,a=m("#dialog-alert");e=e||"Alert",n="normal"===(n=n||"danger")?"":"alert alert-"+n,a.find(".modal-header h3").text(e),a.find(".modal-body p").removeClass().addClass(n).html(t).capitalizeStart(),a.find(".close, .close-dialog").on("click",function(){a.hide()}),a.show(),a.on("hidden.bs.modal",function(){a.find(".modal-body h4, .modal-body p").html(""),clearInterval(i)}),"number"==typeof r&&(o=r,a.find(".self-destruct-timer").text(o),i=setInterval(function(){o--,a.find(".self-destruct-timer").text(o)},1e3),setTimeout(function(){clearInterval(i),a.find(".close").click()},1e3*r))},G_.confirm=function(t,e,n,r){var i,o,a,s,l,u;function c(){console.log("confirm dialog reset called"),s.off("shown hidden hide"),m("body>.modal-backdrop").remove(),s.find("button.positive, button.negative").off("click"),s.find(".modal-body .msg, .modal-body .alert-danger, button").text("")}"string"==typeof t?i=t:"string"==typeof t.msg&&(i=t.msg),i=i||C("confirm.default.msg"),o=t.heading||C("confirm.default.heading"),a=t.errorMsg||"",t.dialog||C("confirm.default.posButton"),n=n||{},(e=e||{}).posButton=e.posButton||C("confirm.default.posButton"),e.negButton=e.negButton||C("confirm.default.negButton"),e.posAction=e.posAction||function(){},e.negAction=e.negAction||function(){},e.beforeAction=e.beforeAction||function(){},(s=m("#dialog-confirm")).find(".modal-body h4").text(o),s.find(".modal-body .msg").html(i).capitalizeStart(),s.find(".modal-body .alert-danger").html(a).show(),a||s.find(".modal-body .alert-danger").hide(),m("#recname").text(C("confirm.save.name")),s.find("input, select, textarea").each(function(){var t=m(this).attr("name");m(this).val(n[t]||"")}),s.show(),s.on("shown.bs.modal",function(){e.beforeAction.call()}),s.find("button.positive").on("click",function(){var t={};m(this).closest(".modal-dialog").find("input, select, textarea").each(function(){m(this).attr("name")&&(t[m(this).attr("name")]=m(this).val().trim())}),s.hide(),c(),e.posAction.call(void 0,t)}).text(e.posButton),s.find("button.negative").on("click",function(){s.hide(),c(),e.negAction.call()}).text(e.negButton),"number"==typeof r&&(u=r.toString(),s.find(".self-destruct-timer").text(u),l=setInterval(function(){u--,s.find(".self-destruct-timer").text(u)},1e3),setTimeout(function(){clearInterval(l),s.find(".close").click()},1e3*r))},G_.showLoadErrors=function(t,e){var n='<ul class="error-list"><li>'+t.join("</li><li>")+"</li></ul>",r="* "+t.join("* "),t=1<t.length?"s":"",i=ot.supportEmail;e=e||"",G_.alert("<p>Error"+t+" occured during the loading of this form. "+e+'</p><br/><p>Please contact <a href="mailto:'+i+"?subject=loading errors for: "+location.href+"&body="+r+'" target="_blank" >'+i+"</a> with the link to this page and the error message"+t+" below:</p>"+n,"Loading Error"+t)},b_={connection:function(t){},edit:function(t){t?m("header #status-editing").removeClass().addClass("ui-icon ui-icon-pencil").attr("title","Form is being edited."):m("header #status-editing").removeClass().attr("title","")},support:function(t){},offlineLaunch:function(t){t?m(".offline-enabled-icon.not-enabled").removeClass("not-enabled"):m(".offline-enabled-icon").addClass("not-enabled")}},G_.init();let K_="jr://instance/last-saved",X_=()=>Array.isArray(surveyData.external)&&surveyData.external.some(t=>t?.src===K_),Z_=()=>"other"===ot.type&&V.available&&X_(),Y_=n=>V.available&&"other"===ot.type?new Promise((e,t)=>{V.getLastSavedRecord(n).then(t=>{null!=t?(V.removeLastSavedRecord(surveyData.surveyIdent),e(Object.assign(t,{id:n}))):e()})}):Promise.resolve(),Q_=new DOMParser,J_=t=>{var e;return null!=t&&Z_()?Q_.parseFromString(t.data,"text/xml"):(t=Q_.parseFromString(surveyData.modelStr,"text/xml").querySelector("model > instance > *").cloneNode(!0),(e=document.implementation.createDocument(null,"",null)).appendChild(t),e)},tw=t=>{if(X_()){let e=J_(t);surveyData.external=surveyData.external.map(t=>t?.src===K_?{...t,xml:e}:t)}},ew=r=>new Promise((t,e)=>{var n=Z_()?{...r,_surveyId:surveyData.surveyIdent}:null;null==n?(V.removeLastSavedRecord(surveyData.surveyIdent),t()):V.setLastSavedRecord(n).then(()=>{t()},()=>{e()})}),nw={};function rw(t,e,n,r,i,o){var a,s,l,u,c,h;nw.isSuccess(t.status)?(m(document).trigger("submissionsuccess",[e.name,e.instanceID]),n?(console.debug("Refresh Form"),window.onbeforeunload=void 0,window.location.reload(!0)):surveyData.showDonePage&&(window.location.href="/app/myWork/done.html")):403!=t.status&&401!=t.status||(a=e,m.ajax({url:"/surveyKPI/login/key?form=user",dataType:"json",cache:!1,success:function(t){var e;"iframe_record"==a.name?surveyData.key=t.key:((e=Q.getRecord(a.name)).accessKey=t.key,Q.setRecord(a.name,e,!0,!0,e.key))},error:function(t,e,n){removeHourglass(),0!=t.readyState&&0!=t.status&&alert("Error: Failed to get access key: "+n)}})),o&&(n=t,o=r,r=i,i=(i=e).name,s="",l=[],u="error",c="Contact "+settings.supportEmail+" please.",void 0!==(c={0:{success:!(h="Sorry, the server is not available. Please try again later or contact your administrator."),msg:"Failed (offline?). The browser will retry to send when back online. Please do not close this page."},200:{success:!1,msg:"Data server did not accept data. "+c},201:{success:!0,msg:"Done!"},202:{success:!0,msg:"Done! (duplicate)"},"2xx":{success:!1,msg:"Unknown error occurred when submitting data. "+c},400:{success:!1,msg:n.message},401:{success:!1,msg:"Authorisation expired. Refresh your browser. "},403:{success:!1,msg:"Authorisation expired. Refresh your browser. "},404:{success:!1,msg:"Submission service on data server not found."},"4xx":{success:!1,msg:"Unknown submission problem on data server."},413:{success:!1,msg:"Data is too large. Please contact "+settings.supportEmail+"."},500:{success:!1,msg:h},503:{success:!1,msg:h},"5xx":{success:!1,msg:h}})[n.status]&&!0===c[n.status].success?u="success":void 0!==n.msg?s=n.msg:void 0!==c[n.status]?s=c[n.status].msg:500<n.status?(console.error("Error during uploading, received unexpected statuscode: "+n.status),s=c["5xx"].msg):400<n.status?(console.error("Error during uploading, received unexpected statuscode: "+n.status),s=c["4xx"].msg):200<n.status&&(console.error("Error during uploading, received unexpected statuscode: "+n.status),s=c["2xx"].msg),l.push(i),"success"===u?G_.feedback(C("alert.queuesubmissionsuccess.msg",{count:l.length,recordNames:i})):(s=i+" "+s,!o||r?G_.feedback(s,10,"Failed data submission"):G_.alert(s,"Failed data submission"))),V.writeLog("submit",e.name,t.status,e.instanceID)}async function iw(t,e,n,r){for(var i,o=(t=>{var e="";return t.accessKey&&(e="/key/"+t.accessKey),t=t.instanceStrToEditId?"/submission"+e+"/"+t.instanceStrToEditId:"/submission"+e,e="webform",navigator.userAgent&&(/iPhone/i.test(navigator.userAgent)?e="iPhone":/iPad/i.test(navigator.userAgent)?e="iPad":/iPod/i.test(navigator.userAgent)?e="iPod":/Android/i.test(navigator.userAgent)&&(e="Android")),t+="?deviceID="+e})(e),a=0,s=!0;a<r.length||s;){var l,u=a,s=!1,c=0;for((l=new FormData).append("xml_submission_data",n),e.assignmentId&&l.append("assignment_id",e.assignmentId),c+=n.length;a<r.length;a++){var h=void 0,d=void 0,d=r[a].blob?(h=r[a].blob,r[a].fileName):(r[a].dataUrl?(h=t.dataURLtoBlob(r[a].dataUrl),r[a]):h=r[a]).name;if(console.log("++++++++++ append file: "+d),h&&(l.append(d,h,d),c+=r[a].size,a+1<r.length)&&(100<a-u+1||1e7<c+r[a+1].size)){console.log("Splitting large post"),l.append("*isIncomplete*","yes"),++a;break}}if(i=await((t,e)=>new Promise(n=>{console.debug("Submit: "+t),m.ajax(t,{type:"POST",data:e,cache:!1,contentType:!1,processData:!1,timeout:0,dataType:"json",complete:function(t){var e={status:t.status,msg:t.statusText};t.responseJSON&&(e.msg+=" : "+t.responseJSON.message),n(e)}})}))(o,l),!nw.isSuccess(i.status))return console.log("error"),i}return console.log("Finished submission"),i}nw.send=function(u,c,h,d,p,f,g){return console.log("submit called from: "+c),new Promise((n,t)=>{var r,i,a,s,l,o=[];if(h.data){(r=new S(h.data)).init(),i=r.getStr(),i=nw.fixIosMediaNames(i),h.instanceID=r.instanceID,h.name=h.key;let e=g||"submitQueue"!==c;d?(o=h.media||nw.getMedia(),iw(u,h,i,o).then(t=>{rw(t,h,p,d,f,e),n(t)})):(a=u,s=r.instanceID,l=r,new Promise((r,e)=>{var t,n=a?m(l.data.modelStr).find('[type="file"]').removeAttr("type"):[],i=[],o=[];a?n.each(function(){t={fileName:m(this).text()},i.push(a.retrieveFile(s,t))}):e("Database store not found"),Promise.all(i).then(function(t){for(var e=[],n=0;n<t.length;n++)t[n].blob?o.push(t[n]):e.push(t[n].fileName);0<e.length&&alert("Cound not find the following files: "+e.join("")),r(o)}).catch(t=>{e(t.toString())})}).then(t=>{iw(u,h,i,t).then(t=>{rw(t,h,p,d,f,e),n(t)})}))}else t("Record has no data")})},nw.isSuccess=function(t){return 201==t||202==t},nw.fixIosMediaNames=function(t){var t=m.parseXML(t),n=0,r=0;return m(t).find('[type="file"]').each(function(){var t=m(this),e=t.text();"image.jpg"===e&&(e="image_"+n+".jpg",t.text(e),n++),"capturedvideo.MOV"===e&&(e="capturedvideo_"+r+".MOV",t.text(e),r++)}),(new XMLSerializer).serializeToString(t)},nw.getMedia=function(){var e,n,r,i,o,a,s=[];return m('[type="file"]').each(function(){e=m(this),n=e.parent().find(".file-preview").find("img"),r=e[0];var t=e.parent().find('input[type="file"]').data("filename-postfix")||"";if(0==r.files.length&&0<n.length)s.push({name:e.attr("data-loaded-file-name"),dataUrl:n.attr("src"),size:n.attr("src").length});else for(i=0;i<r.files.length;i++)o=r.files[i].name,1<(a=o.split(".")).length?a[a.length-2]+=t:1===a.length&&(a[0]+=t),o=a.join("."),s.push({fileName:o,dataUrl:n.attr("src"),size:r.files[i].size})}),s},m.fn.capitalizeStart=function(t){t=t||1;var e=this.contents().filter(function(){return 3==this.nodeType}).first(),n=e.text(),t=n.split(" ",t).join(" ");e.length&&(e[0].nodeValue=n.slice(t.length),e.before('<span class="capitalize">'+t+"</span>"))},m.fn.btnBusyState=function(t){var e,n;return this.each(function(){e=m(this),n=e.data("btnContent"),t&&!n?(n=e.html(),e.data("btnContent",n),e.empty().append("<progress></progress>").attr("disabled",!0)):!t&&n&&(e.data("btnContent",null),e.empty().append(n).removeAttr("disabled"))})};let ow={},aw=new DOMParser;var sw=!1,lw=!1,uw=!1;function cw(t){!t&&E_.editStatus?(t={posAction:function(){hw()}},G_.confirm("There are unsaved changes, would you like to continue <strong>without</strong> saving those?",t)):hw()}function hw(){bw().then(()=>{var t,e;vw(!1),t=null,(e=m(".side-slider .record-list")).find("li").removeClass("active"),t&&e.find('li[name="'+t+'"]').addClass("active"),surveyData.instanceStrToEditId=null,E_.resetView(),(E_=new B_("form.or:eq(0)",{modelStr:surveyData.modelStr,external:surveyData.external,xml:surveyData.xml})).init(),S_=m("form.or"),T_=m(".form-progress"),L_=E_.getDataStr(!0,!0)})}function dw(e,t,n,r){var i,o,a,s=0,l=ml.getCurrentFiles(),u=nw.getMedia();if(0<u.length)for(a=0;a<u.length;a++)u[a].dataUrl&&0!=u[a].dataUrl.indexOf("blob:")&&l.push(u[a]);r=r||_w(),console.log("saveRecord called with recordname:"+e,"confirmed:"+t,"error:"+n+"draft:"+r),document.body.dispatchEvent(new Event("before-save")),t=void 0!==t&&t,(e=e||E_.recordName||E_.surveyName+" - "+A_.getCounterValue())?(r&&!t||E_.validate().then(function(t){if(t||r){var t=window.location.href.split("?"),n=(o={draft:r,form:t[0],data:E_.getDataStr(!0,!0),instanceStrToEditId:surveyData.instanceStrToEditId,assignmentId:surveyData.assignmentId,accessKey:surveyData.key},E_.instanceID);if(0<l.length)for(I_.delete(n,!1),a=0;a<l.length;a++)l[a].dataUrl?I_.saveFile(l[a],n):(e=>{ml.getDataUrl(l[e]).then(function(t){l[e].dataUrl=t,I_.saveFile(l[e],n)})})(a,l[a]),++s===l.length&&pw(e,o,r,l);else pw(e,o,r,l);r&&I_.writeLog("save",e,"",o.accessKey),surveyData.instanceStrToEditId=void 0,surveyData.assignmentId=void 0,surveyData.instanceStrToEdit=void 0}else G_.alert(C("alert.validationerror.msg"))}),r&&!t&&(t={dialog:"save",msg:"",heading:C("formfooter.savedraft.label"),errorMsg:n},i={posButton:C("confirm.save.posButton"),negButton:C("confirm.default.negButton"),posAction:function(t){E_.recordName&&E_.recordName!==t["record-name"]?G_.confirm({msg:'Are you sure you want to rename "'+E_.recordName+'"" to "'+t["record-name"]+'"?'},{posAction:function(){dw(t["record-name"],!0,n)}}):dw(t["record-name"],!0,n)},negAction:function(){return!1}},G_.confirm(t,i,{"record-name":e}))):console.log("No record name could be created.")}function pw(r,i,t,o){var e;window.smapConfig.myWork?((e={task:{},assignment:{},location:{},record:{}}).task.title=r,e.assignment.assignment_status=i.draft?"accepted":"complete",e.record.data=i.data,I_.setRecord(e,void 0).catch(t=>{G_.alert("Error trying to save data in mywork database (message: "+t+")")})):(e=E_.recordName===r,e=A_.setRecord(r,i,!0,e,E_.recordName),console.log("saveResult: "+e),"success"===e?t?(G_.feedback(C("alert.recordsavesuccess.draftmsg"),3),cw(!0),S_.trigger("save",JSON.stringify(A_.getRecordList()))):(G_.feedback(C("alert.recordsavesuccess.finalmsg"),3),ew(i).then(()=>{var t,e,n;t=r,n=o,(e=i).draft||(ww("start","manual"),nw.send(I_,"submitOneForced",{key:t,data:e.data,assignmentId:e.assignmentId,instanceStrToEditId:e.instanceStrToEditId,accessKey:e.accessKey,media:n},!0,gw(),!0).then(()=>{ww("stop","manual")}).catch(t=>{ww("stop","manual"),G_.alert(t,"Record Error")})),cw(!0),S_.trigger("save",JSON.stringify(A_.getRecordList()))})):"require"===e||"existing"===e||"forbidden"===e?dw(void 0,!1,'Record name "'+r+'" already exists (or is not allowed). The record was not saved.'):G_.alert("Error trying to save data locally (message: "+e+")"))}function fw(t){var e;document.body.dispatchEvent(new Event("before-save")),E_.isValid()?(e={key:"iframe_record",data:E_.getDataStr(!0,!0),instanceStrToEditId:surveyData.instanceStrToEditId,assignmentId:surveyData.assignmentId,accessKey:surveyData.key,media:ml.getCurrentFiles()},nw.send(I_,"submitEditedRecord",e,!0,t,!1).then(t=>{nw.isSuccess(t.status)&&cw(!0)})):G_.alert(C("alert.validationerror.msg"))}function gw(){return!(!surveyData.assignmentId&&!surveyData.closeAfterSending||(console.log("Close after saving"),0))}function mw(){return A_.isSupported()&&sw&&(console.log("Can Save record:"),1)}async function yw(t){var e,n=A_.getSurveyDataArr(!0);if(!lw&&!uw){if(t&&0===n.length&&G_.alert(C("record-list.nocomprecords")),S_.trigger("save",JSON.stringify(A_.getRecordList())),ww("start","auto"),m(".record-list").find("li").removeClass("error"),0<n.length)for(t&&G_.feedback(C("formfooter.submit.btn")),e=0;e<n.length;e++)await nw.send(I_,"submitQueue",n[e],!1,!1,!0,t);return ww("stop","auto"),"done"}}function vw(t){t=t||!1,m('.form-footer [name="draft"]').prop("checked",t).trigger("change")}function _w(){return m('.form-footer [name="draft"]').prop("checked")}function ww(t,e){"start"===t?("auto"===e?lw=!0:"manual"===e&&(uw=!0),m("#hour_glass").show()):"stop"===t&&("auto"===e?lw=!1:"manual"===e&&(uw=!1),m("#hour_glass").hide())}function bw(){return new Promise(e=>{surveyData.external&&0<surveyData.external.length?Y_(surveyData.surveyIdent).then(t=>tw(t)).then(t=>{e()}):e()})}ow.init=function(t,n){m("article").hide(),m(".loader").show(),setTimeout(function(){window.onbeforeunload=function(){if((()=>{var t;if(void 0!==E_)return(t=E_.getDataStr(!0,!0))&&L_!=t})())return"You have unsaved changes. Are you sure you want to leave?"},I_=(n=n||{}).dbStore,A_=n.recordStore||null,surveyData.instanceStrToEdit=surveyData.instanceStrToEdit||null,surveyData.instanceStr=surveyData.instanceStrToEdit||null,surveyData.xml=aw.parseFromString(surveyData.modelStr,"text/xml"),surveyData.instanceStrToEdit||Cw(),bw().then(()=>{A_.isSupported()&&((t=A_.getKey("draft"))?((e=A_.getRecord(t))&&(surveyData.instanceStrToEdit=e.data,surveyData.instanceStr=e.data,surveyData.instanceStrToEditId=e.instanceStrToEditId,surveyData.assignmentId=e.assignmentId,surveyData.key=e.accessKey,surveyData.submitted=!1,(e=new S(e.data)).init(),window.gLoadedInstanceID=e.instanceID),A_.removeRecord("draft")):window.gLoadedInstanceID=void 0),I_.isSupported().then(t=>{t?(sw=!0,A_&&0!==A_.getRecordList().length||I_.delete(void 0,!0)):(sw=!1,G_.alert("Warning: Storage is not supported by your browser. Hence it is not possible to save the survey as draft and do not close the browser window until the completed surveyhas been sent successfully",void 0,"normal",void 0))});var t,e=(E_=new B_("form.or:eq(0)",surveyData)).init();t&&(E_.recordName=t),0<e.length&&(t=surveyData.instanceStr?C("alert.loaderror.editadvice"):C("alert.loaderror.entryadvice"),G_.showLoadErrors(e,t)),m(".loader").hide(),m("article").show(),S_=m("form.or"),T_=m(".form-progress"),m("button#reset-form").click(function(){cw()}),m("button#submit-form").click(function(){var t=m(this);t.btnBusyState(!0),setTimeout(function(){if(!surveyData.viewOnly)return mw()?dw():_w()?(vw(!1),t.btnBusyState(!1),t.text(C("formfooter.submit.btn")),G_.alert("Your browser does not support saving media files")):(E_.validate(),fw(gw())),t.btnBusyState(!1),!1;window.open("","_self").close()},100)}),m("button#exit-form").click(function(){window.onbeforeunload=void 0,window.open("","_self").close()}),m("button#submit-form-single").click(function(){var t;surveyData.viewOnly?window.open("","_self").close():((t=m(this)).btnBusyState(!0),setTimeout(function(){return mw()?dw():_w()?(vw(!1),t.btnBusyState(!1),t.text(C("formfooter.submit.btn")),G_.alert("Your browser does not support saving media files")):(E_.validate(),fw(!0)),t.btnBusyState(!1),!1},100))}),m('.form-footer [name="draft"]').on("change",function(){var t=m(this).prop("checked")?C("formfooter.savedraft.btn"):C("formfooter.submit.btn");m("#submit-form").text(t)}),m(document).on("click","button#validate-form:not(.disabled)",function(){var t;void 0!==E_&&((t=m(this)).btnBusyState(!0),setTimeout(function(){E_.validate(),t.btnBusyState(!1),E_.isValid()||G_.alert(C("alert.validationerror.msg"))},100))}),m(document).on("click",".export-records",function(){var t,e=E_.getSurveyName()+"_data_backup.xml",n=A_.getExportStr();n?(t=settings.serverURL||"",t=vkbeautify.xml('<export date="'+new Date+'" server="'+t+'">'+n+"</export>"),n=e,e=t,e=new Blob([t],{type:"text/plain; charset=utf-8"}),saveAs(e,n)):G_.alert("No records in queue. The records may have been successfully submitted already.")}),m(document).on("click",".upload-records:not(:disabled)",function(){lw||uw?G_.alert(C("alert.submission.msg")):yw(!0)}),m(document).on("click",".delete-records:not(:disabled)",function(){var t=C("confirm.deleteall.msg"),e={posAction:function(){var t,e=A_.getSurveyDataArr(!1);for(S_.trigger("save",JSON.stringify(A_.getRecordList())),t=0;t<e.length;t++){var n,r=e[t],i=r.key,r=new S(r.data);r&&(r.init(),n=r.instanceID),I_.delete(n,!1),A_&&A_.removeRecord(i),I_.writeLog("delete",i,"",n)}I_.delete(void 0,!0)}};G_.confirm(t,e)}),m(document).on("click",".record.error",function(){var t=m(this).attr("name"),t=m(this).siblings('[name="'+t+'"]');t.is(":visible")?t.hide(500):t.show(500)}),m(document).on("click",'.record-list [data-draft="true"]',function(){!function t(e,n){{var r;!n&&E_.editStatus?(n={msg:"The current form has unsaved changes. Would you like to load a record <strong>without saving changes</strong> to the form you were working on?",heading:"Unsaved edits"},r={posButton:"Proceed without saving",posAction:function(){t(e,!0)}},G_.confirm(n,r)):(n=A_.getRecord(e))&&n.data&&(A_.setKey("draft",e),r=n.form,"?debug=yes"==window.location.search&&(r+="?debug=yes"),window.location.replace(r))}}(m(this).closest(".record").attr("name"),!1)}),m(document).on("save delete","form.or",function(t,e){var n,r,i,o,a;n=JSON.parse(e),m(".side-slider .upload-records, .side-slider .export-records"),a=m(".side-slider .record-list"),console.log("updating record list"),n=n||[],m(".queue-length").text(n.length),a.find(".record").each(function(){if(r=m(this).attr("name"),console.log("Name: "+r),0===m.grep(n,function(t){return t.key==r}).length)try{m(this).siblings('[name="'+r+'"]').addBack().hide(2e3,function(){m(this).remove()})}catch(t){console.error(t)}}),0<n.length?(a.find(".no-records").remove(),m(".side-slider .export-records").removeAttr("disabled"),n.forEach(function(t){r=t.key,i=t.draft;try{0===(o=a.find('[name="'+r+'"]')).length&&((o=m('<li class="record"></li>')).text(r),o.attr("name",r),a.append(o)),o.attr("data-draft",i)}catch(t){console.error(t)}})):0===a.find(".no-records").length&&a.append('<li class="no-records">'+C("record-list.norecords")+"</li>")}),m(document).on("submissionsuccess",function(t,e,n){I_.isSupported().then(t=>{t&&I_.delete(n,!1)}),A_&&A_.removeRecord(e),console.log("After submission success, attempted to remove record with key:"+e+"and files in folder:"+n)}),m(document).on("progressupdate","form.or",function(t,e){0<T_.length&&T_.css("width",e+"%")}),surveyData.viewOnly&&(m('.form-footer [name="draft"]').parent().hide(),m("#submit-form, #submit-form-single").text("close")),L_=E_.getDataStr(!0,!0),A_&&(e="width:48%; white-space: normal;padding-left:5px; padding-right:5px;",m(".side-slider").append('<h3 class="lang" data-lang="record-list.title">queue</h3><p class="lang" data-lang="record-list.msg1">Records are stored</p><progress class="upload-progress"></progress><ul class="record-list"></ul><a type="button" href="/app/myWork/history.html" target="_blank" class="btn btn-default lang show-history full-width" data-lang="record-list.history">h</a><div class="button-bar"><button class="btn btn-primary upload-records lang pull-left" data-lang="record-list.upload" style="'+e+'">upload</button><button class="btn btn-default delete-records pull-right lang" data-lang="confirm.deleteall.posButton"style="'+e+'">Delete</button></div><p class="lang" data-lang="record-list.msg2-nodraft" >Queued records</p><p class="lang" data-lang="record-list.msg3" >Foce Upload</p>'),S_.trigger("save",JSON.stringify(A_.getRecordList()))),n.submitInterval&&(window.setInterval(function(){yw(!1)},n.submitInterval),window.setTimeout(function(){yw(!1)},5e3))})},0)};let Cw=()=>{surveyData.external=[],[...surveyData.xml.querySelectorAll("instance[id][src]")].map(t=>({id:t.id,src:t.getAttribute("src")})).forEach((t,e)=>{var n=t.src;n===K_&&surveyData.external.push(t)})};window.jQuery=m,window.enketo=ow,"undefined"!=typeof surveyData&&C.init().then(function(){ow.init("form.or:eq(0)",{recordStore:Q,dbStore:V,submitInterval:3e5}),m(".lang").each(function(){var t=m(this),e=t.data("lang");e&&t.html(C(e))})})})();